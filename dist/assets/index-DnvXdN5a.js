var J_=Object.defineProperty;var Y_=(t,e,n)=>e in t?J_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Zn=(t,e,n)=>Y_(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var To=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ms(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ey={exports:{}},yl={},Sy={exports:{}},se={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gs=Symbol.for("react.element"),Q_=Symbol.for("react.portal"),X_=Symbol.for("react.fragment"),eb=Symbol.for("react.strict_mode"),tb=Symbol.for("react.profiler"),nb=Symbol.for("react.provider"),rb=Symbol.for("react.context"),ib=Symbol.for("react.forward_ref"),ab=Symbol.for("react.suspense"),sb=Symbol.for("react.memo"),ob=Symbol.for("react.lazy"),Oh=Symbol.iterator;function lb(t){return t===null||typeof t!="object"?null:(t=Oh&&t[Oh]||t["@@iterator"],typeof t=="function"?t:null)}var ky={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Cy=Object.assign,Ty={};function Wi(t,e,n){this.props=t,this.context=e,this.refs=Ty,this.updater=n||ky}Wi.prototype.isReactComponent={};Wi.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Wi.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Oy(){}Oy.prototype=Wi.prototype;function Fd(t,e,n){this.props=t,this.context=e,this.refs=Ty,this.updater=n||ky}var zd=Fd.prototype=new Oy;zd.constructor=Fd;Cy(zd,Wi.prototype);zd.isPureReactComponent=!0;var Nh=Array.isArray,Ny=Object.prototype.hasOwnProperty,Ud={current:null},Iy={key:!0,ref:!0,__self:!0,__source:!0};function Ay(t,e,n){var r,i={},a=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(a=""+e.key),e)Ny.call(e,r)&&!Iy.hasOwnProperty(r)&&(i[r]=e[r]);var o=arguments.length-2;if(o===1)i.children=n;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in o=t.defaultProps,o)i[r]===void 0&&(i[r]=o[r]);return{$$typeof:gs,type:t,key:a,ref:s,props:i,_owner:Ud.current}}function ub(t,e){return{$$typeof:gs,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Bd(t){return typeof t=="object"&&t!==null&&t.$$typeof===gs}function cb(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Ih=/\/+/g;function Xl(t,e){return typeof t=="object"&&t!==null&&t.key!=null?cb(""+t.key):e.toString(36)}function co(t,e,n,r,i){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(a){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case gs:case Q_:s=!0}}if(s)return s=t,i=i(s),t=r===""?"."+Xl(s,0):r,Nh(i)?(n="",t!=null&&(n=t.replace(Ih,"$&/")+"/"),co(i,e,n,"",function(u){return u})):i!=null&&(Bd(i)&&(i=ub(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(Ih,"$&/")+"/")+t)),e.push(i)),1;if(s=0,r=r===""?".":r+":",Nh(t))for(var o=0;o<t.length;o++){a=t[o];var l=r+Xl(a,o);s+=co(a,e,n,l,i)}else if(l=lb(t),typeof l=="function")for(t=l.call(t),o=0;!(a=t.next()).done;)a=a.value,l=r+Xl(a,o++),s+=co(a,e,n,l,i);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function Rs(t,e,n){if(t==null)return t;var r=[],i=0;return co(t,r,"","",function(a){return e.call(n,a,i++)}),r}function db(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ct={current:null},fo={transition:null},fb={ReactCurrentDispatcher:ct,ReactCurrentBatchConfig:fo,ReactCurrentOwner:Ud};function Ry(){throw Error("act(...) is not supported in production builds of React.")}se.Children={map:Rs,forEach:function(t,e,n){Rs(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Rs(t,function(){e++}),e},toArray:function(t){return Rs(t,function(e){return e})||[]},only:function(t){if(!Bd(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};se.Component=Wi;se.Fragment=X_;se.Profiler=tb;se.PureComponent=Fd;se.StrictMode=eb;se.Suspense=ab;se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fb;se.act=Ry;se.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Cy({},t.props),i=t.key,a=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,s=Ud.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)Ny.call(e,l)&&!Iy.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];r.children=o}return{$$typeof:gs,type:t.type,key:i,ref:a,props:r,_owner:s}};se.createContext=function(t){return t={$$typeof:rb,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:nb,_context:t},t.Consumer=t};se.createElement=Ay;se.createFactory=function(t){var e=Ay.bind(null,t);return e.type=t,e};se.createRef=function(){return{current:null}};se.forwardRef=function(t){return{$$typeof:ib,render:t}};se.isValidElement=Bd;se.lazy=function(t){return{$$typeof:ob,_payload:{_status:-1,_result:t},_init:db}};se.memo=function(t,e){return{$$typeof:sb,type:t,compare:e===void 0?null:e}};se.startTransition=function(t){var e=fo.transition;fo.transition={};try{t()}finally{fo.transition=e}};se.unstable_act=Ry;se.useCallback=function(t,e){return ct.current.useCallback(t,e)};se.useContext=function(t){return ct.current.useContext(t)};se.useDebugValue=function(){};se.useDeferredValue=function(t){return ct.current.useDeferredValue(t)};se.useEffect=function(t,e){return ct.current.useEffect(t,e)};se.useId=function(){return ct.current.useId()};se.useImperativeHandle=function(t,e,n){return ct.current.useImperativeHandle(t,e,n)};se.useInsertionEffect=function(t,e){return ct.current.useInsertionEffect(t,e)};se.useLayoutEffect=function(t,e){return ct.current.useLayoutEffect(t,e)};se.useMemo=function(t,e){return ct.current.useMemo(t,e)};se.useReducer=function(t,e,n){return ct.current.useReducer(t,e,n)};se.useRef=function(t){return ct.current.useRef(t)};se.useState=function(t){return ct.current.useState(t)};se.useSyncExternalStore=function(t,e,n){return ct.current.useSyncExternalStore(t,e,n)};se.useTransition=function(){return ct.current.useTransition()};se.version="18.3.1";Sy.exports=se;var Y=Sy.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hb=Y,pb=Symbol.for("react.element"),mb=Symbol.for("react.fragment"),gb=Object.prototype.hasOwnProperty,yb=hb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,vb={key:!0,ref:!0,__self:!0,__source:!0};function Py(t,e,n){var r,i={},a=null,s=null;n!==void 0&&(a=""+n),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)gb.call(e,r)&&!vb.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:pb,type:t,key:a,ref:s,props:i,_owner:yb.current}}yl.Fragment=mb;yl.jsx=Py;yl.jsxs=Py;Ey.exports=yl;var w=Ey.exports,jy={exports:{}},Lt={},Ly={exports:{}},$y={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(T,I){var b=T.length;T.push(I);e:for(;0<b;){var W=b-1>>>1,G=T[W];if(0<i(G,I))T[W]=I,T[b]=G,b=W;else break e}}function n(T){return T.length===0?null:T[0]}function r(T){if(T.length===0)return null;var I=T[0],b=T.pop();if(b!==I){T[0]=b;e:for(var W=0,G=T.length,E=G>>>1;W<E;){var oe=2*(W+1)-1,ue=T[oe],de=oe+1,We=T[de];if(0>i(ue,b))de<G&&0>i(We,ue)?(T[W]=We,T[de]=b,W=de):(T[W]=ue,T[oe]=b,W=oe);else if(de<G&&0>i(We,b))T[W]=We,T[de]=b,W=de;else break e}}return I}function i(T,I){var b=T.sortIndex-I.sortIndex;return b!==0?b:T.id-I.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,o=s.now();t.unstable_now=function(){return s.now()-o}}var l=[],u=[],c=1,d=null,f=3,h=!1,m=!1,v=!1,_=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(T){for(var I=n(u);I!==null;){if(I.callback===null)r(u);else if(I.startTime<=T)r(u),I.sortIndex=I.expirationTime,e(l,I);else break;I=n(u)}}function x(T){if(v=!1,g(T),!m)if(n(l)!==null)m=!0,z(k);else{var I=n(u);I!==null&&F(x,I.startTime-T)}}function k(T,I){m=!1,v&&(v=!1,p(A),A=-1),h=!0;var b=f;try{for(g(I),d=n(l);d!==null&&(!(d.expirationTime>I)||T&&!B());){var W=d.callback;if(typeof W=="function"){d.callback=null,f=d.priorityLevel;var G=W(d.expirationTime<=I);I=t.unstable_now(),typeof G=="function"?d.callback=G:d===n(l)&&r(l),g(I)}else r(l);d=n(l)}if(d!==null)var E=!0;else{var oe=n(u);oe!==null&&F(x,oe.startTime-I),E=!1}return E}finally{d=null,f=b,h=!1}}var S=!1,C=null,A=-1,U=5,j=-1;function B(){return!(t.unstable_now()-j<U)}function Z(){if(C!==null){var T=t.unstable_now();j=T;var I=!0;try{I=C(!0,T)}finally{I?le():(S=!1,C=null)}}else S=!1}var le;if(typeof y=="function")le=function(){y(Z)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,N=L.port2;L.port1.onmessage=Z,le=function(){N.postMessage(null)}}else le=function(){_(Z,0)};function z(T){C=T,S||(S=!0,le())}function F(T,I){A=_(function(){T(t.unstable_now())},I)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(T){T.callback=null},t.unstable_continueExecution=function(){m||h||(m=!0,z(k))},t.unstable_forceFrameRate=function(T){0>T||125<T?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<T?Math.floor(1e3/T):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(T){switch(f){case 1:case 2:case 3:var I=3;break;default:I=f}var b=f;f=I;try{return T()}finally{f=b}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(T,I){switch(T){case 1:case 2:case 3:case 4:case 5:break;default:T=3}var b=f;f=T;try{return I()}finally{f=b}},t.unstable_scheduleCallback=function(T,I,b){var W=t.unstable_now();switch(typeof b=="object"&&b!==null?(b=b.delay,b=typeof b=="number"&&0<b?W+b:W):b=W,T){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=b+G,T={id:c++,callback:I,priorityLevel:T,startTime:b,expirationTime:G,sortIndex:-1},b>W?(T.sortIndex=b,e(u,T),n(l)===null&&T===n(u)&&(v?(p(A),A=-1):v=!0,F(x,b-W))):(T.sortIndex=G,e(l,T),m||h||(m=!0,z(k))),T},t.unstable_shouldYield=B,t.unstable_wrapCallback=function(T){var I=f;return function(){var b=f;f=I;try{return T.apply(this,arguments)}finally{f=b}}}})($y);Ly.exports=$y;var wb=Ly.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _b=Y,At=wb;function R(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var My=new Set,Ba={};function Yr(t,e){Ri(t,e),Ri(t+"Capture",e)}function Ri(t,e){for(Ba[t]=e,t=0;t<e.length;t++)My.add(e[t])}var zn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),pc=Object.prototype.hasOwnProperty,bb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ah={},Rh={};function xb(t){return pc.call(Rh,t)?!0:pc.call(Ah,t)?!1:bb.test(t)?Rh[t]=!0:(Ah[t]=!0,!1)}function Eb(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Sb(t,e,n,r){if(e===null||typeof e>"u"||Eb(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function dt(t,e,n,r,i,a,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=s}var Ye={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ye[t]=new dt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ye[e]=new dt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ye[t]=new dt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ye[t]=new dt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ye[t]=new dt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ye[t]=new dt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ye[t]=new dt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ye[t]=new dt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ye[t]=new dt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Hd=/[\-:]([a-z])/g;function Gd(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Hd,Gd);Ye[e]=new dt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Hd,Gd);Ye[e]=new dt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Hd,Gd);Ye[e]=new dt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ye[t]=new dt(t,1,!1,t.toLowerCase(),null,!1,!1)});Ye.xlinkHref=new dt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ye[t]=new dt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Vd(t,e,n,r){var i=Ye.hasOwnProperty(e)?Ye[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Sb(e,n,i,r)&&(n=null),r||i===null?xb(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Vn=_b.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ps=Symbol.for("react.element"),ui=Symbol.for("react.portal"),ci=Symbol.for("react.fragment"),Wd=Symbol.for("react.strict_mode"),mc=Symbol.for("react.profiler"),Dy=Symbol.for("react.provider"),Fy=Symbol.for("react.context"),Zd=Symbol.for("react.forward_ref"),gc=Symbol.for("react.suspense"),yc=Symbol.for("react.suspense_list"),qd=Symbol.for("react.memo"),Qn=Symbol.for("react.lazy"),zy=Symbol.for("react.offscreen"),Ph=Symbol.iterator;function ia(t){return t===null||typeof t!="object"?null:(t=Ph&&t[Ph]||t["@@iterator"],typeof t=="function"?t:null)}var Ie=Object.assign,eu;function ga(t){if(eu===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);eu=e&&e[1]||""}return`
`+eu+t}var tu=!1;function nu(t,e){if(!t||tu)return"";tu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),a=r.stack.split(`
`),s=i.length-1,o=a.length-1;1<=s&&0<=o&&i[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==a[o]){if(s!==1||o!==1)do if(s--,o--,0>o||i[s]!==a[o]){var l=`
`+i[s].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=s&&0<=o);break}}}finally{tu=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ga(t):""}function kb(t){switch(t.tag){case 5:return ga(t.type);case 16:return ga("Lazy");case 13:return ga("Suspense");case 19:return ga("SuspenseList");case 0:case 2:case 15:return t=nu(t.type,!1),t;case 11:return t=nu(t.type.render,!1),t;case 1:return t=nu(t.type,!0),t;default:return""}}function vc(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ci:return"Fragment";case ui:return"Portal";case mc:return"Profiler";case Wd:return"StrictMode";case gc:return"Suspense";case yc:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Fy:return(t.displayName||"Context")+".Consumer";case Dy:return(t._context.displayName||"Context")+".Provider";case Zd:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case qd:return e=t.displayName||null,e!==null?e:vc(t.type)||"Memo";case Qn:e=t._payload,t=t._init;try{return vc(t(e))}catch{}}return null}function Cb(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return vc(e);case 8:return e===Wd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function _r(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Uy(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Tb(t){var e=Uy(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,a=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,a.call(this,s)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function js(t){t._valueTracker||(t._valueTracker=Tb(t))}function By(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Uy(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Oo(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function wc(t,e){var n=e.checked;return Ie({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function jh(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=_r(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Hy(t,e){e=e.checked,e!=null&&Vd(t,"checked",e,!1)}function _c(t,e){Hy(t,e);var n=_r(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?bc(t,e.type,n):e.hasOwnProperty("defaultValue")&&bc(t,e.type,_r(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Lh(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function bc(t,e,n){(e!=="number"||Oo(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ya=Array.isArray;function Si(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+_r(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function xc(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(R(91));return Ie({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function $h(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(R(92));if(ya(n)){if(1<n.length)throw Error(R(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:_r(n)}}function Gy(t,e){var n=_r(e.value),r=_r(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Mh(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Vy(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ec(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Vy(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ls,Wy=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ls=Ls||document.createElement("div"),Ls.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ls.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ha(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ea={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ob=["Webkit","ms","Moz","O"];Object.keys(Ea).forEach(function(t){Ob.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ea[e]=Ea[t]})});function Zy(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ea.hasOwnProperty(t)&&Ea[t]?(""+e).trim():e+"px"}function qy(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Zy(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var Nb=Ie({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Sc(t,e){if(e){if(Nb[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(R(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(R(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(R(61))}if(e.style!=null&&typeof e.style!="object")throw Error(R(62))}}function kc(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Cc=null;function Kd(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Tc=null,ki=null,Ci=null;function Dh(t){if(t=ws(t)){if(typeof Tc!="function")throw Error(R(280));var e=t.stateNode;e&&(e=xl(e),Tc(t.stateNode,t.type,e))}}function Ky(t){ki?Ci?Ci.push(t):Ci=[t]:ki=t}function Jy(){if(ki){var t=ki,e=Ci;if(Ci=ki=null,Dh(t),e)for(t=0;t<e.length;t++)Dh(e[t])}}function Yy(t,e){return t(e)}function Qy(){}var ru=!1;function Xy(t,e,n){if(ru)return t(e,n);ru=!0;try{return Yy(t,e,n)}finally{ru=!1,(ki!==null||Ci!==null)&&(Qy(),Jy())}}function Ga(t,e){var n=t.stateNode;if(n===null)return null;var r=xl(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(R(231,e,typeof n));return n}var Oc=!1;if(zn)try{var aa={};Object.defineProperty(aa,"passive",{get:function(){Oc=!0}}),window.addEventListener("test",aa,aa),window.removeEventListener("test",aa,aa)}catch{Oc=!1}function Ib(t,e,n,r,i,a,s,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var Sa=!1,No=null,Io=!1,Nc=null,Ab={onError:function(t){Sa=!0,No=t}};function Rb(t,e,n,r,i,a,s,o,l){Sa=!1,No=null,Ib.apply(Ab,arguments)}function Pb(t,e,n,r,i,a,s,o,l){if(Rb.apply(this,arguments),Sa){if(Sa){var u=No;Sa=!1,No=null}else throw Error(R(198));Io||(Io=!0,Nc=u)}}function Qr(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function e0(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Fh(t){if(Qr(t)!==t)throw Error(R(188))}function jb(t){var e=t.alternate;if(!e){if(e=Qr(t),e===null)throw Error(R(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var a=i.alternate;if(a===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return Fh(i),t;if(a===r)return Fh(i),e;a=a.sibling}throw Error(R(188))}if(n.return!==r.return)n=i,r=a;else{for(var s=!1,o=i.child;o;){if(o===n){s=!0,n=i,r=a;break}if(o===r){s=!0,r=i,n=a;break}o=o.sibling}if(!s){for(o=a.child;o;){if(o===n){s=!0,n=a,r=i;break}if(o===r){s=!0,r=a,n=i;break}o=o.sibling}if(!s)throw Error(R(189))}}if(n.alternate!==r)throw Error(R(190))}if(n.tag!==3)throw Error(R(188));return n.stateNode.current===n?t:e}function t0(t){return t=jb(t),t!==null?n0(t):null}function n0(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=n0(t);if(e!==null)return e;t=t.sibling}return null}var r0=At.unstable_scheduleCallback,zh=At.unstable_cancelCallback,Lb=At.unstable_shouldYield,$b=At.unstable_requestPaint,Pe=At.unstable_now,Mb=At.unstable_getCurrentPriorityLevel,Jd=At.unstable_ImmediatePriority,i0=At.unstable_UserBlockingPriority,Ao=At.unstable_NormalPriority,Db=At.unstable_LowPriority,a0=At.unstable_IdlePriority,vl=null,kn=null;function Fb(t){if(kn&&typeof kn.onCommitFiberRoot=="function")try{kn.onCommitFiberRoot(vl,t,void 0,(t.current.flags&128)===128)}catch{}}var sn=Math.clz32?Math.clz32:Bb,zb=Math.log,Ub=Math.LN2;function Bb(t){return t>>>=0,t===0?32:31-(zb(t)/Ub|0)|0}var $s=64,Ms=4194304;function va(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ro(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,a=t.pingedLanes,s=n&268435455;if(s!==0){var o=s&~i;o!==0?r=va(o):(a&=s,a!==0&&(r=va(a)))}else s=n&~i,s!==0?r=va(s):a!==0&&(r=va(a));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,a=e&-e,i>=a||i===16&&(a&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-sn(e),i=1<<n,r|=t[n],e&=~i;return r}function Hb(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Gb(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,a=t.pendingLanes;0<a;){var s=31-sn(a),o=1<<s,l=i[s];l===-1?(!(o&n)||o&r)&&(i[s]=Hb(o,e)):l<=e&&(t.expiredLanes|=o),a&=~o}}function Ic(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function s0(){var t=$s;return $s<<=1,!($s&4194240)&&($s=64),t}function iu(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ys(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-sn(e),t[e]=n}function Vb(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-sn(n),a=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~a}}function Yd(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-sn(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var we=0;function o0(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var l0,Qd,u0,c0,d0,Ac=!1,Ds=[],cr=null,dr=null,fr=null,Va=new Map,Wa=new Map,ir=[],Wb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Uh(t,e){switch(t){case"focusin":case"focusout":cr=null;break;case"dragenter":case"dragleave":dr=null;break;case"mouseover":case"mouseout":fr=null;break;case"pointerover":case"pointerout":Va.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wa.delete(e.pointerId)}}function sa(t,e,n,r,i,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},e!==null&&(e=ws(e),e!==null&&Qd(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Zb(t,e,n,r,i){switch(e){case"focusin":return cr=sa(cr,t,e,n,r,i),!0;case"dragenter":return dr=sa(dr,t,e,n,r,i),!0;case"mouseover":return fr=sa(fr,t,e,n,r,i),!0;case"pointerover":var a=i.pointerId;return Va.set(a,sa(Va.get(a)||null,t,e,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Wa.set(a,sa(Wa.get(a)||null,t,e,n,r,i)),!0}return!1}function f0(t){var e=jr(t.target);if(e!==null){var n=Qr(e);if(n!==null){if(e=n.tag,e===13){if(e=e0(n),e!==null){t.blockedOn=e,d0(t.priority,function(){u0(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ho(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Rc(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Cc=r,n.target.dispatchEvent(r),Cc=null}else return e=ws(n),e!==null&&Qd(e),t.blockedOn=n,!1;e.shift()}return!0}function Bh(t,e,n){ho(t)&&n.delete(e)}function qb(){Ac=!1,cr!==null&&ho(cr)&&(cr=null),dr!==null&&ho(dr)&&(dr=null),fr!==null&&ho(fr)&&(fr=null),Va.forEach(Bh),Wa.forEach(Bh)}function oa(t,e){t.blockedOn===e&&(t.blockedOn=null,Ac||(Ac=!0,At.unstable_scheduleCallback(At.unstable_NormalPriority,qb)))}function Za(t){function e(i){return oa(i,t)}if(0<Ds.length){oa(Ds[0],t);for(var n=1;n<Ds.length;n++){var r=Ds[n];r.blockedOn===t&&(r.blockedOn=null)}}for(cr!==null&&oa(cr,t),dr!==null&&oa(dr,t),fr!==null&&oa(fr,t),Va.forEach(e),Wa.forEach(e),n=0;n<ir.length;n++)r=ir[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ir.length&&(n=ir[0],n.blockedOn===null);)f0(n),n.blockedOn===null&&ir.shift()}var Ti=Vn.ReactCurrentBatchConfig,Po=!0;function Kb(t,e,n,r){var i=we,a=Ti.transition;Ti.transition=null;try{we=1,Xd(t,e,n,r)}finally{we=i,Ti.transition=a}}function Jb(t,e,n,r){var i=we,a=Ti.transition;Ti.transition=null;try{we=4,Xd(t,e,n,r)}finally{we=i,Ti.transition=a}}function Xd(t,e,n,r){if(Po){var i=Rc(t,e,n,r);if(i===null)pu(t,e,r,jo,n),Uh(t,r);else if(Zb(i,t,e,n,r))r.stopPropagation();else if(Uh(t,r),e&4&&-1<Wb.indexOf(t)){for(;i!==null;){var a=ws(i);if(a!==null&&l0(a),a=Rc(t,e,n,r),a===null&&pu(t,e,r,jo,n),a===i)break;i=a}i!==null&&r.stopPropagation()}else pu(t,e,r,null,n)}}var jo=null;function Rc(t,e,n,r){if(jo=null,t=Kd(r),t=jr(t),t!==null)if(e=Qr(t),e===null)t=null;else if(n=e.tag,n===13){if(t=e0(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return jo=t,null}function h0(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Mb()){case Jd:return 1;case i0:return 4;case Ao:case Db:return 16;case a0:return 536870912;default:return 16}default:return 16}}var sr=null,ef=null,po=null;function p0(){if(po)return po;var t,e=ef,n=e.length,r,i="value"in sr?sr.value:sr.textContent,a=i.length;for(t=0;t<n&&e[t]===i[t];t++);var s=n-t;for(r=1;r<=s&&e[n-r]===i[a-r];r++);return po=i.slice(t,1<r?1-r:void 0)}function mo(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Fs(){return!0}function Hh(){return!1}function $t(t){function e(n,r,i,a,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=a,this.target=s,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Fs:Hh,this.isPropagationStopped=Hh,this}return Ie(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Fs)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Fs)},persist:function(){},isPersistent:Fs}),e}var Zi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tf=$t(Zi),vs=Ie({},Zi,{view:0,detail:0}),Yb=$t(vs),au,su,la,wl=Ie({},vs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==la&&(la&&t.type==="mousemove"?(au=t.screenX-la.screenX,su=t.screenY-la.screenY):su=au=0,la=t),au)},movementY:function(t){return"movementY"in t?t.movementY:su}}),Gh=$t(wl),Qb=Ie({},wl,{dataTransfer:0}),Xb=$t(Qb),ex=Ie({},vs,{relatedTarget:0}),ou=$t(ex),tx=Ie({},Zi,{animationName:0,elapsedTime:0,pseudoElement:0}),nx=$t(tx),rx=Ie({},Zi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),ix=$t(rx),ax=Ie({},Zi,{data:0}),Vh=$t(ax),sx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ox={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ux(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=lx[t])?!!e[t]:!1}function nf(){return ux}var cx=Ie({},vs,{key:function(t){if(t.key){var e=sx[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=mo(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?ox[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nf,charCode:function(t){return t.type==="keypress"?mo(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?mo(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),dx=$t(cx),fx=Ie({},wl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Wh=$t(fx),hx=Ie({},vs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nf}),px=$t(hx),mx=Ie({},Zi,{propertyName:0,elapsedTime:0,pseudoElement:0}),gx=$t(mx),yx=Ie({},wl,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),vx=$t(yx),wx=[9,13,27,32],rf=zn&&"CompositionEvent"in window,ka=null;zn&&"documentMode"in document&&(ka=document.documentMode);var _x=zn&&"TextEvent"in window&&!ka,m0=zn&&(!rf||ka&&8<ka&&11>=ka),Zh=" ",qh=!1;function g0(t,e){switch(t){case"keyup":return wx.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function y0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var di=!1;function bx(t,e){switch(t){case"compositionend":return y0(e);case"keypress":return e.which!==32?null:(qh=!0,Zh);case"textInput":return t=e.data,t===Zh&&qh?null:t;default:return null}}function xx(t,e){if(di)return t==="compositionend"||!rf&&g0(t,e)?(t=p0(),po=ef=sr=null,di=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return m0&&e.locale!=="ko"?null:e.data;default:return null}}var Ex={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kh(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Ex[t.type]:e==="textarea"}function v0(t,e,n,r){Ky(r),e=Lo(e,"onChange"),0<e.length&&(n=new tf("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ca=null,qa=null;function Sx(t){N0(t,0)}function _l(t){var e=pi(t);if(By(e))return t}function kx(t,e){if(t==="change")return e}var w0=!1;if(zn){var lu;if(zn){var uu="oninput"in document;if(!uu){var Jh=document.createElement("div");Jh.setAttribute("oninput","return;"),uu=typeof Jh.oninput=="function"}lu=uu}else lu=!1;w0=lu&&(!document.documentMode||9<document.documentMode)}function Yh(){Ca&&(Ca.detachEvent("onpropertychange",_0),qa=Ca=null)}function _0(t){if(t.propertyName==="value"&&_l(qa)){var e=[];v0(e,qa,t,Kd(t)),Xy(Sx,e)}}function Cx(t,e,n){t==="focusin"?(Yh(),Ca=e,qa=n,Ca.attachEvent("onpropertychange",_0)):t==="focusout"&&Yh()}function Tx(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return _l(qa)}function Ox(t,e){if(t==="click")return _l(e)}function Nx(t,e){if(t==="input"||t==="change")return _l(e)}function Ix(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var dn=typeof Object.is=="function"?Object.is:Ix;function Ka(t,e){if(dn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!pc.call(e,i)||!dn(t[i],e[i]))return!1}return!0}function Qh(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Xh(t,e){var n=Qh(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Qh(n)}}function b0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?b0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function x0(){for(var t=window,e=Oo();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Oo(t.document)}return e}function af(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Ax(t){var e=x0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&b0(n.ownerDocument.documentElement,n)){if(r!==null&&af(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=r.end===void 0?a:Math.min(r.end,i),!t.extend&&a>r&&(i=r,r=a,a=i),i=Xh(n,a);var s=Xh(n,r);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),a>r?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Rx=zn&&"documentMode"in document&&11>=document.documentMode,fi=null,Pc=null,Ta=null,jc=!1;function ep(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;jc||fi==null||fi!==Oo(r)||(r=fi,"selectionStart"in r&&af(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ta&&Ka(Ta,r)||(Ta=r,r=Lo(Pc,"onSelect"),0<r.length&&(e=new tf("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=fi)))}function zs(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var hi={animationend:zs("Animation","AnimationEnd"),animationiteration:zs("Animation","AnimationIteration"),animationstart:zs("Animation","AnimationStart"),transitionend:zs("Transition","TransitionEnd")},cu={},E0={};zn&&(E0=document.createElement("div").style,"AnimationEvent"in window||(delete hi.animationend.animation,delete hi.animationiteration.animation,delete hi.animationstart.animation),"TransitionEvent"in window||delete hi.transitionend.transition);function bl(t){if(cu[t])return cu[t];if(!hi[t])return t;var e=hi[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in E0)return cu[t]=e[n];return t}var S0=bl("animationend"),k0=bl("animationiteration"),C0=bl("animationstart"),T0=bl("transitionend"),O0=new Map,tp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Cr(t,e){O0.set(t,e),Yr(e,[t])}for(var du=0;du<tp.length;du++){var fu=tp[du],Px=fu.toLowerCase(),jx=fu[0].toUpperCase()+fu.slice(1);Cr(Px,"on"+jx)}Cr(S0,"onAnimationEnd");Cr(k0,"onAnimationIteration");Cr(C0,"onAnimationStart");Cr("dblclick","onDoubleClick");Cr("focusin","onFocus");Cr("focusout","onBlur");Cr(T0,"onTransitionEnd");Ri("onMouseEnter",["mouseout","mouseover"]);Ri("onMouseLeave",["mouseout","mouseover"]);Ri("onPointerEnter",["pointerout","pointerover"]);Ri("onPointerLeave",["pointerout","pointerover"]);Yr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Yr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Yr("onBeforeInput",["compositionend","keypress","textInput","paste"]);Yr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Yr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Yr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lx=new Set("cancel close invalid load scroll toggle".split(" ").concat(wa));function np(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Pb(r,e,void 0,t),t.currentTarget=null}function N0(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var a=void 0;if(e)for(var s=r.length-1;0<=s;s--){var o=r[s],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==a&&i.isPropagationStopped())break e;np(i,o,u),a=l}else for(s=0;s<r.length;s++){if(o=r[s],l=o.instance,u=o.currentTarget,o=o.listener,l!==a&&i.isPropagationStopped())break e;np(i,o,u),a=l}}}if(Io)throw t=Nc,Io=!1,Nc=null,t}function ke(t,e){var n=e[Fc];n===void 0&&(n=e[Fc]=new Set);var r=t+"__bubble";n.has(r)||(I0(e,t,2,!1),n.add(r))}function hu(t,e,n){var r=0;e&&(r|=4),I0(n,t,r,e)}var Us="_reactListening"+Math.random().toString(36).slice(2);function Ja(t){if(!t[Us]){t[Us]=!0,My.forEach(function(n){n!=="selectionchange"&&(Lx.has(n)||hu(n,!1,t),hu(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Us]||(e[Us]=!0,hu("selectionchange",!1,e))}}function I0(t,e,n,r){switch(h0(e)){case 1:var i=Kb;break;case 4:i=Jb;break;default:i=Xd}n=i.bind(null,e,n,t),i=void 0,!Oc||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function pu(t,e,n,r,i){var a=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var o=r.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;s=s.return}for(;o!==null;){if(s=jr(o),s===null)return;if(l=s.tag,l===5||l===6){r=a=s;continue e}o=o.parentNode}}r=r.return}Xy(function(){var u=a,c=Kd(n),d=[];e:{var f=O0.get(t);if(f!==void 0){var h=tf,m=t;switch(t){case"keypress":if(mo(n)===0)break e;case"keydown":case"keyup":h=dx;break;case"focusin":m="focus",h=ou;break;case"focusout":m="blur",h=ou;break;case"beforeblur":case"afterblur":h=ou;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Gh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=Xb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=px;break;case S0:case k0:case C0:h=nx;break;case T0:h=gx;break;case"scroll":h=Yb;break;case"wheel":h=vx;break;case"copy":case"cut":case"paste":h=ix;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=Wh}var v=(e&4)!==0,_=!v&&t==="scroll",p=v?f!==null?f+"Capture":null:f;v=[];for(var y=u,g;y!==null;){g=y;var x=g.stateNode;if(g.tag===5&&x!==null&&(g=x,p!==null&&(x=Ga(y,p),x!=null&&v.push(Ya(y,x,g)))),_)break;y=y.return}0<v.length&&(f=new h(f,m,null,n,c),d.push({event:f,listeners:v}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",f&&n!==Cc&&(m=n.relatedTarget||n.fromElement)&&(jr(m)||m[Un]))break e;if((h||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,h?(m=n.relatedTarget||n.toElement,h=u,m=m?jr(m):null,m!==null&&(_=Qr(m),m!==_||m.tag!==5&&m.tag!==6)&&(m=null)):(h=null,m=u),h!==m)){if(v=Gh,x="onMouseLeave",p="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(v=Wh,x="onPointerLeave",p="onPointerEnter",y="pointer"),_=h==null?f:pi(h),g=m==null?f:pi(m),f=new v(x,y+"leave",h,n,c),f.target=_,f.relatedTarget=g,x=null,jr(c)===u&&(v=new v(p,y+"enter",m,n,c),v.target=g,v.relatedTarget=_,x=v),_=x,h&&m)t:{for(v=h,p=m,y=0,g=v;g;g=ni(g))y++;for(g=0,x=p;x;x=ni(x))g++;for(;0<y-g;)v=ni(v),y--;for(;0<g-y;)p=ni(p),g--;for(;y--;){if(v===p||p!==null&&v===p.alternate)break t;v=ni(v),p=ni(p)}v=null}else v=null;h!==null&&rp(d,f,h,v,!1),m!==null&&_!==null&&rp(d,_,m,v,!0)}}e:{if(f=u?pi(u):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var k=kx;else if(Kh(f))if(w0)k=Nx;else{k=Tx;var S=Cx}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(k=Ox);if(k&&(k=k(t,u))){v0(d,k,n,c);break e}S&&S(t,f,u),t==="focusout"&&(S=f._wrapperState)&&S.controlled&&f.type==="number"&&bc(f,"number",f.value)}switch(S=u?pi(u):window,t){case"focusin":(Kh(S)||S.contentEditable==="true")&&(fi=S,Pc=u,Ta=null);break;case"focusout":Ta=Pc=fi=null;break;case"mousedown":jc=!0;break;case"contextmenu":case"mouseup":case"dragend":jc=!1,ep(d,n,c);break;case"selectionchange":if(Rx)break;case"keydown":case"keyup":ep(d,n,c)}var C;if(rf)e:{switch(t){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else di?g0(t,n)&&(A="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(A="onCompositionStart");A&&(m0&&n.locale!=="ko"&&(di||A!=="onCompositionStart"?A==="onCompositionEnd"&&di&&(C=p0()):(sr=c,ef="value"in sr?sr.value:sr.textContent,di=!0)),S=Lo(u,A),0<S.length&&(A=new Vh(A,t,null,n,c),d.push({event:A,listeners:S}),C?A.data=C:(C=y0(n),C!==null&&(A.data=C)))),(C=_x?bx(t,n):xx(t,n))&&(u=Lo(u,"onBeforeInput"),0<u.length&&(c=new Vh("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:u}),c.data=C))}N0(d,e)})}function Ya(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Lo(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=Ga(t,n),a!=null&&r.unshift(Ya(t,a,i)),a=Ga(t,e),a!=null&&r.push(Ya(t,a,i))),t=t.return}return r}function ni(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function rp(t,e,n,r,i){for(var a=e._reactName,s=[];n!==null&&n!==r;){var o=n,l=o.alternate,u=o.stateNode;if(l!==null&&l===r)break;o.tag===5&&u!==null&&(o=u,i?(l=Ga(n,a),l!=null&&s.unshift(Ya(n,l,o))):i||(l=Ga(n,a),l!=null&&s.push(Ya(n,l,o)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var $x=/\r\n?/g,Mx=/\u0000|\uFFFD/g;function ip(t){return(typeof t=="string"?t:""+t).replace($x,`
`).replace(Mx,"")}function Bs(t,e,n){if(e=ip(e),ip(t)!==e&&n)throw Error(R(425))}function $o(){}var Lc=null,$c=null;function Mc(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Dc=typeof setTimeout=="function"?setTimeout:void 0,Dx=typeof clearTimeout=="function"?clearTimeout:void 0,ap=typeof Promise=="function"?Promise:void 0,Fx=typeof queueMicrotask=="function"?queueMicrotask:typeof ap<"u"?function(t){return ap.resolve(null).then(t).catch(zx)}:Dc;function zx(t){setTimeout(function(){throw t})}function mu(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Za(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Za(e)}function hr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function sp(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var qi=Math.random().toString(36).slice(2),bn="__reactFiber$"+qi,Qa="__reactProps$"+qi,Un="__reactContainer$"+qi,Fc="__reactEvents$"+qi,Ux="__reactListeners$"+qi,Bx="__reactHandles$"+qi;function jr(t){var e=t[bn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Un]||n[bn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=sp(t);t!==null;){if(n=t[bn])return n;t=sp(t)}return e}t=n,n=t.parentNode}return null}function ws(t){return t=t[bn]||t[Un],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function pi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(R(33))}function xl(t){return t[Qa]||null}var zc=[],mi=-1;function Tr(t){return{current:t}}function Ce(t){0>mi||(t.current=zc[mi],zc[mi]=null,mi--)}function Ee(t,e){mi++,zc[mi]=t.current,t.current=e}var br={},rt=Tr(br),wt=Tr(!1),Br=br;function Pi(t,e){var n=t.type.contextTypes;if(!n)return br;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in n)i[a]=e[a];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function _t(t){return t=t.childContextTypes,t!=null}function Mo(){Ce(wt),Ce(rt)}function op(t,e,n){if(rt.current!==br)throw Error(R(168));Ee(rt,e),Ee(wt,n)}function A0(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(R(108,Cb(t)||"Unknown",i));return Ie({},n,r)}function Do(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||br,Br=rt.current,Ee(rt,t),Ee(wt,wt.current),!0}function lp(t,e,n){var r=t.stateNode;if(!r)throw Error(R(169));n?(t=A0(t,e,Br),r.__reactInternalMemoizedMergedChildContext=t,Ce(wt),Ce(rt),Ee(rt,t)):Ce(wt),Ee(wt,n)}var jn=null,El=!1,gu=!1;function R0(t){jn===null?jn=[t]:jn.push(t)}function Hx(t){El=!0,R0(t)}function Or(){if(!gu&&jn!==null){gu=!0;var t=0,e=we;try{var n=jn;for(we=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}jn=null,El=!1}catch(i){throw jn!==null&&(jn=jn.slice(t+1)),r0(Jd,Or),i}finally{we=e,gu=!1}}return null}var gi=[],yi=0,Fo=null,zo=0,Ft=[],zt=0,Hr=null,Ln=1,$n="";function Ar(t,e){gi[yi++]=zo,gi[yi++]=Fo,Fo=t,zo=e}function P0(t,e,n){Ft[zt++]=Ln,Ft[zt++]=$n,Ft[zt++]=Hr,Hr=t;var r=Ln;t=$n;var i=32-sn(r)-1;r&=~(1<<i),n+=1;var a=32-sn(e)+i;if(30<a){var s=i-i%5;a=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Ln=1<<32-sn(e)+i|n<<i|r,$n=a+t}else Ln=1<<a|n<<i|r,$n=t}function sf(t){t.return!==null&&(Ar(t,1),P0(t,1,0))}function of(t){for(;t===Fo;)Fo=gi[--yi],gi[yi]=null,zo=gi[--yi],gi[yi]=null;for(;t===Hr;)Hr=Ft[--zt],Ft[zt]=null,$n=Ft[--zt],Ft[zt]=null,Ln=Ft[--zt],Ft[zt]=null}var It=null,Ot=null,Te=!1,an=null;function j0(t,e){var n=Ht(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function up(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,It=t,Ot=hr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,It=t,Ot=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Hr!==null?{id:Ln,overflow:$n}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ht(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,It=t,Ot=null,!0):!1;default:return!1}}function Uc(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Bc(t){if(Te){var e=Ot;if(e){var n=e;if(!up(t,e)){if(Uc(t))throw Error(R(418));e=hr(n.nextSibling);var r=It;e&&up(t,e)?j0(r,n):(t.flags=t.flags&-4097|2,Te=!1,It=t)}}else{if(Uc(t))throw Error(R(418));t.flags=t.flags&-4097|2,Te=!1,It=t}}}function cp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;It=t}function Hs(t){if(t!==It)return!1;if(!Te)return cp(t),Te=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Mc(t.type,t.memoizedProps)),e&&(e=Ot)){if(Uc(t))throw L0(),Error(R(418));for(;e;)j0(t,e),e=hr(e.nextSibling)}if(cp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(R(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ot=hr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ot=null}}else Ot=It?hr(t.stateNode.nextSibling):null;return!0}function L0(){for(var t=Ot;t;)t=hr(t.nextSibling)}function ji(){Ot=It=null,Te=!1}function lf(t){an===null?an=[t]:an.push(t)}var Gx=Vn.ReactCurrentBatchConfig;function ua(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(R(309));var r=n.stateNode}if(!r)throw Error(R(147,t));var i=r,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(s){var o=i.refs;s===null?delete o[a]:o[a]=s},e._stringRef=a,e)}if(typeof t!="string")throw Error(R(284));if(!n._owner)throw Error(R(290,t))}return t}function Gs(t,e){throw t=Object.prototype.toString.call(e),Error(R(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function dp(t){var e=t._init;return e(t._payload)}function $0(t){function e(p,y){if(t){var g=p.deletions;g===null?(p.deletions=[y],p.flags|=16):g.push(y)}}function n(p,y){if(!t)return null;for(;y!==null;)e(p,y),y=y.sibling;return null}function r(p,y){for(p=new Map;y!==null;)y.key!==null?p.set(y.key,y):p.set(y.index,y),y=y.sibling;return p}function i(p,y){return p=yr(p,y),p.index=0,p.sibling=null,p}function a(p,y,g){return p.index=g,t?(g=p.alternate,g!==null?(g=g.index,g<y?(p.flags|=2,y):g):(p.flags|=2,y)):(p.flags|=1048576,y)}function s(p){return t&&p.alternate===null&&(p.flags|=2),p}function o(p,y,g,x){return y===null||y.tag!==6?(y=Eu(g,p.mode,x),y.return=p,y):(y=i(y,g),y.return=p,y)}function l(p,y,g,x){var k=g.type;return k===ci?c(p,y,g.props.children,x,g.key):y!==null&&(y.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Qn&&dp(k)===y.type)?(x=i(y,g.props),x.ref=ua(p,y,g),x.return=p,x):(x=xo(g.type,g.key,g.props,null,p.mode,x),x.ref=ua(p,y,g),x.return=p,x)}function u(p,y,g,x){return y===null||y.tag!==4||y.stateNode.containerInfo!==g.containerInfo||y.stateNode.implementation!==g.implementation?(y=Su(g,p.mode,x),y.return=p,y):(y=i(y,g.children||[]),y.return=p,y)}function c(p,y,g,x,k){return y===null||y.tag!==7?(y=Fr(g,p.mode,x,k),y.return=p,y):(y=i(y,g),y.return=p,y)}function d(p,y,g){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Eu(""+y,p.mode,g),y.return=p,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ps:return g=xo(y.type,y.key,y.props,null,p.mode,g),g.ref=ua(p,null,y),g.return=p,g;case ui:return y=Su(y,p.mode,g),y.return=p,y;case Qn:var x=y._init;return d(p,x(y._payload),g)}if(ya(y)||ia(y))return y=Fr(y,p.mode,g,null),y.return=p,y;Gs(p,y)}return null}function f(p,y,g,x){var k=y!==null?y.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return k!==null?null:o(p,y,""+g,x);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Ps:return g.key===k?l(p,y,g,x):null;case ui:return g.key===k?u(p,y,g,x):null;case Qn:return k=g._init,f(p,y,k(g._payload),x)}if(ya(g)||ia(g))return k!==null?null:c(p,y,g,x,null);Gs(p,g)}return null}function h(p,y,g,x,k){if(typeof x=="string"&&x!==""||typeof x=="number")return p=p.get(g)||null,o(y,p,""+x,k);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ps:return p=p.get(x.key===null?g:x.key)||null,l(y,p,x,k);case ui:return p=p.get(x.key===null?g:x.key)||null,u(y,p,x,k);case Qn:var S=x._init;return h(p,y,g,S(x._payload),k)}if(ya(x)||ia(x))return p=p.get(g)||null,c(y,p,x,k,null);Gs(y,x)}return null}function m(p,y,g,x){for(var k=null,S=null,C=y,A=y=0,U=null;C!==null&&A<g.length;A++){C.index>A?(U=C,C=null):U=C.sibling;var j=f(p,C,g[A],x);if(j===null){C===null&&(C=U);break}t&&C&&j.alternate===null&&e(p,C),y=a(j,y,A),S===null?k=j:S.sibling=j,S=j,C=U}if(A===g.length)return n(p,C),Te&&Ar(p,A),k;if(C===null){for(;A<g.length;A++)C=d(p,g[A],x),C!==null&&(y=a(C,y,A),S===null?k=C:S.sibling=C,S=C);return Te&&Ar(p,A),k}for(C=r(p,C);A<g.length;A++)U=h(C,p,A,g[A],x),U!==null&&(t&&U.alternate!==null&&C.delete(U.key===null?A:U.key),y=a(U,y,A),S===null?k=U:S.sibling=U,S=U);return t&&C.forEach(function(B){return e(p,B)}),Te&&Ar(p,A),k}function v(p,y,g,x){var k=ia(g);if(typeof k!="function")throw Error(R(150));if(g=k.call(g),g==null)throw Error(R(151));for(var S=k=null,C=y,A=y=0,U=null,j=g.next();C!==null&&!j.done;A++,j=g.next()){C.index>A?(U=C,C=null):U=C.sibling;var B=f(p,C,j.value,x);if(B===null){C===null&&(C=U);break}t&&C&&B.alternate===null&&e(p,C),y=a(B,y,A),S===null?k=B:S.sibling=B,S=B,C=U}if(j.done)return n(p,C),Te&&Ar(p,A),k;if(C===null){for(;!j.done;A++,j=g.next())j=d(p,j.value,x),j!==null&&(y=a(j,y,A),S===null?k=j:S.sibling=j,S=j);return Te&&Ar(p,A),k}for(C=r(p,C);!j.done;A++,j=g.next())j=h(C,p,A,j.value,x),j!==null&&(t&&j.alternate!==null&&C.delete(j.key===null?A:j.key),y=a(j,y,A),S===null?k=j:S.sibling=j,S=j);return t&&C.forEach(function(Z){return e(p,Z)}),Te&&Ar(p,A),k}function _(p,y,g,x){if(typeof g=="object"&&g!==null&&g.type===ci&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case Ps:e:{for(var k=g.key,S=y;S!==null;){if(S.key===k){if(k=g.type,k===ci){if(S.tag===7){n(p,S.sibling),y=i(S,g.props.children),y.return=p,p=y;break e}}else if(S.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Qn&&dp(k)===S.type){n(p,S.sibling),y=i(S,g.props),y.ref=ua(p,S,g),y.return=p,p=y;break e}n(p,S);break}else e(p,S);S=S.sibling}g.type===ci?(y=Fr(g.props.children,p.mode,x,g.key),y.return=p,p=y):(x=xo(g.type,g.key,g.props,null,p.mode,x),x.ref=ua(p,y,g),x.return=p,p=x)}return s(p);case ui:e:{for(S=g.key;y!==null;){if(y.key===S)if(y.tag===4&&y.stateNode.containerInfo===g.containerInfo&&y.stateNode.implementation===g.implementation){n(p,y.sibling),y=i(y,g.children||[]),y.return=p,p=y;break e}else{n(p,y);break}else e(p,y);y=y.sibling}y=Su(g,p.mode,x),y.return=p,p=y}return s(p);case Qn:return S=g._init,_(p,y,S(g._payload),x)}if(ya(g))return m(p,y,g,x);if(ia(g))return v(p,y,g,x);Gs(p,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,y!==null&&y.tag===6?(n(p,y.sibling),y=i(y,g),y.return=p,p=y):(n(p,y),y=Eu(g,p.mode,x),y.return=p,p=y),s(p)):n(p,y)}return _}var Li=$0(!0),M0=$0(!1),Uo=Tr(null),Bo=null,vi=null,uf=null;function cf(){uf=vi=Bo=null}function df(t){var e=Uo.current;Ce(Uo),t._currentValue=e}function Hc(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Oi(t,e){Bo=t,uf=vi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(yt=!0),t.firstContext=null)}function Vt(t){var e=t._currentValue;if(uf!==t)if(t={context:t,memoizedValue:e,next:null},vi===null){if(Bo===null)throw Error(R(308));vi=t,Bo.dependencies={lanes:0,firstContext:t}}else vi=vi.next=t;return e}var Lr=null;function ff(t){Lr===null?Lr=[t]:Lr.push(t)}function D0(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,ff(e)):(n.next=i.next,i.next=n),e.interleaved=n,Bn(t,r)}function Bn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Xn=!1;function hf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function F0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Dn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function pr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,fe&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Bn(t,n)}return i=r.interleaved,i===null?(e.next=e,ff(r)):(e.next=i.next,i.next=e),r.interleaved=e,Bn(t,n)}function go(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Yd(t,n)}}function fp(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?i=a=s:a=a.next=s,n=n.next}while(n!==null);a===null?i=a=e:a=a.next=e}else i=a=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ho(t,e,n,r){var i=t.updateQueue;Xn=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,s===null?a=u:s.next=u,s=l;var c=t.alternate;c!==null&&(c=c.updateQueue,o=c.lastBaseUpdate,o!==s&&(o===null?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(a!==null){var d=i.baseState;s=0,c=u=l=null,o=a;do{var f=o.lane,h=o.eventTime;if((r&f)===f){c!==null&&(c=c.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=t,v=o;switch(f=e,h=n,v.tag){case 1:if(m=v.payload,typeof m=="function"){d=m.call(h,d,f);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=v.payload,f=typeof m=="function"?m.call(h,d,f):m,f==null)break e;d=Ie({},d,f);break e;case 2:Xn=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[o]:f.push(o))}else h={eventTime:h,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},c===null?(u=c=h,l=d):c=c.next=h,s|=f;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;f=o,o=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(c===null&&(l=d),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else a===null&&(i.shared.lanes=0);Vr|=s,t.lanes=s,t.memoizedState=d}}function hp(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(R(191,i));i.call(r)}}}var _s={},Cn=Tr(_s),Xa=Tr(_s),es=Tr(_s);function $r(t){if(t===_s)throw Error(R(174));return t}function pf(t,e){switch(Ee(es,e),Ee(Xa,t),Ee(Cn,_s),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Ec(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Ec(e,t)}Ce(Cn),Ee(Cn,e)}function $i(){Ce(Cn),Ce(Xa),Ce(es)}function z0(t){$r(es.current);var e=$r(Cn.current),n=Ec(e,t.type);e!==n&&(Ee(Xa,t),Ee(Cn,n))}function mf(t){Xa.current===t&&(Ce(Cn),Ce(Xa))}var Oe=Tr(0);function Go(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var yu=[];function gf(){for(var t=0;t<yu.length;t++)yu[t]._workInProgressVersionPrimary=null;yu.length=0}var yo=Vn.ReactCurrentDispatcher,vu=Vn.ReactCurrentBatchConfig,Gr=0,Ne=null,De=null,Be=null,Vo=!1,Oa=!1,ts=0,Vx=0;function Qe(){throw Error(R(321))}function yf(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!dn(t[n],e[n]))return!1;return!0}function vf(t,e,n,r,i,a){if(Gr=a,Ne=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,yo.current=t===null||t.memoizedState===null?Kx:Jx,t=n(r,i),Oa){a=0;do{if(Oa=!1,ts=0,25<=a)throw Error(R(301));a+=1,Be=De=null,e.updateQueue=null,yo.current=Yx,t=n(r,i)}while(Oa)}if(yo.current=Wo,e=De!==null&&De.next!==null,Gr=0,Be=De=Ne=null,Vo=!1,e)throw Error(R(300));return t}function wf(){var t=ts!==0;return ts=0,t}function wn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Be===null?Ne.memoizedState=Be=t:Be=Be.next=t,Be}function Wt(){if(De===null){var t=Ne.alternate;t=t!==null?t.memoizedState:null}else t=De.next;var e=Be===null?Ne.memoizedState:Be.next;if(e!==null)Be=e,De=t;else{if(t===null)throw Error(R(310));De=t,t={memoizedState:De.memoizedState,baseState:De.baseState,baseQueue:De.baseQueue,queue:De.queue,next:null},Be===null?Ne.memoizedState=Be=t:Be=Be.next=t}return Be}function ns(t,e){return typeof e=="function"?e(t):e}function wu(t){var e=Wt(),n=e.queue;if(n===null)throw Error(R(311));n.lastRenderedReducer=t;var r=De,i=r.baseQueue,a=n.pending;if(a!==null){if(i!==null){var s=i.next;i.next=a.next,a.next=s}r.baseQueue=i=a,n.pending=null}if(i!==null){a=i.next,r=r.baseState;var o=s=null,l=null,u=a;do{var c=u.lane;if((Gr&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=d,s=r):l=l.next=d,Ne.lanes|=c,Vr|=c}u=u.next}while(u!==null&&u!==a);l===null?s=r:l.next=o,dn(r,e.memoizedState)||(yt=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do a=i.lane,Ne.lanes|=a,Vr|=a,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function _u(t){var e=Wt(),n=e.queue;if(n===null)throw Error(R(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,a=e.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do a=t(a,s.action),s=s.next;while(s!==i);dn(a,e.memoizedState)||(yt=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),n.lastRenderedState=a}return[a,r]}function U0(){}function B0(t,e){var n=Ne,r=Wt(),i=e(),a=!dn(r.memoizedState,i);if(a&&(r.memoizedState=i,yt=!0),r=r.queue,_f(V0.bind(null,n,r,t),[t]),r.getSnapshot!==e||a||Be!==null&&Be.memoizedState.tag&1){if(n.flags|=2048,rs(9,G0.bind(null,n,r,i,e),void 0,null),Ge===null)throw Error(R(349));Gr&30||H0(n,e,i)}return i}function H0(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ne.updateQueue,e===null?(e={lastEffect:null,stores:null},Ne.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function G0(t,e,n,r){e.value=n,e.getSnapshot=r,W0(e)&&Z0(t)}function V0(t,e,n){return n(function(){W0(e)&&Z0(t)})}function W0(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!dn(t,n)}catch{return!0}}function Z0(t){var e=Bn(t,1);e!==null&&on(e,t,1,-1)}function pp(t){var e=wn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ns,lastRenderedState:t},e.queue=t,t=t.dispatch=qx.bind(null,Ne,t),[e.memoizedState,t]}function rs(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ne.updateQueue,e===null?(e={lastEffect:null,stores:null},Ne.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function q0(){return Wt().memoizedState}function vo(t,e,n,r){var i=wn();Ne.flags|=t,i.memoizedState=rs(1|e,n,void 0,r===void 0?null:r)}function Sl(t,e,n,r){var i=Wt();r=r===void 0?null:r;var a=void 0;if(De!==null){var s=De.memoizedState;if(a=s.destroy,r!==null&&yf(r,s.deps)){i.memoizedState=rs(e,n,a,r);return}}Ne.flags|=t,i.memoizedState=rs(1|e,n,a,r)}function mp(t,e){return vo(8390656,8,t,e)}function _f(t,e){return Sl(2048,8,t,e)}function K0(t,e){return Sl(4,2,t,e)}function J0(t,e){return Sl(4,4,t,e)}function Y0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Q0(t,e,n){return n=n!=null?n.concat([t]):null,Sl(4,4,Y0.bind(null,e,t),n)}function bf(){}function X0(t,e){var n=Wt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&yf(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function ev(t,e){var n=Wt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&yf(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function tv(t,e,n){return Gr&21?(dn(n,e)||(n=s0(),Ne.lanes|=n,Vr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,yt=!0),t.memoizedState=n)}function Wx(t,e){var n=we;we=n!==0&&4>n?n:4,t(!0);var r=vu.transition;vu.transition={};try{t(!1),e()}finally{we=n,vu.transition=r}}function nv(){return Wt().memoizedState}function Zx(t,e,n){var r=gr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},rv(t))iv(e,n);else if(n=D0(t,e,n,r),n!==null){var i=ut();on(n,t,r,i),av(n,e,r)}}function qx(t,e,n){var r=gr(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(rv(t))iv(e,i);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var s=e.lastRenderedState,o=a(s,n);if(i.hasEagerState=!0,i.eagerState=o,dn(o,s)){var l=e.interleaved;l===null?(i.next=i,ff(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=D0(t,e,i,r),n!==null&&(i=ut(),on(n,t,r,i),av(n,e,r))}}function rv(t){var e=t.alternate;return t===Ne||e!==null&&e===Ne}function iv(t,e){Oa=Vo=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function av(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Yd(t,n)}}var Wo={readContext:Vt,useCallback:Qe,useContext:Qe,useEffect:Qe,useImperativeHandle:Qe,useInsertionEffect:Qe,useLayoutEffect:Qe,useMemo:Qe,useReducer:Qe,useRef:Qe,useState:Qe,useDebugValue:Qe,useDeferredValue:Qe,useTransition:Qe,useMutableSource:Qe,useSyncExternalStore:Qe,useId:Qe,unstable_isNewReconciler:!1},Kx={readContext:Vt,useCallback:function(t,e){return wn().memoizedState=[t,e===void 0?null:e],t},useContext:Vt,useEffect:mp,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,vo(4194308,4,Y0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return vo(4194308,4,t,e)},useInsertionEffect:function(t,e){return vo(4,2,t,e)},useMemo:function(t,e){var n=wn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=wn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Zx.bind(null,Ne,t),[r.memoizedState,t]},useRef:function(t){var e=wn();return t={current:t},e.memoizedState=t},useState:pp,useDebugValue:bf,useDeferredValue:function(t){return wn().memoizedState=t},useTransition:function(){var t=pp(!1),e=t[0];return t=Wx.bind(null,t[1]),wn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ne,i=wn();if(Te){if(n===void 0)throw Error(R(407));n=n()}else{if(n=e(),Ge===null)throw Error(R(349));Gr&30||H0(r,e,n)}i.memoizedState=n;var a={value:n,getSnapshot:e};return i.queue=a,mp(V0.bind(null,r,a,t),[t]),r.flags|=2048,rs(9,G0.bind(null,r,a,n,e),void 0,null),n},useId:function(){var t=wn(),e=Ge.identifierPrefix;if(Te){var n=$n,r=Ln;n=(r&~(1<<32-sn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=ts++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Vx++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Jx={readContext:Vt,useCallback:X0,useContext:Vt,useEffect:_f,useImperativeHandle:Q0,useInsertionEffect:K0,useLayoutEffect:J0,useMemo:ev,useReducer:wu,useRef:q0,useState:function(){return wu(ns)},useDebugValue:bf,useDeferredValue:function(t){var e=Wt();return tv(e,De.memoizedState,t)},useTransition:function(){var t=wu(ns)[0],e=Wt().memoizedState;return[t,e]},useMutableSource:U0,useSyncExternalStore:B0,useId:nv,unstable_isNewReconciler:!1},Yx={readContext:Vt,useCallback:X0,useContext:Vt,useEffect:_f,useImperativeHandle:Q0,useInsertionEffect:K0,useLayoutEffect:J0,useMemo:ev,useReducer:_u,useRef:q0,useState:function(){return _u(ns)},useDebugValue:bf,useDeferredValue:function(t){var e=Wt();return De===null?e.memoizedState=t:tv(e,De.memoizedState,t)},useTransition:function(){var t=_u(ns)[0],e=Wt().memoizedState;return[t,e]},useMutableSource:U0,useSyncExternalStore:B0,useId:nv,unstable_isNewReconciler:!1};function nn(t,e){if(t&&t.defaultProps){e=Ie({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Gc(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ie({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var kl={isMounted:function(t){return(t=t._reactInternals)?Qr(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=ut(),i=gr(t),a=Dn(r,i);a.payload=e,n!=null&&(a.callback=n),e=pr(t,a,i),e!==null&&(on(e,t,i,r),go(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=ut(),i=gr(t),a=Dn(r,i);a.tag=1,a.payload=e,n!=null&&(a.callback=n),e=pr(t,a,i),e!==null&&(on(e,t,i,r),go(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ut(),r=gr(t),i=Dn(n,r);i.tag=2,e!=null&&(i.callback=e),e=pr(t,i,r),e!==null&&(on(e,t,r,n),go(e,t,r))}};function gp(t,e,n,r,i,a,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,a,s):e.prototype&&e.prototype.isPureReactComponent?!Ka(n,r)||!Ka(i,a):!0}function sv(t,e,n){var r=!1,i=br,a=e.contextType;return typeof a=="object"&&a!==null?a=Vt(a):(i=_t(e)?Br:rt.current,r=e.contextTypes,a=(r=r!=null)?Pi(t,i):br),e=new e(n,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=kl,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=a),e}function yp(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&kl.enqueueReplaceState(e,e.state,null)}function Vc(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},hf(t);var a=e.contextType;typeof a=="object"&&a!==null?i.context=Vt(a):(a=_t(e)?Br:rt.current,i.context=Pi(t,a)),i.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(Gc(t,e,a,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&kl.enqueueReplaceState(i,i.state,null),Ho(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Mi(t,e){try{var n="",r=e;do n+=kb(r),r=r.return;while(r);var i=n}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:i,digest:null}}function bu(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Wc(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Qx=typeof WeakMap=="function"?WeakMap:Map;function ov(t,e,n){n=Dn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){qo||(qo=!0,nd=r),Wc(t,e)},n}function lv(t,e,n){n=Dn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Wc(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){Wc(t,e),typeof r!="function"&&(mr===null?mr=new Set([this]):mr.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),n}function vp(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Qx;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=f1.bind(null,t,e,n),e.then(t,t))}function wp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function _p(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Dn(-1,1),e.tag=2,pr(n,e,1))),n.lanes|=1),t)}var Xx=Vn.ReactCurrentOwner,yt=!1;function ot(t,e,n,r){e.child=t===null?M0(e,null,n,r):Li(e,t.child,n,r)}function bp(t,e,n,r,i){n=n.render;var a=e.ref;return Oi(e,i),r=vf(t,e,n,r,a,i),n=wf(),t!==null&&!yt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Hn(t,e,i)):(Te&&n&&sf(e),e.flags|=1,ot(t,e,r,i),e.child)}function xp(t,e,n,r,i){if(t===null){var a=n.type;return typeof a=="function"&&!Nf(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=a,uv(t,e,a,r,i)):(t=xo(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&i)){var s=a.memoizedProps;if(n=n.compare,n=n!==null?n:Ka,n(s,r)&&t.ref===e.ref)return Hn(t,e,i)}return e.flags|=1,t=yr(a,r),t.ref=e.ref,t.return=e,e.child=t}function uv(t,e,n,r,i){if(t!==null){var a=t.memoizedProps;if(Ka(a,r)&&t.ref===e.ref)if(yt=!1,e.pendingProps=r=a,(t.lanes&i)!==0)t.flags&131072&&(yt=!0);else return e.lanes=t.lanes,Hn(t,e,i)}return Zc(t,e,n,r,i)}function cv(t,e,n){var r=e.pendingProps,i=r.children,a=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ee(_i,Tt),Tt|=n;else{if(!(n&1073741824))return t=a!==null?a.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ee(_i,Tt),Tt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,Ee(_i,Tt),Tt|=r}else a!==null?(r=a.baseLanes|n,e.memoizedState=null):r=n,Ee(_i,Tt),Tt|=r;return ot(t,e,i,n),e.child}function dv(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Zc(t,e,n,r,i){var a=_t(n)?Br:rt.current;return a=Pi(e,a),Oi(e,i),n=vf(t,e,n,r,a,i),r=wf(),t!==null&&!yt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Hn(t,e,i)):(Te&&r&&sf(e),e.flags|=1,ot(t,e,n,i),e.child)}function Ep(t,e,n,r,i){if(_t(n)){var a=!0;Do(e)}else a=!1;if(Oi(e,i),e.stateNode===null)wo(t,e),sv(e,n,r),Vc(e,n,r,i),r=!0;else if(t===null){var s=e.stateNode,o=e.memoizedProps;s.props=o;var l=s.context,u=n.contextType;typeof u=="object"&&u!==null?u=Vt(u):(u=_t(n)?Br:rt.current,u=Pi(e,u));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof s.getSnapshotBeforeUpdate=="function";d||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==r||l!==u)&&yp(e,s,r,u),Xn=!1;var f=e.memoizedState;s.state=f,Ho(e,r,s,i),l=e.memoizedState,o!==r||f!==l||wt.current||Xn?(typeof c=="function"&&(Gc(e,n,c,r),l=e.memoizedState),(o=Xn||gp(e,n,o,r,f,l,u))?(d||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),s.props=r,s.state=l,s.context=u,r=o):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,F0(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:nn(e.type,o),s.props=u,d=e.pendingProps,f=s.context,l=n.contextType,typeof l=="object"&&l!==null?l=Vt(l):(l=_t(n)?Br:rt.current,l=Pi(e,l));var h=n.getDerivedStateFromProps;(c=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==d||f!==l)&&yp(e,s,r,l),Xn=!1,f=e.memoizedState,s.state=f,Ho(e,r,s,i);var m=e.memoizedState;o!==d||f!==m||wt.current||Xn?(typeof h=="function"&&(Gc(e,n,h,r),m=e.memoizedState),(u=Xn||gp(e,n,u,r,f,m,l)||!1)?(c||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,m,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,m,l)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=m),s.props=r,s.state=m,s.context=l,r=u):(typeof s.componentDidUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return qc(t,e,n,r,a,i)}function qc(t,e,n,r,i,a){dv(t,e);var s=(e.flags&128)!==0;if(!r&&!s)return i&&lp(e,n,!1),Hn(t,e,a);r=e.stateNode,Xx.current=e;var o=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&s?(e.child=Li(e,t.child,null,a),e.child=Li(e,null,o,a)):ot(t,e,o,a),e.memoizedState=r.state,i&&lp(e,n,!0),e.child}function fv(t){var e=t.stateNode;e.pendingContext?op(t,e.pendingContext,e.pendingContext!==e.context):e.context&&op(t,e.context,!1),pf(t,e.containerInfo)}function Sp(t,e,n,r,i){return ji(),lf(i),e.flags|=256,ot(t,e,n,r),e.child}var Kc={dehydrated:null,treeContext:null,retryLane:0};function Jc(t){return{baseLanes:t,cachePool:null,transitions:null}}function hv(t,e,n){var r=e.pendingProps,i=Oe.current,a=!1,s=(e.flags&128)!==0,o;if((o=s)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Ee(Oe,i&1),t===null)return Bc(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,t=r.fallback,a?(r=e.mode,a=e.child,s={mode:"hidden",children:s},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=s):a=Ol(s,r,0,null),t=Fr(t,r,n,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=Jc(n),e.memoizedState=Kc,t):xf(e,s));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return e1(t,e,s,r,o,i,n);if(a){a=r.fallback,s=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:r.children};return!(s&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=yr(i,l),r.subtreeFlags=i.subtreeFlags&14680064),o!==null?a=yr(o,a):(a=Fr(a,s,n,null),a.flags|=2),a.return=e,r.return=e,r.sibling=a,e.child=r,r=a,a=e.child,s=t.child.memoizedState,s=s===null?Jc(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},a.memoizedState=s,a.childLanes=t.childLanes&~n,e.memoizedState=Kc,r}return a=t.child,t=a.sibling,r=yr(a,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function xf(t,e){return e=Ol({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Vs(t,e,n,r){return r!==null&&lf(r),Li(e,t.child,null,n),t=xf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function e1(t,e,n,r,i,a,s){if(n)return e.flags&256?(e.flags&=-257,r=bu(Error(R(422))),Vs(t,e,s,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=r.fallback,i=e.mode,r=Ol({mode:"visible",children:r.children},i,0,null),a=Fr(a,i,s,null),a.flags|=2,r.return=e,a.return=e,r.sibling=a,e.child=r,e.mode&1&&Li(e,t.child,null,s),e.child.memoizedState=Jc(s),e.memoizedState=Kc,a);if(!(e.mode&1))return Vs(t,e,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var o=r.dgst;return r=o,a=Error(R(419)),r=bu(a,r,void 0),Vs(t,e,s,r)}if(o=(s&t.childLanes)!==0,yt||o){if(r=Ge,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,Bn(t,i),on(r,t,i,-1))}return Of(),r=bu(Error(R(421))),Vs(t,e,s,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=h1.bind(null,t),i._reactRetry=e,null):(t=a.treeContext,Ot=hr(i.nextSibling),It=e,Te=!0,an=null,t!==null&&(Ft[zt++]=Ln,Ft[zt++]=$n,Ft[zt++]=Hr,Ln=t.id,$n=t.overflow,Hr=e),e=xf(e,r.children),e.flags|=4096,e)}function kp(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Hc(t.return,e,n)}function xu(t,e,n,r,i){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function pv(t,e,n){var r=e.pendingProps,i=r.revealOrder,a=r.tail;if(ot(t,e,r.children,n),r=Oe.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&kp(t,n,e);else if(t.tag===19)kp(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ee(Oe,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Go(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),xu(e,!1,i,n,a);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Go(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}xu(e,!0,n,null,a);break;case"together":xu(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function wo(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Hn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Vr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(R(153));if(e.child!==null){for(t=e.child,n=yr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=yr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function t1(t,e,n){switch(e.tag){case 3:fv(e),ji();break;case 5:z0(e);break;case 1:_t(e.type)&&Do(e);break;case 4:pf(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Ee(Uo,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ee(Oe,Oe.current&1),e.flags|=128,null):n&e.child.childLanes?hv(t,e,n):(Ee(Oe,Oe.current&1),t=Hn(t,e,n),t!==null?t.sibling:null);Ee(Oe,Oe.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return pv(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ee(Oe,Oe.current),r)break;return null;case 22:case 23:return e.lanes=0,cv(t,e,n)}return Hn(t,e,n)}var mv,Yc,gv,yv;mv=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Yc=function(){};gv=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,$r(Cn.current);var a=null;switch(n){case"input":i=wc(t,i),r=wc(t,r),a=[];break;case"select":i=Ie({},i,{value:void 0}),r=Ie({},r,{value:void 0}),a=[];break;case"textarea":i=xc(t,i),r=xc(t,r),a=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=$o)}Sc(n,r);var s;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(s in o)o.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Ba.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var l=r[u];if(o=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(s in o)!o.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in l)l.hasOwnProperty(s)&&o[s]!==l[s]&&(n||(n={}),n[s]=l[s])}else n||(a||(a=[]),a.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(a=a||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Ba.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&ke("scroll",t),a||o===l||(a=[])):(a=a||[]).push(u,l))}n&&(a=a||[]).push("style",n);var u=a;(e.updateQueue=u)&&(e.flags|=4)}};yv=function(t,e,n,r){n!==r&&(e.flags|=4)};function ca(t,e){if(!Te)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Xe(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function n1(t,e,n){var r=e.pendingProps;switch(of(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xe(e),null;case 1:return _t(e.type)&&Mo(),Xe(e),null;case 3:return r=e.stateNode,$i(),Ce(wt),Ce(rt),gf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Hs(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,an!==null&&(ad(an),an=null))),Yc(t,e),Xe(e),null;case 5:mf(e);var i=$r(es.current);if(n=e.type,t!==null&&e.stateNode!=null)gv(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(R(166));return Xe(e),null}if(t=$r(Cn.current),Hs(e)){r=e.stateNode,n=e.type;var a=e.memoizedProps;switch(r[bn]=e,r[Qa]=a,t=(e.mode&1)!==0,n){case"dialog":ke("cancel",r),ke("close",r);break;case"iframe":case"object":case"embed":ke("load",r);break;case"video":case"audio":for(i=0;i<wa.length;i++)ke(wa[i],r);break;case"source":ke("error",r);break;case"img":case"image":case"link":ke("error",r),ke("load",r);break;case"details":ke("toggle",r);break;case"input":jh(r,a),ke("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},ke("invalid",r);break;case"textarea":$h(r,a),ke("invalid",r)}Sc(n,a),i=null;for(var s in a)if(a.hasOwnProperty(s)){var o=a[s];s==="children"?typeof o=="string"?r.textContent!==o&&(a.suppressHydrationWarning!==!0&&Bs(r.textContent,o,t),i=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&Bs(r.textContent,o,t),i=["children",""+o]):Ba.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&ke("scroll",r)}switch(n){case"input":js(r),Lh(r,a,!0);break;case"textarea":js(r),Mh(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=$o)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Vy(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=s.createElement(n,{is:r.is}):(t=s.createElement(n),n==="select"&&(s=t,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):t=s.createElementNS(t,n),t[bn]=e,t[Qa]=r,mv(t,e,!1,!1),e.stateNode=t;e:{switch(s=kc(n,r),n){case"dialog":ke("cancel",t),ke("close",t),i=r;break;case"iframe":case"object":case"embed":ke("load",t),i=r;break;case"video":case"audio":for(i=0;i<wa.length;i++)ke(wa[i],t);i=r;break;case"source":ke("error",t),i=r;break;case"img":case"image":case"link":ke("error",t),ke("load",t),i=r;break;case"details":ke("toggle",t),i=r;break;case"input":jh(t,r),i=wc(t,r),ke("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Ie({},r,{value:void 0}),ke("invalid",t);break;case"textarea":$h(t,r),i=xc(t,r),ke("invalid",t);break;default:i=r}Sc(n,i),o=i;for(a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="style"?qy(t,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Wy(t,l)):a==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Ha(t,l):typeof l=="number"&&Ha(t,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Ba.hasOwnProperty(a)?l!=null&&a==="onScroll"&&ke("scroll",t):l!=null&&Vd(t,a,l,s))}switch(n){case"input":js(t),Lh(t,r,!1);break;case"textarea":js(t),Mh(t);break;case"option":r.value!=null&&t.setAttribute("value",""+_r(r.value));break;case"select":t.multiple=!!r.multiple,a=r.value,a!=null?Si(t,!!r.multiple,a,!1):r.defaultValue!=null&&Si(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=$o)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Xe(e),null;case 6:if(t&&e.stateNode!=null)yv(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(R(166));if(n=$r(es.current),$r(Cn.current),Hs(e)){if(r=e.stateNode,n=e.memoizedProps,r[bn]=e,(a=r.nodeValue!==n)&&(t=It,t!==null))switch(t.tag){case 3:Bs(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Bs(r.nodeValue,n,(t.mode&1)!==0)}a&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[bn]=e,e.stateNode=r}return Xe(e),null;case 13:if(Ce(Oe),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Te&&Ot!==null&&e.mode&1&&!(e.flags&128))L0(),ji(),e.flags|=98560,a=!1;else if(a=Hs(e),r!==null&&r.dehydrated!==null){if(t===null){if(!a)throw Error(R(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(R(317));a[bn]=e}else ji(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Xe(e),a=!1}else an!==null&&(ad(an),an=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Oe.current&1?ze===0&&(ze=3):Of())),e.updateQueue!==null&&(e.flags|=4),Xe(e),null);case 4:return $i(),Yc(t,e),t===null&&Ja(e.stateNode.containerInfo),Xe(e),null;case 10:return df(e.type._context),Xe(e),null;case 17:return _t(e.type)&&Mo(),Xe(e),null;case 19:if(Ce(Oe),a=e.memoizedState,a===null)return Xe(e),null;if(r=(e.flags&128)!==0,s=a.rendering,s===null)if(r)ca(a,!1);else{if(ze!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=Go(t),s!==null){for(e.flags|=128,ca(a,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)a=n,t=r,a.flags&=14680066,s=a.alternate,s===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=s.childLanes,a.lanes=s.lanes,a.child=s.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=s.memoizedProps,a.memoizedState=s.memoizedState,a.updateQueue=s.updateQueue,a.type=s.type,t=s.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ee(Oe,Oe.current&1|2),e.child}t=t.sibling}a.tail!==null&&Pe()>Di&&(e.flags|=128,r=!0,ca(a,!1),e.lanes=4194304)}else{if(!r)if(t=Go(s),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ca(a,!0),a.tail===null&&a.tailMode==="hidden"&&!s.alternate&&!Te)return Xe(e),null}else 2*Pe()-a.renderingStartTime>Di&&n!==1073741824&&(e.flags|=128,r=!0,ca(a,!1),e.lanes=4194304);a.isBackwards?(s.sibling=e.child,e.child=s):(n=a.last,n!==null?n.sibling=s:e.child=s,a.last=s)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Pe(),e.sibling=null,n=Oe.current,Ee(Oe,r?n&1|2:n&1),e):(Xe(e),null);case 22:case 23:return Tf(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Tt&1073741824&&(Xe(e),e.subtreeFlags&6&&(e.flags|=8192)):Xe(e),null;case 24:return null;case 25:return null}throw Error(R(156,e.tag))}function r1(t,e){switch(of(e),e.tag){case 1:return _t(e.type)&&Mo(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return $i(),Ce(wt),Ce(rt),gf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return mf(e),null;case 13:if(Ce(Oe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(R(340));ji()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ce(Oe),null;case 4:return $i(),null;case 10:return df(e.type._context),null;case 22:case 23:return Tf(),null;case 24:return null;default:return null}}var Ws=!1,et=!1,i1=typeof WeakSet=="function"?WeakSet:Set,V=null;function wi(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Re(t,e,r)}else n.current=null}function Qc(t,e,n){try{n()}catch(r){Re(t,e,r)}}var Cp=!1;function a1(t,e){if(Lc=Po,t=x0(),af(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var s=0,o=-1,l=-1,u=0,c=0,d=t,f=null;t:for(;;){for(var h;d!==n||i!==0&&d.nodeType!==3||(o=s+i),d!==a||r!==0&&d.nodeType!==3||(l=s+r),d.nodeType===3&&(s+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===t)break t;if(f===n&&++u===i&&(o=s),f===a&&++c===r&&(l=s),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=o===-1||l===-1?null:{start:o,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for($c={focusedElem:t,selectionRange:n},Po=!1,V=e;V!==null;)if(e=V,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,V=t;else for(;V!==null;){e=V;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var v=m.memoizedProps,_=m.memoizedState,p=e.stateNode,y=p.getSnapshotBeforeUpdate(e.elementType===e.type?v:nn(e.type,v),_);p.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var g=e.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(R(163))}}catch(x){Re(e,e.return,x)}if(t=e.sibling,t!==null){t.return=e.return,V=t;break}V=e.return}return m=Cp,Cp=!1,m}function Na(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var a=i.destroy;i.destroy=void 0,a!==void 0&&Qc(e,n,a)}i=i.next}while(i!==r)}}function Cl(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Xc(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function vv(t){var e=t.alternate;e!==null&&(t.alternate=null,vv(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[bn],delete e[Qa],delete e[Fc],delete e[Ux],delete e[Bx])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function wv(t){return t.tag===5||t.tag===3||t.tag===4}function Tp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||wv(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function ed(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=$o));else if(r!==4&&(t=t.child,t!==null))for(ed(t,e,n),t=t.sibling;t!==null;)ed(t,e,n),t=t.sibling}function td(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(td(t,e,n),t=t.sibling;t!==null;)td(t,e,n),t=t.sibling}var Ke=null,rn=!1;function qn(t,e,n){for(n=n.child;n!==null;)_v(t,e,n),n=n.sibling}function _v(t,e,n){if(kn&&typeof kn.onCommitFiberUnmount=="function")try{kn.onCommitFiberUnmount(vl,n)}catch{}switch(n.tag){case 5:et||wi(n,e);case 6:var r=Ke,i=rn;Ke=null,qn(t,e,n),Ke=r,rn=i,Ke!==null&&(rn?(t=Ke,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ke.removeChild(n.stateNode));break;case 18:Ke!==null&&(rn?(t=Ke,n=n.stateNode,t.nodeType===8?mu(t.parentNode,n):t.nodeType===1&&mu(t,n),Za(t)):mu(Ke,n.stateNode));break;case 4:r=Ke,i=rn,Ke=n.stateNode.containerInfo,rn=!0,qn(t,e,n),Ke=r,rn=i;break;case 0:case 11:case 14:case 15:if(!et&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var a=i,s=a.destroy;a=a.tag,s!==void 0&&(a&2||a&4)&&Qc(n,e,s),i=i.next}while(i!==r)}qn(t,e,n);break;case 1:if(!et&&(wi(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){Re(n,e,o)}qn(t,e,n);break;case 21:qn(t,e,n);break;case 22:n.mode&1?(et=(r=et)||n.memoizedState!==null,qn(t,e,n),et=r):qn(t,e,n);break;default:qn(t,e,n)}}function Op(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new i1),e.forEach(function(r){var i=p1.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Qt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var a=t,s=e,o=s;e:for(;o!==null;){switch(o.tag){case 5:Ke=o.stateNode,rn=!1;break e;case 3:Ke=o.stateNode.containerInfo,rn=!0;break e;case 4:Ke=o.stateNode.containerInfo,rn=!0;break e}o=o.return}if(Ke===null)throw Error(R(160));_v(a,s,i),Ke=null,rn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Re(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)bv(e,t),e=e.sibling}function bv(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Qt(e,t),yn(t),r&4){try{Na(3,t,t.return),Cl(3,t)}catch(v){Re(t,t.return,v)}try{Na(5,t,t.return)}catch(v){Re(t,t.return,v)}}break;case 1:Qt(e,t),yn(t),r&512&&n!==null&&wi(n,n.return);break;case 5:if(Qt(e,t),yn(t),r&512&&n!==null&&wi(n,n.return),t.flags&32){var i=t.stateNode;try{Ha(i,"")}catch(v){Re(t,t.return,v)}}if(r&4&&(i=t.stateNode,i!=null)){var a=t.memoizedProps,s=n!==null?n.memoizedProps:a,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&Hy(i,a),kc(o,s);var u=kc(o,a);for(s=0;s<l.length;s+=2){var c=l[s],d=l[s+1];c==="style"?qy(i,d):c==="dangerouslySetInnerHTML"?Wy(i,d):c==="children"?Ha(i,d):Vd(i,c,d,u)}switch(o){case"input":_c(i,a);break;case"textarea":Gy(i,a);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var h=a.value;h!=null?Si(i,!!a.multiple,h,!1):f!==!!a.multiple&&(a.defaultValue!=null?Si(i,!!a.multiple,a.defaultValue,!0):Si(i,!!a.multiple,a.multiple?[]:"",!1))}i[Qa]=a}catch(v){Re(t,t.return,v)}}break;case 6:if(Qt(e,t),yn(t),r&4){if(t.stateNode===null)throw Error(R(162));i=t.stateNode,a=t.memoizedProps;try{i.nodeValue=a}catch(v){Re(t,t.return,v)}}break;case 3:if(Qt(e,t),yn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Za(e.containerInfo)}catch(v){Re(t,t.return,v)}break;case 4:Qt(e,t),yn(t);break;case 13:Qt(e,t),yn(t),i=t.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(kf=Pe())),r&4&&Op(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(et=(u=et)||c,Qt(e,t),et=u):Qt(e,t),yn(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(V=t,c=t.child;c!==null;){for(d=V=c;V!==null;){switch(f=V,h=f.child,f.tag){case 0:case 11:case 14:case 15:Na(4,f,f.return);break;case 1:wi(f,f.return);var m=f.stateNode;if(typeof m.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(v){Re(r,n,v)}}break;case 5:wi(f,f.return);break;case 22:if(f.memoizedState!==null){Ip(d);continue}}h!==null?(h.return=f,V=h):Ip(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{i=d.stateNode,u?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=d.stateNode,l=d.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Zy("display",s))}catch(v){Re(t,t.return,v)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(v){Re(t,t.return,v)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Qt(e,t),yn(t),r&4&&Op(t);break;case 21:break;default:Qt(e,t),yn(t)}}function yn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(wv(n)){var r=n;break e}n=n.return}throw Error(R(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Ha(i,""),r.flags&=-33);var a=Tp(t);td(t,a,i);break;case 3:case 4:var s=r.stateNode.containerInfo,o=Tp(t);ed(t,o,s);break;default:throw Error(R(161))}}catch(l){Re(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function s1(t,e,n){V=t,xv(t)}function xv(t,e,n){for(var r=(t.mode&1)!==0;V!==null;){var i=V,a=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||Ws;if(!s){var o=i.alternate,l=o!==null&&o.memoizedState!==null||et;o=Ws;var u=et;if(Ws=s,(et=l)&&!u)for(V=i;V!==null;)s=V,l=s.child,s.tag===22&&s.memoizedState!==null?Ap(i):l!==null?(l.return=s,V=l):Ap(i);for(;a!==null;)V=a,xv(a),a=a.sibling;V=i,Ws=o,et=u}Np(t)}else i.subtreeFlags&8772&&a!==null?(a.return=i,V=a):Np(t)}}function Np(t){for(;V!==null;){var e=V;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:et||Cl(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!et)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:nn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&hp(e,a,r);break;case 3:var s=e.updateQueue;if(s!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}hp(e,s,n)}break;case 5:var o=e.stateNode;if(n===null&&e.flags&4){n=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&Za(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(R(163))}et||e.flags&512&&Xc(e)}catch(f){Re(e,e.return,f)}}if(e===t){V=null;break}if(n=e.sibling,n!==null){n.return=e.return,V=n;break}V=e.return}}function Ip(t){for(;V!==null;){var e=V;if(e===t){V=null;break}var n=e.sibling;if(n!==null){n.return=e.return,V=n;break}V=e.return}}function Ap(t){for(;V!==null;){var e=V;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Cl(4,e)}catch(l){Re(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){Re(e,i,l)}}var a=e.return;try{Xc(e)}catch(l){Re(e,a,l)}break;case 5:var s=e.return;try{Xc(e)}catch(l){Re(e,s,l)}}}catch(l){Re(e,e.return,l)}if(e===t){V=null;break}var o=e.sibling;if(o!==null){o.return=e.return,V=o;break}V=e.return}}var o1=Math.ceil,Zo=Vn.ReactCurrentDispatcher,Ef=Vn.ReactCurrentOwner,Gt=Vn.ReactCurrentBatchConfig,fe=0,Ge=null,$e=null,Je=0,Tt=0,_i=Tr(0),ze=0,is=null,Vr=0,Tl=0,Sf=0,Ia=null,gt=null,kf=0,Di=1/0,Pn=null,qo=!1,nd=null,mr=null,Zs=!1,or=null,Ko=0,Aa=0,rd=null,_o=-1,bo=0;function ut(){return fe&6?Pe():_o!==-1?_o:_o=Pe()}function gr(t){return t.mode&1?fe&2&&Je!==0?Je&-Je:Gx.transition!==null?(bo===0&&(bo=s0()),bo):(t=we,t!==0||(t=window.event,t=t===void 0?16:h0(t.type)),t):1}function on(t,e,n,r){if(50<Aa)throw Aa=0,rd=null,Error(R(185));ys(t,n,r),(!(fe&2)||t!==Ge)&&(t===Ge&&(!(fe&2)&&(Tl|=n),ze===4&&ar(t,Je)),bt(t,r),n===1&&fe===0&&!(e.mode&1)&&(Di=Pe()+500,El&&Or()))}function bt(t,e){var n=t.callbackNode;Gb(t,e);var r=Ro(t,t===Ge?Je:0);if(r===0)n!==null&&zh(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&zh(n),e===1)t.tag===0?Hx(Rp.bind(null,t)):R0(Rp.bind(null,t)),Fx(function(){!(fe&6)&&Or()}),n=null;else{switch(o0(r)){case 1:n=Jd;break;case 4:n=i0;break;case 16:n=Ao;break;case 536870912:n=a0;break;default:n=Ao}n=Iv(n,Ev.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Ev(t,e){if(_o=-1,bo=0,fe&6)throw Error(R(327));var n=t.callbackNode;if(Ni()&&t.callbackNode!==n)return null;var r=Ro(t,t===Ge?Je:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Jo(t,r);else{e=r;var i=fe;fe|=2;var a=kv();(Ge!==t||Je!==e)&&(Pn=null,Di=Pe()+500,Dr(t,e));do try{c1();break}catch(o){Sv(t,o)}while(!0);cf(),Zo.current=a,fe=i,$e!==null?e=0:(Ge=null,Je=0,e=ze)}if(e!==0){if(e===2&&(i=Ic(t),i!==0&&(r=i,e=id(t,i))),e===1)throw n=is,Dr(t,0),ar(t,r),bt(t,Pe()),n;if(e===6)ar(t,r);else{if(i=t.current.alternate,!(r&30)&&!l1(i)&&(e=Jo(t,r),e===2&&(a=Ic(t),a!==0&&(r=a,e=id(t,a))),e===1))throw n=is,Dr(t,0),ar(t,r),bt(t,Pe()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(R(345));case 2:Rr(t,gt,Pn);break;case 3:if(ar(t,r),(r&130023424)===r&&(e=kf+500-Pe(),10<e)){if(Ro(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){ut(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Dc(Rr.bind(null,t,gt,Pn),e);break}Rr(t,gt,Pn);break;case 4:if(ar(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var s=31-sn(r);a=1<<s,s=e[s],s>i&&(i=s),r&=~a}if(r=i,r=Pe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*o1(r/1960))-r,10<r){t.timeoutHandle=Dc(Rr.bind(null,t,gt,Pn),r);break}Rr(t,gt,Pn);break;case 5:Rr(t,gt,Pn);break;default:throw Error(R(329))}}}return bt(t,Pe()),t.callbackNode===n?Ev.bind(null,t):null}function id(t,e){var n=Ia;return t.current.memoizedState.isDehydrated&&(Dr(t,e).flags|=256),t=Jo(t,e),t!==2&&(e=gt,gt=n,e!==null&&ad(e)),t}function ad(t){gt===null?gt=t:gt.push.apply(gt,t)}function l1(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!dn(a(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ar(t,e){for(e&=~Sf,e&=~Tl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-sn(e),r=1<<n;t[n]=-1,e&=~r}}function Rp(t){if(fe&6)throw Error(R(327));Ni();var e=Ro(t,0);if(!(e&1))return bt(t,Pe()),null;var n=Jo(t,e);if(t.tag!==0&&n===2){var r=Ic(t);r!==0&&(e=r,n=id(t,r))}if(n===1)throw n=is,Dr(t,0),ar(t,e),bt(t,Pe()),n;if(n===6)throw Error(R(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Rr(t,gt,Pn),bt(t,Pe()),null}function Cf(t,e){var n=fe;fe|=1;try{return t(e)}finally{fe=n,fe===0&&(Di=Pe()+500,El&&Or())}}function Wr(t){or!==null&&or.tag===0&&!(fe&6)&&Ni();var e=fe;fe|=1;var n=Gt.transition,r=we;try{if(Gt.transition=null,we=1,t)return t()}finally{we=r,Gt.transition=n,fe=e,!(fe&6)&&Or()}}function Tf(){Tt=_i.current,Ce(_i)}function Dr(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Dx(n)),$e!==null)for(n=$e.return;n!==null;){var r=n;switch(of(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Mo();break;case 3:$i(),Ce(wt),Ce(rt),gf();break;case 5:mf(r);break;case 4:$i();break;case 13:Ce(Oe);break;case 19:Ce(Oe);break;case 10:df(r.type._context);break;case 22:case 23:Tf()}n=n.return}if(Ge=t,$e=t=yr(t.current,null),Je=Tt=e,ze=0,is=null,Sf=Tl=Vr=0,gt=Ia=null,Lr!==null){for(e=0;e<Lr.length;e++)if(n=Lr[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,a=n.pending;if(a!==null){var s=a.next;a.next=i,r.next=s}n.pending=r}Lr=null}return t}function Sv(t,e){do{var n=$e;try{if(cf(),yo.current=Wo,Vo){for(var r=Ne.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Vo=!1}if(Gr=0,Be=De=Ne=null,Oa=!1,ts=0,Ef.current=null,n===null||n.return===null){ze=1,is=e,$e=null;break}e:{var a=t,s=n.return,o=n,l=e;if(e=Je,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=o,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var h=wp(s);if(h!==null){h.flags&=-257,_p(h,s,o,a,e),h.mode&1&&vp(a,u,e),e=h,l=u;var m=e.updateQueue;if(m===null){var v=new Set;v.add(l),e.updateQueue=v}else m.add(l);break e}else{if(!(e&1)){vp(a,u,e),Of();break e}l=Error(R(426))}}else if(Te&&o.mode&1){var _=wp(s);if(_!==null){!(_.flags&65536)&&(_.flags|=256),_p(_,s,o,a,e),lf(Mi(l,o));break e}}a=l=Mi(l,o),ze!==4&&(ze=2),Ia===null?Ia=[a]:Ia.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var p=ov(a,l,e);fp(a,p);break e;case 1:o=l;var y=a.type,g=a.stateNode;if(!(a.flags&128)&&(typeof y.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(mr===null||!mr.has(g)))){a.flags|=65536,e&=-e,a.lanes|=e;var x=lv(a,o,e);fp(a,x);break e}}a=a.return}while(a!==null)}Tv(n)}catch(k){e=k,$e===n&&n!==null&&($e=n=n.return);continue}break}while(!0)}function kv(){var t=Zo.current;return Zo.current=Wo,t===null?Wo:t}function Of(){(ze===0||ze===3||ze===2)&&(ze=4),Ge===null||!(Vr&268435455)&&!(Tl&268435455)||ar(Ge,Je)}function Jo(t,e){var n=fe;fe|=2;var r=kv();(Ge!==t||Je!==e)&&(Pn=null,Dr(t,e));do try{u1();break}catch(i){Sv(t,i)}while(!0);if(cf(),fe=n,Zo.current=r,$e!==null)throw Error(R(261));return Ge=null,Je=0,ze}function u1(){for(;$e!==null;)Cv($e)}function c1(){for(;$e!==null&&!Lb();)Cv($e)}function Cv(t){var e=Nv(t.alternate,t,Tt);t.memoizedProps=t.pendingProps,e===null?Tv(t):$e=e,Ef.current=null}function Tv(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=r1(n,e),n!==null){n.flags&=32767,$e=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ze=6,$e=null;return}}else if(n=n1(n,e,Tt),n!==null){$e=n;return}if(e=e.sibling,e!==null){$e=e;return}$e=e=t}while(e!==null);ze===0&&(ze=5)}function Rr(t,e,n){var r=we,i=Gt.transition;try{Gt.transition=null,we=1,d1(t,e,n,r)}finally{Gt.transition=i,we=r}return null}function d1(t,e,n,r){do Ni();while(or!==null);if(fe&6)throw Error(R(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(R(177));t.callbackNode=null,t.callbackPriority=0;var a=n.lanes|n.childLanes;if(Vb(t,a),t===Ge&&($e=Ge=null,Je=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Zs||(Zs=!0,Iv(Ao,function(){return Ni(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=Gt.transition,Gt.transition=null;var s=we;we=1;var o=fe;fe|=4,Ef.current=null,a1(t,n),bv(n,t),Ax($c),Po=!!Lc,$c=Lc=null,t.current=n,s1(n),$b(),fe=o,we=s,Gt.transition=a}else t.current=n;if(Zs&&(Zs=!1,or=t,Ko=i),a=t.pendingLanes,a===0&&(mr=null),Fb(n.stateNode),bt(t,Pe()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(qo)throw qo=!1,t=nd,nd=null,t;return Ko&1&&t.tag!==0&&Ni(),a=t.pendingLanes,a&1?t===rd?Aa++:(Aa=0,rd=t):Aa=0,Or(),null}function Ni(){if(or!==null){var t=o0(Ko),e=Gt.transition,n=we;try{if(Gt.transition=null,we=16>t?16:t,or===null)var r=!1;else{if(t=or,or=null,Ko=0,fe&6)throw Error(R(331));var i=fe;for(fe|=4,V=t.current;V!==null;){var a=V,s=a.child;if(V.flags&16){var o=a.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(V=u;V!==null;){var c=V;switch(c.tag){case 0:case 11:case 15:Na(8,c,a)}var d=c.child;if(d!==null)d.return=c,V=d;else for(;V!==null;){c=V;var f=c.sibling,h=c.return;if(vv(c),c===u){V=null;break}if(f!==null){f.return=h,V=f;break}V=h}}}var m=a.alternate;if(m!==null){var v=m.child;if(v!==null){m.child=null;do{var _=v.sibling;v.sibling=null,v=_}while(v!==null)}}V=a}}if(a.subtreeFlags&2064&&s!==null)s.return=a,V=s;else e:for(;V!==null;){if(a=V,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Na(9,a,a.return)}var p=a.sibling;if(p!==null){p.return=a.return,V=p;break e}V=a.return}}var y=t.current;for(V=y;V!==null;){s=V;var g=s.child;if(s.subtreeFlags&2064&&g!==null)g.return=s,V=g;else e:for(s=y;V!==null;){if(o=V,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Cl(9,o)}}catch(k){Re(o,o.return,k)}if(o===s){V=null;break e}var x=o.sibling;if(x!==null){x.return=o.return,V=x;break e}V=o.return}}if(fe=i,Or(),kn&&typeof kn.onPostCommitFiberRoot=="function")try{kn.onPostCommitFiberRoot(vl,t)}catch{}r=!0}return r}finally{we=n,Gt.transition=e}}return!1}function Pp(t,e,n){e=Mi(n,e),e=ov(t,e,1),t=pr(t,e,1),e=ut(),t!==null&&(ys(t,1,e),bt(t,e))}function Re(t,e,n){if(t.tag===3)Pp(t,t,n);else for(;e!==null;){if(e.tag===3){Pp(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(mr===null||!mr.has(r))){t=Mi(n,t),t=lv(e,t,1),e=pr(e,t,1),t=ut(),e!==null&&(ys(e,1,t),bt(e,t));break}}e=e.return}}function f1(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=ut(),t.pingedLanes|=t.suspendedLanes&n,Ge===t&&(Je&n)===n&&(ze===4||ze===3&&(Je&130023424)===Je&&500>Pe()-kf?Dr(t,0):Sf|=n),bt(t,e)}function Ov(t,e){e===0&&(t.mode&1?(e=Ms,Ms<<=1,!(Ms&130023424)&&(Ms=4194304)):e=1);var n=ut();t=Bn(t,e),t!==null&&(ys(t,e,n),bt(t,n))}function h1(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Ov(t,n)}function p1(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(R(314))}r!==null&&r.delete(e),Ov(t,n)}var Nv;Nv=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||wt.current)yt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return yt=!1,t1(t,e,n);yt=!!(t.flags&131072)}else yt=!1,Te&&e.flags&1048576&&P0(e,zo,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;wo(t,e),t=e.pendingProps;var i=Pi(e,rt.current);Oi(e,n),i=vf(null,e,r,t,i,n);var a=wf();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,_t(r)?(a=!0,Do(e)):a=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,hf(e),i.updater=kl,e.stateNode=i,i._reactInternals=e,Vc(e,r,t,n),e=qc(null,e,r,!0,a,n)):(e.tag=0,Te&&a&&sf(e),ot(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(wo(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=g1(r),t=nn(r,t),i){case 0:e=Zc(null,e,r,t,n);break e;case 1:e=Ep(null,e,r,t,n);break e;case 11:e=bp(null,e,r,t,n);break e;case 14:e=xp(null,e,r,nn(r.type,t),n);break e}throw Error(R(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:nn(r,i),Zc(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:nn(r,i),Ep(t,e,r,i,n);case 3:e:{if(fv(e),t===null)throw Error(R(387));r=e.pendingProps,a=e.memoizedState,i=a.element,F0(t,e),Ho(e,r,null,n);var s=e.memoizedState;if(r=s.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){i=Mi(Error(R(423)),e),e=Sp(t,e,r,n,i);break e}else if(r!==i){i=Mi(Error(R(424)),e),e=Sp(t,e,r,n,i);break e}else for(Ot=hr(e.stateNode.containerInfo.firstChild),It=e,Te=!0,an=null,n=M0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ji(),r===i){e=Hn(t,e,n);break e}ot(t,e,r,n)}e=e.child}return e;case 5:return z0(e),t===null&&Bc(e),r=e.type,i=e.pendingProps,a=t!==null?t.memoizedProps:null,s=i.children,Mc(r,i)?s=null:a!==null&&Mc(r,a)&&(e.flags|=32),dv(t,e),ot(t,e,s,n),e.child;case 6:return t===null&&Bc(e),null;case 13:return hv(t,e,n);case 4:return pf(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Li(e,null,r,n):ot(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:nn(r,i),bp(t,e,r,i,n);case 7:return ot(t,e,e.pendingProps,n),e.child;case 8:return ot(t,e,e.pendingProps.children,n),e.child;case 12:return ot(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,a=e.memoizedProps,s=i.value,Ee(Uo,r._currentValue),r._currentValue=s,a!==null)if(dn(a.value,s)){if(a.children===i.children&&!wt.current){e=Hn(t,e,n);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var o=a.dependencies;if(o!==null){s=a.child;for(var l=o.firstContext;l!==null;){if(l.context===r){if(a.tag===1){l=Dn(-1,n&-n),l.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),Hc(a.return,n,e),o.lanes|=n;break}l=l.next}}else if(a.tag===10)s=a.type===e.type?null:a.child;else if(a.tag===18){if(s=a.return,s===null)throw Error(R(341));s.lanes|=n,o=s.alternate,o!==null&&(o.lanes|=n),Hc(s,n,e),s=a.sibling}else s=a.child;if(s!==null)s.return=a;else for(s=a;s!==null;){if(s===e){s=null;break}if(a=s.sibling,a!==null){a.return=s.return,s=a;break}s=s.return}a=s}ot(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Oi(e,n),i=Vt(i),r=r(i),e.flags|=1,ot(t,e,r,n),e.child;case 14:return r=e.type,i=nn(r,e.pendingProps),i=nn(r.type,i),xp(t,e,r,i,n);case 15:return uv(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:nn(r,i),wo(t,e),e.tag=1,_t(r)?(t=!0,Do(e)):t=!1,Oi(e,n),sv(e,r,i),Vc(e,r,i,n),qc(null,e,r,!0,t,n);case 19:return pv(t,e,n);case 22:return cv(t,e,n)}throw Error(R(156,e.tag))};function Iv(t,e){return r0(t,e)}function m1(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ht(t,e,n,r){return new m1(t,e,n,r)}function Nf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function g1(t){if(typeof t=="function")return Nf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Zd)return 11;if(t===qd)return 14}return 2}function yr(t,e){var n=t.alternate;return n===null?(n=Ht(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function xo(t,e,n,r,i,a){var s=2;if(r=t,typeof t=="function")Nf(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case ci:return Fr(n.children,i,a,e);case Wd:s=8,i|=8;break;case mc:return t=Ht(12,n,e,i|2),t.elementType=mc,t.lanes=a,t;case gc:return t=Ht(13,n,e,i),t.elementType=gc,t.lanes=a,t;case yc:return t=Ht(19,n,e,i),t.elementType=yc,t.lanes=a,t;case zy:return Ol(n,i,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Dy:s=10;break e;case Fy:s=9;break e;case Zd:s=11;break e;case qd:s=14;break e;case Qn:s=16,r=null;break e}throw Error(R(130,t==null?t:typeof t,""))}return e=Ht(s,n,e,i),e.elementType=t,e.type=r,e.lanes=a,e}function Fr(t,e,n,r){return t=Ht(7,t,r,e),t.lanes=n,t}function Ol(t,e,n,r){return t=Ht(22,t,r,e),t.elementType=zy,t.lanes=n,t.stateNode={isHidden:!1},t}function Eu(t,e,n){return t=Ht(6,t,null,e),t.lanes=n,t}function Su(t,e,n){return e=Ht(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function y1(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=iu(0),this.expirationTimes=iu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=iu(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function If(t,e,n,r,i,a,s,o,l){return t=new y1(t,e,n,o,l),e===1?(e=1,a===!0&&(e|=8)):e=0,a=Ht(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},hf(a),t}function v1(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ui,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Av(t){if(!t)return br;t=t._reactInternals;e:{if(Qr(t)!==t||t.tag!==1)throw Error(R(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(_t(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(R(171))}if(t.tag===1){var n=t.type;if(_t(n))return A0(t,n,e)}return e}function Rv(t,e,n,r,i,a,s,o,l){return t=If(n,r,!0,t,i,a,s,o,l),t.context=Av(null),n=t.current,r=ut(),i=gr(n),a=Dn(r,i),a.callback=e??null,pr(n,a,i),t.current.lanes=i,ys(t,i,r),bt(t,r),t}function Nl(t,e,n,r){var i=e.current,a=ut(),s=gr(i);return n=Av(n),e.context===null?e.context=n:e.pendingContext=n,e=Dn(a,s),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=pr(i,e,s),t!==null&&(on(t,i,s,a),go(t,i,s)),s}function Yo(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function jp(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Af(t,e){jp(t,e),(t=t.alternate)&&jp(t,e)}function w1(){return null}var Pv=typeof reportError=="function"?reportError:function(t){console.error(t)};function Rf(t){this._internalRoot=t}Il.prototype.render=Rf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(R(409));Nl(t,e,null,null)};Il.prototype.unmount=Rf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Wr(function(){Nl(null,t,null,null)}),e[Un]=null}};function Il(t){this._internalRoot=t}Il.prototype.unstable_scheduleHydration=function(t){if(t){var e=c0();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ir.length&&e!==0&&e<ir[n].priority;n++);ir.splice(n,0,t),n===0&&f0(t)}};function Pf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Al(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Lp(){}function _1(t,e,n,r,i){if(i){if(typeof r=="function"){var a=r;r=function(){var u=Yo(s);a.call(u)}}var s=Rv(e,r,t,0,null,!1,!1,"",Lp);return t._reactRootContainer=s,t[Un]=s.current,Ja(t.nodeType===8?t.parentNode:t),Wr(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var o=r;r=function(){var u=Yo(l);o.call(u)}}var l=If(t,0,!1,null,null,!1,!1,"",Lp);return t._reactRootContainer=l,t[Un]=l.current,Ja(t.nodeType===8?t.parentNode:t),Wr(function(){Nl(e,l,n,r)}),l}function Rl(t,e,n,r,i){var a=n._reactRootContainer;if(a){var s=a;if(typeof i=="function"){var o=i;i=function(){var l=Yo(s);o.call(l)}}Nl(e,s,t,i)}else s=_1(n,e,t,i,r);return Yo(s)}l0=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=va(e.pendingLanes);n!==0&&(Yd(e,n|1),bt(e,Pe()),!(fe&6)&&(Di=Pe()+500,Or()))}break;case 13:Wr(function(){var r=Bn(t,1);if(r!==null){var i=ut();on(r,t,1,i)}}),Af(t,1)}};Qd=function(t){if(t.tag===13){var e=Bn(t,134217728);if(e!==null){var n=ut();on(e,t,134217728,n)}Af(t,134217728)}};u0=function(t){if(t.tag===13){var e=gr(t),n=Bn(t,e);if(n!==null){var r=ut();on(n,t,e,r)}Af(t,e)}};c0=function(){return we};d0=function(t,e){var n=we;try{return we=t,e()}finally{we=n}};Tc=function(t,e,n){switch(e){case"input":if(_c(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=xl(r);if(!i)throw Error(R(90));By(r),_c(r,i)}}}break;case"textarea":Gy(t,n);break;case"select":e=n.value,e!=null&&Si(t,!!n.multiple,e,!1)}};Yy=Cf;Qy=Wr;var b1={usingClientEntryPoint:!1,Events:[ws,pi,xl,Ky,Jy,Cf]},da={findFiberByHostInstance:jr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},x1={bundleType:da.bundleType,version:da.version,rendererPackageName:da.rendererPackageName,rendererConfig:da.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Vn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=t0(t),t===null?null:t.stateNode},findFiberByHostInstance:da.findFiberByHostInstance||w1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qs=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qs.isDisabled&&qs.supportsFiber)try{vl=qs.inject(x1),kn=qs}catch{}}Lt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=b1;Lt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Pf(e))throw Error(R(200));return v1(t,e,null,n)};Lt.createRoot=function(t,e){if(!Pf(t))throw Error(R(299));var n=!1,r="",i=Pv;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=If(t,1,!1,null,null,n,!1,r,i),t[Un]=e.current,Ja(t.nodeType===8?t.parentNode:t),new Rf(e)};Lt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(R(188)):(t=Object.keys(t).join(","),Error(R(268,t)));return t=t0(e),t=t===null?null:t.stateNode,t};Lt.flushSync=function(t){return Wr(t)};Lt.hydrate=function(t,e,n){if(!Al(e))throw Error(R(200));return Rl(null,t,e,!0,n)};Lt.hydrateRoot=function(t,e,n){if(!Pf(t))throw Error(R(405));var r=n!=null&&n.hydratedSources||null,i=!1,a="",s=Pv;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),e=Rv(e,null,t,1,n??null,i,!1,a,s),t[Un]=e.current,Ja(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Il(e)};Lt.render=function(t,e,n){if(!Al(e))throw Error(R(200));return Rl(null,t,e,!1,n)};Lt.unmountComponentAtNode=function(t){if(!Al(t))throw Error(R(40));return t._reactRootContainer?(Wr(function(){Rl(null,null,t,!1,function(){t._reactRootContainer=null,t[Un]=null})}),!0):!1};Lt.unstable_batchedUpdates=Cf;Lt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Al(n))throw Error(R(200));if(t==null||t._reactInternals===void 0)throw Error(R(38));return Rl(t,e,n,!1,r)};Lt.version="18.3.1-next-f1338f8080-20240426";function jv(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(jv)}catch(t){console.error(t)}}jv(),jy.exports=Lt;var E1=jy.exports,Lv,$p=E1;Lv=$p.createRoot,$p.hydrateRoot;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var S1={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k1=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),_e=(t,e)=>{const n=Y.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:a=2,absoluteStrokeWidth:s,className:o="",children:l,...u},c)=>Y.createElement("svg",{ref:c,...S1,width:i,height:i,stroke:r,strokeWidth:s?Number(a)*24/Number(i):a,className:["lucide",`lucide-${k1(t)}`,o].join(" "),...u},[...e.map(([d,f])=>Y.createElement(d,f)),...Array.isArray(l)?l:[l]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C1=_e("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T1=_e("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mp=_e("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O1=_e("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $v=_e("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N1=_e("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I1=_e("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A1=_e("Hotel",[["path",{d:"M18 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2Z",key:"p9z69c"}],["path",{d:"m9 16 .348-.24c1.465-1.013 3.84-1.013 5.304 0L15 16",key:"1bvcvh"}],["path",{d:"M8 7h.01",key:"1vti4s"}],["path",{d:"M16 7h.01",key:"1kdx03"}],["path",{d:"M12 7h.01",key:"1ivr5q"}],["path",{d:"M12 11h.01",key:"z322tv"}],["path",{d:"M16 11h.01",key:"xkw8gn"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M10 22v-6.5m4 0V22",key:"16gs4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R1=_e("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P1=_e("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j1=_e("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mv=_e("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dv=_e("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fv=_e("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L1=_e("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $1=_e("PhoneOff",[["path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91",key:"z86iuo"}],["line",{x1:"22",x2:"2",y1:"2",y2:"22",key:"11kh81"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jf=_e("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M1=_e("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qo=_e("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D1=_e("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F1=_e("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z1=_e("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zv=_e("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uv=_e("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U1=_e("UtensilsCrossed",[["path",{d:"m16 2-2.3 2.3a3 3 0 0 0 0 4.2l1.8 1.8a3 3 0 0 0 4.2 0L22 8",key:"n7qcjb"}],["path",{d:"M15 15 3.3 3.3a4.2 4.2 0 0 0 0 6l7.3 7.3c.7.7 2 .7 2.8 0L15 15Zm0 0 7 7",key:"d0u48b"}],["path",{d:"m2.1 21.8 6.4-6.3",key:"yn04lh"}],["path",{d:"m19 5-7 7",key:"194lzd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B1=_e("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H1=_e("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G1=_e("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V1=_e("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),W1=[{id:"conv-1",agentId:"hotel-zoka",agentName:"",agentTitle:"   ",messages:[{id:"msg-1",content:" !      ",sender:"agent",timestamp:new Date("2024-01-13T16:45:00"),type:"text",status:"read"},{id:"msg-2",content:"      3 ",sender:"user",timestamp:new Date("2024-01-13T16:46:00"),type:"text",status:"read"}],isActive:!1,lastActivity:new Date("2024-01-13T17:30:00")}],Z1=()=>W1.sort((t,e)=>new Date(e.lastActivity).getTime()-new Date(t.lastActivity).getTime()),Bv=({isOpen:t,onClose:e,currentConversationId:n,onConversationSelect:r,onNewConversation:i})=>{const a=Z1(),s=u=>{const d=Math.floor((new Date().getTime()-u.getTime())/(1e3*60*60)),f=Math.floor(d/24);return d<1?"":d<24?` ${d} `:f===1?"":f<7?` ${f} `:u.toLocaleDateString("ar-SA",{month:"short",day:"numeric"})},o=u=>{const c=u.messages[u.messages.length-1];if(!c)return"";const d=c.content;return d.length>50?d.substring(0,50)+"...":d},l=u=>u.startsWith("gov-")?"from-emerald-500 to-emerald-600":u.startsWith("hospital-")?"from-blue-500 to-blue-600":u.startsWith("hotel-")?"from-purple-500 to-purple-600":u.startsWith("ngo-")?"from-rose-500 to-rose-600":"from-gray-500 to-gray-600";return w.jsxs(w.Fragment,{children:[t&&w.jsx("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm z-40 lg:hidden",onClick:e}),w.jsxs("div",{className:`fixed inset-y-0 right-0 w-80 bg-white border-l border-gray-200 shadow-2xl z-50 transform transition-transform duration-300 ease-out ${t?"translate-x-0":"translate-x-full"}`,dir:"rtl",children:[w.jsx("div",{className:"flex items-center justify-end p-4 mt-20",children:w.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors duration-200 lg:hidden","aria-label":"  ",children:w.jsx(V1,{className:"h-4 w-4 text-gray-600 hover:text-gray-900"})})}),w.jsx("div",{className:"p-4 pt-0",children:w.jsxs("button",{onClick:i,className:"w-full flex items-center justify-center space-x-2 space-x-reverse px-4 py-3 bg-gray-100 hover:bg-gray-200 border border-gray-300 rounded-lg transition-colors duration-200 text-gray-700 font-medium","aria-label":" ",children:[w.jsx(M1,{className:"h-4 w-4"}),w.jsx("span",{children:" "})]})}),w.jsx("div",{className:"px-4 pb-4",children:w.jsxs("div",{className:"relative",children:[w.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:w.jsx(Qo,{className:"h-4 w-4 text-gray-400"})}),w.jsx("input",{type:"text",className:"block w-full pr-10 pl-3 py-2 border border-gray-300 rounded-lg bg-gray-50 placeholder-gray-500 text-gray-900 text-sm focus:outline-none focus:ring-1 focus:ring-orange-500 focus:border-orange-500 transition-all duration-200",placeholder:"  ..."})]})}),w.jsx("div",{className:"flex-1 overflow-y-auto",children:w.jsx("div",{className:"p-2",children:a.map(u=>{var c;return w.jsxs("button",{onClick:()=>r(u),className:`w-full text-right p-3 rounded-lg mb-1 transition-all duration-200 hover:bg-gray-100 group ${n===u.id?"bg-gray-100 border-l-2 border-orange-500":"hover:bg-gray-50"}`,children:[w.jsxs("div",{className:"flex items-start space-x-3 space-x-reverse",children:[w.jsxs("div",{className:`w-8 h-8 rounded-lg bg-gradient-to-br ${l(u.agentId)} flex items-center justify-center text-white font-bold text-xs flex-shrink-0`,children:[u.agentName.split(" ")[0][0],((c=u.agentName.split(" ")[1])==null?void 0:c[0])||""]}),w.jsxs("div",{className:"flex-1 min-w-0",children:[w.jsxs("div",{className:"flex items-center justify-between mb-1",children:[w.jsx("h3",{className:"font-medium text-gray-900 text-sm truncate",children:u.agentName}),w.jsxs("div",{className:"flex items-center space-x-1 space-x-reverse text-xs text-gray-500",children:[w.jsx($v,{className:"h-3 w-3"}),w.jsx("span",{children:s(u.lastActivity)})]})]}),w.jsx("p",{className:"text-xs text-gray-600 truncate",children:o(u)})]})]}),u.isActive&&w.jsx("div",{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-2 h-2 bg-orange-500 rounded-full"})]},u.id)})})}),w.jsx("div",{className:"p-4 border-t border-gray-200",children:w.jsxs("div",{className:"flex items-center justify-center text-xs text-gray-500",children:[w.jsx(Mv,{className:"h-4 w-4 mr-2"}),w.jsxs("span",{children:[a.length," "]})]})})]})]})},q1=({isLoggedIn:t,onToggleLogin:e,onCategorySelect:n})=>{const[r,i]=Y.useState(!1),a=[{id:"government",name:"",icon:F1,color:"from-emerald-500 to-emerald-600",bgColor:"bg-emerald-50/30",borderColor:"border-emerald-100/50",hoverBg:"hover:bg-emerald-50/50",agents:0,description:"  "},{id:"ngos",name:"  ",icon:I1,color:"from-rose-500 to-rose-600",bgColor:"bg-rose-50/30",borderColor:"border-rose-100/50",hoverBg:"hover:bg-rose-50/50",agents:0,description:"  "},{id:"hospitals",name:"",icon:T1,color:"from-blue-500 to-blue-600",bgColor:"bg-blue-50/30",borderColor:"border-blue-100/50",hoverBg:"hover:bg-blue-50/50",agents:0,description:"  "},{id:"hotels",name:"",icon:A1,color:"from-purple-500 to-purple-600",bgColor:"bg-purple-50/30",borderColor:"border-purple-100/50",hoverBg:"hover:bg-purple-50/50",agents:1,description:"  "},{id:"restaurants",name:"",icon:U1,color:"from-amber-500 to-amber-600",bgColor:"bg-amber-50/30",borderColor:"border-amber-100/50",hoverBg:"hover:bg-amber-50/50",agents:1,description:"  "}],s=u=>{n(u)},o=()=>{},l=()=>{};return w.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-orange-50 relative overflow-hidden",dir:"rtl",children:[w.jsx(Bv,{isOpen:r,onClose:()=>i(!1),onConversationSelect:o,onNewConversation:l}),w.jsx("div",{className:`fixed inset-0 transition-all duration-500 pointer-events-none z-30 ${r?"backdrop-blur-xl bg-white/20 opacity-100":"opacity-0"}`}),w.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[w.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[800px] h-[800px] bg-gradient-radial from-orange-200/40 via-blue-200/30 to-purple-200/20 rounded-full blur-3xl opacity-60"}),w.jsx("div",{className:"absolute top-20 right-20 w-96 h-96 bg-gradient-to-br from-orange-300/30 to-pink-300/20 rounded-full blur-3xl opacity-50"}),w.jsx("div",{className:"absolute bottom-20 left-20 w-80 h-80 bg-gradient-to-tr from-blue-300/30 to-purple-300/20 rounded-full blur-3xl opacity-40"}),w.jsx("div",{className:"absolute top-1/3 left-10 w-64 h-64 bg-gradient-to-r from-emerald-200/25 to-teal-200/20 rounded-full blur-2xl opacity-30"}),w.jsx("div",{className:"absolute bottom-1/3 right-10 w-72 h-72 bg-gradient-to-l from-rose-200/25 to-orange-200/20 rounded-full blur-2xl opacity-35"})]}),w.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 backdrop-blur-2xl bg-white/10 border-b border-white/10",children:w.jsx("div",{className:"max-w-7xl mx-auto px-6 lg:px-8",children:w.jsxs("div",{className:"flex items-center justify-between h-20",children:[w.jsxs("div",{className:"flex items-center space-x-4 space-x-reverse",children:[w.jsx("button",{onClick:()=>i(!r),className:"p-2 hover:bg-white/20 rounded-full transition-colors duration-200 backdrop-blur-xl bg-white/10 border border-white/20","aria-label":" ",children:w.jsx(j1,{className:"h-5 w-5 text-gray-700"})}),w.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[w.jsx("img",{src:"/mandaleen-logo.png",alt:"",className:"h-8 w-8"}),w.jsx("h1",{className:"text-2xl font-semibold text-black tracking-normal",children:""})]})]}),w.jsx("div",{className:"flex-1 max-w-xl mx-12",children:w.jsxs("div",{className:"relative group",children:[w.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/20 via-white/25 to-white/20 rounded-full backdrop-blur-3xl border border-white/20 shadow-2xl shadow-orange-500/10 group-hover:shadow-orange-500/20 transition-all duration-500"}),w.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-orange-50/30 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),w.jsx("div",{className:"absolute inset-y-0 right-0 pr-5 flex items-center pointer-events-none z-10",children:w.jsx(Qo,{className:"h-5 w-5 text-gray-500 group-hover:text-orange-500 transition-colors duration-300"})}),w.jsx("input",{type:"text",className:"relative w-full pr-12 pl-6 py-4 bg-transparent border-0 rounded-full placeholder-gray-500 text-gray-800 focus:outline-none focus:ring-0 text-lg font-medium",placeholder:"   ..."})]})}),w.jsx("div",{className:"flex items-center",children:w.jsxs("button",{onClick:e,className:"group relative overflow-hidden px-6 py-3 rounded-full backdrop-blur-xl bg-gradient-to-r from-orange-500/90 to-orange-600/90 hover:from-orange-600 hover:to-orange-700 text-white transition-all duration-300 shadow-xl shadow-orange-500/25 hover:shadow-orange-500/40 border border-orange-400/30",children:[w.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),w.jsx("div",{className:"relative flex items-center space-x-2 space-x-reverse font-medium",children:t?w.jsxs(w.Fragment,{children:[w.jsx(R1,{className:"h-4 w-4"}),w.jsx("span",{children:""})]}):w.jsxs(w.Fragment,{children:[w.jsx(zv,{className:"h-4 w-4"}),w.jsx("span",{children:""})]})})]})})]})})}),w.jsxs("main",{className:"relative pt-20",children:[w.jsx("section",{className:"relative overflow-hidden",children:w.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24",children:w.jsxs("div",{className:"text-center",children:[w.jsxs("div",{className:"flex items-center justify-center mb-6",children:[w.jsx("img",{src:"/mandaleen-logo.png",alt:"",className:"h-16 w-16 ml-4"}),w.jsxs("h1",{className:"text-6xl sm:text-7xl font-bold text-gray-900",children:["  "," ",w.jsx("span",{className:"bg-gradient-to-r from-orange-500 to-orange-600 bg-clip-text text-transparent",children:""})]})]}),w.jsx("p",{className:"text-xl text-gray-600 mb-12 max-w-2xl mx-auto leading-relaxed",children:"        "}),w.jsx("div",{className:"max-w-2xl mx-auto mb-16",children:w.jsx("div",{className:"relative",children:w.jsx("div",{className:"backdrop-blur-2xl bg-white/40 rounded-3xl p-6 border border-white/30 shadow-2xl shadow-black/10 ring-1 ring-white/20",children:w.jsxs("div",{className:"flex items-center space-x-4 space-x-reverse",children:[w.jsx(Qo,{className:"h-6 w-6 text-orange-500 flex-shrink-0"}),w.jsx("input",{type:"text",className:"flex-1 bg-transparent text-lg placeholder-gray-500 text-gray-900 focus:outline-none",placeholder:"    ..."}),w.jsx("button",{className:"px-6 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white rounded-2xl hover:from-orange-600 hover:to-orange-700 transition-all duration-200 shadow-lg shadow-orange-500/30",children:""})]})})})})]})})}),w.jsx("section",{className:"py-20",children:w.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[w.jsxs("div",{className:"text-center mb-16",children:[w.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:" "}),w.jsx("p",{className:"text-xl text-gray-600",children:"      "})]}),w.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:a.map(u=>{const c=u.icon;return w.jsxs("div",{onClick:()=>s(u),className:"group relative overflow-hidden rounded-3xl transition-all duration-300 cursor-pointer backdrop-blur-xl bg-white/30 hover:bg-white/40 border-2 border-white/50 hover:border-white/70 hover:shadow-2xl hover:shadow-black/10 ring-1 ring-white/30 hover:ring-white/40",role:"button",tabIndex:0,"aria-label":`  ${u.name}`,onKeyDown:d=>{(d.key==="Enter"||d.key===" ")&&(d.preventDefault(),s(u))},children:[w.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/25 to-transparent opacity-60 group-hover:opacity-80 transition-opacity duration-300"}),w.jsxs("div",{className:"relative p-8 h-full flex flex-col",children:[w.jsxs("div",{className:"flex items-center justify-between mb-6",children:[w.jsx("div",{className:`p-4 rounded-2xl bg-gradient-to-br ${u.color} text-white shadow-lg shadow-black/20`,children:w.jsx(c,{className:"h-8 w-8"})}),w.jsxs("div",{className:"text-left",children:[w.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[w.jsx(Uv,{className:"h-5 w-5 text-gray-500"}),w.jsx("span",{className:"text-2xl font-bold text-gray-900",children:u.agents})]}),w.jsx("p",{className:"text-sm text-gray-500",children:" "})]})]}),w.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-3 group-hover:text-orange-600 transition-colors duration-300",children:u.name}),w.jsx("p",{className:"text-gray-600 mb-6 flex-grow",children:u.description}),w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center space-x-4 space-x-reverse text-sm text-gray-500",children:[w.jsxs("div",{className:"flex items-center space-x-1 space-x-reverse",children:[w.jsx(P1,{className:"h-4 w-4"}),w.jsx("span",{children:"   "})]}),w.jsxs("div",{className:"flex items-center space-x-1 space-x-reverse",children:[w.jsx(jf,{className:"h-4 w-4"}),w.jsx("span",{children:" 24/7"})]})]}),w.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full shadow-lg shadow-green-500/50"})]})]})]},u.id)})})]})}),w.jsx("footer",{className:"relative py-12 border-t border-white/20 backdrop-blur-sm bg-white/30",children:w.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:w.jsxs("div",{className:"text-center",children:[w.jsxs("div",{className:"flex items-center justify-center space-x-2 space-x-reverse mb-4",children:[w.jsx("img",{src:"/mandaleen-logo.png",alt:"",className:"h-8 w-8"}),w.jsx("h3",{className:"text-2xl font-bold bg-gradient-to-r from-orange-500 to-orange-600 bg-clip-text text-transparent",children:""})]}),w.jsx("p",{className:"text-gray-600",children:"      "})]})})})]})]})},K1=({agent:t,onChat:e,onCall:n})=>{var a;const r=()=>{e(t)},i=()=>{n(t)};return w.jsxs("div",{className:"group relative overflow-hidden rounded-3xl transition-all duration-300 backdrop-blur-xl bg-white/30 border-2 border-white/50 hover:border-white/70 hover:shadow-2xl hover:shadow-black/10 ring-1 ring-white/30 hover:ring-white/40",children:[w.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/25 to-transparent opacity-60 group-hover:opacity-80 transition-opacity duration-300"}),w.jsxs("div",{className:"relative p-6",children:[w.jsx("div",{className:"flex items-start justify-between mb-4",children:w.jsxs("div",{className:"flex items-center space-x-4 space-x-reverse",children:[w.jsxs("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-orange-400 to-orange-600 flex items-center justify-center text-white font-bold text-xl shadow-lg",children:[t.name.split(" ")[0][0],((a=t.name.split(" ")[1])==null?void 0:a[0])||""]}),w.jsxs("div",{className:"flex-1",children:[w.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1 group-hover:text-orange-600 transition-colors duration-300",children:t.name}),w.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[w.jsxs("div",{className:"flex items-center space-x-1 space-x-reverse",children:[w.jsx(z1,{className:"h-4 w-4 text-yellow-500 fill-current"}),w.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.rating})]}),w.jsxs("span",{className:"text-sm text-gray-500",children:["(",t.reviewCount," )"]})]})]})]})}),w.jsxs("div",{className:"flex space-x-3 space-x-reverse",children:[w.jsxs("button",{onClick:r,disabled:!t.isOnline,className:`flex-1 flex items-center justify-center space-x-2 space-x-reverse px-4 py-3 rounded-2xl font-medium transition-all duration-200 ${t.isOnline?"bg-gradient-to-r from-orange-500 to-orange-600 text-white hover:from-orange-600 hover:to-orange-700 shadow-lg shadow-orange-500/25 hover:shadow-orange-500/40":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,"aria-label":`   ${t.name}`,children:[w.jsx(Mv,{className:"h-4 w-4"}),w.jsx("span",{children:""})]}),w.jsxs("button",{onClick:i,disabled:!t.isOnline,className:`flex-1 flex items-center justify-center space-x-2 space-x-reverse px-4 py-3 rounded-2xl font-medium transition-all duration-200 ${t.isOnline?"bg-white text-orange-500 border-2 border-orange-500 hover:bg-orange-50 hover:border-orange-600":"bg-gray-50 text-gray-400 border-2 border-gray-200 cursor-not-allowed"}`,"aria-label":`   ${t.name}`,children:[w.jsx(jf,{className:"h-4 w-4"}),w.jsx("span",{children:""})]})]})]})]})},J1=[{id:"hotel-zoka",name:"",title:"   ",rating:4.9,reviewCount:342,isOnline:!0,responseTime:" ",languages:["","",""],specialties:[" "," "," "," "],categoryId:"hotels",experience:"8 ",location:""},{id:"restaurant-zoka-cafe",name:"   ",title:"   ",rating:4.7,reviewCount:186,isOnline:!0,responseTime:" ",languages:["",""],specialties:[" "," "," "," "],categoryId:"restaurants",experience:"5 ",location:""}],Y1=t=>J1.filter(e=>e.categoryId===t),Q1=({category:t,onBack:e,onStartChat:n,onStartCall:r})=>{const[i,a]=Y.useState([]),[s,o]=Y.useState([]),[l,u]=Y.useState(""),[c,d]=Y.useState(!1),[f,h]=Y.useState("rating"),[m,v]=Y.useState(!0);Y.useEffect(()=>{v(!0),setTimeout(()=>{const g=Y1(t.id);a(g),o(g),v(!1)},300)},[t.id]),Y.useEffect(()=>{let g=i;l&&(g=g.filter(x=>x.name.toLowerCase().includes(l.toLowerCase())||x.title.toLowerCase().includes(l.toLowerCase())||x.specialties.some(k=>k.toLowerCase().includes(l.toLowerCase())))),c&&(g=g.filter(x=>x.isOnline)),g=[...g].sort((x,k)=>{switch(f){case"rating":return k.rating-x.rating;case"name":return x.name.localeCompare(k.name,"ar");case"responseTime":return x.isOnline===k.isOnline?0:x.isOnline?-1:1;default:return 0}}),o(g)},[i,l,c,f]);const _=g=>{n(g)},p=g=>{r(g)},y=i.filter(g=>g.isOnline).length;return m?w.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-orange-50 relative overflow-hidden",dir:"rtl",children:[w.jsx("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:w.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[800px] h-[800px] bg-gradient-radial from-orange-200/40 via-blue-200/30 to-purple-200/20 rounded-full blur-3xl opacity-60"})}),w.jsx("div",{className:"relative pt-32 pb-12",children:w.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:w.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:w.jsxs("div",{className:"text-center",children:[w.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto mb-4"}),w.jsx("p",{className:"text-gray-600",children:"  ..."})]})})})})]}):w.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-orange-50 relative overflow-hidden",dir:"rtl",children:[w.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[w.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[800px] h-[800px] bg-gradient-radial from-orange-200/40 via-blue-200/30 to-purple-200/20 rounded-full blur-3xl opacity-60"}),w.jsx("div",{className:"absolute top-20 right-20 w-96 h-96 bg-gradient-to-br from-orange-300/30 to-pink-300/20 rounded-full blur-3xl opacity-50"}),w.jsx("div",{className:"absolute bottom-20 left-20 w-80 h-80 bg-gradient-to-tr from-blue-300/30 to-purple-300/20 rounded-full blur-3xl opacity-40"})]}),w.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 backdrop-blur-2xl bg-white/10 border-b border-white/10",children:w.jsx("div",{className:"max-w-7xl mx-auto px-6 lg:px-8",children:w.jsxs("div",{className:"flex items-center justify-between h-20",children:[w.jsxs("div",{className:"flex items-center space-x-4 space-x-reverse",children:[w.jsxs("button",{onClick:e,className:"flex items-center space-x-2 space-x-reverse text-orange-600 hover:text-orange-700 transition-colors duration-200 group backdrop-blur-xl bg-white/20 px-4 py-2 rounded-full border border-white/20","aria-label":"  ",children:[w.jsx(C1,{className:"h-4 w-4 group-hover:transform group-hover:translate-x-1 transition-transform duration-200"}),w.jsx("span",{className:"font-medium",children:""})]}),w.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[w.jsx("img",{src:"/mandaleen-logo.png",alt:"",className:"h-8 w-8"}),w.jsx("h1",{className:"text-2xl font-semibold text-black tracking-normal",children:""})]})]}),w.jsx("div",{className:"flex-1 max-w-md mx-8",children:w.jsxs("div",{className:"relative group",children:[w.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/20 via-white/25 to-white/20 rounded-full backdrop-blur-3xl border border-white/20 shadow-2xl shadow-orange-500/10 group-hover:shadow-orange-500/20 transition-all duration-500"}),w.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-orange-50/30 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),w.jsx("div",{className:"absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-none z-10",children:w.jsx(Qo,{className:"h-4 w-4 text-gray-500 group-hover:text-orange-500 transition-colors duration-300"})}),w.jsx("input",{type:"text",value:l,onChange:g=>u(g.target.value),className:"relative w-full pr-10 pl-5 py-3 bg-transparent border-0 rounded-full placeholder-gray-500 text-gray-800 focus:outline-none focus:ring-0 font-medium",placeholder:"  ..."})]})}),w.jsx("div",{className:"flex items-center",children:w.jsxs("button",{className:"group relative overflow-hidden px-5 py-2.5 rounded-full backdrop-blur-xl bg-gradient-to-r from-orange-500/90 to-orange-600/90 hover:from-orange-600 hover:to-orange-700 text-white transition-all duration-300 shadow-xl shadow-orange-500/25 hover:shadow-orange-500/40 border border-orange-400/30",children:[w.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),w.jsxs("div",{className:"relative flex items-center space-x-2 space-x-reverse font-medium",children:[w.jsx(zv,{className:"h-4 w-4"}),w.jsx("span",{children:""})]})]})})]})})}),w.jsx("div",{className:"relative pt-32 pb-12",children:w.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[w.jsx("div",{className:"backdrop-blur-xl bg-white/40 rounded-3xl p-4 border border-white/30 shadow-2xl shadow-black/10 ring-1 ring-white/20 mb-8",children:w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[w.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),w.jsxs("span",{className:"text-sm text-gray-600",children:[y,"  "]})]}),w.jsxs("div",{className:"flex items-center space-x-4 space-x-reverse",children:[w.jsxs("button",{onClick:()=>d(!c),className:`flex items-center space-x-2 space-x-reverse px-4 py-2 rounded-xl font-medium transition-all duration-200 ${c?"bg-green-500 text-white shadow-lg shadow-green-500/25":"bg-white/60 text-gray-700 hover:bg-white/80"}`,children:[w.jsx(N1,{className:"h-4 w-4"}),w.jsx("span",{children:" "})]}),w.jsxs("select",{value:f,onChange:g=>h(g.target.value),className:"px-4 py-2 rounded-xl bg-white/60 text-gray-700 border border-white/30 focus:outline-none focus:ring-2 focus:ring-orange-500/50 focus:bg-white/80 transition-all duration-300",children:[w.jsx("option",{value:"rating",children:"  "}),w.jsx("option",{value:"name",children:"  "}),w.jsx("option",{value:"responseTime",children:"  "})]})]})]})}),w.jsx("div",{className:"mb-6",children:w.jsxs("p",{className:"text-gray-600",children:[" ",s.length,"   ",i.length," "]})}),s.length>0?w.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:s.map(g=>w.jsx(K1,{agent:g,onChat:_,onCall:p},g.id))}):w.jsx("div",{className:"text-center py-12",children:w.jsxs("div",{className:"backdrop-blur-xl bg-white/40 rounded-3xl p-12 border border-white/30 shadow-2xl shadow-black/10 ring-1 ring-white/20",children:[w.jsx(Uv,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),w.jsx("h3",{className:"text-xl font-medium text-gray-900 mb-2",children:"  "}),w.jsx("p",{className:"text-gray-600 mb-6",children:"        "}),w.jsx("button",{onClick:()=>{u(""),d(!1)},className:"px-6 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white rounded-2xl hover:from-orange-600 hover:to-orange-700 transition-all duration-200 shadow-lg shadow-orange-500/25",children:"  "})]})})]})})]})};function X1(t,e){const n={};return(t[t.length-1]===""?[...t,""]:t).join((n.padRight?" ":"")+","+(n.padLeft===!1?"":" ")).trim()}const eE=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,tE=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,nE={};function Dp(t,e){return(nE.jsx?tE:eE).test(t)}const rE=/[ \t\n\f\r]/g;function iE(t){return typeof t=="object"?t.type==="text"?Fp(t.value):!1:Fp(t)}function Fp(t){return t.replace(rE,"")===""}class bs{constructor(e,n,r){this.normal=n,this.property=e,r&&(this.space=r)}}bs.prototype.normal={};bs.prototype.property={};bs.prototype.space=void 0;function Hv(t,e){const n={},r={};for(const i of t)Object.assign(n,i.property),Object.assign(r,i.normal);return new bs(n,r,e)}function sd(t){return t.toLowerCase()}class Et{constructor(e,n){this.attribute=n,this.property=e}}Et.prototype.attribute="";Et.prototype.booleanish=!1;Et.prototype.boolean=!1;Et.prototype.commaOrSpaceSeparated=!1;Et.prototype.commaSeparated=!1;Et.prototype.defined=!1;Et.prototype.mustUseProperty=!1;Et.prototype.number=!1;Et.prototype.overloadedBoolean=!1;Et.prototype.property="";Et.prototype.spaceSeparated=!1;Et.prototype.space=void 0;let aE=0;const re=Xr(),je=Xr(),od=Xr(),P=Xr(),xe=Xr(),Ii=Xr(),kt=Xr();function Xr(){return 2**++aE}const ld=Object.freeze(Object.defineProperty({__proto__:null,boolean:re,booleanish:je,commaOrSpaceSeparated:kt,commaSeparated:Ii,number:P,overloadedBoolean:od,spaceSeparated:xe},Symbol.toStringTag,{value:"Module"})),ku=Object.keys(ld);class Lf extends Et{constructor(e,n,r,i){let a=-1;if(super(e,n),zp(this,"space",i),typeof r=="number")for(;++a<ku.length;){const s=ku[a];zp(this,ku[a],(r&ld[s])===ld[s])}}}Lf.prototype.defined=!0;function zp(t,e,n){n&&(t[e]=n)}function Ki(t){const e={},n={};for(const[r,i]of Object.entries(t.properties)){const a=new Lf(r,t.transform(t.attributes||{},r),i,t.space);t.mustUseProperty&&t.mustUseProperty.includes(r)&&(a.mustUseProperty=!0),e[r]=a,n[sd(r)]=r,n[sd(a.attribute)]=r}return new bs(e,n,t.space)}const Gv=Ki({properties:{ariaActiveDescendant:null,ariaAtomic:je,ariaAutoComplete:null,ariaBusy:je,ariaChecked:je,ariaColCount:P,ariaColIndex:P,ariaColSpan:P,ariaControls:xe,ariaCurrent:null,ariaDescribedBy:xe,ariaDetails:null,ariaDisabled:je,ariaDropEffect:xe,ariaErrorMessage:null,ariaExpanded:je,ariaFlowTo:xe,ariaGrabbed:je,ariaHasPopup:null,ariaHidden:je,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:xe,ariaLevel:P,ariaLive:null,ariaModal:je,ariaMultiLine:je,ariaMultiSelectable:je,ariaOrientation:null,ariaOwns:xe,ariaPlaceholder:null,ariaPosInSet:P,ariaPressed:je,ariaReadOnly:je,ariaRelevant:null,ariaRequired:je,ariaRoleDescription:xe,ariaRowCount:P,ariaRowIndex:P,ariaRowSpan:P,ariaSelected:je,ariaSetSize:P,ariaSort:null,ariaValueMax:P,ariaValueMin:P,ariaValueNow:P,ariaValueText:null,role:null},transform(t,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()}});function Vv(t,e){return e in t?t[e]:e}function Wv(t,e){return Vv(t,e.toLowerCase())}const sE=Ki({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Ii,acceptCharset:xe,accessKey:xe,action:null,allow:null,allowFullScreen:re,allowPaymentRequest:re,allowUserMedia:re,alt:null,as:null,async:re,autoCapitalize:null,autoComplete:xe,autoFocus:re,autoPlay:re,blocking:xe,capture:null,charSet:null,checked:re,cite:null,className:xe,cols:P,colSpan:null,content:null,contentEditable:je,controls:re,controlsList:xe,coords:P|Ii,crossOrigin:null,data:null,dateTime:null,decoding:null,default:re,defer:re,dir:null,dirName:null,disabled:re,download:od,draggable:je,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:re,formTarget:null,headers:xe,height:P,hidden:od,high:P,href:null,hrefLang:null,htmlFor:xe,httpEquiv:xe,id:null,imageSizes:null,imageSrcSet:null,inert:re,inputMode:null,integrity:null,is:null,isMap:re,itemId:null,itemProp:xe,itemRef:xe,itemScope:re,itemType:xe,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:re,low:P,manifest:null,max:null,maxLength:P,media:null,method:null,min:null,minLength:P,multiple:re,muted:re,name:null,nonce:null,noModule:re,noValidate:re,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:re,optimum:P,pattern:null,ping:xe,placeholder:null,playsInline:re,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:re,referrerPolicy:null,rel:xe,required:re,reversed:re,rows:P,rowSpan:P,sandbox:xe,scope:null,scoped:re,seamless:re,selected:re,shadowRootClonable:re,shadowRootDelegatesFocus:re,shadowRootMode:null,shape:null,size:P,sizes:null,slot:null,span:P,spellCheck:je,src:null,srcDoc:null,srcLang:null,srcSet:null,start:P,step:null,style:null,tabIndex:P,target:null,title:null,translate:null,type:null,typeMustMatch:re,useMap:null,value:je,width:P,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:xe,axis:null,background:null,bgColor:null,border:P,borderColor:null,bottomMargin:P,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:re,declare:re,event:null,face:null,frame:null,frameBorder:null,hSpace:P,leftMargin:P,link:null,longDesc:null,lowSrc:null,marginHeight:P,marginWidth:P,noResize:re,noHref:re,noShade:re,noWrap:re,object:null,profile:null,prompt:null,rev:null,rightMargin:P,rules:null,scheme:null,scrolling:je,standby:null,summary:null,text:null,topMargin:P,valueType:null,version:null,vAlign:null,vLink:null,vSpace:P,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:re,disableRemotePlayback:re,prefix:null,property:null,results:P,security:null,unselectable:null},space:"html",transform:Wv}),oE=Ki({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:kt,accentHeight:P,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:P,amplitude:P,arabicForm:null,ascent:P,attributeName:null,attributeType:null,azimuth:P,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:P,by:null,calcMode:null,capHeight:P,className:xe,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:P,diffuseConstant:P,direction:null,display:null,dur:null,divisor:P,dominantBaseline:null,download:re,dx:null,dy:null,edgeMode:null,editable:null,elevation:P,enableBackground:null,end:null,event:null,exponent:P,externalResourcesRequired:null,fill:null,fillOpacity:P,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Ii,g2:Ii,glyphName:Ii,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:P,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:P,horizOriginX:P,horizOriginY:P,id:null,ideographic:P,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:P,k:P,k1:P,k2:P,k3:P,k4:P,kernelMatrix:kt,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:P,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:P,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:P,overlineThickness:P,paintOrder:null,panose1:null,path:null,pathLength:P,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:xe,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:P,pointsAtY:P,pointsAtZ:P,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:kt,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:kt,rev:kt,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:kt,requiredFeatures:kt,requiredFonts:kt,requiredFormats:kt,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:P,specularExponent:P,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:P,strikethroughThickness:P,string:null,stroke:null,strokeDashArray:kt,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:P,strokeOpacity:P,strokeWidth:null,style:null,surfaceScale:P,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:kt,tabIndex:P,tableValues:null,target:null,targetX:P,targetY:P,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:kt,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:P,underlineThickness:P,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:P,values:null,vAlphabetic:P,vMathematical:P,vectorEffect:null,vHanging:P,vIdeographic:P,version:null,vertAdvY:P,vertOriginX:P,vertOriginY:P,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:P,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:Vv}),Zv=Ki({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(t,e){return"xlink:"+e.slice(5).toLowerCase()}}),qv=Ki({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:Wv}),Kv=Ki({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(t,e){return"xml:"+e.slice(3).toLowerCase()}}),lE={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},uE=/[A-Z]/g,Up=/-[a-z]/g,cE=/^data[-\w.:]+$/i;function dE(t,e){const n=sd(e);let r=e,i=Et;if(n in t.normal)return t.property[t.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&cE.test(e)){if(e.charAt(4)==="-"){const a=e.slice(5).replace(Up,hE);r="data"+a.charAt(0).toUpperCase()+a.slice(1)}else{const a=e.slice(4);if(!Up.test(a)){let s=a.replace(uE,fE);s.charAt(0)!=="-"&&(s="-"+s),e="data"+s}}i=Lf}return new i(r,e)}function fE(t){return"-"+t.toLowerCase()}function hE(t){return t.charAt(1).toUpperCase()}const pE=Hv([Gv,sE,Zv,qv,Kv],"html"),$f=Hv([Gv,oE,Zv,qv,Kv],"svg");function mE(t){return t.join(" ").trim()}var Mf={},Bp=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,gE=/\n/g,yE=/^\s*/,vE=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,wE=/^:\s*/,_E=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,bE=/^[;\s]*/,xE=/^\s+|\s+$/g,EE=`
`,Hp="/",Gp="*",Pr="",SE="comment",kE="declaration",CE=function(t,e){if(typeof t!="string")throw new TypeError("First argument must be a string");if(!t)return[];e=e||{};var n=1,r=1;function i(m){var v=m.match(gE);v&&(n+=v.length);var _=m.lastIndexOf(EE);r=~_?m.length-_:r+m.length}function a(){var m={line:n,column:r};return function(v){return v.position=new s(m),u(),v}}function s(m){this.start=m,this.end={line:n,column:r},this.source=e.source}s.prototype.content=t;function o(m){var v=new Error(e.source+":"+n+":"+r+": "+m);if(v.reason=m,v.filename=e.source,v.line=n,v.column=r,v.source=t,!e.silent)throw v}function l(m){var v=m.exec(t);if(v){var _=v[0];return i(_),t=t.slice(_.length),v}}function u(){l(yE)}function c(m){var v;for(m=m||[];v=d();)v!==!1&&m.push(v);return m}function d(){var m=a();if(!(Hp!=t.charAt(0)||Gp!=t.charAt(1))){for(var v=2;Pr!=t.charAt(v)&&(Gp!=t.charAt(v)||Hp!=t.charAt(v+1));)++v;if(v+=2,Pr===t.charAt(v-1))return o("End of comment missing");var _=t.slice(2,v-2);return r+=2,i(_),t=t.slice(v),r+=2,m({type:SE,comment:_})}}function f(){var m=a(),v=l(vE);if(v){if(d(),!l(wE))return o("property missing ':'");var _=l(_E),p=m({type:kE,property:Vp(v[0].replace(Bp,Pr)),value:_?Vp(_[0].replace(Bp,Pr)):Pr});return l(bE),p}}function h(){var m=[];c(m);for(var v;v=f();)v!==!1&&(m.push(v),c(m));return m}return u(),h()};function Vp(t){return t?t.replace(xE,Pr):Pr}var TE=To&&To.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Mf,"__esModule",{value:!0});Mf.default=NE;var OE=TE(CE);function NE(t,e){var n=null;if(!t||typeof t!="string")return n;var r=(0,OE.default)(t),i=typeof e=="function";return r.forEach(function(a){if(a.type==="declaration"){var s=a.property,o=a.value;i?e(s,o,a):o&&(n=n||{},n[s]=o)}}),n}var Pl={};Object.defineProperty(Pl,"__esModule",{value:!0});Pl.camelCase=void 0;var IE=/^--[a-zA-Z0-9_-]+$/,AE=/-([a-z])/g,RE=/^[^-]+$/,PE=/^-(webkit|moz|ms|o|khtml)-/,jE=/^-(ms)-/,LE=function(t){return!t||RE.test(t)||IE.test(t)},$E=function(t,e){return e.toUpperCase()},Wp=function(t,e){return"".concat(e,"-")},ME=function(t,e){return e===void 0&&(e={}),LE(t)?t:(t=t.toLowerCase(),e.reactCompat?t=t.replace(jE,Wp):t=t.replace(PE,Wp),t.replace(AE,$E))};Pl.camelCase=ME;var DE=To&&To.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},FE=DE(Mf),zE=Pl;function ud(t,e){var n={};return!t||typeof t!="string"||(0,FE.default)(t,function(r,i){r&&i&&(n[(0,zE.camelCase)(r,e)]=i)}),n}ud.default=ud;var UE=ud;const BE=ms(UE),Jv=Yv("end"),Df=Yv("start");function Yv(t){return e;function e(n){const r=n&&n.position&&n.position[t]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function HE(t){const e=Df(t),n=Jv(t);if(e&&n)return{start:e,end:n}}function Ra(t){return!t||typeof t!="object"?"":"position"in t||"type"in t?Zp(t.position):"start"in t||"end"in t?Zp(t):"line"in t||"column"in t?cd(t):""}function cd(t){return qp(t&&t.line)+":"+qp(t&&t.column)}function Zp(t){return cd(t&&t.start)+"-"+cd(t&&t.end)}function qp(t){return t&&typeof t=="number"?t:1}class it extends Error{constructor(e,n,r){super(),typeof n=="string"&&(r=n,n=void 0);let i="",a={},s=!1;if(n&&("line"in n&&"column"in n?a={place:n}:"start"in n&&"end"in n?a={place:n}:"type"in n?a={ancestors:[n],place:n.position}:a={...n}),typeof e=="string"?i=e:!a.cause&&e&&(s=!0,i=e.message,a.cause=e),!a.ruleId&&!a.source&&typeof r=="string"){const l=r.indexOf(":");l===-1?a.ruleId=r:(a.source=r.slice(0,l),a.ruleId=r.slice(l+1))}if(!a.place&&a.ancestors&&a.ancestors){const l=a.ancestors[a.ancestors.length-1];l&&(a.place=l.position)}const o=a.place&&"start"in a.place?a.place.start:a.place;this.ancestors=a.ancestors||void 0,this.cause=a.cause||void 0,this.column=o?o.column:void 0,this.fatal=void 0,this.file,this.message=i,this.line=o?o.line:void 0,this.name=Ra(a.place)||"1:1",this.place=a.place||void 0,this.reason=this.message,this.ruleId=a.ruleId||void 0,this.source=a.source||void 0,this.stack=s&&a.cause&&typeof a.cause.stack=="string"?a.cause.stack:"",this.actual,this.expected,this.note,this.url}}it.prototype.file="";it.prototype.name="";it.prototype.reason="";it.prototype.message="";it.prototype.stack="";it.prototype.column=void 0;it.prototype.line=void 0;it.prototype.ancestors=void 0;it.prototype.cause=void 0;it.prototype.fatal=void 0;it.prototype.place=void 0;it.prototype.ruleId=void 0;it.prototype.source=void 0;const Ff={}.hasOwnProperty,GE=new Map,VE=/[A-Z]/g,WE=new Set(["table","tbody","thead","tfoot","tr"]),ZE=new Set(["td","th"]),Qv="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function qE(t,e){if(!e||e.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const n=e.filePath||void 0;let r;if(e.development){if(typeof e.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=nS(n,e.jsxDEV)}else{if(typeof e.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof e.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=tS(n,e.jsx,e.jsxs)}const i={Fragment:e.Fragment,ancestors:[],components:e.components||{},create:r,elementAttributeNameCase:e.elementAttributeNameCase||"react",evaluater:e.createEvaluater?e.createEvaluater():void 0,filePath:n,ignoreInvalidStyle:e.ignoreInvalidStyle||!1,passKeys:e.passKeys!==!1,passNode:e.passNode||!1,schema:e.space==="svg"?$f:pE,stylePropertyNameCase:e.stylePropertyNameCase||"dom",tableCellAlignToStyle:e.tableCellAlignToStyle!==!1},a=Xv(i,t,void 0);return a&&typeof a!="string"?a:i.create(t,i.Fragment,{children:a||void 0},void 0)}function Xv(t,e,n){if(e.type==="element")return KE(t,e,n);if(e.type==="mdxFlowExpression"||e.type==="mdxTextExpression")return JE(t,e);if(e.type==="mdxJsxFlowElement"||e.type==="mdxJsxTextElement")return QE(t,e,n);if(e.type==="mdxjsEsm")return YE(t,e);if(e.type==="root")return XE(t,e,n);if(e.type==="text")return eS(t,e)}function KE(t,e,n){const r=t.schema;let i=r;e.tagName.toLowerCase()==="svg"&&r.space==="html"&&(i=$f,t.schema=i),t.ancestors.push(e);const a=tw(t,e.tagName,!1),s=rS(t,e);let o=Uf(t,e);return WE.has(e.tagName)&&(o=o.filter(function(l){return typeof l=="string"?!iE(l):!0})),ew(t,s,a,e),zf(s,o),t.ancestors.pop(),t.schema=r,t.create(e,a,s,n)}function JE(t,e){if(e.data&&e.data.estree&&t.evaluater){const r=e.data.estree.body[0];return r.type,t.evaluater.evaluateExpression(r.expression)}as(t,e.position)}function YE(t,e){if(e.data&&e.data.estree&&t.evaluater)return t.evaluater.evaluateProgram(e.data.estree);as(t,e.position)}function QE(t,e,n){const r=t.schema;let i=r;e.name==="svg"&&r.space==="html"&&(i=$f,t.schema=i),t.ancestors.push(e);const a=e.name===null?t.Fragment:tw(t,e.name,!0),s=iS(t,e),o=Uf(t,e);return ew(t,s,a,e),zf(s,o),t.ancestors.pop(),t.schema=r,t.create(e,a,s,n)}function XE(t,e,n){const r={};return zf(r,Uf(t,e)),t.create(e,t.Fragment,r,n)}function eS(t,e){return e.value}function ew(t,e,n,r){typeof n!="string"&&n!==t.Fragment&&t.passNode&&(e.node=r)}function zf(t,e){if(e.length>0){const n=e.length>1?e:e[0];n&&(t.children=n)}}function tS(t,e,n){return r;function r(i,a,s,o){const u=Array.isArray(s.children)?n:e;return o?u(a,s,o):u(a,s)}}function nS(t,e){return n;function n(r,i,a,s){const o=Array.isArray(a.children),l=Df(r);return e(i,a,s,o,{columnNumber:l?l.column-1:void 0,fileName:t,lineNumber:l?l.line:void 0},void 0)}}function rS(t,e){const n={};let r,i;for(i in e.properties)if(i!=="children"&&Ff.call(e.properties,i)){const a=aS(t,i,e.properties[i]);if(a){const[s,o]=a;t.tableCellAlignToStyle&&s==="align"&&typeof o=="string"&&ZE.has(e.tagName)?r=o:n[s]=o}}if(r){const a=n.style||(n.style={});a[t.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return n}function iS(t,e){const n={};for(const r of e.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&t.evaluater){const a=r.data.estree.body[0];a.type;const s=a.expression;s.type;const o=s.properties[0];o.type,Object.assign(n,t.evaluater.evaluateExpression(o.argument))}else as(t,e.position);else{const i=r.name;let a;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&t.evaluater){const o=r.value.data.estree.body[0];o.type,a=t.evaluater.evaluateExpression(o.expression)}else as(t,e.position);else a=r.value===null?!0:r.value;n[i]=a}return n}function Uf(t,e){const n=[];let r=-1;const i=t.passKeys?new Map:GE;for(;++r<e.children.length;){const a=e.children[r];let s;if(t.passKeys){const l=a.type==="element"?a.tagName:a.type==="mdxJsxFlowElement"||a.type==="mdxJsxTextElement"?a.name:void 0;if(l){const u=i.get(l)||0;s=l+"-"+u,i.set(l,u+1)}}const o=Xv(t,a,s);o!==void 0&&n.push(o)}return n}function aS(t,e,n){const r=dE(t.schema,e);if(!(n==null||typeof n=="number"&&Number.isNaN(n))){if(Array.isArray(n)&&(n=r.commaSeparated?X1(n):mE(n)),r.property==="style"){let i=typeof n=="object"?n:sS(t,String(n));return t.stylePropertyNameCase==="css"&&(i=oS(i)),["style",i]}return[t.elementAttributeNameCase==="react"&&r.space?lE[r.property]||r.property:r.attribute,n]}}function sS(t,e){try{return BE(e,{reactCompat:!0})}catch(n){if(t.ignoreInvalidStyle)return{};const r=n,i=new it("Cannot parse `style` attribute",{ancestors:t.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw i.file=t.filePath||void 0,i.url=Qv+"#cannot-parse-style-attribute",i}}function tw(t,e,n){let r;if(!n)r={type:"Literal",value:e};else if(e.includes(".")){const i=e.split(".");let a=-1,s;for(;++a<i.length;){const o=Dp(i[a])?{type:"Identifier",name:i[a]}:{type:"Literal",value:i[a]};s=s?{type:"MemberExpression",object:s,property:o,computed:!!(a&&o.type==="Literal"),optional:!1}:o}r=s}else r=Dp(e)&&!/^[a-z]/.test(e)?{type:"Identifier",name:e}:{type:"Literal",value:e};if(r.type==="Literal"){const i=r.value;return Ff.call(t.components,i)?t.components[i]:i}if(t.evaluater)return t.evaluater.evaluateExpression(r);as(t)}function as(t,e){const n=new it("Cannot handle MDX estrees without `createEvaluater`",{ancestors:t.ancestors,place:e,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=t.filePath||void 0,n.url=Qv+"#cannot-handle-mdx-estrees-without-createevaluater",n}function oS(t){const e={};let n;for(n in t)Ff.call(t,n)&&(e[lS(n)]=t[n]);return e}function lS(t){let e=t.replace(VE,uS);return e.slice(0,3)==="ms-"&&(e="-"+e),e}function uS(t){return"-"+t.toLowerCase()}const Cu={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},cS={};function dS(t,e){const n=cS,r=typeof n.includeImageAlt=="boolean"?n.includeImageAlt:!0,i=typeof n.includeHtml=="boolean"?n.includeHtml:!0;return nw(t,r,i)}function nw(t,e,n){if(fS(t)){if("value"in t)return t.type==="html"&&!n?"":t.value;if(e&&"alt"in t&&t.alt)return t.alt;if("children"in t)return Kp(t.children,e,n)}return Array.isArray(t)?Kp(t,e,n):""}function Kp(t,e,n){const r=[];let i=-1;for(;++i<t.length;)r[i]=nw(t[i],e,n);return r.join("")}function fS(t){return!!(t&&typeof t=="object")}const Jp=document.createElement("i");function Bf(t){const e="&"+t+";";Jp.innerHTML=e;const n=Jp.textContent;return n.charCodeAt(n.length-1)===59&&t!=="semi"||n===e?!1:n}function On(t,e,n,r){const i=t.length;let a=0,s;if(e<0?e=-e>i?0:i+e:e=e>i?i:e,n=n>0?n:0,r.length<1e4)s=Array.from(r),s.unshift(e,n),t.splice(...s);else for(n&&t.splice(e,n);a<r.length;)s=r.slice(a,a+1e4),s.unshift(e,0),t.splice(...s),a+=1e4,e+=1e4}function Ut(t,e){return t.length>0?(On(t,t.length,0,e),t):e}const Yp={}.hasOwnProperty;function hS(t){const e={};let n=-1;for(;++n<t.length;)pS(e,t[n]);return e}function pS(t,e){let n;for(n in e){const i=(Yp.call(t,n)?t[n]:void 0)||(t[n]={}),a=e[n];let s;if(a)for(s in a){Yp.call(i,s)||(i[s]=[]);const o=a[s];mS(i[s],Array.isArray(o)?o:o?[o]:[])}}}function mS(t,e){let n=-1;const r=[];for(;++n<e.length;)(e[n].add==="after"?t:r).push(e[n]);On(t,0,0,r)}function rw(t,e){const n=Number.parseInt(t,e);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"":String.fromCodePoint(n)}function Ai(t){return t.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const xn=Nr(/[A-Za-z]/),Nt=Nr(/[\dA-Za-z]/),gS=Nr(/[#-'*+\--9=?A-Z^-~]/);function dd(t){return t!==null&&(t<32||t===127)}const fd=Nr(/\d/),yS=Nr(/[\dA-Fa-f]/),vS=Nr(/[!-/:-@[-`{-~]/);function Q(t){return t!==null&&t<-2}function xt(t){return t!==null&&(t<0||t===32)}function me(t){return t===-2||t===-1||t===32}const wS=Nr(new RegExp("\\p{P}|\\p{S}","u")),_S=Nr(/\s/);function Nr(t){return e;function e(n){return n!==null&&n>-1&&t.test(String.fromCharCode(n))}}function Ji(t){const e=[];let n=-1,r=0,i=0;for(;++n<t.length;){const a=t.charCodeAt(n);let s="";if(a===37&&Nt(t.charCodeAt(n+1))&&Nt(t.charCodeAt(n+2)))i=2;else if(a<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(a))||(s=String.fromCharCode(a));else if(a>55295&&a<57344){const o=t.charCodeAt(n+1);a<56320&&o>56319&&o<57344?(s=String.fromCharCode(a,o),i=1):s=""}else s=String.fromCharCode(a);s&&(e.push(t.slice(r,n),encodeURIComponent(s)),r=n+i+1,s=""),i&&(n+=i,i=0)}return e.join("")+t.slice(r)}function Se(t,e,n,r){const i=r?r-1:Number.POSITIVE_INFINITY;let a=0;return s;function s(l){return me(l)?(t.enter(n),o(l)):e(l)}function o(l){return me(l)&&a++<i?(t.consume(l),o):(t.exit(n),e(l))}}const bS={tokenize:xS};function xS(t){const e=t.attempt(this.parser.constructs.contentInitial,r,i);let n;return e;function r(o){if(o===null){t.consume(o);return}return t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),Se(t,e,"linePrefix")}function i(o){return t.enter("paragraph"),a(o)}function a(o){const l=t.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=l),n=l,s(o)}function s(o){if(o===null){t.exit("chunkText"),t.exit("paragraph"),t.consume(o);return}return Q(o)?(t.consume(o),t.exit("chunkText"),a):(t.consume(o),s)}}const ES={tokenize:SS},Qp={tokenize:kS};function SS(t){const e=this,n=[];let r=0,i,a,s;return o;function o(g){if(r<n.length){const x=n[r];return e.containerState=x[1],t.attempt(x[0].continuation,l,u)(g)}return u(g)}function l(g){if(r++,e.containerState._closeFlow){e.containerState._closeFlow=void 0,i&&y();const x=e.events.length;let k=x,S;for(;k--;)if(e.events[k][0]==="exit"&&e.events[k][1].type==="chunkFlow"){S=e.events[k][1].end;break}p(r);let C=x;for(;C<e.events.length;)e.events[C][1].end={...S},C++;return On(e.events,k+1,0,e.events.slice(x)),e.events.length=C,u(g)}return o(g)}function u(g){if(r===n.length){if(!i)return f(g);if(i.currentConstruct&&i.currentConstruct.concrete)return m(g);e.interrupt=!!(i.currentConstruct&&!i._gfmTableDynamicInterruptHack)}return e.containerState={},t.check(Qp,c,d)(g)}function c(g){return i&&y(),p(r),f(g)}function d(g){return e.parser.lazy[e.now().line]=r!==n.length,s=e.now().offset,m(g)}function f(g){return e.containerState={},t.attempt(Qp,h,m)(g)}function h(g){return r++,n.push([e.currentConstruct,e.containerState]),f(g)}function m(g){if(g===null){i&&y(),p(0),t.consume(g);return}return i=i||e.parser.flow(e.now()),t.enter("chunkFlow",{_tokenizer:i,contentType:"flow",previous:a}),v(g)}function v(g){if(g===null){_(t.exit("chunkFlow"),!0),p(0),t.consume(g);return}return Q(g)?(t.consume(g),_(t.exit("chunkFlow")),r=0,e.interrupt=void 0,o):(t.consume(g),v)}function _(g,x){const k=e.sliceStream(g);if(x&&k.push(null),g.previous=a,a&&(a.next=g),a=g,i.defineSkip(g.start),i.write(k),e.parser.lazy[g.start.line]){let S=i.events.length;for(;S--;)if(i.events[S][1].start.offset<s&&(!i.events[S][1].end||i.events[S][1].end.offset>s))return;const C=e.events.length;let A=C,U,j;for(;A--;)if(e.events[A][0]==="exit"&&e.events[A][1].type==="chunkFlow"){if(U){j=e.events[A][1].end;break}U=!0}for(p(r),S=C;S<e.events.length;)e.events[S][1].end={...j},S++;On(e.events,A+1,0,e.events.slice(C)),e.events.length=S}}function p(g){let x=n.length;for(;x-- >g;){const k=n[x];e.containerState=k[1],k[0].exit.call(e,t)}n.length=g}function y(){i.write([null]),a=void 0,i=void 0,e.containerState._closeFlow=void 0}}function kS(t,e,n){return Se(t,t.attempt(this.parser.constructs.document,e,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Xp(t){if(t===null||xt(t)||_S(t))return 1;if(wS(t))return 2}function Hf(t,e,n){const r=[];let i=-1;for(;++i<t.length;){const a=t[i].resolveAll;a&&!r.includes(a)&&(e=a(e,n),r.push(a))}return e}const hd={name:"attention",resolveAll:CS,tokenize:TS};function CS(t,e){let n=-1,r,i,a,s,o,l,u,c;for(;++n<t.length;)if(t[n][0]==="enter"&&t[n][1].type==="attentionSequence"&&t[n][1]._close){for(r=n;r--;)if(t[r][0]==="exit"&&t[r][1].type==="attentionSequence"&&t[r][1]._open&&e.sliceSerialize(t[r][1]).charCodeAt(0)===e.sliceSerialize(t[n][1]).charCodeAt(0)){if((t[r][1]._close||t[n][1]._open)&&(t[n][1].end.offset-t[n][1].start.offset)%3&&!((t[r][1].end.offset-t[r][1].start.offset+t[n][1].end.offset-t[n][1].start.offset)%3))continue;l=t[r][1].end.offset-t[r][1].start.offset>1&&t[n][1].end.offset-t[n][1].start.offset>1?2:1;const d={...t[r][1].end},f={...t[n][1].start};em(d,-l),em(f,l),s={type:l>1?"strongSequence":"emphasisSequence",start:d,end:{...t[r][1].end}},o={type:l>1?"strongSequence":"emphasisSequence",start:{...t[n][1].start},end:f},a={type:l>1?"strongText":"emphasisText",start:{...t[r][1].end},end:{...t[n][1].start}},i={type:l>1?"strong":"emphasis",start:{...s.start},end:{...o.end}},t[r][1].end={...s.start},t[n][1].start={...o.end},u=[],t[r][1].end.offset-t[r][1].start.offset&&(u=Ut(u,[["enter",t[r][1],e],["exit",t[r][1],e]])),u=Ut(u,[["enter",i,e],["enter",s,e],["exit",s,e],["enter",a,e]]),u=Ut(u,Hf(e.parser.constructs.insideSpan.null,t.slice(r+1,n),e)),u=Ut(u,[["exit",a,e],["enter",o,e],["exit",o,e],["exit",i,e]]),t[n][1].end.offset-t[n][1].start.offset?(c=2,u=Ut(u,[["enter",t[n][1],e],["exit",t[n][1],e]])):c=0,On(t,r-1,n-r+3,u),n=r+u.length-c-2;break}}for(n=-1;++n<t.length;)t[n][1].type==="attentionSequence"&&(t[n][1].type="data");return t}function TS(t,e){const n=this.parser.constructs.attentionMarkers.null,r=this.previous,i=Xp(r);let a;return s;function s(l){return a=l,t.enter("attentionSequence"),o(l)}function o(l){if(l===a)return t.consume(l),o;const u=t.exit("attentionSequence"),c=Xp(l),d=!c||c===2&&i||n.includes(l),f=!i||i===2&&c||n.includes(r);return u._open=!!(a===42?d:d&&(i||!f)),u._close=!!(a===42?f:f&&(c||!d)),e(l)}}function em(t,e){t.column+=e,t.offset+=e,t._bufferIndex+=e}const OS={name:"autolink",tokenize:NS};function NS(t,e,n){let r=0;return i;function i(h){return t.enter("autolink"),t.enter("autolinkMarker"),t.consume(h),t.exit("autolinkMarker"),t.enter("autolinkProtocol"),a}function a(h){return xn(h)?(t.consume(h),s):h===64?n(h):u(h)}function s(h){return h===43||h===45||h===46||Nt(h)?(r=1,o(h)):u(h)}function o(h){return h===58?(t.consume(h),r=0,l):(h===43||h===45||h===46||Nt(h))&&r++<32?(t.consume(h),o):(r=0,u(h))}function l(h){return h===62?(t.exit("autolinkProtocol"),t.enter("autolinkMarker"),t.consume(h),t.exit("autolinkMarker"),t.exit("autolink"),e):h===null||h===32||h===60||dd(h)?n(h):(t.consume(h),l)}function u(h){return h===64?(t.consume(h),c):gS(h)?(t.consume(h),u):n(h)}function c(h){return Nt(h)?d(h):n(h)}function d(h){return h===46?(t.consume(h),r=0,c):h===62?(t.exit("autolinkProtocol").type="autolinkEmail",t.enter("autolinkMarker"),t.consume(h),t.exit("autolinkMarker"),t.exit("autolink"),e):f(h)}function f(h){if((h===45||Nt(h))&&r++<63){const m=h===45?f:d;return t.consume(h),m}return n(h)}}const jl={partial:!0,tokenize:IS};function IS(t,e,n){return r;function r(a){return me(a)?Se(t,i,"linePrefix")(a):i(a)}function i(a){return a===null||Q(a)?e(a):n(a)}}const iw={continuation:{tokenize:RS},exit:PS,name:"blockQuote",tokenize:AS};function AS(t,e,n){const r=this;return i;function i(s){if(s===62){const o=r.containerState;return o.open||(t.enter("blockQuote",{_container:!0}),o.open=!0),t.enter("blockQuotePrefix"),t.enter("blockQuoteMarker"),t.consume(s),t.exit("blockQuoteMarker"),a}return n(s)}function a(s){return me(s)?(t.enter("blockQuotePrefixWhitespace"),t.consume(s),t.exit("blockQuotePrefixWhitespace"),t.exit("blockQuotePrefix"),e):(t.exit("blockQuotePrefix"),e(s))}}function RS(t,e,n){const r=this;return i;function i(s){return me(s)?Se(t,a,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(s):a(s)}function a(s){return t.attempt(iw,e,n)(s)}}function PS(t){t.exit("blockQuote")}const aw={name:"characterEscape",tokenize:jS};function jS(t,e,n){return r;function r(a){return t.enter("characterEscape"),t.enter("escapeMarker"),t.consume(a),t.exit("escapeMarker"),i}function i(a){return vS(a)?(t.enter("characterEscapeValue"),t.consume(a),t.exit("characterEscapeValue"),t.exit("characterEscape"),e):n(a)}}const sw={name:"characterReference",tokenize:LS};function LS(t,e,n){const r=this;let i=0,a,s;return o;function o(d){return t.enter("characterReference"),t.enter("characterReferenceMarker"),t.consume(d),t.exit("characterReferenceMarker"),l}function l(d){return d===35?(t.enter("characterReferenceMarkerNumeric"),t.consume(d),t.exit("characterReferenceMarkerNumeric"),u):(t.enter("characterReferenceValue"),a=31,s=Nt,c(d))}function u(d){return d===88||d===120?(t.enter("characterReferenceMarkerHexadecimal"),t.consume(d),t.exit("characterReferenceMarkerHexadecimal"),t.enter("characterReferenceValue"),a=6,s=yS,c):(t.enter("characterReferenceValue"),a=7,s=fd,c(d))}function c(d){if(d===59&&i){const f=t.exit("characterReferenceValue");return s===Nt&&!Bf(r.sliceSerialize(f))?n(d):(t.enter("characterReferenceMarker"),t.consume(d),t.exit("characterReferenceMarker"),t.exit("characterReference"),e)}return s(d)&&i++<a?(t.consume(d),c):n(d)}}const tm={partial:!0,tokenize:MS},nm={concrete:!0,name:"codeFenced",tokenize:$S};function $S(t,e,n){const r=this,i={partial:!0,tokenize:k};let a=0,s=0,o;return l;function l(S){return u(S)}function u(S){const C=r.events[r.events.length-1];return a=C&&C[1].type==="linePrefix"?C[2].sliceSerialize(C[1],!0).length:0,o=S,t.enter("codeFenced"),t.enter("codeFencedFence"),t.enter("codeFencedFenceSequence"),c(S)}function c(S){return S===o?(s++,t.consume(S),c):s<3?n(S):(t.exit("codeFencedFenceSequence"),me(S)?Se(t,d,"whitespace")(S):d(S))}function d(S){return S===null||Q(S)?(t.exit("codeFencedFence"),r.interrupt?e(S):t.check(tm,v,x)(S)):(t.enter("codeFencedFenceInfo"),t.enter("chunkString",{contentType:"string"}),f(S))}function f(S){return S===null||Q(S)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),d(S)):me(S)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),Se(t,h,"whitespace")(S)):S===96&&S===o?n(S):(t.consume(S),f)}function h(S){return S===null||Q(S)?d(S):(t.enter("codeFencedFenceMeta"),t.enter("chunkString",{contentType:"string"}),m(S))}function m(S){return S===null||Q(S)?(t.exit("chunkString"),t.exit("codeFencedFenceMeta"),d(S)):S===96&&S===o?n(S):(t.consume(S),m)}function v(S){return t.attempt(i,x,_)(S)}function _(S){return t.enter("lineEnding"),t.consume(S),t.exit("lineEnding"),p}function p(S){return a>0&&me(S)?Se(t,y,"linePrefix",a+1)(S):y(S)}function y(S){return S===null||Q(S)?t.check(tm,v,x)(S):(t.enter("codeFlowValue"),g(S))}function g(S){return S===null||Q(S)?(t.exit("codeFlowValue"),y(S)):(t.consume(S),g)}function x(S){return t.exit("codeFenced"),e(S)}function k(S,C,A){let U=0;return j;function j(N){return S.enter("lineEnding"),S.consume(N),S.exit("lineEnding"),B}function B(N){return S.enter("codeFencedFence"),me(N)?Se(S,Z,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(N):Z(N)}function Z(N){return N===o?(S.enter("codeFencedFenceSequence"),le(N)):A(N)}function le(N){return N===o?(U++,S.consume(N),le):U>=s?(S.exit("codeFencedFenceSequence"),me(N)?Se(S,L,"whitespace")(N):L(N)):A(N)}function L(N){return N===null||Q(N)?(S.exit("codeFencedFence"),C(N)):A(N)}}}function MS(t,e,n){const r=this;return i;function i(s){return s===null?n(s):(t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),a)}function a(s){return r.parser.lazy[r.now().line]?n(s):e(s)}}const Tu={name:"codeIndented",tokenize:FS},DS={partial:!0,tokenize:zS};function FS(t,e,n){const r=this;return i;function i(u){return t.enter("codeIndented"),Se(t,a,"linePrefix",5)(u)}function a(u){const c=r.events[r.events.length-1];return c&&c[1].type==="linePrefix"&&c[2].sliceSerialize(c[1],!0).length>=4?s(u):n(u)}function s(u){return u===null?l(u):Q(u)?t.attempt(DS,s,l)(u):(t.enter("codeFlowValue"),o(u))}function o(u){return u===null||Q(u)?(t.exit("codeFlowValue"),s(u)):(t.consume(u),o)}function l(u){return t.exit("codeIndented"),e(u)}}function zS(t,e,n){const r=this;return i;function i(s){return r.parser.lazy[r.now().line]?n(s):Q(s)?(t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),i):Se(t,a,"linePrefix",5)(s)}function a(s){const o=r.events[r.events.length-1];return o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?e(s):Q(s)?i(s):n(s)}}const US={name:"codeText",previous:HS,resolve:BS,tokenize:GS};function BS(t){let e=t.length-4,n=3,r,i;if((t[n][1].type==="lineEnding"||t[n][1].type==="space")&&(t[e][1].type==="lineEnding"||t[e][1].type==="space")){for(r=n;++r<e;)if(t[r][1].type==="codeTextData"){t[n][1].type="codeTextPadding",t[e][1].type="codeTextPadding",n+=2,e-=2;break}}for(r=n-1,e++;++r<=e;)i===void 0?r!==e&&t[r][1].type!=="lineEnding"&&(i=r):(r===e||t[r][1].type==="lineEnding")&&(t[i][1].type="codeTextData",r!==i+2&&(t[i][1].end=t[r-1][1].end,t.splice(i+2,r-i-2),e-=r-i-2,r=i+2),i=void 0);return t}function HS(t){return t!==96||this.events[this.events.length-1][1].type==="characterEscape"}function GS(t,e,n){let r=0,i,a;return s;function s(d){return t.enter("codeText"),t.enter("codeTextSequence"),o(d)}function o(d){return d===96?(t.consume(d),r++,o):(t.exit("codeTextSequence"),l(d))}function l(d){return d===null?n(d):d===32?(t.enter("space"),t.consume(d),t.exit("space"),l):d===96?(a=t.enter("codeTextSequence"),i=0,c(d)):Q(d)?(t.enter("lineEnding"),t.consume(d),t.exit("lineEnding"),l):(t.enter("codeTextData"),u(d))}function u(d){return d===null||d===32||d===96||Q(d)?(t.exit("codeTextData"),l(d)):(t.consume(d),u)}function c(d){return d===96?(t.consume(d),i++,c):i===r?(t.exit("codeTextSequence"),t.exit("codeText"),e(d)):(a.type="codeTextData",u(d))}}class VS{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,n){const r=n??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(e,r):e>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(e,n,r){const i=n||0;this.setCursor(Math.trunc(e));const a=this.right.splice(this.right.length-i,Number.POSITIVE_INFINITY);return r&&fa(this.left,r),a.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),fa(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),fa(this.right,e.reverse())}setCursor(e){if(!(e===this.left.length||e>this.left.length&&this.right.length===0||e<0&&this.left.length===0))if(e<this.left.length){const n=this.left.splice(e,Number.POSITIVE_INFINITY);fa(this.right,n.reverse())}else{const n=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);fa(this.left,n.reverse())}}}function fa(t,e){let n=0;if(e.length<1e4)t.push(...e);else for(;n<e.length;)t.push(...e.slice(n,n+1e4)),n+=1e4}function ow(t){const e={};let n=-1,r,i,a,s,o,l,u;const c=new VS(t);for(;++n<c.length;){for(;n in e;)n=e[n];if(r=c.get(n),n&&r[1].type==="chunkFlow"&&c.get(n-1)[1].type==="listItemPrefix"&&(l=r[1]._tokenizer.events,a=0,a<l.length&&l[a][1].type==="lineEndingBlank"&&(a+=2),a<l.length&&l[a][1].type==="content"))for(;++a<l.length&&l[a][1].type!=="content";)l[a][1].type==="chunkText"&&(l[a][1]._isInFirstContentOfListItem=!0,a++);if(r[0]==="enter")r[1].contentType&&(Object.assign(e,WS(c,n)),n=e[n],u=!0);else if(r[1]._container){for(a=n,i=void 0;a--;)if(s=c.get(a),s[1].type==="lineEnding"||s[1].type==="lineEndingBlank")s[0]==="enter"&&(i&&(c.get(i)[1].type="lineEndingBlank"),s[1].type="lineEnding",i=a);else if(!(s[1].type==="linePrefix"||s[1].type==="listItemIndent"))break;i&&(r[1].end={...c.get(i)[1].start},o=c.slice(i,n),o.unshift(r),c.splice(i,n-i+1,o))}}return On(t,0,Number.POSITIVE_INFINITY,c.slice(0)),!u}function WS(t,e){const n=t.get(e)[1],r=t.get(e)[2];let i=e-1;const a=[];let s=n._tokenizer;s||(s=r.parser[n.contentType](n.start),n._contentTypeTextTrailing&&(s._contentTypeTextTrailing=!0));const o=s.events,l=[],u={};let c,d,f=-1,h=n,m=0,v=0;const _=[v];for(;h;){for(;t.get(++i)[1]!==h;);a.push(i),h._tokenizer||(c=r.sliceStream(h),h.next||c.push(null),d&&s.defineSkip(h.start),h._isInFirstContentOfListItem&&(s._gfmTasklistFirstContentOfListItem=!0),s.write(c),h._isInFirstContentOfListItem&&(s._gfmTasklistFirstContentOfListItem=void 0)),d=h,h=h.next}for(h=n;++f<o.length;)o[f][0]==="exit"&&o[f-1][0]==="enter"&&o[f][1].type===o[f-1][1].type&&o[f][1].start.line!==o[f][1].end.line&&(v=f+1,_.push(v),h._tokenizer=void 0,h.previous=void 0,h=h.next);for(s.events=[],h?(h._tokenizer=void 0,h.previous=void 0):_.pop(),f=_.length;f--;){const p=o.slice(_[f],_[f+1]),y=a.pop();l.push([y,y+p.length-1]),t.splice(y,2,p)}for(l.reverse(),f=-1;++f<l.length;)u[m+l[f][0]]=m+l[f][1],m+=l[f][1]-l[f][0]-1;return u}const ZS={resolve:KS,tokenize:JS},qS={partial:!0,tokenize:YS};function KS(t){return ow(t),t}function JS(t,e){let n;return r;function r(o){return t.enter("content"),n=t.enter("chunkContent",{contentType:"content"}),i(o)}function i(o){return o===null?a(o):Q(o)?t.check(qS,s,a)(o):(t.consume(o),i)}function a(o){return t.exit("chunkContent"),t.exit("content"),e(o)}function s(o){return t.consume(o),t.exit("chunkContent"),n.next=t.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,i}}function YS(t,e,n){const r=this;return i;function i(s){return t.exit("chunkContent"),t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),Se(t,a,"linePrefix")}function a(s){if(s===null||Q(s))return n(s);const o=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?e(s):t.interrupt(r.parser.constructs.flow,n,e)(s)}}function lw(t,e,n,r,i,a,s,o,l){const u=l||Number.POSITIVE_INFINITY;let c=0;return d;function d(p){return p===60?(t.enter(r),t.enter(i),t.enter(a),t.consume(p),t.exit(a),f):p===null||p===32||p===41||dd(p)?n(p):(t.enter(r),t.enter(s),t.enter(o),t.enter("chunkString",{contentType:"string"}),v(p))}function f(p){return p===62?(t.enter(a),t.consume(p),t.exit(a),t.exit(i),t.exit(r),e):(t.enter(o),t.enter("chunkString",{contentType:"string"}),h(p))}function h(p){return p===62?(t.exit("chunkString"),t.exit(o),f(p)):p===null||p===60||Q(p)?n(p):(t.consume(p),p===92?m:h)}function m(p){return p===60||p===62||p===92?(t.consume(p),h):h(p)}function v(p){return!c&&(p===null||p===41||xt(p))?(t.exit("chunkString"),t.exit(o),t.exit(s),t.exit(r),e(p)):c<u&&p===40?(t.consume(p),c++,v):p===41?(t.consume(p),c--,v):p===null||p===32||p===40||dd(p)?n(p):(t.consume(p),p===92?_:v)}function _(p){return p===40||p===41||p===92?(t.consume(p),v):v(p)}}function uw(t,e,n,r,i,a){const s=this;let o=0,l;return u;function u(h){return t.enter(r),t.enter(i),t.consume(h),t.exit(i),t.enter(a),c}function c(h){return o>999||h===null||h===91||h===93&&!l||h===94&&!o&&"_hiddenFootnoteSupport"in s.parser.constructs?n(h):h===93?(t.exit(a),t.enter(i),t.consume(h),t.exit(i),t.exit(r),e):Q(h)?(t.enter("lineEnding"),t.consume(h),t.exit("lineEnding"),c):(t.enter("chunkString",{contentType:"string"}),d(h))}function d(h){return h===null||h===91||h===93||Q(h)||o++>999?(t.exit("chunkString"),c(h)):(t.consume(h),l||(l=!me(h)),h===92?f:d)}function f(h){return h===91||h===92||h===93?(t.consume(h),o++,d):d(h)}}function cw(t,e,n,r,i,a){let s;return o;function o(f){return f===34||f===39||f===40?(t.enter(r),t.enter(i),t.consume(f),t.exit(i),s=f===40?41:f,l):n(f)}function l(f){return f===s?(t.enter(i),t.consume(f),t.exit(i),t.exit(r),e):(t.enter(a),u(f))}function u(f){return f===s?(t.exit(a),l(s)):f===null?n(f):Q(f)?(t.enter("lineEnding"),t.consume(f),t.exit("lineEnding"),Se(t,u,"linePrefix")):(t.enter("chunkString",{contentType:"string"}),c(f))}function c(f){return f===s||f===null||Q(f)?(t.exit("chunkString"),u(f)):(t.consume(f),f===92?d:c)}function d(f){return f===s||f===92?(t.consume(f),c):c(f)}}function Pa(t,e){let n;return r;function r(i){return Q(i)?(t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),n=!0,r):me(i)?Se(t,r,n?"linePrefix":"lineSuffix")(i):e(i)}}const QS={name:"definition",tokenize:ek},XS={partial:!0,tokenize:tk};function ek(t,e,n){const r=this;let i;return a;function a(h){return t.enter("definition"),s(h)}function s(h){return uw.call(r,t,o,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(h)}function o(h){return i=Ai(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),h===58?(t.enter("definitionMarker"),t.consume(h),t.exit("definitionMarker"),l):n(h)}function l(h){return xt(h)?Pa(t,u)(h):u(h)}function u(h){return lw(t,c,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(h)}function c(h){return t.attempt(XS,d,d)(h)}function d(h){return me(h)?Se(t,f,"whitespace")(h):f(h)}function f(h){return h===null||Q(h)?(t.exit("definition"),r.parser.defined.push(i),e(h)):n(h)}}function tk(t,e,n){return r;function r(o){return xt(o)?Pa(t,i)(o):n(o)}function i(o){return cw(t,a,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(o)}function a(o){return me(o)?Se(t,s,"whitespace")(o):s(o)}function s(o){return o===null||Q(o)?e(o):n(o)}}const nk={name:"hardBreakEscape",tokenize:rk};function rk(t,e,n){return r;function r(a){return t.enter("hardBreakEscape"),t.consume(a),i}function i(a){return Q(a)?(t.exit("hardBreakEscape"),e(a)):n(a)}}const ik={name:"headingAtx",resolve:ak,tokenize:sk};function ak(t,e){let n=t.length-2,r=3,i,a;return t[r][1].type==="whitespace"&&(r+=2),n-2>r&&t[n][1].type==="whitespace"&&(n-=2),t[n][1].type==="atxHeadingSequence"&&(r===n-1||n-4>r&&t[n-2][1].type==="whitespace")&&(n-=r+1===n?2:4),n>r&&(i={type:"atxHeadingText",start:t[r][1].start,end:t[n][1].end},a={type:"chunkText",start:t[r][1].start,end:t[n][1].end,contentType:"text"},On(t,r,n-r+1,[["enter",i,e],["enter",a,e],["exit",a,e],["exit",i,e]])),t}function sk(t,e,n){let r=0;return i;function i(c){return t.enter("atxHeading"),a(c)}function a(c){return t.enter("atxHeadingSequence"),s(c)}function s(c){return c===35&&r++<6?(t.consume(c),s):c===null||xt(c)?(t.exit("atxHeadingSequence"),o(c)):n(c)}function o(c){return c===35?(t.enter("atxHeadingSequence"),l(c)):c===null||Q(c)?(t.exit("atxHeading"),e(c)):me(c)?Se(t,o,"whitespace")(c):(t.enter("atxHeadingText"),u(c))}function l(c){return c===35?(t.consume(c),l):(t.exit("atxHeadingSequence"),o(c))}function u(c){return c===null||c===35||xt(c)?(t.exit("atxHeadingText"),o(c)):(t.consume(c),u)}}const ok=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],rm=["pre","script","style","textarea"],lk={concrete:!0,name:"htmlFlow",resolveTo:dk,tokenize:fk},uk={partial:!0,tokenize:pk},ck={partial:!0,tokenize:hk};function dk(t){let e=t.length;for(;e--&&!(t[e][0]==="enter"&&t[e][1].type==="htmlFlow"););return e>1&&t[e-2][1].type==="linePrefix"&&(t[e][1].start=t[e-2][1].start,t[e+1][1].start=t[e-2][1].start,t.splice(e-2,2)),t}function fk(t,e,n){const r=this;let i,a,s,o,l;return u;function u(E){return c(E)}function c(E){return t.enter("htmlFlow"),t.enter("htmlFlowData"),t.consume(E),d}function d(E){return E===33?(t.consume(E),f):E===47?(t.consume(E),a=!0,v):E===63?(t.consume(E),i=3,r.interrupt?e:b):xn(E)?(t.consume(E),s=String.fromCharCode(E),_):n(E)}function f(E){return E===45?(t.consume(E),i=2,h):E===91?(t.consume(E),i=5,o=0,m):xn(E)?(t.consume(E),i=4,r.interrupt?e:b):n(E)}function h(E){return E===45?(t.consume(E),r.interrupt?e:b):n(E)}function m(E){const oe="CDATA[";return E===oe.charCodeAt(o++)?(t.consume(E),o===oe.length?r.interrupt?e:Z:m):n(E)}function v(E){return xn(E)?(t.consume(E),s=String.fromCharCode(E),_):n(E)}function _(E){if(E===null||E===47||E===62||xt(E)){const oe=E===47,ue=s.toLowerCase();return!oe&&!a&&rm.includes(ue)?(i=1,r.interrupt?e(E):Z(E)):ok.includes(s.toLowerCase())?(i=6,oe?(t.consume(E),p):r.interrupt?e(E):Z(E)):(i=7,r.interrupt&&!r.parser.lazy[r.now().line]?n(E):a?y(E):g(E))}return E===45||Nt(E)?(t.consume(E),s+=String.fromCharCode(E),_):n(E)}function p(E){return E===62?(t.consume(E),r.interrupt?e:Z):n(E)}function y(E){return me(E)?(t.consume(E),y):j(E)}function g(E){return E===47?(t.consume(E),j):E===58||E===95||xn(E)?(t.consume(E),x):me(E)?(t.consume(E),g):j(E)}function x(E){return E===45||E===46||E===58||E===95||Nt(E)?(t.consume(E),x):k(E)}function k(E){return E===61?(t.consume(E),S):me(E)?(t.consume(E),k):g(E)}function S(E){return E===null||E===60||E===61||E===62||E===96?n(E):E===34||E===39?(t.consume(E),l=E,C):me(E)?(t.consume(E),S):A(E)}function C(E){return E===l?(t.consume(E),l=null,U):E===null||Q(E)?n(E):(t.consume(E),C)}function A(E){return E===null||E===34||E===39||E===47||E===60||E===61||E===62||E===96||xt(E)?k(E):(t.consume(E),A)}function U(E){return E===47||E===62||me(E)?g(E):n(E)}function j(E){return E===62?(t.consume(E),B):n(E)}function B(E){return E===null||Q(E)?Z(E):me(E)?(t.consume(E),B):n(E)}function Z(E){return E===45&&i===2?(t.consume(E),z):E===60&&i===1?(t.consume(E),F):E===62&&i===4?(t.consume(E),W):E===63&&i===3?(t.consume(E),b):E===93&&i===5?(t.consume(E),I):Q(E)&&(i===6||i===7)?(t.exit("htmlFlowData"),t.check(uk,G,le)(E)):E===null||Q(E)?(t.exit("htmlFlowData"),le(E)):(t.consume(E),Z)}function le(E){return t.check(ck,L,G)(E)}function L(E){return t.enter("lineEnding"),t.consume(E),t.exit("lineEnding"),N}function N(E){return E===null||Q(E)?le(E):(t.enter("htmlFlowData"),Z(E))}function z(E){return E===45?(t.consume(E),b):Z(E)}function F(E){return E===47?(t.consume(E),s="",T):Z(E)}function T(E){if(E===62){const oe=s.toLowerCase();return rm.includes(oe)?(t.consume(E),W):Z(E)}return xn(E)&&s.length<8?(t.consume(E),s+=String.fromCharCode(E),T):Z(E)}function I(E){return E===93?(t.consume(E),b):Z(E)}function b(E){return E===62?(t.consume(E),W):E===45&&i===2?(t.consume(E),b):Z(E)}function W(E){return E===null||Q(E)?(t.exit("htmlFlowData"),G(E)):(t.consume(E),W)}function G(E){return t.exit("htmlFlow"),e(E)}}function hk(t,e,n){const r=this;return i;function i(s){return Q(s)?(t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),a):n(s)}function a(s){return r.parser.lazy[r.now().line]?n(s):e(s)}}function pk(t,e,n){return r;function r(i){return t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),t.attempt(jl,e,n)}}const mk={name:"htmlText",tokenize:gk};function gk(t,e,n){const r=this;let i,a,s;return o;function o(b){return t.enter("htmlText"),t.enter("htmlTextData"),t.consume(b),l}function l(b){return b===33?(t.consume(b),u):b===47?(t.consume(b),k):b===63?(t.consume(b),g):xn(b)?(t.consume(b),A):n(b)}function u(b){return b===45?(t.consume(b),c):b===91?(t.consume(b),a=0,m):xn(b)?(t.consume(b),y):n(b)}function c(b){return b===45?(t.consume(b),h):n(b)}function d(b){return b===null?n(b):b===45?(t.consume(b),f):Q(b)?(s=d,F(b)):(t.consume(b),d)}function f(b){return b===45?(t.consume(b),h):d(b)}function h(b){return b===62?z(b):b===45?f(b):d(b)}function m(b){const W="CDATA[";return b===W.charCodeAt(a++)?(t.consume(b),a===W.length?v:m):n(b)}function v(b){return b===null?n(b):b===93?(t.consume(b),_):Q(b)?(s=v,F(b)):(t.consume(b),v)}function _(b){return b===93?(t.consume(b),p):v(b)}function p(b){return b===62?z(b):b===93?(t.consume(b),p):v(b)}function y(b){return b===null||b===62?z(b):Q(b)?(s=y,F(b)):(t.consume(b),y)}function g(b){return b===null?n(b):b===63?(t.consume(b),x):Q(b)?(s=g,F(b)):(t.consume(b),g)}function x(b){return b===62?z(b):g(b)}function k(b){return xn(b)?(t.consume(b),S):n(b)}function S(b){return b===45||Nt(b)?(t.consume(b),S):C(b)}function C(b){return Q(b)?(s=C,F(b)):me(b)?(t.consume(b),C):z(b)}function A(b){return b===45||Nt(b)?(t.consume(b),A):b===47||b===62||xt(b)?U(b):n(b)}function U(b){return b===47?(t.consume(b),z):b===58||b===95||xn(b)?(t.consume(b),j):Q(b)?(s=U,F(b)):me(b)?(t.consume(b),U):z(b)}function j(b){return b===45||b===46||b===58||b===95||Nt(b)?(t.consume(b),j):B(b)}function B(b){return b===61?(t.consume(b),Z):Q(b)?(s=B,F(b)):me(b)?(t.consume(b),B):U(b)}function Z(b){return b===null||b===60||b===61||b===62||b===96?n(b):b===34||b===39?(t.consume(b),i=b,le):Q(b)?(s=Z,F(b)):me(b)?(t.consume(b),Z):(t.consume(b),L)}function le(b){return b===i?(t.consume(b),i=void 0,N):b===null?n(b):Q(b)?(s=le,F(b)):(t.consume(b),le)}function L(b){return b===null||b===34||b===39||b===60||b===61||b===96?n(b):b===47||b===62||xt(b)?U(b):(t.consume(b),L)}function N(b){return b===47||b===62||xt(b)?U(b):n(b)}function z(b){return b===62?(t.consume(b),t.exit("htmlTextData"),t.exit("htmlText"),e):n(b)}function F(b){return t.exit("htmlTextData"),t.enter("lineEnding"),t.consume(b),t.exit("lineEnding"),T}function T(b){return me(b)?Se(t,I,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(b):I(b)}function I(b){return t.enter("htmlTextData"),s(b)}}const Gf={name:"labelEnd",resolveAll:_k,resolveTo:bk,tokenize:xk},yk={tokenize:Ek},vk={tokenize:Sk},wk={tokenize:kk};function _k(t){let e=-1;const n=[];for(;++e<t.length;){const r=t[e][1];if(n.push(t[e]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const i=r.type==="labelImage"?4:2;r.type="data",e+=i}}return t.length!==n.length&&On(t,0,t.length,n),t}function bk(t,e){let n=t.length,r=0,i,a,s,o;for(;n--;)if(i=t[n][1],a){if(i.type==="link"||i.type==="labelLink"&&i._inactive)break;t[n][0]==="enter"&&i.type==="labelLink"&&(i._inactive=!0)}else if(s){if(t[n][0]==="enter"&&(i.type==="labelImage"||i.type==="labelLink")&&!i._balanced&&(a=n,i.type!=="labelLink")){r=2;break}}else i.type==="labelEnd"&&(s=n);const l={type:t[a][1].type==="labelLink"?"link":"image",start:{...t[a][1].start},end:{...t[t.length-1][1].end}},u={type:"label",start:{...t[a][1].start},end:{...t[s][1].end}},c={type:"labelText",start:{...t[a+r+2][1].end},end:{...t[s-2][1].start}};return o=[["enter",l,e],["enter",u,e]],o=Ut(o,t.slice(a+1,a+r+3)),o=Ut(o,[["enter",c,e]]),o=Ut(o,Hf(e.parser.constructs.insideSpan.null,t.slice(a+r+4,s-3),e)),o=Ut(o,[["exit",c,e],t[s-2],t[s-1],["exit",u,e]]),o=Ut(o,t.slice(s+1)),o=Ut(o,[["exit",l,e]]),On(t,a,t.length,o),t}function xk(t,e,n){const r=this;let i=r.events.length,a,s;for(;i--;)if((r.events[i][1].type==="labelImage"||r.events[i][1].type==="labelLink")&&!r.events[i][1]._balanced){a=r.events[i][1];break}return o;function o(f){return a?a._inactive?d(f):(s=r.parser.defined.includes(Ai(r.sliceSerialize({start:a.end,end:r.now()}))),t.enter("labelEnd"),t.enter("labelMarker"),t.consume(f),t.exit("labelMarker"),t.exit("labelEnd"),l):n(f)}function l(f){return f===40?t.attempt(yk,c,s?c:d)(f):f===91?t.attempt(vk,c,s?u:d)(f):s?c(f):d(f)}function u(f){return t.attempt(wk,c,d)(f)}function c(f){return e(f)}function d(f){return a._balanced=!0,n(f)}}function Ek(t,e,n){return r;function r(d){return t.enter("resource"),t.enter("resourceMarker"),t.consume(d),t.exit("resourceMarker"),i}function i(d){return xt(d)?Pa(t,a)(d):a(d)}function a(d){return d===41?c(d):lw(t,s,o,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(d)}function s(d){return xt(d)?Pa(t,l)(d):c(d)}function o(d){return n(d)}function l(d){return d===34||d===39||d===40?cw(t,u,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(d):c(d)}function u(d){return xt(d)?Pa(t,c)(d):c(d)}function c(d){return d===41?(t.enter("resourceMarker"),t.consume(d),t.exit("resourceMarker"),t.exit("resource"),e):n(d)}}function Sk(t,e,n){const r=this;return i;function i(o){return uw.call(r,t,a,s,"reference","referenceMarker","referenceString")(o)}function a(o){return r.parser.defined.includes(Ai(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?e(o):n(o)}function s(o){return n(o)}}function kk(t,e,n){return r;function r(a){return t.enter("reference"),t.enter("referenceMarker"),t.consume(a),t.exit("referenceMarker"),i}function i(a){return a===93?(t.enter("referenceMarker"),t.consume(a),t.exit("referenceMarker"),t.exit("reference"),e):n(a)}}const Ck={name:"labelStartImage",resolveAll:Gf.resolveAll,tokenize:Tk};function Tk(t,e,n){const r=this;return i;function i(o){return t.enter("labelImage"),t.enter("labelImageMarker"),t.consume(o),t.exit("labelImageMarker"),a}function a(o){return o===91?(t.enter("labelMarker"),t.consume(o),t.exit("labelMarker"),t.exit("labelImage"),s):n(o)}function s(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(o):e(o)}}const Ok={name:"labelStartLink",resolveAll:Gf.resolveAll,tokenize:Nk};function Nk(t,e,n){const r=this;return i;function i(s){return t.enter("labelLink"),t.enter("labelMarker"),t.consume(s),t.exit("labelMarker"),t.exit("labelLink"),a}function a(s){return s===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(s):e(s)}}const Ou={name:"lineEnding",tokenize:Ik};function Ik(t,e){return n;function n(r){return t.enter("lineEnding"),t.consume(r),t.exit("lineEnding"),Se(t,e,"linePrefix")}}const Eo={name:"thematicBreak",tokenize:Ak};function Ak(t,e,n){let r=0,i;return a;function a(u){return t.enter("thematicBreak"),s(u)}function s(u){return i=u,o(u)}function o(u){return u===i?(t.enter("thematicBreakSequence"),l(u)):r>=3&&(u===null||Q(u))?(t.exit("thematicBreak"),e(u)):n(u)}function l(u){return u===i?(t.consume(u),r++,l):(t.exit("thematicBreakSequence"),me(u)?Se(t,o,"whitespace")(u):o(u))}}const pt={continuation:{tokenize:Lk},exit:Mk,name:"list",tokenize:jk},Rk={partial:!0,tokenize:Dk},Pk={partial:!0,tokenize:$k};function jk(t,e,n){const r=this,i=r.events[r.events.length-1];let a=i&&i[1].type==="linePrefix"?i[2].sliceSerialize(i[1],!0).length:0,s=0;return o;function o(h){const m=r.containerState.type||(h===42||h===43||h===45?"listUnordered":"listOrdered");if(m==="listUnordered"?!r.containerState.marker||h===r.containerState.marker:fd(h)){if(r.containerState.type||(r.containerState.type=m,t.enter(m,{_container:!0})),m==="listUnordered")return t.enter("listItemPrefix"),h===42||h===45?t.check(Eo,n,u)(h):u(h);if(!r.interrupt||h===49)return t.enter("listItemPrefix"),t.enter("listItemValue"),l(h)}return n(h)}function l(h){return fd(h)&&++s<10?(t.consume(h),l):(!r.interrupt||s<2)&&(r.containerState.marker?h===r.containerState.marker:h===41||h===46)?(t.exit("listItemValue"),u(h)):n(h)}function u(h){return t.enter("listItemMarker"),t.consume(h),t.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||h,t.check(jl,r.interrupt?n:c,t.attempt(Rk,f,d))}function c(h){return r.containerState.initialBlankLine=!0,a++,f(h)}function d(h){return me(h)?(t.enter("listItemPrefixWhitespace"),t.consume(h),t.exit("listItemPrefixWhitespace"),f):n(h)}function f(h){return r.containerState.size=a+r.sliceSerialize(t.exit("listItemPrefix"),!0).length,e(h)}}function Lk(t,e,n){const r=this;return r.containerState._closeFlow=void 0,t.check(jl,i,a);function i(o){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,Se(t,e,"listItemIndent",r.containerState.size+1)(o)}function a(o){return r.containerState.furtherBlankLines||!me(o)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,s(o)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,t.attempt(Pk,e,s)(o))}function s(o){return r.containerState._closeFlow=!0,r.interrupt=void 0,Se(t,t.attempt(pt,e,n),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o)}}function $k(t,e,n){const r=this;return Se(t,i,"listItemIndent",r.containerState.size+1);function i(a){const s=r.events[r.events.length-1];return s&&s[1].type==="listItemIndent"&&s[2].sliceSerialize(s[1],!0).length===r.containerState.size?e(a):n(a)}}function Mk(t){t.exit(this.containerState.type)}function Dk(t,e,n){const r=this;return Se(t,i,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function i(a){const s=r.events[r.events.length-1];return!me(a)&&s&&s[1].type==="listItemPrefixWhitespace"?e(a):n(a)}}const im={name:"setextUnderline",resolveTo:Fk,tokenize:zk};function Fk(t,e){let n=t.length,r,i,a;for(;n--;)if(t[n][0]==="enter"){if(t[n][1].type==="content"){r=n;break}t[n][1].type==="paragraph"&&(i=n)}else t[n][1].type==="content"&&t.splice(n,1),!a&&t[n][1].type==="definition"&&(a=n);const s={type:"setextHeading",start:{...t[r][1].start},end:{...t[t.length-1][1].end}};return t[i][1].type="setextHeadingText",a?(t.splice(i,0,["enter",s,e]),t.splice(a+1,0,["exit",t[r][1],e]),t[r][1].end={...t[a][1].end}):t[r][1]=s,t.push(["exit",s,e]),t}function zk(t,e,n){const r=this;let i;return a;function a(u){let c=r.events.length,d;for(;c--;)if(r.events[c][1].type!=="lineEnding"&&r.events[c][1].type!=="linePrefix"&&r.events[c][1].type!=="content"){d=r.events[c][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||d)?(t.enter("setextHeadingLine"),i=u,s(u)):n(u)}function s(u){return t.enter("setextHeadingLineSequence"),o(u)}function o(u){return u===i?(t.consume(u),o):(t.exit("setextHeadingLineSequence"),me(u)?Se(t,l,"lineSuffix")(u):l(u))}function l(u){return u===null||Q(u)?(t.exit("setextHeadingLine"),e(u)):n(u)}}const Uk={tokenize:Bk};function Bk(t){const e=this,n=t.attempt(jl,r,t.attempt(this.parser.constructs.flowInitial,i,Se(t,t.attempt(this.parser.constructs.flow,i,t.attempt(ZS,i)),"linePrefix")));return n;function r(a){if(a===null){t.consume(a);return}return t.enter("lineEndingBlank"),t.consume(a),t.exit("lineEndingBlank"),e.currentConstruct=void 0,n}function i(a){if(a===null){t.consume(a);return}return t.enter("lineEnding"),t.consume(a),t.exit("lineEnding"),e.currentConstruct=void 0,n}}const Hk={resolveAll:fw()},Gk=dw("string"),Vk=dw("text");function dw(t){return{resolveAll:fw(t==="text"?Wk:void 0),tokenize:e};function e(n){const r=this,i=this.parser.constructs[t],a=n.attempt(i,s,o);return s;function s(c){return u(c)?a(c):o(c)}function o(c){if(c===null){n.consume(c);return}return n.enter("data"),n.consume(c),l}function l(c){return u(c)?(n.exit("data"),a(c)):(n.consume(c),l)}function u(c){if(c===null)return!0;const d=i[c];let f=-1;if(d)for(;++f<d.length;){const h=d[f];if(!h.previous||h.previous.call(r,r.previous))return!0}return!1}}}function fw(t){return e;function e(n,r){let i=-1,a;for(;++i<=n.length;)a===void 0?n[i]&&n[i][1].type==="data"&&(a=i,i++):(!n[i]||n[i][1].type!=="data")&&(i!==a+2&&(n[a][1].end=n[i-1][1].end,n.splice(a+2,i-a-2),i=a+2),a=void 0);return t?t(n,r):n}}function Wk(t,e){let n=0;for(;++n<=t.length;)if((n===t.length||t[n][1].type==="lineEnding")&&t[n-1][1].type==="data"){const r=t[n-1][1],i=e.sliceStream(r);let a=i.length,s=-1,o=0,l;for(;a--;){const u=i[a];if(typeof u=="string"){for(s=u.length;u.charCodeAt(s-1)===32;)o++,s--;if(s)break;s=-1}else if(u===-2)l=!0,o++;else if(u!==-1){a++;break}}if(e._contentTypeTextTrailing&&n===t.length&&(o=0),o){const u={type:n===t.length||l||o<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:a?s:r.start._bufferIndex+s,_index:r.start._index+a,line:r.end.line,column:r.end.column-o,offset:r.end.offset-o},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(t.splice(n,0,["enter",u,e],["exit",u,e]),n+=2)}n++}return t}const Zk={42:pt,43:pt,45:pt,48:pt,49:pt,50:pt,51:pt,52:pt,53:pt,54:pt,55:pt,56:pt,57:pt,62:iw},qk={91:QS},Kk={[-2]:Tu,[-1]:Tu,32:Tu},Jk={35:ik,42:Eo,45:[im,Eo],60:lk,61:im,95:Eo,96:nm,126:nm},Yk={38:sw,92:aw},Qk={[-5]:Ou,[-4]:Ou,[-3]:Ou,33:Ck,38:sw,42:hd,60:[OS,mk],91:Ok,92:[nk,aw],93:Gf,95:hd,96:US},Xk={null:[hd,Hk]},eC={null:[42,95]},tC={null:[]},nC=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:eC,contentInitial:qk,disable:tC,document:Zk,flow:Jk,flowInitial:Kk,insideSpan:Xk,string:Yk,text:Qk},Symbol.toStringTag,{value:"Module"}));function rC(t,e,n){let r={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0};const i={},a=[];let s=[],o=[];const l={attempt:C(k),check:C(S),consume:y,enter:g,exit:x,interrupt:C(S,{interrupt:!0})},u={code:null,containerState:{},defineSkip:v,events:[],now:m,parser:t,previous:null,sliceSerialize:f,sliceStream:h,write:d};let c=e.tokenize.call(u,l);return e.resolveAll&&a.push(e),u;function d(B){return s=Ut(s,B),_(),s[s.length-1]!==null?[]:(A(e,0),u.events=Hf(a,u.events,u),u.events)}function f(B,Z){return aC(h(B),Z)}function h(B){return iC(s,B)}function m(){const{_bufferIndex:B,_index:Z,line:le,column:L,offset:N}=r;return{_bufferIndex:B,_index:Z,line:le,column:L,offset:N}}function v(B){i[B.line]=B.column,j()}function _(){let B;for(;r._index<s.length;){const Z=s[r._index];if(typeof Z=="string")for(B=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===B&&r._bufferIndex<Z.length;)p(Z.charCodeAt(r._bufferIndex));else p(Z)}}function p(B){c=c(B)}function y(B){Q(B)?(r.line++,r.column=1,r.offset+=B===-3?2:1,j()):B!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===s[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=B}function g(B,Z){const le=Z||{};return le.type=B,le.start=m(),u.events.push(["enter",le,u]),o.push(le),le}function x(B){const Z=o.pop();return Z.end=m(),u.events.push(["exit",Z,u]),Z}function k(B,Z){A(B,Z.from)}function S(B,Z){Z.restore()}function C(B,Z){return le;function le(L,N,z){let F,T,I,b;return Array.isArray(L)?G(L):"tokenize"in L?G([L]):W(L);function W(de){return We;function We(Jt){const mn=Jt!==null&&de[Jt],gn=Jt!==null&&de.null,ei=[...Array.isArray(mn)?mn:mn?[mn]:[],...Array.isArray(gn)?gn:gn?[gn]:[]];return G(ei)(Jt)}}function G(de){return F=de,T=0,de.length===0?z:E(de[T])}function E(de){return We;function We(Jt){return b=U(),I=de,de.partial||(u.currentConstruct=de),de.name&&u.parser.constructs.disable.null.includes(de.name)?ue():de.tokenize.call(Z?Object.assign(Object.create(u),Z):u,l,oe,ue)(Jt)}}function oe(de){return B(I,b),N}function ue(de){return b.restore(),++T<F.length?E(F[T]):z}}}function A(B,Z){B.resolveAll&&!a.includes(B)&&a.push(B),B.resolve&&On(u.events,Z,u.events.length-Z,B.resolve(u.events.slice(Z),u)),B.resolveTo&&(u.events=B.resolveTo(u.events,u))}function U(){const B=m(),Z=u.previous,le=u.currentConstruct,L=u.events.length,N=Array.from(o);return{from:L,restore:z};function z(){r=B,u.previous=Z,u.currentConstruct=le,u.events.length=L,o=N,j()}}function j(){r.line in i&&r.column<2&&(r.column=i[r.line],r.offset+=i[r.line]-1)}}function iC(t,e){const n=e.start._index,r=e.start._bufferIndex,i=e.end._index,a=e.end._bufferIndex;let s;if(n===i)s=[t[n].slice(r,a)];else{if(s=t.slice(n,i),r>-1){const o=s[0];typeof o=="string"?s[0]=o.slice(r):s.shift()}a>0&&s.push(t[i].slice(0,a))}return s}function aC(t,e){let n=-1;const r=[];let i;for(;++n<t.length;){const a=t[n];let s;if(typeof a=="string")s=a;else switch(a){case-5:{s="\r";break}case-4:{s=`
`;break}case-3:{s=`\r
`;break}case-2:{s=e?" ":"	";break}case-1:{if(!e&&i)continue;s=" ";break}default:s=String.fromCharCode(a)}i=a===-2,r.push(s)}return r.join("")}function sC(t){const r={constructs:hS([nC,...(t||{}).extensions||[]]),content:i(bS),defined:[],document:i(ES),flow:i(Uk),lazy:{},string:i(Gk),text:i(Vk)};return r;function i(a){return s;function s(o){return rC(r,a,o)}}}function oC(t){for(;!ow(t););return t}const am=/[\0\t\n\r]/g;function lC(){let t=1,e="",n=!0,r;return i;function i(a,s,o){const l=[];let u,c,d,f,h;for(a=e+(typeof a=="string"?a.toString():new TextDecoder(s||void 0).decode(a)),d=0,e="",n&&(a.charCodeAt(0)===65279&&d++,n=void 0);d<a.length;){if(am.lastIndex=d,u=am.exec(a),f=u&&u.index!==void 0?u.index:a.length,h=a.charCodeAt(f),!u){e=a.slice(d);break}if(h===10&&d===f&&r)l.push(-3),r=void 0;else switch(r&&(l.push(-5),r=void 0),d<f&&(l.push(a.slice(d,f)),t+=f-d),h){case 0:{l.push(65533),t++;break}case 9:{for(c=Math.ceil(t/4)*4,l.push(-2);t++<c;)l.push(-1);break}case 10:{l.push(-4),t=1;break}default:r=!0,t=1}d=f+1}return o&&(r&&l.push(-5),e&&l.push(e),l.push(null)),l}}const uC=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function cC(t){return t.replace(uC,dC)}function dC(t,e,n){if(e)return e;if(n.charCodeAt(0)===35){const i=n.charCodeAt(1),a=i===120||i===88;return rw(n.slice(a?2:1),a?16:10)}return Bf(n)||t}const hw={}.hasOwnProperty;function fC(t,e,n){return typeof e!="string"&&(n=e,e=void 0),hC(n)(oC(sC(n).document().write(lC()(t,e,!0))))}function hC(t){const e={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:a(Ch),autolinkProtocol:U,autolinkEmail:U,atxHeading:a(Eh),blockQuote:a(gn),characterEscape:U,characterReference:U,codeFenced:a(ei),codeFencedFenceInfo:s,codeFencedFenceMeta:s,codeIndented:a(ei,s),codeText:a(U_,s),codeTextData:U,data:U,codeFlowValue:U,definition:a(B_),definitionDestinationString:s,definitionLabelString:s,definitionTitleString:s,emphasis:a(H_),hardBreakEscape:a(Sh),hardBreakTrailing:a(Sh),htmlFlow:a(kh,s),htmlFlowData:U,htmlText:a(kh,s),htmlTextData:U,image:a(G_),label:s,link:a(Ch),listItem:a(V_),listItemValue:f,listOrdered:a(Th,d),listUnordered:a(Th),paragraph:a(W_),reference:E,referenceString:s,resourceDestinationString:s,resourceTitleString:s,setextHeading:a(Eh),strong:a(Z_),thematicBreak:a(K_)},exit:{atxHeading:l(),atxHeadingSequence:k,autolink:l(),autolinkEmail:mn,autolinkProtocol:Jt,blockQuote:l(),characterEscapeValue:j,characterReferenceMarkerHexadecimal:ue,characterReferenceMarkerNumeric:ue,characterReferenceValue:de,characterReference:We,codeFenced:l(_),codeFencedFence:v,codeFencedFenceInfo:h,codeFencedFenceMeta:m,codeFlowValue:j,codeIndented:l(p),codeText:l(N),codeTextData:j,data:j,definition:l(),definitionDestinationString:x,definitionLabelString:y,definitionTitleString:g,emphasis:l(),hardBreakEscape:l(Z),hardBreakTrailing:l(Z),htmlFlow:l(le),htmlFlowData:j,htmlText:l(L),htmlTextData:j,image:l(F),label:I,labelText:T,lineEnding:B,link:l(z),listItem:l(),listOrdered:l(),listUnordered:l(),paragraph:l(),referenceString:oe,resourceDestinationString:b,resourceTitleString:W,resource:G,setextHeading:l(A),setextHeadingLineSequence:C,setextHeadingText:S,strong:l(),thematicBreak:l()}};pw(e,(t||{}).mdastExtensions||[]);const n={};return r;function r(O){let D={type:"root",children:[]};const ee={stack:[D],tokenStack:[],config:e,enter:o,exit:u,buffer:s,resume:c,data:n},ce=[];let be=-1;for(;++be<O.length;)if(O[be][1].type==="listOrdered"||O[be][1].type==="listUnordered")if(O[be][0]==="enter")ce.push(be);else{const Yt=ce.pop();be=i(O,Yt,be)}for(be=-1;++be<O.length;){const Yt=e[O[be][0]];hw.call(Yt,O[be][1].type)&&Yt[O[be][1].type].call(Object.assign({sliceSerialize:O[be][2].sliceSerialize},ee),O[be][1])}if(ee.tokenStack.length>0){const Yt=ee.tokenStack[ee.tokenStack.length-1];(Yt[1]||sm).call(ee,void 0,Yt[0])}for(D.position={start:Kn(O.length>0?O[0][1].start:{line:1,column:1,offset:0}),end:Kn(O.length>0?O[O.length-2][1].end:{line:1,column:1,offset:0})},be=-1;++be<e.transforms.length;)D=e.transforms[be](D)||D;return D}function i(O,D,ee){let ce=D-1,be=-1,Yt=!1,Ir,In,na,ra;for(;++ce<=ee;){const St=O[ce];switch(St[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{St[0]==="enter"?be++:be--,ra=void 0;break}case"lineEndingBlank":{St[0]==="enter"&&(Ir&&!ra&&!be&&!na&&(na=ce),ra=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:ra=void 0}if(!be&&St[0]==="enter"&&St[1].type==="listItemPrefix"||be===-1&&St[0]==="exit"&&(St[1].type==="listUnordered"||St[1].type==="listOrdered")){if(Ir){let ti=ce;for(In=void 0;ti--;){const An=O[ti];if(An[1].type==="lineEnding"||An[1].type==="lineEndingBlank"){if(An[0]==="exit")continue;In&&(O[In][1].type="lineEndingBlank",Yt=!0),An[1].type="lineEnding",In=ti}else if(!(An[1].type==="linePrefix"||An[1].type==="blockQuotePrefix"||An[1].type==="blockQuotePrefixWhitespace"||An[1].type==="blockQuoteMarker"||An[1].type==="listItemIndent"))break}na&&(!In||na<In)&&(Ir._spread=!0),Ir.end=Object.assign({},In?O[In][1].start:St[1].end),O.splice(In||ce,0,["exit",Ir,St[2]]),ce++,ee++}if(St[1].type==="listItemPrefix"){const ti={type:"listItem",_spread:!1,start:Object.assign({},St[1].start),end:void 0};Ir=ti,O.splice(ce,0,["enter",ti,St[2]]),ce++,ee++,na=void 0,ra=!0}}}return O[D][1]._spread=Yt,ee}function a(O,D){return ee;function ee(ce){o.call(this,O(ce),ce),D&&D.call(this,ce)}}function s(){this.stack.push({type:"fragment",children:[]})}function o(O,D,ee){this.stack[this.stack.length-1].children.push(O),this.stack.push(O),this.tokenStack.push([D,ee||void 0]),O.position={start:Kn(D.start),end:void 0}}function l(O){return D;function D(ee){O&&O.call(this,ee),u.call(this,ee)}}function u(O,D){const ee=this.stack.pop(),ce=this.tokenStack.pop();if(ce)ce[0].type!==O.type&&(D?D.call(this,O,ce[0]):(ce[1]||sm).call(this,O,ce[0]));else throw new Error("Cannot close `"+O.type+"` ("+Ra({start:O.start,end:O.end})+"): its not open");ee.position.end=Kn(O.end)}function c(){return dS(this.stack.pop())}function d(){this.data.expectingFirstListItemValue=!0}function f(O){if(this.data.expectingFirstListItemValue){const D=this.stack[this.stack.length-2];D.start=Number.parseInt(this.sliceSerialize(O),10),this.data.expectingFirstListItemValue=void 0}}function h(){const O=this.resume(),D=this.stack[this.stack.length-1];D.lang=O}function m(){const O=this.resume(),D=this.stack[this.stack.length-1];D.meta=O}function v(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function _(){const O=this.resume(),D=this.stack[this.stack.length-1];D.value=O.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function p(){const O=this.resume(),D=this.stack[this.stack.length-1];D.value=O.replace(/(\r?\n|\r)$/g,"")}function y(O){const D=this.resume(),ee=this.stack[this.stack.length-1];ee.label=D,ee.identifier=Ai(this.sliceSerialize(O)).toLowerCase()}function g(){const O=this.resume(),D=this.stack[this.stack.length-1];D.title=O}function x(){const O=this.resume(),D=this.stack[this.stack.length-1];D.url=O}function k(O){const D=this.stack[this.stack.length-1];if(!D.depth){const ee=this.sliceSerialize(O).length;D.depth=ee}}function S(){this.data.setextHeadingSlurpLineEnding=!0}function C(O){const D=this.stack[this.stack.length-1];D.depth=this.sliceSerialize(O).codePointAt(0)===61?1:2}function A(){this.data.setextHeadingSlurpLineEnding=void 0}function U(O){const ee=this.stack[this.stack.length-1].children;let ce=ee[ee.length-1];(!ce||ce.type!=="text")&&(ce=q_(),ce.position={start:Kn(O.start),end:void 0},ee.push(ce)),this.stack.push(ce)}function j(O){const D=this.stack.pop();D.value+=this.sliceSerialize(O),D.position.end=Kn(O.end)}function B(O){const D=this.stack[this.stack.length-1];if(this.data.atHardBreak){const ee=D.children[D.children.length-1];ee.position.end=Kn(O.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&e.canContainEols.includes(D.type)&&(U.call(this,O),j.call(this,O))}function Z(){this.data.atHardBreak=!0}function le(){const O=this.resume(),D=this.stack[this.stack.length-1];D.value=O}function L(){const O=this.resume(),D=this.stack[this.stack.length-1];D.value=O}function N(){const O=this.resume(),D=this.stack[this.stack.length-1];D.value=O}function z(){const O=this.stack[this.stack.length-1];if(this.data.inReference){const D=this.data.referenceType||"shortcut";O.type+="Reference",O.referenceType=D,delete O.url,delete O.title}else delete O.identifier,delete O.label;this.data.referenceType=void 0}function F(){const O=this.stack[this.stack.length-1];if(this.data.inReference){const D=this.data.referenceType||"shortcut";O.type+="Reference",O.referenceType=D,delete O.url,delete O.title}else delete O.identifier,delete O.label;this.data.referenceType=void 0}function T(O){const D=this.sliceSerialize(O),ee=this.stack[this.stack.length-2];ee.label=cC(D),ee.identifier=Ai(D).toLowerCase()}function I(){const O=this.stack[this.stack.length-1],D=this.resume(),ee=this.stack[this.stack.length-1];if(this.data.inReference=!0,ee.type==="link"){const ce=O.children;ee.children=ce}else ee.alt=D}function b(){const O=this.resume(),D=this.stack[this.stack.length-1];D.url=O}function W(){const O=this.resume(),D=this.stack[this.stack.length-1];D.title=O}function G(){this.data.inReference=void 0}function E(){this.data.referenceType="collapsed"}function oe(O){const D=this.resume(),ee=this.stack[this.stack.length-1];ee.label=D,ee.identifier=Ai(this.sliceSerialize(O)).toLowerCase(),this.data.referenceType="full"}function ue(O){this.data.characterReferenceType=O.type}function de(O){const D=this.sliceSerialize(O),ee=this.data.characterReferenceType;let ce;ee?(ce=rw(D,ee==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):ce=Bf(D);const be=this.stack[this.stack.length-1];be.value+=ce}function We(O){const D=this.stack.pop();D.position.end=Kn(O.end)}function Jt(O){j.call(this,O);const D=this.stack[this.stack.length-1];D.url=this.sliceSerialize(O)}function mn(O){j.call(this,O);const D=this.stack[this.stack.length-1];D.url="mailto:"+this.sliceSerialize(O)}function gn(){return{type:"blockquote",children:[]}}function ei(){return{type:"code",lang:null,meta:null,value:""}}function U_(){return{type:"inlineCode",value:""}}function B_(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function H_(){return{type:"emphasis",children:[]}}function Eh(){return{type:"heading",depth:0,children:[]}}function Sh(){return{type:"break"}}function kh(){return{type:"html",value:""}}function G_(){return{type:"image",title:null,url:"",alt:null}}function Ch(){return{type:"link",title:null,url:"",children:[]}}function Th(O){return{type:"list",ordered:O.type==="listOrdered",start:null,spread:O._spread,children:[]}}function V_(O){return{type:"listItem",spread:O._spread,checked:null,children:[]}}function W_(){return{type:"paragraph",children:[]}}function Z_(){return{type:"strong",children:[]}}function q_(){return{type:"text",value:""}}function K_(){return{type:"thematicBreak"}}}function Kn(t){return{line:t.line,column:t.column,offset:t.offset}}function pw(t,e){let n=-1;for(;++n<e.length;){const r=e[n];Array.isArray(r)?pw(t,r):pC(t,r)}}function pC(t,e){let n;for(n in e)if(hw.call(e,n))switch(n){case"canContainEols":{const r=e[n];r&&t[n].push(...r);break}case"transforms":{const r=e[n];r&&t[n].push(...r);break}case"enter":case"exit":{const r=e[n];r&&Object.assign(t[n],r);break}}}function sm(t,e){throw t?new Error("Cannot close `"+t.type+"` ("+Ra({start:t.start,end:t.end})+"): a different token (`"+e.type+"`, "+Ra({start:e.start,end:e.end})+") is open"):new Error("Cannot close document, a token (`"+e.type+"`, "+Ra({start:e.start,end:e.end})+") is still open")}function mC(t){const e=this;e.parser=n;function n(r){return fC(r,{...e.data("settings"),...t,extensions:e.data("micromarkExtensions")||[],mdastExtensions:e.data("fromMarkdownExtensions")||[]})}}function gC(t,e){const n={type:"element",tagName:"blockquote",properties:{},children:t.wrap(t.all(e),!0)};return t.patch(e,n),t.applyData(e,n)}function yC(t,e){const n={type:"element",tagName:"br",properties:{},children:[]};return t.patch(e,n),[t.applyData(e,n),{type:"text",value:`
`}]}function vC(t,e){const n=e.value?e.value+`
`:"",r={};e.lang&&(r.className=["language-"+e.lang]);let i={type:"element",tagName:"code",properties:r,children:[{type:"text",value:n}]};return e.meta&&(i.data={meta:e.meta}),t.patch(e,i),i=t.applyData(e,i),i={type:"element",tagName:"pre",properties:{},children:[i]},t.patch(e,i),i}function wC(t,e){const n={type:"element",tagName:"del",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function _C(t,e){const n={type:"element",tagName:"em",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function bC(t,e){const n=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",r=String(e.identifier).toUpperCase(),i=Ji(r.toLowerCase()),a=t.footnoteOrder.indexOf(r);let s,o=t.footnoteCounts.get(r);o===void 0?(o=0,t.footnoteOrder.push(r),s=t.footnoteOrder.length):s=a+1,o+=1,t.footnoteCounts.set(r,o);const l={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+i,id:n+"fnref-"+i+(o>1?"-"+o:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(s)}]};t.patch(e,l);const u={type:"element",tagName:"sup",properties:{},children:[l]};return t.patch(e,u),t.applyData(e,u)}function xC(t,e){const n={type:"element",tagName:"h"+e.depth,properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function EC(t,e){if(t.options.allowDangerousHtml){const n={type:"raw",value:e.value};return t.patch(e,n),t.applyData(e,n)}}function mw(t,e){const n=e.referenceType;let r="]";if(n==="collapsed"?r+="[]":n==="full"&&(r+="["+(e.label||e.identifier)+"]"),e.type==="imageReference")return[{type:"text",value:"!["+e.alt+r}];const i=t.all(e),a=i[0];a&&a.type==="text"?a.value="["+a.value:i.unshift({type:"text",value:"["});const s=i[i.length-1];return s&&s.type==="text"?s.value+=r:i.push({type:"text",value:r}),i}function SC(t,e){const n=String(e.identifier).toUpperCase(),r=t.definitionById.get(n);if(!r)return mw(t,e);const i={src:Ji(r.url||""),alt:e.alt};r.title!==null&&r.title!==void 0&&(i.title=r.title);const a={type:"element",tagName:"img",properties:i,children:[]};return t.patch(e,a),t.applyData(e,a)}function kC(t,e){const n={src:Ji(e.url)};e.alt!==null&&e.alt!==void 0&&(n.alt=e.alt),e.title!==null&&e.title!==void 0&&(n.title=e.title);const r={type:"element",tagName:"img",properties:n,children:[]};return t.patch(e,r),t.applyData(e,r)}function CC(t,e){const n={type:"text",value:e.value.replace(/\r?\n|\r/g," ")};t.patch(e,n);const r={type:"element",tagName:"code",properties:{},children:[n]};return t.patch(e,r),t.applyData(e,r)}function TC(t,e){const n=String(e.identifier).toUpperCase(),r=t.definitionById.get(n);if(!r)return mw(t,e);const i={href:Ji(r.url||"")};r.title!==null&&r.title!==void 0&&(i.title=r.title);const a={type:"element",tagName:"a",properties:i,children:t.all(e)};return t.patch(e,a),t.applyData(e,a)}function OC(t,e){const n={href:Ji(e.url)};e.title!==null&&e.title!==void 0&&(n.title=e.title);const r={type:"element",tagName:"a",properties:n,children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function NC(t,e,n){const r=t.all(e),i=n?IC(n):gw(e),a={},s=[];if(typeof e.checked=="boolean"){const c=r[0];let d;c&&c.type==="element"&&c.tagName==="p"?d=c:(d={type:"element",tagName:"p",properties:{},children:[]},r.unshift(d)),d.children.length>0&&d.children.unshift({type:"text",value:" "}),d.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:e.checked,disabled:!0},children:[]}),a.className=["task-list-item"]}let o=-1;for(;++o<r.length;){const c=r[o];(i||o!==0||c.type!=="element"||c.tagName!=="p")&&s.push({type:"text",value:`
`}),c.type==="element"&&c.tagName==="p"&&!i?s.push(...c.children):s.push(c)}const l=r[r.length-1];l&&(i||l.type!=="element"||l.tagName!=="p")&&s.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:a,children:s};return t.patch(e,u),t.applyData(e,u)}function IC(t){let e=!1;if(t.type==="list"){e=t.spread||!1;const n=t.children;let r=-1;for(;!e&&++r<n.length;)e=gw(n[r])}return e}function gw(t){const e=t.spread;return e??t.children.length>1}function AC(t,e){const n={},r=t.all(e);let i=-1;for(typeof e.start=="number"&&e.start!==1&&(n.start=e.start);++i<r.length;){const s=r[i];if(s.type==="element"&&s.tagName==="li"&&s.properties&&Array.isArray(s.properties.className)&&s.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const a={type:"element",tagName:e.ordered?"ol":"ul",properties:n,children:t.wrap(r,!0)};return t.patch(e,a),t.applyData(e,a)}function RC(t,e){const n={type:"element",tagName:"p",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function PC(t,e){const n={type:"root",children:t.wrap(t.all(e))};return t.patch(e,n),t.applyData(e,n)}function jC(t,e){const n={type:"element",tagName:"strong",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function LC(t,e){const n=t.all(e),r=n.shift(),i=[];if(r){const s={type:"element",tagName:"thead",properties:{},children:t.wrap([r],!0)};t.patch(e.children[0],s),i.push(s)}if(n.length>0){const s={type:"element",tagName:"tbody",properties:{},children:t.wrap(n,!0)},o=Df(e.children[1]),l=Jv(e.children[e.children.length-1]);o&&l&&(s.position={start:o,end:l}),i.push(s)}const a={type:"element",tagName:"table",properties:{},children:t.wrap(i,!0)};return t.patch(e,a),t.applyData(e,a)}function $C(t,e,n){const r=n?n.children:void 0,a=(r?r.indexOf(e):1)===0?"th":"td",s=n&&n.type==="table"?n.align:void 0,o=s?s.length:e.children.length;let l=-1;const u=[];for(;++l<o;){const d=e.children[l],f={},h=s?s[l]:void 0;h&&(f.align=h);let m={type:"element",tagName:a,properties:f,children:[]};d&&(m.children=t.all(d),t.patch(d,m),m=t.applyData(d,m)),u.push(m)}const c={type:"element",tagName:"tr",properties:{},children:t.wrap(u,!0)};return t.patch(e,c),t.applyData(e,c)}function MC(t,e){const n={type:"element",tagName:"td",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}const om=9,lm=32;function DC(t){const e=String(t),n=/\r?\n|\r/g;let r=n.exec(e),i=0;const a=[];for(;r;)a.push(um(e.slice(i,r.index),i>0,!0),r[0]),i=r.index+r[0].length,r=n.exec(e);return a.push(um(e.slice(i),i>0,!1)),a.join("")}function um(t,e,n){let r=0,i=t.length;if(e){let a=t.codePointAt(r);for(;a===om||a===lm;)r++,a=t.codePointAt(r)}if(n){let a=t.codePointAt(i-1);for(;a===om||a===lm;)i--,a=t.codePointAt(i-1)}return i>r?t.slice(r,i):""}function FC(t,e){const n={type:"text",value:DC(String(e.value))};return t.patch(e,n),t.applyData(e,n)}function zC(t,e){const n={type:"element",tagName:"hr",properties:{},children:[]};return t.patch(e,n),t.applyData(e,n)}const UC={blockquote:gC,break:yC,code:vC,delete:wC,emphasis:_C,footnoteReference:bC,heading:xC,html:EC,imageReference:SC,image:kC,inlineCode:CC,linkReference:TC,link:OC,listItem:NC,list:AC,paragraph:RC,root:PC,strong:jC,table:LC,tableCell:MC,tableRow:$C,text:FC,thematicBreak:zC,toml:Ks,yaml:Ks,definition:Ks,footnoteDefinition:Ks};function Ks(){}const yw=-1,Ll=0,ja=1,Xo=2,Vf=3,Wf=4,Zf=5,qf=6,vw=7,ww=8,cm=typeof self=="object"?self:globalThis,BC=(t,e)=>{const n=(i,a)=>(t.set(a,i),i),r=i=>{if(t.has(i))return t.get(i);const[a,s]=e[i];switch(a){case Ll:case yw:return n(s,i);case ja:{const o=n([],i);for(const l of s)o.push(r(l));return o}case Xo:{const o=n({},i);for(const[l,u]of s)o[r(l)]=r(u);return o}case Vf:return n(new Date(s),i);case Wf:{const{source:o,flags:l}=s;return n(new RegExp(o,l),i)}case Zf:{const o=n(new Map,i);for(const[l,u]of s)o.set(r(l),r(u));return o}case qf:{const o=n(new Set,i);for(const l of s)o.add(r(l));return o}case vw:{const{name:o,message:l}=s;return n(new cm[o](l),i)}case ww:return n(BigInt(s),i);case"BigInt":return n(Object(BigInt(s)),i);case"ArrayBuffer":return n(new Uint8Array(s).buffer,s);case"DataView":{const{buffer:o}=new Uint8Array(s);return n(new DataView(o),s)}}return n(new cm[a](s),i)};return r},dm=t=>BC(new Map,t)(0),ri="",{toString:HC}={},{keys:GC}=Object,ha=t=>{const e=typeof t;if(e!=="object"||!t)return[Ll,e];const n=HC.call(t).slice(8,-1);switch(n){case"Array":return[ja,ri];case"Object":return[Xo,ri];case"Date":return[Vf,ri];case"RegExp":return[Wf,ri];case"Map":return[Zf,ri];case"Set":return[qf,ri];case"DataView":return[ja,n]}return n.includes("Array")?[ja,n]:n.includes("Error")?[vw,n]:[Xo,n]},Js=([t,e])=>t===Ll&&(e==="function"||e==="symbol"),VC=(t,e,n,r)=>{const i=(s,o)=>{const l=r.push(s)-1;return n.set(o,l),l},a=s=>{if(n.has(s))return n.get(s);let[o,l]=ha(s);switch(o){case Ll:{let c=s;switch(l){case"bigint":o=ww,c=s.toString();break;case"function":case"symbol":if(t)throw new TypeError("unable to serialize "+l);c=null;break;case"undefined":return i([yw],s)}return i([o,c],s)}case ja:{if(l){let f=s;return l==="DataView"?f=new Uint8Array(s.buffer):l==="ArrayBuffer"&&(f=new Uint8Array(s)),i([l,[...f]],s)}const c=[],d=i([o,c],s);for(const f of s)c.push(a(f));return d}case Xo:{if(l)switch(l){case"BigInt":return i([l,s.toString()],s);case"Boolean":case"Number":case"String":return i([l,s.valueOf()],s)}if(e&&"toJSON"in s)return a(s.toJSON());const c=[],d=i([o,c],s);for(const f of GC(s))(t||!Js(ha(s[f])))&&c.push([a(f),a(s[f])]);return d}case Vf:return i([o,s.toISOString()],s);case Wf:{const{source:c,flags:d}=s;return i([o,{source:c,flags:d}],s)}case Zf:{const c=[],d=i([o,c],s);for(const[f,h]of s)(t||!(Js(ha(f))||Js(ha(h))))&&c.push([a(f),a(h)]);return d}case qf:{const c=[],d=i([o,c],s);for(const f of s)(t||!Js(ha(f)))&&c.push(a(f));return d}}const{message:u}=s;return i([o,{name:l,message:u}],s)};return a},fm=(t,{json:e,lossy:n}={})=>{const r=[];return VC(!(e||n),!!e,new Map,r)(t),r},el=typeof structuredClone=="function"?(t,e)=>e&&("json"in e||"lossy"in e)?dm(fm(t,e)):structuredClone(t):(t,e)=>dm(fm(t,e));function WC(t,e){const n=[{type:"text",value:""}];return e>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(e)}]}),n}function ZC(t,e){return"Back to reference "+(t+1)+(e>1?"-"+e:"")}function qC(t){const e=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",n=t.options.footnoteBackContent||WC,r=t.options.footnoteBackLabel||ZC,i=t.options.footnoteLabel||"Footnotes",a=t.options.footnoteLabelTagName||"h2",s=t.options.footnoteLabelProperties||{className:["sr-only"]},o=[];let l=-1;for(;++l<t.footnoteOrder.length;){const u=t.footnoteById.get(t.footnoteOrder[l]);if(!u)continue;const c=t.all(u),d=String(u.identifier).toUpperCase(),f=Ji(d.toLowerCase());let h=0;const m=[],v=t.footnoteCounts.get(d);for(;v!==void 0&&++h<=v;){m.length>0&&m.push({type:"text",value:" "});let y=typeof n=="string"?n:n(l,h);typeof y=="string"&&(y={type:"text",value:y}),m.push({type:"element",tagName:"a",properties:{href:"#"+e+"fnref-"+f+(h>1?"-"+h:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(l,h),className:["data-footnote-backref"]},children:Array.isArray(y)?y:[y]})}const _=c[c.length-1];if(_&&_.type==="element"&&_.tagName==="p"){const y=_.children[_.children.length-1];y&&y.type==="text"?y.value+=" ":_.children.push({type:"text",value:" "}),_.children.push(...m)}else c.push(...m);const p={type:"element",tagName:"li",properties:{id:e+"fn-"+f},children:t.wrap(c,!0)};t.patch(u,p),o.push(p)}if(o.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:a,properties:{...el(s),id:"footnote-label"},children:[{type:"text",value:i}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:t.wrap(o,!0)},{type:"text",value:`
`}]}}const _w=function(t){if(t==null)return QC;if(typeof t=="function")return $l(t);if(typeof t=="object")return Array.isArray(t)?KC(t):JC(t);if(typeof t=="string")return YC(t);throw new Error("Expected function, string, or object as test")};function KC(t){const e=[];let n=-1;for(;++n<t.length;)e[n]=_w(t[n]);return $l(r);function r(...i){let a=-1;for(;++a<e.length;)if(e[a].apply(this,i))return!0;return!1}}function JC(t){const e=t;return $l(n);function n(r){const i=r;let a;for(a in t)if(i[a]!==e[a])return!1;return!0}}function YC(t){return $l(e);function e(n){return n&&n.type===t}}function $l(t){return e;function e(n,r,i){return!!(XC(n)&&t.call(this,n,typeof r=="number"?r:void 0,i||void 0))}}function QC(){return!0}function XC(t){return t!==null&&typeof t=="object"&&"type"in t}const bw=[],eT=!0,hm=!1,tT="skip";function nT(t,e,n,r){let i;typeof e=="function"&&typeof n!="function"?(r=n,n=e):i=e;const a=_w(i),s=r?-1:1;o(t,void 0,[])();function o(l,u,c){const d=l&&typeof l=="object"?l:{};if(typeof d.type=="string"){const h=typeof d.tagName=="string"?d.tagName:typeof d.name=="string"?d.name:void 0;Object.defineProperty(f,"name",{value:"node ("+(l.type+(h?"<"+h+">":""))+")"})}return f;function f(){let h=bw,m,v,_;if((!e||a(l,u,c[c.length-1]||void 0))&&(h=rT(n(l,c)),h[0]===hm))return h;if("children"in l&&l.children){const p=l;if(p.children&&h[0]!==tT)for(v=(r?p.children.length:-1)+s,_=c.concat(p);v>-1&&v<p.children.length;){const y=p.children[v];if(m=o(y,v,_)(),m[0]===hm)return m;v=typeof m[1]=="number"?m[1]:v+s}}return h}}}function rT(t){return Array.isArray(t)?t:typeof t=="number"?[eT,t]:t==null?bw:[t]}function xw(t,e,n,r){let i,a,s;typeof e=="function"&&typeof n!="function"?(a=void 0,s=e,i=n):(a=e,s=n,i=r),nT(t,a,o,i);function o(l,u){const c=u[u.length-1],d=c?c.children.indexOf(l):void 0;return s(l,d,c)}}const pd={}.hasOwnProperty,iT={};function aT(t,e){const n=e||iT,r=new Map,i=new Map,a=new Map,s={...UC,...n.handlers},o={all:u,applyData:oT,definitionById:r,footnoteById:i,footnoteCounts:a,footnoteOrder:[],handlers:s,one:l,options:n,patch:sT,wrap:uT};return xw(t,function(c){if(c.type==="definition"||c.type==="footnoteDefinition"){const d=c.type==="definition"?r:i,f=String(c.identifier).toUpperCase();d.has(f)||d.set(f,c)}}),o;function l(c,d){const f=c.type,h=o.handlers[f];if(pd.call(o.handlers,f)&&h)return h(o,c,d);if(o.options.passThrough&&o.options.passThrough.includes(f)){if("children"in c){const{children:v,..._}=c,p=el(_);return p.children=o.all(c),p}return el(c)}return(o.options.unknownHandler||lT)(o,c,d)}function u(c){const d=[];if("children"in c){const f=c.children;let h=-1;for(;++h<f.length;){const m=o.one(f[h],c);if(m){if(h&&f[h-1].type==="break"&&(!Array.isArray(m)&&m.type==="text"&&(m.value=pm(m.value)),!Array.isArray(m)&&m.type==="element")){const v=m.children[0];v&&v.type==="text"&&(v.value=pm(v.value))}Array.isArray(m)?d.push(...m):d.push(m)}}}return d}}function sT(t,e){t.position&&(e.position=HE(t))}function oT(t,e){let n=e;if(t&&t.data){const r=t.data.hName,i=t.data.hChildren,a=t.data.hProperties;if(typeof r=="string")if(n.type==="element")n.tagName=r;else{const s="children"in n?n.children:[n];n={type:"element",tagName:r,properties:{},children:s}}n.type==="element"&&a&&Object.assign(n.properties,el(a)),"children"in n&&n.children&&i!==null&&i!==void 0&&(n.children=i)}return n}function lT(t,e){const n=e.data||{},r="value"in e&&!(pd.call(n,"hProperties")||pd.call(n,"hChildren"))?{type:"text",value:e.value}:{type:"element",tagName:"div",properties:{},children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function uT(t,e){const n=[];let r=-1;for(e&&n.push({type:"text",value:`
`});++r<t.length;)r&&n.push({type:"text",value:`
`}),n.push(t[r]);return e&&t.length>0&&n.push({type:"text",value:`
`}),n}function pm(t){let e=0,n=t.charCodeAt(e);for(;n===9||n===32;)e++,n=t.charCodeAt(e);return t.slice(e)}function mm(t,e){const n=aT(t,e),r=n.one(t,void 0),i=qC(n),a=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return i&&a.children.push({type:"text",value:`
`},i),a}function cT(t,e){return t&&"run"in t?async function(n,r){const i=mm(n,{file:r,...e});await t.run(i,r)}:function(n,r){return mm(n,{file:r,...t||e})}}function gm(t){if(t)throw t}var So=Object.prototype.hasOwnProperty,Ew=Object.prototype.toString,ym=Object.defineProperty,vm=Object.getOwnPropertyDescriptor,wm=function(e){return typeof Array.isArray=="function"?Array.isArray(e):Ew.call(e)==="[object Array]"},_m=function(e){if(!e||Ew.call(e)!=="[object Object]")return!1;var n=So.call(e,"constructor"),r=e.constructor&&e.constructor.prototype&&So.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!r)return!1;var i;for(i in e);return typeof i>"u"||So.call(e,i)},bm=function(e,n){ym&&n.name==="__proto__"?ym(e,n.name,{enumerable:!0,configurable:!0,value:n.newValue,writable:!0}):e[n.name]=n.newValue},xm=function(e,n){if(n==="__proto__")if(So.call(e,n)){if(vm)return vm(e,n).value}else return;return e[n]},dT=function t(){var e,n,r,i,a,s,o=arguments[0],l=1,u=arguments.length,c=!1;for(typeof o=="boolean"&&(c=o,o=arguments[1]||{},l=2),(o==null||typeof o!="object"&&typeof o!="function")&&(o={});l<u;++l)if(e=arguments[l],e!=null)for(n in e)r=xm(o,n),i=xm(e,n),o!==i&&(c&&i&&(_m(i)||(a=wm(i)))?(a?(a=!1,s=r&&wm(r)?r:[]):s=r&&_m(r)?r:{},bm(o,{name:n,newValue:t(c,s,i)})):typeof i<"u"&&bm(o,{name:n,newValue:i}));return o};const Nu=ms(dT);function md(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function fT(){const t=[],e={run:n,use:r};return e;function n(...i){let a=-1;const s=i.pop();if(typeof s!="function")throw new TypeError("Expected function as last argument, not "+s);o(null,...i);function o(l,...u){const c=t[++a];let d=-1;if(l){s(l);return}for(;++d<i.length;)(u[d]===null||u[d]===void 0)&&(u[d]=i[d]);i=u,c?hT(c,o)(...u):s(null,...u)}}function r(i){if(typeof i!="function")throw new TypeError("Expected `middelware` to be a function, not "+i);return t.push(i),e}}function hT(t,e){let n;return r;function r(...s){const o=t.length>s.length;let l;o&&s.push(i);try{l=t.apply(this,s)}catch(u){const c=u;if(o&&n)throw c;return i(c)}o||(l&&l.then&&typeof l.then=="function"?l.then(a,i):l instanceof Error?i(l):a(l))}function i(s,...o){n||(n=!0,e(s,...o))}function a(s){i(null,s)}}const _n={basename:pT,dirname:mT,extname:gT,join:yT,sep:"/"};function pT(t,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');xs(t);let n=0,r=-1,i=t.length,a;if(e===void 0||e.length===0||e.length>t.length){for(;i--;)if(t.codePointAt(i)===47){if(a){n=i+1;break}}else r<0&&(a=!0,r=i+1);return r<0?"":t.slice(n,r)}if(e===t)return"";let s=-1,o=e.length-1;for(;i--;)if(t.codePointAt(i)===47){if(a){n=i+1;break}}else s<0&&(a=!0,s=i+1),o>-1&&(t.codePointAt(i)===e.codePointAt(o--)?o<0&&(r=i):(o=-1,r=s));return n===r?r=s:r<0&&(r=t.length),t.slice(n,r)}function mT(t){if(xs(t),t.length===0)return".";let e=-1,n=t.length,r;for(;--n;)if(t.codePointAt(n)===47){if(r){e=n;break}}else r||(r=!0);return e<0?t.codePointAt(0)===47?"/":".":e===1&&t.codePointAt(0)===47?"//":t.slice(0,e)}function gT(t){xs(t);let e=t.length,n=-1,r=0,i=-1,a=0,s;for(;e--;){const o=t.codePointAt(e);if(o===47){if(s){r=e+1;break}continue}n<0&&(s=!0,n=e+1),o===46?i<0?i=e:a!==1&&(a=1):i>-1&&(a=-1)}return i<0||n<0||a===0||a===1&&i===n-1&&i===r+1?"":t.slice(i,n)}function yT(...t){let e=-1,n;for(;++e<t.length;)xs(t[e]),t[e]&&(n=n===void 0?t[e]:n+"/"+t[e]);return n===void 0?".":vT(n)}function vT(t){xs(t);const e=t.codePointAt(0)===47;let n=wT(t,!e);return n.length===0&&!e&&(n="."),n.length>0&&t.codePointAt(t.length-1)===47&&(n+="/"),e?"/"+n:n}function wT(t,e){let n="",r=0,i=-1,a=0,s=-1,o,l;for(;++s<=t.length;){if(s<t.length)o=t.codePointAt(s);else{if(o===47)break;o=47}if(o===47){if(!(i===s-1||a===1))if(i!==s-1&&a===2){if(n.length<2||r!==2||n.codePointAt(n.length-1)!==46||n.codePointAt(n.length-2)!==46){if(n.length>2){if(l=n.lastIndexOf("/"),l!==n.length-1){l<0?(n="",r=0):(n=n.slice(0,l),r=n.length-1-n.lastIndexOf("/")),i=s,a=0;continue}}else if(n.length>0){n="",r=0,i=s,a=0;continue}}e&&(n=n.length>0?n+"/..":"..",r=2)}else n.length>0?n+="/"+t.slice(i+1,s):n=t.slice(i+1,s),r=s-i-1;i=s,a=0}else o===46&&a>-1?a++:a=-1}return n}function xs(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}const _T={cwd:bT};function bT(){return"/"}function gd(t){return!!(t!==null&&typeof t=="object"&&"href"in t&&t.href&&"protocol"in t&&t.protocol&&t.auth===void 0)}function xT(t){if(typeof t=="string")t=new URL(t);else if(!gd(t)){const e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+t+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if(t.protocol!=="file:"){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return ET(t)}function ET(t){if(t.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const e=t.pathname;let n=-1;for(;++n<e.length;)if(e.codePointAt(n)===37&&e.codePointAt(n+1)===50){const r=e.codePointAt(n+2);if(r===70||r===102){const i=new TypeError("File URL path must not include encoded / characters");throw i.code="ERR_INVALID_FILE_URL_PATH",i}}return decodeURIComponent(e)}const Iu=["history","path","basename","stem","extname","dirname"];class Sw{constructor(e){let n;e?gd(e)?n={path:e}:typeof e=="string"||ST(e)?n={value:e}:n=e:n={},this.cwd="cwd"in n?"":_T.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<Iu.length;){const a=Iu[r];a in n&&n[a]!==void 0&&n[a]!==null&&(this[a]=a==="history"?[...n[a]]:n[a])}let i;for(i in n)Iu.includes(i)||(this[i]=n[i])}get basename(){return typeof this.path=="string"?_n.basename(this.path):void 0}set basename(e){Ru(e,"basename"),Au(e,"basename"),this.path=_n.join(this.dirname||"",e)}get dirname(){return typeof this.path=="string"?_n.dirname(this.path):void 0}set dirname(e){Em(this.basename,"dirname"),this.path=_n.join(e||"",this.basename)}get extname(){return typeof this.path=="string"?_n.extname(this.path):void 0}set extname(e){if(Au(e,"extname"),Em(this.dirname,"extname"),e){if(e.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=_n.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){gd(e)&&(e=xT(e)),Ru(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return typeof this.path=="string"?_n.basename(this.path,this.extname):void 0}set stem(e){Ru(e,"stem"),Au(e,"stem"),this.path=_n.join(this.dirname||"",e+(this.extname||""))}fail(e,n,r){const i=this.message(e,n,r);throw i.fatal=!0,i}info(e,n,r){const i=this.message(e,n,r);return i.fatal=void 0,i}message(e,n,r){const i=new it(e,n,r);return this.path&&(i.name=this.path+":"+i.name,i.file=this.path),i.fatal=!1,this.messages.push(i),i}toString(e){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(e||void 0).decode(this.value)}}function Au(t,e){if(t&&t.includes(_n.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+_n.sep+"`")}function Ru(t,e){if(!t)throw new Error("`"+e+"` cannot be empty")}function Em(t,e){if(!t)throw new Error("Setting `"+e+"` requires `path` to be set too")}function ST(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const kT=function(t){const r=this.constructor.prototype,i=r[t],a=function(){return i.apply(a,arguments)};return Object.setPrototypeOf(a,r),a},CT={}.hasOwnProperty;class Kf extends kT{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=fT()}copy(){const e=new Kf;let n=-1;for(;++n<this.attachers.length;){const r=this.attachers[n];e.use(...r)}return e.data(Nu(!0,{},this.namespace)),e}data(e,n){return typeof e=="string"?arguments.length===2?(Lu("data",this.frozen),this.namespace[e]=n,this):CT.call(this.namespace,e)&&this.namespace[e]||void 0:e?(Lu("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[n,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const i=n.call(e,...r);typeof i=="function"&&this.transformers.use(i)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const n=Ys(e),r=this.parser||this.Parser;return Pu("parse",r),r(String(n),n)}process(e,n){const r=this;return this.freeze(),Pu("process",this.parser||this.Parser),ju("process",this.compiler||this.Compiler),n?i(void 0,n):new Promise(i);function i(a,s){const o=Ys(e),l=r.parse(o);r.run(l,o,function(c,d,f){if(c||!d||!f)return u(c);const h=d,m=r.stringify(h,f);NT(m)?f.value=m:f.result=m,u(c,f)});function u(c,d){c||!d?s(c):a?a(d):n(void 0,d)}}}processSync(e){let n=!1,r;return this.freeze(),Pu("processSync",this.parser||this.Parser),ju("processSync",this.compiler||this.Compiler),this.process(e,i),km("processSync","process",n),r;function i(a,s){n=!0,gm(a),r=s}}run(e,n,r){Sm(e),this.freeze();const i=this.transformers;return!r&&typeof n=="function"&&(r=n,n=void 0),r?a(void 0,r):new Promise(a);function a(s,o){const l=Ys(n);i.run(e,l,u);function u(c,d,f){const h=d||e;c?o(c):s?s(h):r(void 0,h,f)}}}runSync(e,n){let r=!1,i;return this.run(e,n,a),km("runSync","run",r),i;function a(s,o){gm(s),i=o,r=!0}}stringify(e,n){this.freeze();const r=Ys(n),i=this.compiler||this.Compiler;return ju("stringify",i),Sm(e),i(e,r)}use(e,...n){const r=this.attachers,i=this.namespace;if(Lu("use",this.frozen),e!=null)if(typeof e=="function")l(e,n);else if(typeof e=="object")Array.isArray(e)?o(e):s(e);else throw new TypeError("Expected usable value, not `"+e+"`");return this;function a(u){if(typeof u=="function")l(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[c,...d]=u;l(c,d)}else s(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function s(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");o(u.plugins),u.settings&&(i.settings=Nu(!0,i.settings,u.settings))}function o(u){let c=-1;if(u!=null)if(Array.isArray(u))for(;++c<u.length;){const d=u[c];a(d)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function l(u,c){let d=-1,f=-1;for(;++d<r.length;)if(r[d][0]===u){f=d;break}if(f===-1)r.push([u,...c]);else if(c.length>0){let[h,...m]=c;const v=r[f][1];md(v)&&md(h)&&(h=Nu(!0,v,h)),r[f]=[u,h,...m]}}}}const TT=new Kf().freeze();function Pu(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `parser`")}function ju(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `compiler`")}function Lu(t,e){if(e)throw new Error("Cannot call `"+t+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function Sm(t){if(!md(t)||typeof t.type!="string")throw new TypeError("Expected node, got `"+t+"`")}function km(t,e,n){if(!n)throw new Error("`"+t+"` finished async. Use `"+e+"` instead")}function Ys(t){return OT(t)?t:new Sw(t)}function OT(t){return!!(t&&typeof t=="object"&&"message"in t&&"messages"in t)}function NT(t){return typeof t=="string"||IT(t)}function IT(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const AT="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",Cm=[],Tm={allowDangerousHtml:!0},RT=/^(https?|ircs?|mailto|xmpp)$/i,PT=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function jT(t){const e=LT(t),n=$T(t);return MT(e.runSync(e.parse(n),n),t)}function LT(t){const e=t.rehypePlugins||Cm,n=t.remarkPlugins||Cm,r=t.remarkRehypeOptions?{...t.remarkRehypeOptions,...Tm}:Tm;return TT().use(mC).use(n).use(cT,r).use(e)}function $T(t){const e=t.children||"",n=new Sw;return typeof e=="string"&&(n.value=e),n}function MT(t,e){const n=e.allowedElements,r=e.allowElement,i=e.components,a=e.disallowedElements,s=e.skipHtml,o=e.unwrapDisallowed,l=e.urlTransform||DT;for(const c of PT)Object.hasOwn(e,c.from)&&(""+c.from+(c.to?"use `"+c.to+"` instead":"remove it")+AT+c.id,void 0);return xw(t,u),qE(t,{Fragment:w.Fragment,components:i,ignoreInvalidStyle:!0,jsx:w.jsx,jsxs:w.jsxs,passKeys:!0,passNode:!0});function u(c,d,f){if(c.type==="raw"&&f&&typeof d=="number")return s?f.children.splice(d,1):f.children[d]={type:"text",value:c.value},d;if(c.type==="element"){let h;for(h in Cu)if(Object.hasOwn(Cu,h)&&Object.hasOwn(c.properties,h)){const m=c.properties[h],v=Cu[h];(v===null||v.includes(c.tagName))&&(c.properties[h]=l(String(m||""),h,c))}}if(c.type==="element"){let h=n?!n.includes(c.tagName):a?a.includes(c.tagName):!1;if(!h&&r&&typeof d=="number"&&(h=!r(c,d,f)),h&&f&&typeof d=="number")return o&&c.children?f.children.splice(d,1,...c.children):f.children.splice(d,1),d}}}function DT(t){const e=t.indexOf(":"),n=t.indexOf("?"),r=t.indexOf("#"),i=t.indexOf("/");return e===-1||i!==-1&&e>i||n!==-1&&e>n||r!==-1&&e>r||RT.test(t.slice(0,e))?t:""}const FT=({text:t,speed:e=5,interval:n=15,onComplete:r,onUpdate:i,enabled:a=!0})=>{const[s,o]=Y.useState(""),[l,u]=Y.useState(!1),c=Y.useRef(null),d=Y.useRef(0);return Y.useEffect(()=>{if(!a||!t){o(t);return}return o(""),u(!0),d.current=0,c.current&&clearInterval(c.current),c.current=setInterval(()=>{const h=d.current;if(h>=t.length){clearInterval(c.current),u(!1),r==null||r();return}const m=Math.min(h+e,t.length);o(t.substring(0,m)),d.current=m,i==null||i()},n),()=>{c.current&&clearInterval(c.current)}},[t,e,n,a,r,i]),{displayedText:s,isStreaming:l,skipToEnd:()=>{c.current&&clearInterval(c.current),o(t),u(!1),d.current=t.length,r==null||r()},progress:t.length>0?d.current/t.length*100:0}},zT=({message:t,isLast:e,enableStreaming:n=!0,onStreamingComplete:r,onStreamingUpdate:i})=>{const a="sender"in t&&typeof t.sender=="string"?t.sender==="user":"type"in t?t.type==="user":!1,s=!a&&n&&e,{displayedText:o,isStreaming:l,skipToEnd:u}=FT({text:t.content,speed:5,interval:15,enabled:s,onComplete:r,onUpdate:i}),c=()=>{if("status"in t)switch(t.status){case"sending":return w.jsx($v,{className:"h-3 w-3 text-gray-400 animate-pulse"});case"sent":return w.jsx(O1,{className:"h-3 w-3 text-gray-400"});case"delivered":return w.jsx(Mp,{className:"h-3 w-3 text-gray-400"});case"read":return w.jsx(Mp,{className:"h-3 w-3 text-orange-500"});default:return null}return null},d=h=>h.toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit",hour12:!1}),f=s?o:t.content;return w.jsxs("div",{className:`flex ${a?"justify-start":"justify-end"} mb-4 animate-slideIn`,style:{animationDelay:e?"0ms":"100ms"},children:[w.jsxs("div",{className:`max-w-[70%] sm:max-w-[60%] ${a?"order-2 mr-3":"order-1 ml-3"}`,children:[w.jsxs("div",{className:`relative px-4 py-3 rounded-2xl shadow-sm transition-all duration-200 hover:shadow-md ${a?"bg-gradient-to-r from-orange-500 to-orange-600 text-white rounded-br-md":"backdrop-blur-xl bg-white/80 text-gray-900 border border-white/40 rounded-bl-md"}`,onClick:l?u:void 0,style:{cursor:l?"pointer":"default"},title:l?"   ":void 0,children:[a?w.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap break-words",children:f}):w.jsxs("div",{className:"text-sm leading-relaxed prose prose-sm max-w-none",children:[w.jsx(jT,{components:{h1:({children:h})=>w.jsx("h1",{className:"text-base font-bold text-gray-900 mb-2 mt-1",children:h}),h2:({children:h})=>w.jsx("h2",{className:"text-sm font-bold text-gray-900 mb-2 mt-1",children:h}),h3:({children:h})=>w.jsx("h3",{className:"text-sm font-semibold text-gray-800 mb-1 mt-1",children:h}),p:({children:h})=>w.jsx("p",{className:"text-sm text-gray-900 mb-2 last:mb-0",children:h}),strong:({children:h})=>w.jsx("strong",{className:"font-semibold text-gray-900",children:h}),ul:({children:h})=>w.jsx("ul",{className:"list-disc list-inside text-sm text-gray-900 mb-2 space-y-1 mr-2",children:h}),ol:({children:h})=>w.jsx("ol",{className:"list-decimal list-inside text-sm text-gray-900 mb-2 space-y-1 mr-2",children:h}),li:({children:h})=>w.jsx("li",{className:"text-sm text-gray-900",children:h}),blockquote:({children:h})=>w.jsx("blockquote",{className:"border-r-2 border-orange-300 pr-3 mr-2 text-sm italic text-gray-700 mb-2",children:h}),code:({children:h,className:m})=>m?w.jsx("pre",{className:"bg-gray-100 text-gray-800 p-2 rounded text-xs font-mono overflow-x-auto mb-2",children:w.jsx("code",{children:h})}):w.jsx("code",{className:"bg-gray-100 text-gray-800 px-1 py-0.5 rounded text-xs font-mono",children:h}),a:({children:h,href:m})=>w.jsx("a",{href:m,className:"text-orange-600 hover:text-orange-700 underline",target:"_blank",rel:"noopener noreferrer",children:h})},children:f}),l&&w.jsx("span",{className:"inline-block w-2 h-4 bg-orange-500 ml-1 animate-pulse"})]}),w.jsx("div",{className:`absolute top-4 w-3 h-3 transform rotate-45 ${a?"right-[-6px] bg-gradient-to-r from-orange-500 to-orange-600":"left-[-6px] backdrop-blur-xl bg-white/80 border-l border-b border-white/40"}`})]}),w.jsxs("div",{className:`flex items-center mt-1 space-x-2 space-x-reverse text-xs text-gray-500 ${a?"justify-start":"justify-end"}`,children:[w.jsx("span",{children:d(t.timestamp)}),l&&!a&&w.jsx("span",{className:"text-orange-500 animate-pulse",children:" ..."}),a&&c()]})]}),w.jsx("div",{className:`w-8 h-8 rounded-full flex-shrink-0 flex items-center justify-center text-xs font-medium shadow-sm ${a?"order-1 bg-gradient-to-br from-orange-400 to-orange-600 text-white":"order-2 bg-gradient-to-br from-gray-100 to-gray-200 text-gray-700"}`,children:a?"":""})]})},UT=()=>w.jsx("div",{className:"flex justify-end mb-4 animate-fadeIn",children:w.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[w.jsx("div",{className:"backdrop-blur-xl bg-white/80 border border-white/40 rounded-2xl rounded-bl-md px-4 py-3 shadow-sm",children:w.jsxs("div",{className:"flex items-center space-x-1 space-x-reverse",children:[w.jsxs("div",{className:"flex space-x-1 space-x-reverse",children:[w.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),w.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),w.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),w.jsx("span",{className:"text-xs text-gray-500 mr-2",children:"..."})]})}),w.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center text-xs font-medium text-gray-700 shadow-sm",children:""})]})}),BT=({voiceRecording:t,onStartRecording:e,onStopRecording:n,disabled:r=!1})=>{const i=a=>{const s=Math.floor(a/60),o=a%60;return`${s}:${o.toString().padStart(2,"0")}`};return t.isRecording?w.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse bg-red-50 border border-red-200 rounded-2xl px-4 py-3 animate-pulse",children:[w.jsx("button",{onClick:n,className:"p-2 bg-red-500 hover:bg-red-600 text-white rounded-full transition-colors duration-200 shadow-lg shadow-red-500/25","aria-label":" ",children:w.jsx(Dv,{className:"h-4 w-4"})}),w.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse flex-1",children:[w.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),w.jsxs("span",{className:"text-sm font-medium text-red-700",children:[" ... ",i(t.duration)]})]}),w.jsx("div",{className:"flex space-x-1 space-x-reverse",children:[...Array(5)].map((a,s)=>w.jsx("div",{className:"w-1 bg-red-400 rounded-full animate-pulse",style:{height:`${Math.random()*20+10}px`,animationDelay:`${s*100}ms`}},s))})]}):w.jsx("button",{onClick:e,disabled:r,className:`p-3 rounded-full transition-all duration-200 shadow-lg ${r?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white hover:bg-gray-50 text-gray-600 hover:text-orange-500 shadow-gray-200/50 hover:shadow-orange-500/25 hover:scale-105"}`,"aria-label":"  ",children:w.jsx(Fv,{className:"h-5 w-5"})})};var Om;(function(t){t.STRING="string",t.NUMBER="number",t.INTEGER="integer",t.BOOLEAN="boolean",t.ARRAY="array",t.OBJECT="object"})(Om||(Om={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nm;(function(t){t.LANGUAGE_UNSPECIFIED="language_unspecified",t.PYTHON="python"})(Nm||(Nm={}));var Im;(function(t){t.OUTCOME_UNSPECIFIED="outcome_unspecified",t.OUTCOME_OK="outcome_ok",t.OUTCOME_FAILED="outcome_failed",t.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(Im||(Im={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Am=["user","model","function","system"];var Rm;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(Rm||(Rm={}));var Pm;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(Pm||(Pm={}));var jm;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(jm||(jm={}));var Lm;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER"})(Lm||(Lm={}));var La;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.OTHER="OTHER"})(La||(La={}));var $m;(function(t){t.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",t.RETRIEVAL_QUERY="RETRIEVAL_QUERY",t.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",t.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",t.CLASSIFICATION="CLASSIFICATION",t.CLUSTERING="CLUSTERING"})($m||($m={}));var bi;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE"})(bi||(bi={}));var Mm;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Mm||(Mm={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt extends Error{constructor(e){super(`[GoogleGenerativeAI Error]: ${e}`)}}class ii extends tt{constructor(e,n){super(e),this.response=n}}class kw extends tt{constructor(e,n,r,i){super(e),this.status=n,this.statusText=r,this.errorDetails=i}}class vr extends tt{}class Cw extends tt{}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HT="https://generativelanguage.googleapis.com",GT="v1beta",VT="0.24.1",WT="genai-js";var Zr;(function(t){t.GENERATE_CONTENT="generateContent",t.STREAM_GENERATE_CONTENT="streamGenerateContent",t.COUNT_TOKENS="countTokens",t.EMBED_CONTENT="embedContent",t.BATCH_EMBED_CONTENTS="batchEmbedContents"})(Zr||(Zr={}));class ZT{constructor(e,n,r,i,a){this.model=e,this.task=n,this.apiKey=r,this.stream=i,this.requestOptions=a}toString(){var e,n;const r=((e=this.requestOptions)===null||e===void 0?void 0:e.apiVersion)||GT;let a=`${((n=this.requestOptions)===null||n===void 0?void 0:n.baseUrl)||HT}/${r}/${this.model}:${this.task}`;return this.stream&&(a+="?alt=sse"),a}}function qT(t){const e=[];return t!=null&&t.apiClient&&e.push(t.apiClient),e.push(`${WT}/${VT}`),e.join(" ")}async function KT(t){var e;const n=new Headers;n.append("Content-Type","application/json"),n.append("x-goog-api-client",qT(t.requestOptions)),n.append("x-goog-api-key",t.apiKey);let r=(e=t.requestOptions)===null||e===void 0?void 0:e.customHeaders;if(r){if(!(r instanceof Headers))try{r=new Headers(r)}catch(i){throw new vr(`unable to convert customHeaders value ${JSON.stringify(r)} to Headers: ${i.message}`)}for(const[i,a]of r.entries()){if(i==="x-goog-api-key")throw new vr(`Cannot set reserved header name ${i}`);if(i==="x-goog-api-client")throw new vr(`Header name ${i} can only be set using the apiClient field`);n.append(i,a)}}return n}async function JT(t,e,n,r,i,a){const s=new ZT(t,e,n,r,a);return{url:s.toString(),fetchOptions:Object.assign(Object.assign({},eO(a)),{method:"POST",headers:await KT(s),body:i})}}async function Es(t,e,n,r,i,a={},s=fetch){const{url:o,fetchOptions:l}=await JT(t,e,n,r,i,a);return YT(o,l,s)}async function YT(t,e,n=fetch){let r;try{r=await n(t,e)}catch(i){QT(i,t)}return r.ok||await XT(r,t),r}function QT(t,e){let n=t;throw n.name==="AbortError"?(n=new Cw(`Request aborted when fetching ${e.toString()}: ${t.message}`),n.stack=t.stack):t instanceof kw||t instanceof vr||(n=new tt(`Error fetching from ${e.toString()}: ${t.message}`),n.stack=t.stack),n}async function XT(t,e){let n="",r;try{const i=await t.json();n=i.error.message,i.error.details&&(n+=` ${JSON.stringify(i.error.details)}`,r=i.error.details)}catch{}throw new kw(`Error fetching from ${e.toString()}: [${t.status} ${t.statusText}] ${n}`,t.status,t.statusText,r)}function eO(t){const e={};if((t==null?void 0:t.signal)!==void 0||(t==null?void 0:t.timeout)>=0){const n=new AbortController;(t==null?void 0:t.timeout)>=0&&setTimeout(()=>n.abort(),t.timeout),t!=null&&t.signal&&t.signal.addEventListener("abort",()=>{n.abort()}),e.signal=n.signal}return e}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jf(t){return t.text=()=>{if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&console.warn(`This response had ${t.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),ko(t.candidates[0]))throw new ii(`${er(t)}`,t);return tO(t)}else if(t.promptFeedback)throw new ii(`Text not available. ${er(t)}`,t);return""},t.functionCall=()=>{if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&console.warn(`This response had ${t.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),ko(t.candidates[0]))throw new ii(`${er(t)}`,t);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),Dm(t)[0]}else if(t.promptFeedback)throw new ii(`Function call not available. ${er(t)}`,t)},t.functionCalls=()=>{if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&console.warn(`This response had ${t.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),ko(t.candidates[0]))throw new ii(`${er(t)}`,t);return Dm(t)}else if(t.promptFeedback)throw new ii(`Function call not available. ${er(t)}`,t)},t}function tO(t){var e,n,r,i;const a=[];if(!((n=(e=t.candidates)===null||e===void 0?void 0:e[0].content)===null||n===void 0)&&n.parts)for(const s of(i=(r=t.candidates)===null||r===void 0?void 0:r[0].content)===null||i===void 0?void 0:i.parts)s.text&&a.push(s.text),s.executableCode&&a.push("\n```"+s.executableCode.language+`
`+s.executableCode.code+"\n```\n"),s.codeExecutionResult&&a.push("\n```\n"+s.codeExecutionResult.output+"\n```\n");return a.length>0?a.join(""):""}function Dm(t){var e,n,r,i;const a=[];if(!((n=(e=t.candidates)===null||e===void 0?void 0:e[0].content)===null||n===void 0)&&n.parts)for(const s of(i=(r=t.candidates)===null||r===void 0?void 0:r[0].content)===null||i===void 0?void 0:i.parts)s.functionCall&&a.push(s.functionCall);if(a.length>0)return a}const nO=[La.RECITATION,La.SAFETY,La.LANGUAGE];function ko(t){return!!t.finishReason&&nO.includes(t.finishReason)}function er(t){var e,n,r;let i="";if((!t.candidates||t.candidates.length===0)&&t.promptFeedback)i+="Response was blocked",!((e=t.promptFeedback)===null||e===void 0)&&e.blockReason&&(i+=` due to ${t.promptFeedback.blockReason}`),!((n=t.promptFeedback)===null||n===void 0)&&n.blockReasonMessage&&(i+=`: ${t.promptFeedback.blockReasonMessage}`);else if(!((r=t.candidates)===null||r===void 0)&&r[0]){const a=t.candidates[0];ko(a)&&(i+=`Candidate was blocked due to ${a.finishReason}`,a.finishMessage&&(i+=`: ${a.finishMessage}`))}return i}function ss(t){return this instanceof ss?(this.v=t,this):new ss(t)}function rO(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,a=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(f){r[f]&&(i[f]=function(h){return new Promise(function(m,v){a.push([f,h,m,v])>1||o(f,h)})})}function o(f,h){try{l(r[f](h))}catch(m){d(a[0][3],m)}}function l(f){f.value instanceof ss?Promise.resolve(f.value.v).then(u,c):d(a[0][2],f)}function u(f){o("next",f)}function c(f){o("throw",f)}function d(f,h){f(h),a.shift(),a.length&&o(a[0][0],a[0][1])}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fm=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function iO(t){const e=t.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),n=oO(e),[r,i]=n.tee();return{stream:sO(r),response:aO(i)}}async function aO(t){const e=[],n=t.getReader();for(;;){const{done:r,value:i}=await n.read();if(r)return Jf(lO(e));e.push(i)}}function sO(t){return rO(this,arguments,function*(){const n=t.getReader();for(;;){const{value:r,done:i}=yield ss(n.read());if(i)break;yield yield ss(Jf(r))}})}function oO(t){const e=t.getReader();return new ReadableStream({start(r){let i="";return a();function a(){return e.read().then(({value:s,done:o})=>{if(o){if(i.trim()){r.error(new tt("Failed to parse stream"));return}r.close();return}i+=s;let l=i.match(Fm),u;for(;l;){try{u=JSON.parse(l[1])}catch{r.error(new tt(`Error parsing JSON response: "${l[1]}"`));return}r.enqueue(u),i=i.substring(l[0].length),l=i.match(Fm)}return a()}).catch(s=>{let o=s;throw o.stack=s.stack,o.name==="AbortError"?o=new Cw("Request aborted when reading from the stream"):o=new tt("Error reading from the stream"),o})}}})}function lO(t){const e=t[t.length-1],n={promptFeedback:e==null?void 0:e.promptFeedback};for(const r of t){if(r.candidates){let i=0;for(const a of r.candidates)if(n.candidates||(n.candidates=[]),n.candidates[i]||(n.candidates[i]={index:i}),n.candidates[i].citationMetadata=a.citationMetadata,n.candidates[i].groundingMetadata=a.groundingMetadata,n.candidates[i].finishReason=a.finishReason,n.candidates[i].finishMessage=a.finishMessage,n.candidates[i].safetyRatings=a.safetyRatings,a.content&&a.content.parts){n.candidates[i].content||(n.candidates[i].content={role:a.content.role||"user",parts:[]});const s={};for(const o of a.content.parts)o.text&&(s.text=o.text),o.functionCall&&(s.functionCall=o.functionCall),o.executableCode&&(s.executableCode=o.executableCode),o.codeExecutionResult&&(s.codeExecutionResult=o.codeExecutionResult),Object.keys(s).length===0&&(s.text=""),n.candidates[i].content.parts.push(s)}i++}r.usageMetadata&&(n.usageMetadata=r.usageMetadata)}return n}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tw(t,e,n,r){const i=await Es(e,Zr.STREAM_GENERATE_CONTENT,t,!0,JSON.stringify(n),r);return iO(i)}async function Ow(t,e,n,r){const a=await(await Es(e,Zr.GENERATE_CONTENT,t,!1,JSON.stringify(n),r)).json();return{response:Jf(a)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nw(t){if(t!=null){if(typeof t=="string")return{role:"system",parts:[{text:t}]};if(t.text)return{role:"system",parts:[t]};if(t.parts)return t.role?t:{role:"system",parts:t.parts}}}function os(t){let e=[];if(typeof t=="string")e=[{text:t}];else for(const n of t)typeof n=="string"?e.push({text:n}):e.push(n);return uO(e)}function uO(t){const e={role:"user",parts:[]},n={role:"function",parts:[]};let r=!1,i=!1;for(const a of t)"functionResponse"in a?(n.parts.push(a),i=!0):(e.parts.push(a),r=!0);if(r&&i)throw new tt("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!r&&!i)throw new tt("No content is provided for sending chat message.");return r?e:n}function cO(t,e){var n;let r={model:e==null?void 0:e.model,generationConfig:e==null?void 0:e.generationConfig,safetySettings:e==null?void 0:e.safetySettings,tools:e==null?void 0:e.tools,toolConfig:e==null?void 0:e.toolConfig,systemInstruction:e==null?void 0:e.systemInstruction,cachedContent:(n=e==null?void 0:e.cachedContent)===null||n===void 0?void 0:n.name,contents:[]};const i=t.generateContentRequest!=null;if(t.contents){if(i)throw new vr("CountTokensRequest must have one of contents or generateContentRequest, not both.");r.contents=t.contents}else if(i)r=Object.assign(Object.assign({},r),t.generateContentRequest);else{const a=os(t);r.contents=[a]}return{generateContentRequest:r}}function zm(t){let e;return t.contents?e=t:e={contents:[os(t)]},t.systemInstruction&&(e.systemInstruction=Nw(t.systemInstruction)),e}function dO(t){return typeof t=="string"||Array.isArray(t)?{content:os(t)}:t}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Um=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],fO={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function hO(t){let e=!1;for(const n of t){const{role:r,parts:i}=n;if(!e&&r!=="user")throw new tt(`First content should be with role 'user', got ${r}`);if(!Am.includes(r))throw new tt(`Each item should include role field. Got ${r} but valid roles are: ${JSON.stringify(Am)}`);if(!Array.isArray(i))throw new tt("Content should have 'parts' property with an array of Parts");if(i.length===0)throw new tt("Each Content should have at least one part");const a={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const o of i)for(const l of Um)l in o&&(a[l]+=1);const s=fO[r];for(const o of Um)if(!s.includes(o)&&a[o]>0)throw new tt(`Content with role '${r}' can't contain '${o}' part`);e=!0}}function Bm(t){var e;if(t.candidates===void 0||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;if(n===void 0||n.parts===void 0||n.parts.length===0)return!1;for(const r of n.parts)if(r===void 0||Object.keys(r).length===0||r.text!==void 0&&r.text==="")return!1;return!0}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hm="SILENT_ERROR";class pO{constructor(e,n,r,i={}){this.model=n,this.params=r,this._requestOptions=i,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,r!=null&&r.history&&(hO(r.history),this._history=r.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e,n={}){var r,i,a,s,o,l;await this._sendPromise;const u=os(e),c={safetySettings:(r=this.params)===null||r===void 0?void 0:r.safetySettings,generationConfig:(i=this.params)===null||i===void 0?void 0:i.generationConfig,tools:(a=this.params)===null||a===void 0?void 0:a.tools,toolConfig:(s=this.params)===null||s===void 0?void 0:s.toolConfig,systemInstruction:(o=this.params)===null||o===void 0?void 0:o.systemInstruction,cachedContent:(l=this.params)===null||l===void 0?void 0:l.cachedContent,contents:[...this._history,u]},d=Object.assign(Object.assign({},this._requestOptions),n);let f;return this._sendPromise=this._sendPromise.then(()=>Ow(this._apiKey,this.model,c,d)).then(h=>{var m;if(Bm(h.response)){this._history.push(u);const v=Object.assign({parts:[],role:"model"},(m=h.response.candidates)===null||m===void 0?void 0:m[0].content);this._history.push(v)}else{const v=er(h.response);v&&console.warn(`sendMessage() was unsuccessful. ${v}. Inspect response object for details.`)}f=h}).catch(h=>{throw this._sendPromise=Promise.resolve(),h}),await this._sendPromise,f}async sendMessageStream(e,n={}){var r,i,a,s,o,l;await this._sendPromise;const u=os(e),c={safetySettings:(r=this.params)===null||r===void 0?void 0:r.safetySettings,generationConfig:(i=this.params)===null||i===void 0?void 0:i.generationConfig,tools:(a=this.params)===null||a===void 0?void 0:a.tools,toolConfig:(s=this.params)===null||s===void 0?void 0:s.toolConfig,systemInstruction:(o=this.params)===null||o===void 0?void 0:o.systemInstruction,cachedContent:(l=this.params)===null||l===void 0?void 0:l.cachedContent,contents:[...this._history,u]},d=Object.assign(Object.assign({},this._requestOptions),n),f=Tw(this._apiKey,this.model,c,d);return this._sendPromise=this._sendPromise.then(()=>f).catch(h=>{throw new Error(Hm)}).then(h=>h.response).then(h=>{if(Bm(h)){this._history.push(u);const m=Object.assign({},h.candidates[0].content);m.role||(m.role="model"),this._history.push(m)}else{const m=er(h);m&&console.warn(`sendMessageStream() was unsuccessful. ${m}. Inspect response object for details.`)}}).catch(h=>{h.message!==Hm&&console.error(h)}),f}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mO(t,e,n,r){return(await Es(e,Zr.COUNT_TOKENS,t,!1,JSON.stringify(n),r)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gO(t,e,n,r){return(await Es(e,Zr.EMBED_CONTENT,t,!1,JSON.stringify(n),r)).json()}async function yO(t,e,n,r){const i=n.requests.map(s=>Object.assign(Object.assign({},s),{model:e}));return(await Es(e,Zr.BATCH_EMBED_CONTENTS,t,!1,JSON.stringify({requests:i}),r)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gm{constructor(e,n,r={}){this.apiKey=e,this._requestOptions=r,n.model.includes("/")?this.model=n.model:this.model=`models/${n.model}`,this.generationConfig=n.generationConfig||{},this.safetySettings=n.safetySettings||[],this.tools=n.tools,this.toolConfig=n.toolConfig,this.systemInstruction=Nw(n.systemInstruction),this.cachedContent=n.cachedContent}async generateContent(e,n={}){var r;const i=zm(e),a=Object.assign(Object.assign({},this._requestOptions),n);return Ow(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(r=this.cachedContent)===null||r===void 0?void 0:r.name},i),a)}async generateContentStream(e,n={}){var r;const i=zm(e),a=Object.assign(Object.assign({},this._requestOptions),n);return Tw(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(r=this.cachedContent)===null||r===void 0?void 0:r.name},i),a)}startChat(e){var n;return new pO(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(n=this.cachedContent)===null||n===void 0?void 0:n.name},e),this._requestOptions)}async countTokens(e,n={}){const r=cO(e,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),i=Object.assign(Object.assign({},this._requestOptions),n);return mO(this.apiKey,this.model,r,i)}async embedContent(e,n={}){const r=dO(e),i=Object.assign(Object.assign({},this._requestOptions),n);return gO(this.apiKey,this.model,r,i)}async batchEmbedContents(e,n={}){const r=Object.assign(Object.assign({},this._requestOptions),n);return yO(this.apiKey,this.model,e,r)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vm{constructor(e){this.apiKey=e}getGenerativeModel(e,n){if(!e.model)throw new tt("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new Gm(this.apiKey,e,n)}getGenerativeModelFromCachedContent(e,n,r){if(!e.name)throw new vr("Cached content must contain a `name` field.");if(!e.model)throw new vr("Cached content must contain a `model` field.");const i=["model","systemInstruction"];for(const s of i)if(n!=null&&n[s]&&e[s]&&(n==null?void 0:n[s])!==e[s]){if(s==="model"){const o=n.model.startsWith("models/")?n.model.replace("models/",""):n.model,l=e.model.startsWith("models/")?e.model.replace("models/",""):e.model;if(o===l)continue}throw new vr(`Different value for "${s}" specified in modelParams (${n[s]}) and cachedContent (${e[s]})`)}const a=Object.assign(Object.assign({},n),{model:e.model,tools:e.tools,toolConfig:e.toolConfig,systemInstruction:e.systemInstruction,cachedContent:e});return new Gm(this.apiKey,a,r)}}var $u={};const vO=()=>typeof window<"u"&&typeof window.document<"u",wO=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",_O=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&navigator.userAgent.includes("jsdom"),Yf=()=>typeof Deno<"u",bO=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!Yf(),xO=()=>{let t;return vO()?t="browser":bO()?t="node":wO()?t="webworker":_O()?t="jsdom":Yf()?t="deno":t="other",t};let Mu;function EO(){return Mu===void 0&&(Mu={library:"langchain-js",runtime:xO()}),Mu}function zr(t){try{return typeof process<"u"?$u==null?void 0:$u[t]:Yf()?Deno==null?void 0:Deno.env.get(t):void 0}catch{return}}function Wm(t,e=Iw){t=t.trim();const n=t.indexOf("```");if(n===-1)return e(t);let r=t.substring(n+3);r.startsWith(`json
`)?r=r.substring(5):r.startsWith("json")?r=r.substring(4):r.startsWith(`
`)&&(r=r.substring(1));const i=r.indexOf("```");let a=r;return i!==-1&&(a=r.substring(0,i)),e(a.trim())}function Iw(t){if(typeof t>"u")return null;try{return JSON.parse(t)}catch{}let e="";const n=[];let r=!1,i=!1;for(let a of t){if(r)a==='"'&&!i?r=!1:a===`
`&&!i?a="\\n":a==="\\"?i=!i:i=!1;else if(a==='"')r=!0,i=!1;else if(a==="{")n.push("}");else if(a==="[")n.push("]");else if(a==="}"||a==="]")if(n&&n[n.length-1]===a)n.pop();else return null;e+=a}r&&(e+='"');for(let a=n.length-1;a>=0;a-=1)e+=n[a];try{return JSON.parse(e)}catch{return null}}var SO=function(t,e){if(typeof t!="string")throw new TypeError("Expected a string");return e=typeof e>"u"?"_":e,t.replace(/([a-z\d])([A-Z])/g,"$1"+e+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+e+"$2").toLowerCase()};const kO=ms(SO);var Aw={exports:{}};const CO=/[\p{Lu}]/u,TO=/[\p{Ll}]/u,Zm=/^[\p{Lu}](?![\p{Lu}])/gu,Rw=/([\p{Alpha}\p{N}_]|$)/u,Pw=/[_.\- ]+/,OO=new RegExp("^"+Pw.source),qm=new RegExp(Pw.source+Rw.source,"gu"),Km=new RegExp("\\d+"+Rw.source,"gu"),NO=(t,e,n)=>{let r=!1,i=!1,a=!1;for(let s=0;s<t.length;s++){const o=t[s];r&&CO.test(o)?(t=t.slice(0,s)+"-"+t.slice(s),r=!1,a=i,i=!0,s++):i&&a&&TO.test(o)?(t=t.slice(0,s-1)+"-"+t.slice(s-1),a=i,i=!1,r=!0):(r=e(o)===o&&n(o)!==o,a=i,i=n(o)===o&&e(o)!==o)}return t},IO=(t,e)=>(Zm.lastIndex=0,t.replace(Zm,n=>e(n))),AO=(t,e)=>(qm.lastIndex=0,Km.lastIndex=0,t.replace(qm,(n,r)=>e(r)).replace(Km,n=>e(n))),jw=(t,e)=>{if(!(typeof t=="string"||Array.isArray(t)))throw new TypeError("Expected the input to be `string | string[]`");if(e={pascalCase:!1,preserveConsecutiveUppercase:!1,...e},Array.isArray(t)?t=t.map(a=>a.trim()).filter(a=>a.length).join("-"):t=t.trim(),t.length===0)return"";const n=e.locale===!1?a=>a.toLowerCase():a=>a.toLocaleLowerCase(e.locale),r=e.locale===!1?a=>a.toUpperCase():a=>a.toLocaleUpperCase(e.locale);return t.length===1?e.pascalCase?r(t):n(t):(t!==n(t)&&(t=NO(t,n,r)),t=t.replace(OO,""),e.preserveConsecutiveUppercase?t=IO(t,n):t=n(t),e.pascalCase&&(t=r(t.charAt(0))+t.slice(1)),AO(t,r))};Aw.exports=jw;Aw.exports.default=jw;function RO(t,e){return(e==null?void 0:e[t])||kO(t)}function PO(t,e,n){const r={};for(const i in t)Object.hasOwn(t,i)&&(r[e(i,n)]=t[i]);return r}function Jm(t){return Array.isArray(t)?[...t]:{...t}}function jO(t,e){const n=Jm(t);for(const[r,i]of Object.entries(e)){const[a,...s]=r.split(".").reverse();let o=n;for(const l of s.reverse()){if(o[l]===void 0)break;o[l]=Jm(o[l]),o=o[l]}o[a]!==void 0&&(o[a]={lc:1,type:"secret",id:[i]})}return n}function Lw(t){const e=Object.getPrototypeOf(t);return typeof t.lc_name=="function"&&(typeof e.lc_name!="function"||t.lc_name()!==e.lc_name())?t.lc_name():t.name}class qr{static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,Lw(this.constructor)]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}constructor(e,...n){Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_serializable_keys!==void 0?this.lc_kwargs=Object.fromEntries(Object.entries(e||{}).filter(([r])=>{var i;return(i=this.lc_serializable_keys)==null?void 0:i.includes(r)})):this.lc_kwargs=e??{}}toJSON(){if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof qr||typeof this.lc_kwargs!="object"||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();const e={},n={},r=Object.keys(this.lc_kwargs).reduce((i,a)=>(i[a]=a in this?this[a]:this.lc_kwargs[a],i),{});for(let i=Object.getPrototypeOf(this);i;i=Object.getPrototypeOf(i))Object.assign(e,Reflect.get(i,"lc_aliases",this)),Object.assign(n,Reflect.get(i,"lc_secrets",this)),Object.assign(r,Reflect.get(i,"lc_attributes",this));return Object.keys(n).forEach(i=>{let a=this,s=r;const[o,...l]=i.split(".").reverse();for(const u of l.reverse()){if(!(u in a)||a[u]===void 0)return;(!(u in s)||s[u]===void 0)&&(typeof a[u]=="object"&&a[u]!=null?s[u]={}:Array.isArray(a[u])&&(s[u]=[])),a=a[u],s=s[u]}o in a&&a[o]!==void 0&&(s[o]=s[o]||a[o])}),{lc:1,type:"constructor",id:this.lc_id,kwargs:PO(Object.keys(n).length?jO(r,n):r,RO,e)}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:this.lc_id}}}function Fi(t){return typeof t=="object"&&t!==null&&"type"in t&&typeof t.type=="string"&&"source_type"in t&&(t.source_type==="url"||t.source_type==="base64"||t.source_type==="text"||t.source_type==="id")}function LO(t){return Fi(t)&&t.source_type==="url"&&"url"in t&&typeof t.url=="string"}function $O(t){return Fi(t)&&t.source_type==="base64"&&"data"in t&&typeof t.data=="string"}function MO(t){if(Fi(t)){if(t.source_type==="url")return{type:"image_url",image_url:{url:t.url}};if(t.source_type==="base64"){if(!t.mime_type)throw new Error("mime_type key is required for base64 data.");return{type:"image_url",image_url:{url:`data:${t.mime_type};base64,${t.data}`}}}}throw new Error("Unsupported source type. Only 'url' and 'base64' are supported.")}function Du({dataUrl:t,asTypedArray:e=!1}){const n=t.match(/^data:(\w+\/\w+);base64,([A-Za-z0-9+/]+=*)$/);let r;if(n){r=n[1].toLowerCase();const i=e?Uint8Array.from(atob(n[2]),a=>a.charCodeAt(0)):n[2];return{mime_type:r,data:i}}}function DO(t,e){if(t.type==="text"){if(!e.fromStandardTextBlock)throw new Error(`Converter for ${e.providerName} does not implement \`fromStandardTextBlock\` method.`);return e.fromStandardTextBlock(t)}if(t.type==="image"){if(!e.fromStandardImageBlock)throw new Error(`Converter for ${e.providerName} does not implement \`fromStandardImageBlock\` method.`);return e.fromStandardImageBlock(t)}if(t.type==="audio"){if(!e.fromStandardAudioBlock)throw new Error(`Converter for ${e.providerName} does not implement \`fromStandardAudioBlock\` method.`);return e.fromStandardAudioBlock(t)}if(t.type==="file"){if(!e.fromStandardFileBlock)throw new Error(`Converter for ${e.providerName} does not implement \`fromStandardFileBlock\` method.`);return e.fromStandardFileBlock(t)}throw new Error(`Unable to convert content block type '${t.type}' to provider-specific format: not recognized.`)}function Ss(t,e){return typeof t=="string"?t===""?e:typeof e=="string"?t+e:Array.isArray(e)&&e.some(n=>Fi(n))?[{type:"text",source_type:"text",text:t},...e]:[{type:"text",text:t},...e]:Array.isArray(e)?Qf(t,e)??[...t,...e]:e===""?t:Array.isArray(t)&&t.some(n=>Fi(n))?[...t,{type:"file",source_type:"text",text:e}]:[...t,{type:"text",text:e}]}function FO(t,e){function n(r,i){if(typeof r!="object"||r===null||r===void 0)return r;if(i>=e)return Array.isArray(r)?"[Array]":"[Object]";if(Array.isArray(r))return r.map(s=>n(s,i+1));const a={};for(const s of Object.keys(r))a[s]=n(r[s],i+1);return a}return JSON.stringify(n(t,0),null,2)}class Yi extends qr{get lc_aliases(){return{additional_kwargs:"additional_kwargs",response_metadata:"response_metadata"}}get text(){return typeof this.content=="string"?this.content:Array.isArray(this.content)?this.content.map(e=>typeof e=="string"?e:e.type==="text"?e.text:"").join(""):""}getType(){return this._getType()}constructor(e,n){typeof e=="string"&&(e={content:e,additional_kwargs:n,response_metadata:{}}),e.additional_kwargs||(e.additional_kwargs={}),e.response_metadata||(e.response_metadata={}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","messages"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.content=e.content,this.additional_kwargs=e.additional_kwargs,this.response_metadata=e.response_metadata,this.id=e.id}toDict(){return{type:this._getType(),data:this.toJSON().kwargs}}static lc_name(){return"BaseMessage"}get _printableFields(){return{id:this.id,content:this.content,name:this.name,additional_kwargs:this.additional_kwargs,response_metadata:this.response_metadata}}_updateId(e){this.id=e,this.lc_kwargs.id=e}get[Symbol.toStringTag](){return this.constructor.lc_name()}[Symbol.for("nodejs.util.inspect.custom")](e){if(e===null)return this;const n=FO(this._printableFields,Math.max(4,e));return`${this.constructor.lc_name()} ${n}`}}function Zt(t,e){const n={...t};for(const[r,i]of Object.entries(e))if(n[r]==null)n[r]=i;else{if(i==null)continue;if(typeof n[r]!=typeof i||Array.isArray(n[r])!==Array.isArray(i))throw new Error(`field[${r}] already exists in the message chunk, but with a different type.`);if(typeof n[r]=="string"){if(r==="type")continue;n[r]+=i}else if(typeof n[r]=="object"&&!Array.isArray(n[r]))n[r]=Zt(n[r],i);else if(Array.isArray(n[r]))n[r]=Qf(n[r],i);else{if(n[r]===i)continue;console.warn(`field[${r}] already exists in this message chunk and value has unsupported type.`)}}return n}function Qf(t,e){if(!(t===void 0&&e===void 0)){if(t===void 0||e===void 0)return t||e;{const n=[...t];for(const r of e)if(typeof r=="object"&&"index"in r&&typeof r.index=="number"){const i=n.findIndex(a=>a.index===r.index);i!==-1?n[i]=Zt(n[i],r):n.push(r)}else{if(typeof r=="object"&&"text"in r&&r.text==="")continue;n.push(r)}return n}}}class ks extends Yi{}function zO(t){return typeof t.role=="string"}function Cs(t){return typeof(t==null?void 0:t._getType)=="function"}function UO(t){return Cs(t)&&typeof t.concat=="function"}class BO extends Yi{static lc_name(){return"ToolMessage"}get lc_aliases(){return{tool_call_id:"tool_call_id"}}constructor(e,n,r){typeof e=="string"&&(e={content:e,name:r,tool_call_id:n}),super(e),Object.defineProperty(this,"lc_direct_tool_output",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}_getType(){return"tool"}static isInstance(e){return e._getType()==="tool"}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}}function HO(t){const e=[],n=[];for(const r of t)if(r.function){const i=r.function.name;try{const a=JSON.parse(r.function.arguments),s={name:i||"",args:a||{},id:r.id};e.push(s)}catch{n.push({name:i,args:r.function.arguments,id:r.id,error:"Malformed args."})}}else continue;return[e,n]}function GO(t){return t._getType()==="tool"}class yd extends Yi{get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls"}}constructor(e,n){var i;let r;if(typeof e=="string")r={content:e,tool_calls:[],invalid_tool_calls:[],additional_kwargs:n??{}};else{r=e;const a=(i=r.additional_kwargs)==null?void 0:i.tool_calls,s=r.tool_calls;a!=null&&a.length>0&&(s===void 0||s.length===0)&&console.warn(["New LangChain packages are available that more efficiently handle",`tool calling.

Please upgrade your packages to versions that set`,"message tool calls. e.g., `yarn add @langchain/anthropic`,","yarn add @langchain/openai`, etc."].join(" "));try{if(a!=null&&s===void 0){const[o,l]=HO(a);r.tool_calls=o??[],r.invalid_tool_calls=l??[]}else r.tool_calls=r.tool_calls??[],r.invalid_tool_calls=r.invalid_tool_calls??[]}catch{r.tool_calls=[],r.invalid_tool_calls=[]}}super(r),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof r!="string"&&(this.tool_calls=r.tool_calls??this.tool_calls,this.invalid_tool_calls=r.invalid_tool_calls??this.invalid_tool_calls),this.usage_metadata=r.usage_metadata}static lc_name(){return"AIMessage"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}}function Xf(t){return t._getType()==="ai"}function Ym(t){return t._getType()==="ai"}class Qi extends ks{constructor(e){var r;let n;if(typeof e=="string")n={content:e,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else if(e.tool_call_chunks===void 0)n={...e,tool_calls:e.tool_calls??[],invalid_tool_calls:[],tool_call_chunks:[],usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0};else{const i=e.tool_call_chunks.reduce((o,l)=>(l.id&&(o[l.id]=o[l.id]??[],o[l.id].push(l)),o),{}),a=[],s=[];for(const[o,l]of Object.entries(i)){let u={};const c=((r=l[0])==null?void 0:r.name)??"",d=l.map(h=>h.args||"").join(""),f=d.length?d:"{}";try{if(u=Iw(f),u===null||typeof u!="object"||Array.isArray(u))throw new Error("Malformed tool call chunk args.");a.push({name:c,args:u,id:o,type:"tool_call"})}catch{s.push({name:c,args:f,id:o,error:"Malformed args.",type:"invalid_tool_call"})}}n={...e,tool_calls:a,invalid_tool_calls:s,usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0}}super(n),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tool_call_chunks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_chunks=n.tool_call_chunks??this.tool_call_chunks,this.tool_calls=n.tool_calls??this.tool_calls,this.invalid_tool_calls=n.invalid_tool_calls??this.invalid_tool_calls,this.usage_metadata=n.usage_metadata}get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls",tool_call_chunks:"tool_call_chunks"}}static lc_name(){return"AIMessageChunk"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,tool_call_chunks:this.tool_call_chunks,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}concat(e){var r,i,a,s,o,l,u,c,d,f,h,m,v,_,p,y,g,x,k,S,C,A,U,j,B,Z,le,L,N,z,F,T,I,b,W,G,E,oe,ue,de;const n={content:Ss(this.content,e.content),additional_kwargs:Zt(this.additional_kwargs,e.additional_kwargs),response_metadata:Zt(this.response_metadata,e.response_metadata),tool_call_chunks:[],id:this.id??e.id};if(this.tool_call_chunks!==void 0||e.tool_call_chunks!==void 0){const We=Qf(this.tool_call_chunks,e.tool_call_chunks);We!==void 0&&We.length>0&&(n.tool_call_chunks=We)}if(this.usage_metadata!==void 0||e.usage_metadata!==void 0){const We={...(((i=(r=this.usage_metadata)==null?void 0:r.input_token_details)==null?void 0:i.audio)!==void 0||((s=(a=e.usage_metadata)==null?void 0:a.input_token_details)==null?void 0:s.audio)!==void 0)&&{audio:(((l=(o=this.usage_metadata)==null?void 0:o.input_token_details)==null?void 0:l.audio)??0)+(((c=(u=e.usage_metadata)==null?void 0:u.input_token_details)==null?void 0:c.audio)??0)},...(((f=(d=this.usage_metadata)==null?void 0:d.input_token_details)==null?void 0:f.cache_read)!==void 0||((m=(h=e.usage_metadata)==null?void 0:h.input_token_details)==null?void 0:m.cache_read)!==void 0)&&{cache_read:(((_=(v=this.usage_metadata)==null?void 0:v.input_token_details)==null?void 0:_.cache_read)??0)+(((y=(p=e.usage_metadata)==null?void 0:p.input_token_details)==null?void 0:y.cache_read)??0)},...(((x=(g=this.usage_metadata)==null?void 0:g.input_token_details)==null?void 0:x.cache_creation)!==void 0||((S=(k=e.usage_metadata)==null?void 0:k.input_token_details)==null?void 0:S.cache_creation)!==void 0)&&{cache_creation:(((A=(C=this.usage_metadata)==null?void 0:C.input_token_details)==null?void 0:A.cache_creation)??0)+(((j=(U=e.usage_metadata)==null?void 0:U.input_token_details)==null?void 0:j.cache_creation)??0)}},Jt={...(((Z=(B=this.usage_metadata)==null?void 0:B.output_token_details)==null?void 0:Z.audio)!==void 0||((L=(le=e.usage_metadata)==null?void 0:le.output_token_details)==null?void 0:L.audio)!==void 0)&&{audio:(((z=(N=this.usage_metadata)==null?void 0:N.output_token_details)==null?void 0:z.audio)??0)+(((T=(F=e.usage_metadata)==null?void 0:F.output_token_details)==null?void 0:T.audio)??0)},...(((b=(I=this.usage_metadata)==null?void 0:I.output_token_details)==null?void 0:b.reasoning)!==void 0||((G=(W=e.usage_metadata)==null?void 0:W.output_token_details)==null?void 0:G.reasoning)!==void 0)&&{reasoning:(((oe=(E=this.usage_metadata)==null?void 0:E.output_token_details)==null?void 0:oe.reasoning)??0)+(((de=(ue=e.usage_metadata)==null?void 0:ue.output_token_details)==null?void 0:de.reasoning)??0)}},mn=this.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},gn=e.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},ei={input_tokens:mn.input_tokens+gn.input_tokens,output_tokens:mn.output_tokens+gn.output_tokens,total_tokens:mn.total_tokens+gn.total_tokens,...Object.keys(We).length>0&&{input_token_details:We},...Object.keys(Jt).length>0&&{output_token_details:Jt}};n.usage_metadata=ei}return new Qi(n)}}class Ml extends Yi{static lc_name(){return"ChatMessage"}static _chatMessageClass(){return Ml}constructor(e,n){typeof e=="string"&&(e={content:e,role:n}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}static isInstance(e){return e._getType()==="generic"}get _printableFields(){return{...super._printableFields,role:this.role}}}class eh extends ks{static lc_name(){return"ChatMessageChunk"}constructor(e,n){typeof e=="string"&&(e={content:e,role:n}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}concat(e){return new eh({content:Ss(this.content,e.content),additional_kwargs:Zt(this.additional_kwargs,e.additional_kwargs),response_metadata:Zt(this.response_metadata,e.response_metadata),role:this.role,id:this.id??e.id})}get _printableFields(){return{...super._printableFields,role:this.role}}}class th extends ks{static lc_name(){return"FunctionMessageChunk"}_getType(){return"function"}concat(e){return new th({content:Ss(this.content,e.content),additional_kwargs:Zt(this.additional_kwargs,e.additional_kwargs),response_metadata:Zt(this.response_metadata,e.response_metadata),name:this.name??"",id:this.id??e.id})}}class Dl extends Yi{static lc_name(){return"HumanMessage"}_getType(){return"human"}constructor(e,n){super(e,n)}}class nh extends ks{static lc_name(){return"HumanMessageChunk"}_getType(){return"human"}constructor(e,n){super(e,n)}concat(e){return new nh({content:Ss(this.content,e.content),additional_kwargs:Zt(this.additional_kwargs,e.additional_kwargs),response_metadata:Zt(this.response_metadata,e.response_metadata),id:this.id??e.id})}}class Qm extends Yi{static lc_name(){return"SystemMessage"}_getType(){return"system"}constructor(e,n){super(e,n)}}class rh extends ks{static lc_name(){return"SystemMessageChunk"}_getType(){return"system"}constructor(e,n){super(e,n)}concat(e){return new rh({content:Ss(this.content,e.content),additional_kwargs:Zt(this.additional_kwargs,e.additional_kwargs),response_metadata:Zt(this.response_metadata,e.response_metadata),id:this.id??e.id})}}function $w(t,e){return t.lc_error_code=e,t.message=`${t.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${e}/
`,t}function Mw(t){return!!(t&&typeof t=="object"&&"type"in t&&t.type==="tool_call")}class VO extends Error{constructor(e,n){super(e),Object.defineProperty(this,"output",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.output=n}}function WO(t){return Mw(t)?t:typeof t.id=="string"&&t.type==="function"&&typeof t.function=="object"&&t.function!==null&&"arguments"in t.function&&typeof t.function.arguments=="string"&&"name"in t.function&&typeof t.function.name=="string"?{id:t.id,args:JSON.parse(t.function.arguments),name:t.function.name,type:"tool_call"}:t}function ZO(t){return typeof t=="object"&&t!=null&&t.lc===1&&Array.isArray(t.id)&&t.kwargs!=null&&typeof t.kwargs=="object"}function Fu(t){let e,n;if(ZO(t)){const r=t.id.at(-1);r==="HumanMessage"||r==="HumanMessageChunk"?e="user":r==="AIMessage"||r==="AIMessageChunk"?e="assistant":r==="SystemMessage"||r==="SystemMessageChunk"?e="system":r==="FunctionMessage"||r==="FunctionMessageChunk"?e="function":r==="ToolMessage"||r==="ToolMessageChunk"?e="tool":e="unknown",n=t.kwargs}else{const{type:r,...i}=t;e=r,n=i}if(e==="human"||e==="user")return new Dl(n);if(e==="ai"||e==="assistant"){const{tool_calls:r,...i}=n;if(!Array.isArray(r))return new yd(n);const a=r.map(WO);return new yd({...i,tool_calls:a})}else{if(e==="system")return new Qm(n);if(e==="developer")return new Qm({...n,additional_kwargs:{...n.additional_kwargs,__openai_role__:"developer"}});if(e==="tool"&&"tool_call_id"in n)return new BO({...n,content:n.content,tool_call_id:n.tool_call_id,name:n.name});throw $w(new Error(`Unable to coerce message from array: only human, AI, system, developer, or tool message coercion is currently supported.

Received: ${JSON.stringify(t,null,2)}`),"MESSAGE_COERCION_FAILURE")}}function _a(t){if(typeof t=="string")return new Dl(t);if(Cs(t))return t;if(Array.isArray(t)){const[e,n]=t;return Fu({type:e,content:n})}else if(zO(t)){const{role:e,...n}=t;return Fu({...n,type:e})}else return Fu(t)}function Dw(t,e="Human",n="AI"){const r=[];for(const i of t){let a;if(i._getType()==="human")a=e;else if(i._getType()==="ai")a=n;else if(i._getType()==="system")a="System";else if(i._getType()==="function")a="Function";else if(i._getType()==="tool")a="Tool";else if(i._getType()==="generic")a=i.role;else throw new Error(`Got unsupported message type: ${i._getType()}`);const s=i.name?`${i.name}, `:"",o=typeof i.content=="string"?i.content:JSON.stringify(i.content,null,2);r.push(`${a}: ${s}${o}`)}return r.join(`
`)}function qO(t){var n;const e=t._getType();if(e==="human")return new nh({...t});if(e==="ai"){let r={...t};return"tool_calls"in r&&(r={...r,tool_call_chunks:(n=r.tool_calls)==null?void 0:n.map(i=>({...i,type:"tool_call_chunk",index:void 0,args:JSON.stringify(i.args)}))}),new Qi({...r})}else{if(e==="system")return new rh({...t});if(e==="function")return new th({...t});if(Ml.isInstance(t))return new eh({...t});throw new Error("Unknown message type.")}}var pe;(function(t){t.assertEqual=i=>{};function e(i){}t.assertIs=e;function n(i){throw new Error}t.assertNever=n,t.arrayToEnum=i=>{const a={};for(const s of i)a[s]=s;return a},t.getValidEnumValues=i=>{const a=t.objectKeys(i).filter(o=>typeof i[i[o]]!="number"),s={};for(const o of a)s[o]=i[o];return t.objectValues(s)},t.objectValues=i=>t.objectKeys(i).map(function(a){return i[a]}),t.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const a=[];for(const s in i)Object.prototype.hasOwnProperty.call(i,s)&&a.push(s);return a},t.find=(i,a)=>{for(const s of i)if(a(s))return s},t.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&Number.isFinite(i)&&Math.floor(i)===i;function r(i,a=" | "){return i.map(s=>typeof s=="string"?`'${s}'`:s).join(a)}t.joinValues=r,t.jsonStringifyReplacer=(i,a)=>typeof a=="bigint"?a.toString():a})(pe||(pe={}));var Xm;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(Xm||(Xm={}));const q=pe.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),tr=t=>{switch(typeof t){case"undefined":return q.undefined;case"string":return q.string;case"number":return Number.isNaN(t)?q.nan:q.number;case"boolean":return q.boolean;case"function":return q.function;case"bigint":return q.bigint;case"symbol":return q.symbol;case"object":return Array.isArray(t)?q.array:t===null?q.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?q.promise:typeof Map<"u"&&t instanceof Map?q.map:typeof Set<"u"&&t instanceof Set?q.set:typeof Date<"u"&&t instanceof Date?q.date:q.object;default:return q.unknown}},$=pe.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Gn extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}format(e){const n=e||function(a){return a.message},r={_errors:[]},i=a=>{for(const s of a.issues)if(s.code==="invalid_union")s.unionErrors.map(i);else if(s.code==="invalid_return_type")i(s.returnTypeError);else if(s.code==="invalid_arguments")i(s.argumentsError);else if(s.path.length===0)r._errors.push(n(s));else{let o=r,l=0;for(;l<s.path.length;){const u=s.path[l];l===s.path.length-1?(o[u]=o[u]||{_errors:[]},o[u]._errors.push(n(s))):o[u]=o[u]||{_errors:[]},o=o[u],l++}}};return i(this),r}static assert(e){if(!(e instanceof Gn))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,pe.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const i of this.issues)if(i.path.length>0){const a=i.path[0];n[a]=n[a]||[],n[a].push(e(i))}else r.push(e(i));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Gn.create=t=>new Gn(t);const vd=(t,e)=>{let n;switch(t.code){case $.invalid_type:t.received===q.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case $.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,pe.jsonStringifyReplacer)}`;break;case $.unrecognized_keys:n=`Unrecognized key(s) in object: ${pe.joinValues(t.keys,", ")}`;break;case $.invalid_union:n="Invalid input";break;case $.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${pe.joinValues(t.options)}`;break;case $.invalid_enum_value:n=`Invalid enum value. Expected ${pe.joinValues(t.options)}, received '${t.received}'`;break;case $.invalid_arguments:n="Invalid function arguments";break;case $.invalid_return_type:n="Invalid function return type";break;case $.invalid_date:n="Invalid date";break;case $.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:pe.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case $.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case $.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case $.custom:n="Invalid input";break;case $.invalid_intersection_types:n="Intersection results could not be merged";break;case $.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case $.not_finite:n="Number must be finite";break;default:n=e.defaultError,pe.assertNever(t)}return{message:n}};let KO=vd;function JO(){return KO}const YO=t=>{const{data:e,path:n,errorMaps:r,issueData:i}=t,a=[...n,...i.path||[]],s={...i,path:a};if(i.message!==void 0)return{...i,path:a,message:i.message};let o="";const l=r.filter(u=>!!u).slice().reverse();for(const u of l)o=u(s,{data:e,defaultError:o}).message;return{...i,path:a,message:o}};function H(t,e){const n=JO(),r=YO({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===vd?void 0:vd].filter(i=>!!i)});t.common.issues.push(r)}class Rt{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const i of n){if(i.status==="aborted")return X;i.status==="dirty"&&e.dirty(),r.push(i.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const i of n){const a=await i.key,s=await i.value;r.push({key:a,value:s})}return Rt.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const i of n){const{key:a,value:s}=i;if(a.status==="aborted"||s.status==="aborted")return X;a.status==="dirty"&&e.dirty(),s.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof s.value<"u"||i.alwaysSet)&&(r[a.value]=s.value)}return{status:e.value,value:r}}}const X=Object.freeze({status:"aborted"}),ba=t=>({status:"dirty",value:t}),Kt=t=>({status:"valid",value:t}),eg=t=>t.status==="aborted",tg=t=>t.status==="dirty",zi=t=>t.status==="valid",tl=t=>typeof Promise<"u"&&t instanceof Promise;var K;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(K||(K={}));class xr{constructor(e,n,r,i){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const ng=(t,e)=>{if(zi(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Gn(t.common.issues);return this._error=n,this._error}}};function ae(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:i}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(s,o)=>{const{message:l}=t;return s.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:l??r??o.defaultError}:s.code!=="invalid_type"?{message:o.defaultError}:{message:l??n??o.defaultError}},description:i}}class he{get description(){return this._def.description}_getType(e){return tr(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:tr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Rt,ctx:{common:e.parent.common,data:e.data,parsedType:tr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(tl(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){const r={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:tr(e)},i=this._parseSync({data:e,path:r.path,parent:r});return ng(r,i)}"~validate"(e){var r,i;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:tr(e)};if(!this["~standard"].async)try{const a=this._parseSync({data:e,path:[],parent:n});return zi(a)?{value:a.value}:{issues:n.common.issues}}catch(a){(i=(r=a==null?void 0:a.message)==null?void 0:r.toLowerCase())!=null&&i.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(a=>zi(a)?{value:a.value}:{issues:n.common.issues})}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:tr(e)},i=this._parse({data:e,path:r.path,parent:r}),a=await(tl(i)?i:Promise.resolve(i));return ng(r,a)}refine(e,n){const r=i=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(i):n;return this._refinement((i,a)=>{const s=e(i),o=()=>a.addIssue({code:$.custom,...r(i)});return typeof Promise<"u"&&s instanceof Promise?s.then(l=>l?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,n){return this._refinement((r,i)=>e(r)?!0:(i.addIssue(typeof n=="function"?n(r,i):n),!1))}_refinement(e){return new Bi({schema:this,typeName:M.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return wr.create(this,this._def)}nullable(){return Hi.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Tn.create(this)}promise(){return al.create(this,this._def)}or(e){return rl.create([this,e],this._def)}and(e){return il.create(this,e,this._def)}transform(e){return new Bi({...ae(this._def),schema:this,typeName:M.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new bd({...ae(this._def),innerType:this,defaultValue:n,typeName:M.ZodDefault})}brand(){return new _N({typeName:M.ZodBranded,type:this,...ae(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new xd({...ae(this._def),innerType:this,catchValue:n,typeName:M.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return ih.create(this,e)}readonly(){return Ed.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const QO=/^c[^\s-]{8,}$/i,XO=/^[0-9a-z]+$/,eN=/^[0-9A-HJKMNP-TV-Z]{26}$/i,tN=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,nN=/^[a-z0-9_-]{21}$/i,rN=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,iN=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,aN=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,sN="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let zu;const oN=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,lN=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,uN=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,cN=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,dN=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,fN=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Fw="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",hN=new RegExp(`^${Fw}$`);function zw(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const n=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${n}`}function pN(t){return new RegExp(`^${zw(t)}$`)}function mN(t){let e=`${Fw}T${zw(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function gN(t,e){return!!((e==="v4"||!e)&&oN.test(t)||(e==="v6"||!e)&&uN.test(t))}function yN(t,e){if(!rN.test(t))return!1;try{const[n]=t.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),i=JSON.parse(atob(r));return!(typeof i!="object"||i===null||"typ"in i&&(i==null?void 0:i.typ)!=="JWT"||!i.alg||e&&i.alg!==e)}catch{return!1}}function vN(t,e){return!!((e==="v4"||!e)&&lN.test(t)||(e==="v6"||!e)&&cN.test(t))}class lr extends he{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==q.string){const a=this._getOrReturnCtx(e);return H(a,{code:$.invalid_type,expected:q.string,received:a.parsedType}),X}const r=new Rt;let i;for(const a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(i=this._getOrReturnCtx(e,i),H(i,{code:$.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="max")e.data.length>a.value&&(i=this._getOrReturnCtx(e,i),H(i,{code:$.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="length"){const s=e.data.length>a.value,o=e.data.length<a.value;(s||o)&&(i=this._getOrReturnCtx(e,i),s?H(i,{code:$.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):o&&H(i,{code:$.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),r.dirty())}else if(a.kind==="email")aN.test(e.data)||(i=this._getOrReturnCtx(e,i),H(i,{validation:"email",code:$.invalid_string,message:a.message}),r.dirty());else if(a.kind==="emoji")zu||(zu=new RegExp(sN,"u")),zu.test(e.data)||(i=this._getOrReturnCtx(e,i),H(i,{validation:"emoji",code:$.invalid_string,message:a.message}),r.dirty());else if(a.kind==="uuid")tN.test(e.data)||(i=this._getOrReturnCtx(e,i),H(i,{validation:"uuid",code:$.invalid_string,message:a.message}),r.dirty());else if(a.kind==="nanoid")nN.test(e.data)||(i=this._getOrReturnCtx(e,i),H(i,{validation:"nanoid",code:$.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid")QO.test(e.data)||(i=this._getOrReturnCtx(e,i),H(i,{validation:"cuid",code:$.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid2")XO.test(e.data)||(i=this._getOrReturnCtx(e,i),H(i,{validation:"cuid2",code:$.invalid_string,message:a.message}),r.dirty());else if(a.kind==="ulid")eN.test(e.data)||(i=this._getOrReturnCtx(e,i),H(i,{validation:"ulid",code:$.invalid_string,message:a.message}),r.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),H(i,{validation:"url",code:$.invalid_string,message:a.message}),r.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),H(i,{validation:"regex",code:$.invalid_string,message:a.message}),r.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(i=this._getOrReturnCtx(e,i),H(i,{code:$.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),r.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(i=this._getOrReturnCtx(e,i),H(i,{code:$.invalid_string,validation:{startsWith:a.value},message:a.message}),r.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(i=this._getOrReturnCtx(e,i),H(i,{code:$.invalid_string,validation:{endsWith:a.value},message:a.message}),r.dirty()):a.kind==="datetime"?mN(a).test(e.data)||(i=this._getOrReturnCtx(e,i),H(i,{code:$.invalid_string,validation:"datetime",message:a.message}),r.dirty()):a.kind==="date"?hN.test(e.data)||(i=this._getOrReturnCtx(e,i),H(i,{code:$.invalid_string,validation:"date",message:a.message}),r.dirty()):a.kind==="time"?pN(a).test(e.data)||(i=this._getOrReturnCtx(e,i),H(i,{code:$.invalid_string,validation:"time",message:a.message}),r.dirty()):a.kind==="duration"?iN.test(e.data)||(i=this._getOrReturnCtx(e,i),H(i,{validation:"duration",code:$.invalid_string,message:a.message}),r.dirty()):a.kind==="ip"?gN(e.data,a.version)||(i=this._getOrReturnCtx(e,i),H(i,{validation:"ip",code:$.invalid_string,message:a.message}),r.dirty()):a.kind==="jwt"?yN(e.data,a.alg)||(i=this._getOrReturnCtx(e,i),H(i,{validation:"jwt",code:$.invalid_string,message:a.message}),r.dirty()):a.kind==="cidr"?vN(e.data,a.version)||(i=this._getOrReturnCtx(e,i),H(i,{validation:"cidr",code:$.invalid_string,message:a.message}),r.dirty()):a.kind==="base64"?dN.test(e.data)||(i=this._getOrReturnCtx(e,i),H(i,{validation:"base64",code:$.invalid_string,message:a.message}),r.dirty()):a.kind==="base64url"?fN.test(e.data)||(i=this._getOrReturnCtx(e,i),H(i,{validation:"base64url",code:$.invalid_string,message:a.message}),r.dirty()):pe.assertNever(a);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(i=>e.test(i),{validation:n,code:$.invalid_string,...K.errToObj(r)})}_addCheck(e){return new lr({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...K.errToObj(e)})}url(e){return this._addCheck({kind:"url",...K.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...K.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...K.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...K.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...K.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...K.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...K.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...K.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...K.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...K.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...K.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...K.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...K.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...K.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...K.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...K.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...K.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...K.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...K.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...K.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...K.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...K.errToObj(n)})}nonempty(e){return this.min(1,K.errToObj(e))}trim(){return new lr({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new lr({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new lr({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}lr.create=t=>new lr({checks:[],typeName:M.ZodString,coerce:(t==null?void 0:t.coerce)??!1,...ae(t)});function wN(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,i=n>r?n:r,a=Number.parseInt(t.toFixed(i).replace(".","")),s=Number.parseInt(e.toFixed(i).replace(".",""));return a%s/10**i}class ls extends he{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==q.number){const a=this._getOrReturnCtx(e);return H(a,{code:$.invalid_type,expected:q.number,received:a.parsedType}),X}let r;const i=new Rt;for(const a of this._def.checks)a.kind==="int"?pe.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),H(r,{code:$.invalid_type,expected:"integer",received:"float",message:a.message}),i.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(r=this._getOrReturnCtx(e,r),H(r,{code:$.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(r=this._getOrReturnCtx(e,r),H(r,{code:$.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind==="multipleOf"?wN(e.data,a.value)!==0&&(r=this._getOrReturnCtx(e,r),H(r,{code:$.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),H(r,{code:$.not_finite,message:a.message}),i.dirty()):pe.assertNever(a);return{status:i.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,K.toString(n))}gt(e,n){return this.setLimit("min",e,!1,K.toString(n))}lte(e,n){return this.setLimit("max",e,!0,K.toString(n))}lt(e,n){return this.setLimit("max",e,!1,K.toString(n))}setLimit(e,n,r,i){return new ls({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:K.toString(i)}]})}_addCheck(e){return new ls({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:K.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:K.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:K.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:K.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:K.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:K.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:K.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:K.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:K.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&pe.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}ls.create=t=>new ls({checks:[],typeName:M.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...ae(t)});class us extends he{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==q.bigint)return this._getInvalidInput(e);let r;const i=new Rt;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(r=this._getOrReturnCtx(e,r),H(r,{code:$.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),i.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(r=this._getOrReturnCtx(e,r),H(r,{code:$.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),i.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),H(r,{code:$.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):pe.assertNever(a);return{status:i.value,value:e.data}}_getInvalidInput(e){const n=this._getOrReturnCtx(e);return H(n,{code:$.invalid_type,expected:q.bigint,received:n.parsedType}),X}gte(e,n){return this.setLimit("min",e,!0,K.toString(n))}gt(e,n){return this.setLimit("min",e,!1,K.toString(n))}lte(e,n){return this.setLimit("max",e,!0,K.toString(n))}lt(e,n){return this.setLimit("max",e,!1,K.toString(n))}setLimit(e,n,r,i){return new us({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:K.toString(i)}]})}_addCheck(e){return new us({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:K.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:K.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:K.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:K.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:K.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}us.create=t=>new us({checks:[],typeName:M.ZodBigInt,coerce:(t==null?void 0:t.coerce)??!1,...ae(t)});class rg extends he{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==q.boolean){const r=this._getOrReturnCtx(e);return H(r,{code:$.invalid_type,expected:q.boolean,received:r.parsedType}),X}return Kt(e.data)}}rg.create=t=>new rg({typeName:M.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...ae(t)});class nl extends he{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==q.date){const a=this._getOrReturnCtx(e);return H(a,{code:$.invalid_type,expected:q.date,received:a.parsedType}),X}if(Number.isNaN(e.data.getTime())){const a=this._getOrReturnCtx(e);return H(a,{code:$.invalid_date}),X}const r=new Rt;let i;for(const a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(i=this._getOrReturnCtx(e,i),H(i,{code:$.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),r.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(i=this._getOrReturnCtx(e,i),H(i,{code:$.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),r.dirty()):pe.assertNever(a);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new nl({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:K.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:K.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}nl.create=t=>new nl({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:M.ZodDate,...ae(t)});class ig extends he{_parse(e){if(this._getType(e)!==q.symbol){const r=this._getOrReturnCtx(e);return H(r,{code:$.invalid_type,expected:q.symbol,received:r.parsedType}),X}return Kt(e.data)}}ig.create=t=>new ig({typeName:M.ZodSymbol,...ae(t)});class ag extends he{_parse(e){if(this._getType(e)!==q.undefined){const r=this._getOrReturnCtx(e);return H(r,{code:$.invalid_type,expected:q.undefined,received:r.parsedType}),X}return Kt(e.data)}}ag.create=t=>new ag({typeName:M.ZodUndefined,...ae(t)});class sg extends he{_parse(e){if(this._getType(e)!==q.null){const r=this._getOrReturnCtx(e);return H(r,{code:$.invalid_type,expected:q.null,received:r.parsedType}),X}return Kt(e.data)}}sg.create=t=>new sg({typeName:M.ZodNull,...ae(t)});class wd extends he{constructor(){super(...arguments),this._any=!0}_parse(e){return Kt(e.data)}}wd.create=t=>new wd({typeName:M.ZodAny,...ae(t)});class og extends he{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Kt(e.data)}}og.create=t=>new og({typeName:M.ZodUnknown,...ae(t)});class Er extends he{_parse(e){const n=this._getOrReturnCtx(e);return H(n,{code:$.invalid_type,expected:q.never,received:n.parsedType}),X}}Er.create=t=>new Er({typeName:M.ZodNever,...ae(t)});class lg extends he{_parse(e){if(this._getType(e)!==q.undefined){const r=this._getOrReturnCtx(e);return H(r,{code:$.invalid_type,expected:q.void,received:r.parsedType}),X}return Kt(e.data)}}lg.create=t=>new lg({typeName:M.ZodVoid,...ae(t)});class Tn extends he{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),i=this._def;if(n.parsedType!==q.array)return H(n,{code:$.invalid_type,expected:q.array,received:n.parsedType}),X;if(i.exactLength!==null){const s=n.data.length>i.exactLength.value,o=n.data.length<i.exactLength.value;(s||o)&&(H(n,{code:s?$.too_big:$.too_small,minimum:o?i.exactLength.value:void 0,maximum:s?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),r.dirty())}if(i.minLength!==null&&n.data.length<i.minLength.value&&(H(n,{code:$.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),r.dirty()),i.maxLength!==null&&n.data.length>i.maxLength.value&&(H(n,{code:$.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((s,o)=>i.type._parseAsync(new xr(n,s,n.path,o)))).then(s=>Rt.mergeArray(r,s));const a=[...n.data].map((s,o)=>i.type._parseSync(new xr(n,s,n.path,o)));return Rt.mergeArray(r,a)}get element(){return this._def.type}min(e,n){return new Tn({...this._def,minLength:{value:e,message:K.toString(n)}})}max(e,n){return new Tn({...this._def,maxLength:{value:e,message:K.toString(n)}})}length(e,n){return new Tn({...this._def,exactLength:{value:e,message:K.toString(n)}})}nonempty(e){return this.min(1,e)}}Tn.create=(t,e)=>new Tn({type:t,minLength:null,maxLength:null,exactLength:null,typeName:M.ZodArray,...ae(e)});function li(t){if(t instanceof Ae){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=wr.create(li(r))}return new Ae({...t._def,shape:()=>e})}else return t instanceof Tn?new Tn({...t._def,type:li(t.element)}):t instanceof wr?wr.create(li(t.unwrap())):t instanceof Hi?Hi.create(li(t.unwrap())):t instanceof Kr?Kr.create(t.items.map(e=>li(e))):t}class Ae extends he{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=pe.objectKeys(e);return this._cached={shape:e,keys:n},this._cached}_parse(e){if(this._getType(e)!==q.object){const u=this._getOrReturnCtx(e);return H(u,{code:$.invalid_type,expected:q.object,received:u.parsedType}),X}const{status:r,ctx:i}=this._processInputParams(e),{shape:a,keys:s}=this._getCached(),o=[];if(!(this._def.catchall instanceof Er&&this._def.unknownKeys==="strip"))for(const u in i.data)s.includes(u)||o.push(u);const l=[];for(const u of s){const c=a[u],d=i.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new xr(i,d,i.path,u)),alwaysSet:u in i.data})}if(this._def.catchall instanceof Er){const u=this._def.unknownKeys;if(u==="passthrough")for(const c of o)l.push({key:{status:"valid",value:c},value:{status:"valid",value:i.data[c]}});else if(u==="strict")o.length>0&&(H(i,{code:$.unrecognized_keys,keys:o}),r.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const c of o){const d=i.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new xr(i,d,i.path,c)),alwaysSet:c in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const u=[];for(const c of l){const d=await c.key,f=await c.value;u.push({key:d,value:f,alwaysSet:c.alwaysSet})}return u}).then(u=>Rt.mergeObjectSync(r,u)):Rt.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(e){return K.errToObj,new Ae({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var a,s;const i=((s=(a=this._def).errorMap)==null?void 0:s.call(a,n,r).message)??r.defaultError;return n.code==="unrecognized_keys"?{message:K.errToObj(e).message??i}:{message:i}}}:{}})}strip(){return new Ae({...this._def,unknownKeys:"strip"})}passthrough(){return new Ae({...this._def,unknownKeys:"passthrough"})}extend(e){return new Ae({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Ae({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:M.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new Ae({...this._def,catchall:e})}pick(e){const n={};for(const r of pe.objectKeys(e))e[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new Ae({...this._def,shape:()=>n})}omit(e){const n={};for(const r of pe.objectKeys(this.shape))e[r]||(n[r]=this.shape[r]);return new Ae({...this._def,shape:()=>n})}deepPartial(){return li(this)}partial(e){const n={};for(const r of pe.objectKeys(this.shape)){const i=this.shape[r];e&&!e[r]?n[r]=i:n[r]=i.optional()}return new Ae({...this._def,shape:()=>n})}required(e){const n={};for(const r of pe.objectKeys(this.shape))if(e&&!e[r])n[r]=this.shape[r];else{let a=this.shape[r];for(;a instanceof wr;)a=a._def.innerType;n[r]=a}return new Ae({...this._def,shape:()=>n})}keyof(){return Uw(pe.objectKeys(this.shape))}}Ae.create=(t,e)=>new Ae({shape:()=>t,unknownKeys:"strip",catchall:Er.create(),typeName:M.ZodObject,...ae(e)});Ae.strictCreate=(t,e)=>new Ae({shape:()=>t,unknownKeys:"strict",catchall:Er.create(),typeName:M.ZodObject,...ae(e)});Ae.lazycreate=(t,e)=>new Ae({shape:t,unknownKeys:"strip",catchall:Er.create(),typeName:M.ZodObject,...ae(e)});class rl extends he{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function i(a){for(const o of a)if(o.result.status==="valid")return o.result;for(const o of a)if(o.result.status==="dirty")return n.common.issues.push(...o.ctx.common.issues),o.result;const s=a.map(o=>new Gn(o.ctx.common.issues));return H(n,{code:$.invalid_union,unionErrors:s}),X}if(n.common.async)return Promise.all(r.map(async a=>{const s={...n,common:{...n.common,issues:[]},parent:null};return{result:await a._parseAsync({data:n.data,path:n.path,parent:s}),ctx:s}})).then(i);{let a;const s=[];for(const l of r){const u={...n,common:{...n.common,issues:[]},parent:null},c=l._parseSync({data:n.data,path:n.path,parent:u});if(c.status==="valid")return c;c.status==="dirty"&&!a&&(a={result:c,ctx:u}),u.common.issues.length&&s.push(u.common.issues)}if(a)return n.common.issues.push(...a.ctx.common.issues),a.result;const o=s.map(l=>new Gn(l));return H(n,{code:$.invalid_union,unionErrors:o}),X}}get options(){return this._def.options}}rl.create=(t,e)=>new rl({options:t,typeName:M.ZodUnion,...ae(e)});function _d(t,e){const n=tr(t),r=tr(e);if(t===e)return{valid:!0,data:t};if(n===q.object&&r===q.object){const i=pe.objectKeys(e),a=pe.objectKeys(t).filter(o=>i.indexOf(o)!==-1),s={...t,...e};for(const o of a){const l=_d(t[o],e[o]);if(!l.valid)return{valid:!1};s[o]=l.data}return{valid:!0,data:s}}else if(n===q.array&&r===q.array){if(t.length!==e.length)return{valid:!1};const i=[];for(let a=0;a<t.length;a++){const s=t[a],o=e[a],l=_d(s,o);if(!l.valid)return{valid:!1};i.push(l.data)}return{valid:!0,data:i}}else return n===q.date&&r===q.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class il extends he{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),i=(a,s)=>{if(eg(a)||eg(s))return X;const o=_d(a.value,s.value);return o.valid?((tg(a)||tg(s))&&n.dirty(),{status:n.value,value:o.data}):(H(r,{code:$.invalid_intersection_types}),X)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([a,s])=>i(a,s)):i(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}il.create=(t,e,n)=>new il({left:t,right:e,typeName:M.ZodIntersection,...ae(n)});class Kr extends he{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==q.array)return H(r,{code:$.invalid_type,expected:q.array,received:r.parsedType}),X;if(r.data.length<this._def.items.length)return H(r,{code:$.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),X;!this._def.rest&&r.data.length>this._def.items.length&&(H(r,{code:$.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const a=[...r.data].map((s,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new xr(r,s,r.path,o)):null}).filter(s=>!!s);return r.common.async?Promise.all(a).then(s=>Rt.mergeArray(n,s)):Rt.mergeArray(n,a)}get items(){return this._def.items}rest(e){return new Kr({...this._def,rest:e})}}Kr.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Kr({items:t,typeName:M.ZodTuple,rest:null,...ae(e)})};class ug extends he{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==q.map)return H(r,{code:$.invalid_type,expected:q.map,received:r.parsedType}),X;const i=this._def.keyType,a=this._def.valueType,s=[...r.data.entries()].map(([o,l],u)=>({key:i._parse(new xr(r,o,r.path,[u,"key"])),value:a._parse(new xr(r,l,r.path,[u,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of s){const u=await l.key,c=await l.value;if(u.status==="aborted"||c.status==="aborted")return X;(u.status==="dirty"||c.status==="dirty")&&n.dirty(),o.set(u.value,c.value)}return{status:n.value,value:o}})}else{const o=new Map;for(const l of s){const u=l.key,c=l.value;if(u.status==="aborted"||c.status==="aborted")return X;(u.status==="dirty"||c.status==="dirty")&&n.dirty(),o.set(u.value,c.value)}return{status:n.value,value:o}}}}ug.create=(t,e,n)=>new ug({valueType:e,keyType:t,typeName:M.ZodMap,...ae(n)});class cs extends he{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==q.set)return H(r,{code:$.invalid_type,expected:q.set,received:r.parsedType}),X;const i=this._def;i.minSize!==null&&r.data.size<i.minSize.value&&(H(r,{code:$.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),n.dirty()),i.maxSize!==null&&r.data.size>i.maxSize.value&&(H(r,{code:$.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),n.dirty());const a=this._def.valueType;function s(l){const u=new Set;for(const c of l){if(c.status==="aborted")return X;c.status==="dirty"&&n.dirty(),u.add(c.value)}return{status:n.value,value:u}}const o=[...r.data.values()].map((l,u)=>a._parse(new xr(r,l,r.path,u)));return r.common.async?Promise.all(o).then(l=>s(l)):s(o)}min(e,n){return new cs({...this._def,minSize:{value:e,message:K.toString(n)}})}max(e,n){return new cs({...this._def,maxSize:{value:e,message:K.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}cs.create=(t,e)=>new cs({valueType:t,minSize:null,maxSize:null,typeName:M.ZodSet,...ae(e)});class cg extends he{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}cg.create=(t,e)=>new cg({getter:t,typeName:M.ZodLazy,...ae(e)});class dg extends he{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return H(n,{received:n.data,code:$.invalid_literal,expected:this._def.value}),X}return{status:"valid",value:e.data}}get value(){return this._def.value}}dg.create=(t,e)=>new dg({value:t,typeName:M.ZodLiteral,...ae(e)});function Uw(t,e){return new Ui({values:t,typeName:M.ZodEnum,...ae(e)})}class Ui extends he{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return H(n,{expected:pe.joinValues(r),received:n.parsedType,code:$.invalid_type}),X}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const n=this._getOrReturnCtx(e),r=this._def.values;return H(n,{received:n.data,code:$.invalid_enum_value,options:r}),X}return Kt(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return Ui.create(e,{...this._def,...n})}exclude(e,n=this._def){return Ui.create(this.options.filter(r=>!e.includes(r)),{...this._def,...n})}}Ui.create=Uw;class fg extends he{_parse(e){const n=pe.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==q.string&&r.parsedType!==q.number){const i=pe.objectValues(n);return H(r,{expected:pe.joinValues(i),received:r.parsedType,code:$.invalid_type}),X}if(this._cache||(this._cache=new Set(pe.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const i=pe.objectValues(n);return H(r,{received:r.data,code:$.invalid_enum_value,options:i}),X}return Kt(e.data)}get enum(){return this._def.values}}fg.create=(t,e)=>new fg({values:t,typeName:M.ZodNativeEnum,...ae(e)});class al extends he{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==q.promise&&n.common.async===!1)return H(n,{code:$.invalid_type,expected:q.promise,received:n.parsedType}),X;const r=n.parsedType===q.promise?n.data:Promise.resolve(n.data);return Kt(r.then(i=>this._def.type.parseAsync(i,{path:n.path,errorMap:n.common.contextualErrorMap})))}}al.create=(t,e)=>new al({type:t,typeName:M.ZodPromise,...ae(e)});class Bi extends he{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===M.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),i=this._def.effect||null,a={addIssue:s=>{H(r,s),s.fatal?n.abort():n.dirty()},get path(){return r.path}};if(a.addIssue=a.addIssue.bind(a),i.type==="preprocess"){const s=i.transform(r.data,a);if(r.common.async)return Promise.resolve(s).then(async o=>{if(n.value==="aborted")return X;const l=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return l.status==="aborted"?X:l.status==="dirty"||n.value==="dirty"?ba(l.value):l});{if(n.value==="aborted")return X;const o=this._def.schema._parseSync({data:s,path:r.path,parent:r});return o.status==="aborted"?X:o.status==="dirty"||n.value==="dirty"?ba(o.value):o}}if(i.type==="refinement"){const s=o=>{const l=i.refinement(o,a);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?X:(o.status==="dirty"&&n.dirty(),s(o.value),{status:n.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?X:(o.status==="dirty"&&n.dirty(),s(o.value).then(()=>({status:n.value,value:o.value}))))}if(i.type==="transform")if(r.common.async===!1){const s=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!zi(s))return X;const o=i.transform(s.value,a);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(s=>zi(s)?Promise.resolve(i.transform(s.value,a)).then(o=>({status:n.value,value:o})):X);pe.assertNever(i)}}Bi.create=(t,e,n)=>new Bi({schema:t,typeName:M.ZodEffects,effect:e,...ae(n)});Bi.createWithPreprocess=(t,e,n)=>new Bi({schema:e,effect:{type:"preprocess",transform:t},typeName:M.ZodEffects,...ae(n)});class wr extends he{_parse(e){return this._getType(e)===q.undefined?Kt(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}wr.create=(t,e)=>new wr({innerType:t,typeName:M.ZodOptional,...ae(e)});class Hi extends he{_parse(e){return this._getType(e)===q.null?Kt(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Hi.create=(t,e)=>new Hi({innerType:t,typeName:M.ZodNullable,...ae(e)});class bd extends he{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===q.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}bd.create=(t,e)=>new bd({innerType:t,typeName:M.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...ae(e)});class xd extends he{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},i=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return tl(i)?i.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Gn(r.common.issues)},input:r.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Gn(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}xd.create=(t,e)=>new xd({innerType:t,typeName:M.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...ae(e)});class hg extends he{_parse(e){if(this._getType(e)!==q.nan){const r=this._getOrReturnCtx(e);return H(r,{code:$.invalid_type,expected:q.nan,received:r.parsedType}),X}return{status:"valid",value:e.data}}}hg.create=t=>new hg({typeName:M.ZodNaN,...ae(t)});class _N extends he{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class ih extends he{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?X:a.status==="dirty"?(n.dirty(),ba(a.value)):this._def.out._parseAsync({data:a.value,path:r.path,parent:r})})();{const i=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?X:i.status==="dirty"?(n.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:r.path,parent:r})}}static create(e,n){return new ih({in:e,out:n,typeName:M.ZodPipeline})}}class Ed extends he{_parse(e){const n=this._def.innerType._parse(e),r=i=>(zi(i)&&(i.value=Object.freeze(i.value)),i);return tl(n)?n.then(i=>r(i)):r(n)}unwrap(){return this._def.innerType}}Ed.create=(t,e)=>new Ed({innerType:t,typeName:M.ZodReadonly,...ae(e)});Ae.lazycreate;var M;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(M||(M={}));const bN=lr.create,pg=wd.create;Er.create;Tn.create;const xN=Ae.create;Ae.strictCreate;rl.create;il.create;Kr.create;Ui.create;al.create;wr.create;Hi.create;var Fl={exports:{}},Bw={};function qt(t,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(t)),this._timeouts=t,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}var EN=qt;qt.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};qt.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};qt.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;var e=new Date().getTime();if(t&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(t),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(t);var n=this._timeouts.shift();if(n===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),n=this._cachedTimeouts.slice(-1);else return!1;var r=this;return this._timer=setTimeout(function(){r._attempts++,r._operationTimeoutCb&&(r._timeout=setTimeout(function(){r._operationTimeoutCb(r._attempts)},r._operationTimeout),r._options.unref&&r._timeout.unref()),r._fn(r._attempts)},n),this._options.unref&&this._timer.unref(),!0};qt.prototype.attempt=function(t,e){this._fn=t,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var n=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){n._operationTimeoutCb()},n._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};qt.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)};qt.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)};qt.prototype.start=qt.prototype.try;qt.prototype.errors=function(){return this._errors};qt.prototype.attempts=function(){return this._attempts};qt.prototype.mainError=function(){if(this._errors.length===0)return null;for(var t={},e=null,n=0,r=0;r<this._errors.length;r++){var i=this._errors[r],a=i.message,s=(t[a]||0)+1;t[a]=s,s>=n&&(e=i,n=s)}return e};(function(t){var e=EN;t.operation=function(n){var r=t.timeouts(n);return new e(r,{forever:n&&(n.forever||n.retries===1/0),unref:n&&n.unref,maxRetryTime:n&&n.maxRetryTime})},t.timeouts=function(n){if(n instanceof Array)return[].concat(n);var r={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var i in n)r[i]=n[i];if(r.minTimeout>r.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var a=[],s=0;s<r.retries;s++)a.push(this.createTimeout(s,r));return n&&n.forever&&!a.length&&a.push(this.createTimeout(s,r)),a.sort(function(o,l){return o-l}),a},t.createTimeout=function(n,r){var i=r.randomize?Math.random()+1:1,a=Math.round(i*Math.max(r.minTimeout,1)*Math.pow(r.factor,n));return a=Math.min(a,r.maxTimeout),a},t.wrap=function(n,r,i){if(r instanceof Array&&(i=r,r=null),!i){i=[];for(var a in n)typeof n[a]=="function"&&i.push(a)}for(var s=0;s<i.length;s++){var o=i[s],l=n[o];n[o]=(function(c){var d=t.operation(r),f=Array.prototype.slice.call(arguments,1),h=f.pop();f.push(function(m){d.retry(m)||(m&&(arguments[0]=d.mainError()),h.apply(this,arguments))}),d.attempt(function(){c.apply(n,f)})}).bind(n,l),n[o].options=r}}})(Bw);var SN=Bw;const kN=SN,CN=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class Hw extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}const TN=(t,e,n)=>{const r=n.retries-(e-1);return t.attemptNumber=e,t.retriesLeft=r,t},ON=t=>CN.includes(t),Gw=(t,e)=>new Promise((n,r)=>{e={onFailedAttempt:()=>{},retries:10,...e};const i=kN.operation(e);i.attempt(async a=>{try{n(await t(a))}catch(s){if(!(s instanceof Error)){r(new TypeError(`Non-error was thrown: "${s}". You should only throw errors.`));return}if(s instanceof Hw)i.stop(),r(s.originalError);else if(s instanceof TypeError&&!ON(s.message))i.stop(),r(s);else{TN(s,a,e);try{await e.onFailedAttempt(s)}catch(o){r(o);return}i.retry(s)||r(i.mainError())}}})});Fl.exports=Gw;Fl.exports.default=Gw;Fl.exports.AbortError=Hw;var NN=Fl.exports;const sl=ms(NN),IN=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function $a(t){return typeof t=="string"&&IN.test(t)}function AN(t){if(!$a(t))throw TypeError("Invalid UUID");var e,n=new Uint8Array(16);return n[0]=(e=parseInt(t.slice(0,8),16))>>>24,n[1]=e>>>16&255,n[2]=e>>>8&255,n[3]=e&255,n[4]=(e=parseInt(t.slice(9,13),16))>>>8,n[5]=e&255,n[6]=(e=parseInt(t.slice(14,18),16))>>>8,n[7]=e&255,n[8]=(e=parseInt(t.slice(19,23),16))>>>8,n[9]=e&255,n[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,n[11]=e/4294967296&255,n[12]=e>>>24&255,n[13]=e>>>16&255,n[14]=e>>>8&255,n[15]=e&255,n}var Ze=[];for(var Uu=0;Uu<256;++Uu)Ze.push((Uu+256).toString(16).slice(1));function Vw(t,e=0){return(Ze[t[e+0]]+Ze[t[e+1]]+Ze[t[e+2]]+Ze[t[e+3]]+"-"+Ze[t[e+4]]+Ze[t[e+5]]+"-"+Ze[t[e+6]]+Ze[t[e+7]]+"-"+Ze[t[e+8]]+Ze[t[e+9]]+"-"+Ze[t[e+10]]+Ze[t[e+11]]+Ze[t[e+12]]+Ze[t[e+13]]+Ze[t[e+14]]+Ze[t[e+15]]).toLowerCase()}var Qs,RN=new Uint8Array(16);function PN(){if(!Qs&&(Qs=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Qs))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Qs(RN)}function jN(t){t=unescape(encodeURIComponent(t));for(var e=[],n=0;n<t.length;++n)e.push(t.charCodeAt(n));return e}var LN="6ba7b810-9dad-11d1-80b4-00c04fd430c8",$N="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function MN(t,e,n){function r(i,a,s,o){var l;if(typeof i=="string"&&(i=jN(i)),typeof a=="string"&&(a=AN(a)),((l=a)===null||l===void 0?void 0:l.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var u=new Uint8Array(16+i.length);if(u.set(a),u.set(i,a.length),u=n(u),u[6]=u[6]&15|e,u[8]=u[8]&63|128,s){o=o||0;for(var c=0;c<16;++c)s[o+c]=u[c];return s}return Vw(u)}try{r.name=t}catch{}return r.DNS=LN,r.URL=$N,r}var DN=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const mg={randomUUID:DN};function lt(t,e,n){if(mg.randomUUID&&!e&&!t)return mg.randomUUID();t=t||{};var r=t.random||(t.rng||PN)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Vw(r)}function FN(t,e,n,r){switch(t){case 0:return e&n^~e&r;case 1:return e^n^r;case 2:return e&n^e&r^n&r;case 3:return e^n^r}}function Bu(t,e){return t<<e|t>>>32-e}function zN(t){var e=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof t=="string"){var r=unescape(encodeURIComponent(t));t=[];for(var i=0;i<r.length;++i)t.push(r.charCodeAt(i))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);for(var a=t.length/4+2,s=Math.ceil(a/16),o=new Array(s),l=0;l<s;++l){for(var u=new Uint32Array(16),c=0;c<16;++c)u[c]=t[l*64+c*4]<<24|t[l*64+c*4+1]<<16|t[l*64+c*4+2]<<8|t[l*64+c*4+3];o[l]=u}o[s-1][14]=(t.length-1)*8/Math.pow(2,32),o[s-1][14]=Math.floor(o[s-1][14]),o[s-1][15]=(t.length-1)*8&4294967295;for(var d=0;d<s;++d){for(var f=new Uint32Array(80),h=0;h<16;++h)f[h]=o[d][h];for(var m=16;m<80;++m)f[m]=Bu(f[m-3]^f[m-8]^f[m-14]^f[m-16],1);for(var v=n[0],_=n[1],p=n[2],y=n[3],g=n[4],x=0;x<80;++x){var k=Math.floor(x/20),S=Bu(v,5)+FN(k,_,p,y)+g+e[k]+f[x]>>>0;g=y,y=p,p=Bu(_,30)>>>0,_=v,v=S}n[0]=n[0]+v>>>0,n[1]=n[1]+_>>>0,n[2]=n[2]+p>>>0,n[3]=n[3]+y>>>0,n[4]=n[4]+g>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,n[0]&255,n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,n[1]&255,n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,n[2]&255,n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,n[3]&255,n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,n[4]&255]}var gg=MN("v5",80,zN);let UN=class{getStore(){}run(e,n){return n()}};const Hu=Symbol.for("ls:tracing_async_local_storage"),BN=new UN;let HN=class{getInstance(){return globalThis[Hu]??BN}initializeGlobalInstance(e){globalThis[Hu]===void 0&&(globalThis[Hu]=e)}};const GN=new HN;function VN(t=!1){const e=GN.getInstance().getStore();if(!t&&e===void 0)throw new Error(`Could not get the current run tree.

Please make sure you are calling this method within a traceable function and that tracing is enabled.`);return e}function ah(t){return typeof t=="function"&&"langsmith:traceable"in t}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */const WN=Object.prototype.hasOwnProperty;function Sd(t,e){return WN.call(t,e)}function kd(t){if(Array.isArray(t)){const n=new Array(t.length);for(let r=0;r<n.length;r++)n[r]=""+r;return n}if(Object.keys)return Object.keys(t);let e=[];for(let n in t)Sd(t,n)&&e.push(n);return e}function Sn(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function Cd(t){let e=0;const n=t.length;let r;for(;e<n;){if(r=t.charCodeAt(e),r>=48&&r<=57){e++;continue}return!1}return!0}function ai(t){return t.indexOf("/")===-1&&t.indexOf("~")===-1?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function ZN(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function Td(t){if(t===void 0)return!0;if(t){if(Array.isArray(t)){for(let n=0,r=t.length;n<r;n++)if(Td(t[n]))return!0}else if(typeof t=="object"){const n=kd(t),r=n.length;for(var e=0;e<r;e++)if(Td(t[n[e]]))return!0}}return!1}function yg(t,e){const n=[t];for(const r in e){const i=typeof e[r]=="object"?JSON.stringify(e[r],null,2):e[r];typeof i<"u"&&n.push(`${r}: ${i}`)}return n.join(`
`)}class qN extends Error{constructor(e,n,r,i,a){super(yg(e,{name:n,index:r,operation:i,tree:a})),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"index",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"operation",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"tree",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.setPrototypeOf(this,new.target.prototype),this.message=yg(e,{name:n,index:r,operation:i,tree:a})}}const Le=qN,xi={add:function(t,e,n){return t[e]=this.value,{newDocument:n}},remove:function(t,e,n){var r=t[e];return delete t[e],{newDocument:n,removed:r}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:function(t,e,n){let r=Od(n,this.path);r&&(r=Sn(r));const i=Ma(n,{op:"remove",path:this.from}).removed;return Ma(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(t,e,n){const r=Od(n,this.from);return Ma(n,{op:"add",path:this.path,value:Sn(r)}),{newDocument:n}},test:function(t,e,n){return{newDocument:n,test:ll(t[e],this.value)}},_get:function(t,e,n){return this.value=t[e],{newDocument:n}}};var KN={add:function(t,e,n){return Cd(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:n,index:e}},remove:function(t,e,n){var r=t.splice(e,1);return{newDocument:n,removed:r[0]}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:xi.move,copy:xi.copy,test:xi.test,_get:xi._get};function Od(t,e){if(e=="")return t;var n={op:"_get",path:e};return Ma(t,n),n.value}function Ma(t,e,n=!1,r=!0,i=!0,a=0){if(n&&(typeof n=="function"?n(e,0,t,e.path):Nd(e,0)),e.path===""){let s={newDocument:t};if(e.op==="add")return s.newDocument=e.value,s;if(e.op==="replace")return s.newDocument=e.value,s.removed=t,s;if(e.op==="move"||e.op==="copy")return s.newDocument=Od(t,e.from),e.op==="move"&&(s.removed=t),s;if(e.op==="test"){if(s.test=ll(t,e.value),s.test===!1)throw new Le("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return s.newDocument=t,s}else{if(e.op==="remove")return s.removed=t,s.newDocument=null,s;if(e.op==="_get")return e.value=t,s;if(n)throw new Le("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,e,t);return s}}else{r||(t=Sn(t));const o=(e.path||"").split("/");let l=t,u=1,c=o.length,d,f,h;for(typeof n=="function"?h=n:h=Nd;;){if(f=o[u],f&&f.indexOf("~")!=-1&&(f=ZN(f)),i&&(f=="__proto__"||f=="prototype"&&u>0&&o[u-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(l[f]===void 0?d=o.slice(0,u).join("/"):u==c-1&&(d=e.path),d!==void 0&&h(e,0,t,d)),u++,Array.isArray(l)){if(f==="-")f=l.length;else{if(n&&!Cd(f))throw new Le("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,e,t);Cd(f)&&(f=~~f)}if(u>=c){if(n&&e.op==="add"&&f>l.length)throw new Le("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,e,t);const m=KN[e.op].call(e,l,f,t);if(m.test===!1)throw new Le("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return m}}else if(u>=c){const m=xi[e.op].call(e,l,f,t);if(m.test===!1)throw new Le("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return m}if(l=l[f],n&&u<c&&(!l||typeof l!="object"))throw new Le("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",a,e,t)}}}function ol(t,e,n,r=!0,i=!0){if(n&&!Array.isArray(e))throw new Le("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(t=Sn(t));const a=new Array(e.length);for(let s=0,o=e.length;s<o;s++)a[s]=Ma(t,e[s],n,!0,i,s),t=a[s].newDocument;return a.newDocument=t,a}function Nd(t,e,n,r){if(typeof t!="object"||t===null||Array.isArray(t))throw new Le("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,n);if(xi[t.op]){if(typeof t.path!="string")throw new Le("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,n);if(t.path.indexOf("/")!==0&&t.path.length>0)throw new Le('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,n);if((t.op==="move"||t.op==="copy")&&typeof t.from!="string")throw new Le("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&t.value===void 0)throw new Le("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&Td(t.value))throw new Le("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,n);if(n){if(t.op=="add"){var i=t.path.split("/").length,a=r.split("/").length;if(i!==a+1&&i!==a)throw new Le("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,n)}else if(t.op==="replace"||t.op==="remove"||t.op==="_get"){if(t.path!==r)throw new Le("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,n)}else if(t.op==="move"||t.op==="copy"){var s={op:"_get",path:t.from,value:void 0},o=JN([s],n);if(o&&o.name==="OPERATION_PATH_UNRESOLVABLE")throw new Le("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,n)}}}else throw new Le("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,n)}function JN(t,e,n){try{if(!Array.isArray(t))throw new Le("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)ol(Sn(e),Sn(t),n||!0);else{n=n||Nd;for(var r=0;r<t.length;r++)n(t[r],r,e,void 0)}}catch(i){if(i instanceof Le)return i;throw i}}function ll(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){var n=Array.isArray(t),r=Array.isArray(e),i,a,s;if(n&&r){if(a=t.length,a!=e.length)return!1;for(i=a;i--!==0;)if(!ll(t[i],e[i]))return!1;return!0}if(n!=r)return!1;var o=Object.keys(t);if(a=o.length,a!==Object.keys(e).length)return!1;for(i=a;i--!==0;)if(!e.hasOwnProperty(o[i]))return!1;for(i=a;i--!==0;)if(s=o[i],!ll(t[s],e[s]))return!1;return!0}return t!==t&&e!==e}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2013-2021 Joachim Wester
 * MIT license
 */function Ww(t,e,n,r,i){if(e!==t){typeof e.toJSON=="function"&&(e=e.toJSON());for(var a=kd(e),s=kd(t),o=!1,l=s.length-1;l>=0;l--){var u=s[l],c=t[u];if(Sd(e,u)&&!(e[u]===void 0&&c!==void 0&&Array.isArray(e)===!1)){var d=e[u];typeof c=="object"&&c!=null&&typeof d=="object"&&d!=null&&Array.isArray(c)===Array.isArray(d)?Ww(c,d,n,r+"/"+ai(u),i):c!==d&&(i&&n.push({op:"test",path:r+"/"+ai(u),value:Sn(c)}),n.push({op:"replace",path:r+"/"+ai(u),value:Sn(d)}))}else Array.isArray(t)===Array.isArray(e)?(i&&n.push({op:"test",path:r+"/"+ai(u),value:Sn(c)}),n.push({op:"remove",path:r+"/"+ai(u)}),o=!0):(i&&n.push({op:"test",path:r,value:t}),n.push({op:"replace",path:r,value:e}))}if(!(!o&&a.length==s.length))for(var l=0;l<a.length;l++){var u=a[l];!Sd(t,u)&&e[u]!==void 0&&n.push({op:"add",path:r+"/"+ai(u),value:Sn(e[u])})}}}function YN(t,e,n=!1){var r=[];return Ww(t,e,r,"",n),r}const QN="gen_ai.operation.name",XN="gen_ai.system",vg="gen_ai.request.model",eI="gen_ai.response.model",wg="gen_ai.usage.input_tokens",_g="gen_ai.usage.output_tokens",bg="gen_ai.usage.total_tokens",tI="gen_ai.request.max_tokens",nI="gen_ai.request.temperature",rI="gen_ai.request.top_p",iI="gen_ai.request.frequency_penalty",aI="gen_ai.request.presence_penalty",sI="gen_ai.response.finish_reasons",oI="gen_ai.prompt",lI="gen_ai.completion",uI="gen_ai.request.extra_query",cI="gen_ai.request.extra_body",dI="gen_ai.serialized.name",fI="gen_ai.serialized.signature",hI="gen_ai.serialized.doc",pI="gen_ai.response.id",mI="gen_ai.response.service_tier",gI="gen_ai.response.system_fingerprint",yI="gen_ai.usage.input_token_details",vI="gen_ai.usage.output_token_details",wI="langsmith.trace.session_id",_I="langsmith.trace.session_name",bI="langsmith.span.kind",xI="langsmith.trace.name",EI="langsmith.metadata",xg="langsmith.span.tags",SI="langsmith.request.streaming",kI="langsmith.request.headers",CI=(...t)=>fetch(...t),Zw=Symbol.for("ls:fetch_implementation"),TI=()=>{const t=globalThis[Zw];return t?typeof t=="function"&&"Headers"in t&&"Request"in t&&"Response"in t:!1},J=t=>async(...e)=>{if(t||Bt("DEBUG")==="true"){const[r,i]=e;console.log(` ${(i==null?void 0:i.method)||"GET"} ${r}`)}const n=await(globalThis[Zw]??CI)(...e);return(t||Bt("DEBUG")==="true")&&console.log(` ${n.status} ${n.statusText} ${n.url}`),n},qw=()=>Bt("PROJECT")??ln("LANGCHAIN_SESSION")??"default",Kw="0.3.46";var Da={};let Rn;const OI=()=>typeof window<"u"&&typeof window.document<"u",NI=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",II=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&navigator.userAgent.includes("jsdom"),Jw=()=>typeof Deno<"u",AI=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!Jw(),RI=()=>Rn||(OI()?Rn="browser":AI()?Rn="node":NI()?Rn="webworker":II()?Rn="jsdom":Jw()?Rn="deno":Rn="other",Rn);let Gu;function Yw(){if(Gu===void 0){const t=RI(),e=LI();Gu={library:"langsmith",runtime:t,sdk:"langsmith-js",sdk_version:Kw,...e}}return Gu}function PI(){const t=jI()||{},e={},n=["LANGCHAIN_API_KEY","LANGCHAIN_ENDPOINT","LANGCHAIN_TRACING_V2","LANGCHAIN_PROJECT","LANGCHAIN_SESSION","LANGSMITH_API_KEY","LANGSMITH_ENDPOINT","LANGSMITH_TRACING_V2","LANGSMITH_PROJECT","LANGSMITH_SESSION"];for(const[r,i]of Object.entries(t))(r.startsWith("LANGCHAIN_")||r.startsWith("LANGSMITH_"))&&typeof i=="string"&&!n.includes(r)&&!r.toLowerCase().includes("key")&&!r.toLowerCase().includes("secret")&&!r.toLowerCase().includes("token")&&(r==="LANGCHAIN_REVISION_ID"?e.revision_id=i:e[r]=i);return e}function jI(){try{return typeof process<"u"&&Da?Object.entries(Da).reduce((t,[e,n])=>(t[e]=String(n),t),{}):void 0}catch{return}}function ln(t){try{return typeof process<"u"?Da==null?void 0:Da[t]:void 0}catch{return}}function Bt(t){return ln(`LANGSMITH_${t}`)||ln(`LANGCHAIN_${t}`)}let Vu;function LI(){if(Vu!==void 0)return Vu;const t=["VERCEL_GIT_COMMIT_SHA","NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA","COMMIT_REF","RENDER_GIT_COMMIT","CI_COMMIT_SHA","CIRCLE_SHA1","CF_PAGES_COMMIT_SHA","REACT_APP_GIT_SHA","SOURCE_VERSION","GITHUB_SHA","TRAVIS_COMMIT","GIT_COMMIT","BUILD_VCS_NUMBER","bamboo_planRepository_revision","Build.SourceVersion","BITBUCKET_COMMIT","DRONE_COMMIT_SHA","SEMAPHORE_GIT_SHA","BUILDKITE_COMMIT"],e={};for(const n of t){const r=ln(n);r!==void 0&&(e[n]=r)}return Vu=e,e}class $I{constructor(){Object.defineProperty(this,"hasWarned",{enumerable:!0,configurable:!0,writable:!0,value:!1})}startActiveSpan(e,...n){!this.hasWarned&&ln("OTEL_ENABLED")==="true"&&(console.warn('You have enabled OTEL export via the `OTEL_ENABLED` environment variable, but have not initialized the required OTEL instances. Please add:\n```\nimport { initializeOTEL } from "langsmith/experimental/otel/setup";\ninitializeOTEL();\n```\nat the beginning of your code.'),this.hasWarned=!0);let r;if(n.length===1&&typeof n[0]=="function"?r=n[0]:n.length===2&&typeof n[1]=="function"?r=n[1]:n.length===3&&typeof n[2]=="function"&&(r=n[2]),typeof r=="function")return r()}}class MI{constructor(){Object.defineProperty(this,"mockTracer",{enumerable:!0,configurable:!0,writable:!0,value:new $I})}getTracer(e,n){return this.mockTracer}getActiveSpan(){}setSpan(e,n){return e}getSpan(e){}setSpanContext(e,n){return e}getTracerProvider(){}setGlobalTracerProvider(e){return!1}}class DI{active(){return{}}with(e,n){return n()}}const Wu=Symbol.for("ls:otel_trace"),Zu=Symbol.for("ls:otel_context"),Eg=Symbol.for("ls:otel_get_default_otlp_tracer_provider"),FI=new MI,zI=new DI;class UI{getTraceInstance(){return globalThis[Wu]??FI}getContextInstance(){return globalThis[Zu]??zI}initializeGlobalInstances(e){globalThis[Wu]===void 0&&(globalThis[Wu]=e.trace),globalThis[Zu]===void 0&&(globalThis[Zu]=e.context)}setDefaultOTLPTracerComponents(e){globalThis[Eg]=e}getDefaultOTLPTracerComponents(){return globalThis[Eg]??void 0}}const sh=new UI;function Qw(){return sh.getTraceInstance()}function BI(){return sh.getContextInstance()}function HI(){return sh.getDefaultOTLPTracerComponents()}const GI={llm:"chat",tool:"execute_tool",retriever:"embeddings",embedding:"embeddings",prompt:"chat"};function VI(t){return GI[t]||t}class WI{constructor(){Object.defineProperty(this,"spans",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}exportBatch(e,n){for(const r of e)try{if(!r.run)continue;if(r.operation==="post"){const i=this.createSpanForRun(r,r.run,n.get(r.id));i&&!r.run.end_time&&this.spans.set(r.id,i)}else this.updateSpanForRun(r,r.run)}catch(i){console.error(`Error processing operation ${r.id}:`,i)}}createSpanForRun(e,n,r){const i=r&&Qw().getSpan(r);if(i)try{return this.finishSpanSetup(i,n,e)}catch(a){console.error(`Failed to create span for run ${e.id}:`,a);return}}finishSpanSetup(e,n,r){return this.setSpanAttributes(e,n,r),n.error?(e.setStatus({code:2}),e.recordException(new Error(n.error))):e.setStatus({code:1}),n.end_time&&e.end(new Date(n.end_time)),e}updateSpanForRun(e,n){try{const r=this.spans.get(e.id);if(!r){console.debug(`No span found for run ${e.id} during update`);return}this.setSpanAttributes(r,n,e),n.error?(r.setStatus({code:2}),r.recordException(new Error(n.error))):r.setStatus({code:1});const i=n.end_time;i&&(r.end(new Date(i)),this.spans.delete(e.id))}catch(r){console.error(`Failed to update span for run ${e.id}:`,r)}}extractModelName(e){var n;if((n=e.extra)!=null&&n.metadata){const r=e.extra.metadata;if(r.ls_model_name)return r.ls_model_name;if(r.invocation_params){const i=r.invocation_params;if(i.model)return i.model;if(i.model_name)return i.model_name}}}setSpanAttributes(e,n,r){var o;if("run_type"in n&&n.run_type){e.setAttribute(bI,n.run_type);const l=VI(n.run_type||"chain");e.setAttribute(QN,l)}"name"in n&&n.name&&e.setAttribute(xI,n.name),"session_id"in n&&n.session_id&&e.setAttribute(wI,n.session_id),"session_name"in n&&n.session_name&&e.setAttribute(_I,n.session_name),this.setGenAiSystem(e,n);const i=this.extractModelName(n);i&&e.setAttribute(vg,i),"prompt_tokens"in n&&typeof n.prompt_tokens=="number"&&e.setAttribute(wg,n.prompt_tokens),"completion_tokens"in n&&typeof n.completion_tokens=="number"&&e.setAttribute(_g,n.completion_tokens),"total_tokens"in n&&typeof n.total_tokens=="number"&&e.setAttribute(bg,n.total_tokens),this.setInvocationParameters(e,n);const a=((o=n.extra)==null?void 0:o.metadata)||{};for(const[l,u]of Object.entries(a))u!=null&&e.setAttribute(`${EI}.${l}`,String(u));const s=n.tags;if(s&&Array.isArray(s)?e.setAttribute(xg,s.join(", ")):s&&e.setAttribute(xg,String(s)),"serialized"in n&&typeof n.serialized=="object"){const l=n.serialized;l.name&&e.setAttribute(dI,String(l.name)),l.signature&&e.setAttribute(fI,String(l.signature)),l.doc&&e.setAttribute(hI,String(l.doc))}this.setIOAttributes(e,r)}setGenAiSystem(e,n){let r="langchain";const i=this.extractModelName(n);if(i){const a=i.toLowerCase();a.includes("anthropic")||a.startsWith("claude")?r="anthropic":a.includes("bedrock")?r="aws.bedrock":a.includes("azure")&&a.includes("openai")?r="az.ai.openai":a.includes("azure")&&a.includes("inference")?r="az.ai.inference":a.includes("cohere")?r="cohere":a.includes("deepseek")?r="deepseek":a.includes("gemini")?r="gemini":a.includes("groq")?r="groq":a.includes("watson")||a.includes("ibm")?r="ibm.watsonx.ai":a.includes("mistral")?r="mistral_ai":a.includes("gpt")||a.includes("openai")?r="openai":a.includes("perplexity")||a.includes("sonar")?r="perplexity":a.includes("vertex")?r="vertex_ai":(a.includes("xai")||a.includes("grok"))&&(r="xai")}e.setAttribute(XN,r)}setInvocationParameters(e,n){var i,a;if(!((a=(i=n.extra)==null?void 0:i.metadata)!=null&&a.invocation_params))return;const r=n.extra.metadata.invocation_params;r.max_tokens!==void 0&&e.setAttribute(tI,r.max_tokens),r.temperature!==void 0&&e.setAttribute(nI,r.temperature),r.top_p!==void 0&&e.setAttribute(rI,r.top_p),r.frequency_penalty!==void 0&&e.setAttribute(iI,r.frequency_penalty),r.presence_penalty!==void 0&&e.setAttribute(aI,r.presence_penalty)}setIOAttributes(e,n){if(n.run.inputs)try{const r=n.run.inputs;typeof r=="object"&&r!==null&&(r.model&&Array.isArray(r.messages)&&e.setAttribute(vg,r.model),r.stream!==void 0&&e.setAttribute(SI,r.stream),r.extra_headers&&e.setAttribute(kI,JSON.stringify(r.extra_headers)),r.extra_query&&e.setAttribute(uI,JSON.stringify(r.extra_query)),r.extra_body&&e.setAttribute(cI,JSON.stringify(r.extra_body))),e.setAttribute(oI,JSON.stringify(r))}catch(r){console.debug(`Failed to process inputs for run ${n.id}`,r)}if(n.run.outputs)try{const r=n.run.outputs,i=this.getUnifiedRunTokens(r);if(i&&(e.setAttribute(wg,i[0]),e.setAttribute(_g,i[1]),e.setAttribute(bg,i[0]+i[1])),r&&typeof r=="object"){if(r.model&&e.setAttribute(eI,String(r.model)),r.id&&e.setAttribute(pI,r.id),r.choices&&Array.isArray(r.choices)){const a=r.choices.map(s=>s.finish_reason).filter(s=>s).map(String);a.length>0&&e.setAttribute(sI,a.join(", "))}if(r.service_tier&&e.setAttribute(mI,r.service_tier),r.system_fingerprint&&e.setAttribute(gI,r.system_fingerprint),r.usage_metadata&&typeof r.usage_metadata=="object"){const a=r.usage_metadata;a.input_token_details&&e.setAttribute(yI,JSON.stringify(a.input_token_details)),a.output_token_details&&e.setAttribute(vI,JSON.stringify(a.output_token_details))}}e.setAttribute(lI,JSON.stringify(r))}catch(r){console.debug(`Failed to process outputs for run ${n.id}`,r)}}getUnifiedRunTokens(e){if(!e)return null;let n=this.extractUnifiedRunTokens(e.usage_metadata);if(n)return n;const r=Object.keys(e);for(const s of r){const o=e[s];if(!(!o||typeof o!="object")&&(n=this.extractUnifiedRunTokens(o.usage_metadata),n||o.lc===1&&o.kwargs&&typeof o.kwargs=="object"&&(n=this.extractUnifiedRunTokens(o.kwargs.usage_metadata),n)))return n}const i=e.generations||[];if(!Array.isArray(i))return null;const a=Array.isArray(i[0])?i.flat():i;for(const s of a)if(typeof s=="object"&&s.message&&typeof s.message=="object"&&s.message.kwargs&&typeof s.message.kwargs=="object"&&(n=this.extractUnifiedRunTokens(s.message.kwargs.usage_metadata),n))return n;return null}extractUnifiedRunTokens(e){return!e||typeof e!="object"||typeof e.input_tokens!="number"||typeof e.output_tokens!="number"?null:[e.input_tokens,e.output_tokens]}}var Xw={},e_={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function a(l,u,c,d,f){if(typeof c!="function")throw new TypeError("The listener must be a function");var h=new i(c,d||l,f),m=n?n+u:u;return l._events[m]?l._events[m].fn?l._events[m]=[l._events[m],h]:l._events[m].push(h):(l._events[m]=h,l._eventsCount++),l}function s(l,u){--l._eventsCount===0?l._events=new r:delete l._events[u]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],c,d;if(this._eventsCount===0)return u;for(d in c=this._events)e.call(c,d)&&u.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},o.prototype.listeners=function(u){var c=n?n+u:u,d=this._events[c];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,h=d.length,m=new Array(h);f<h;f++)m[f]=d[f].fn;return m},o.prototype.listenerCount=function(u){var c=n?n+u:u,d=this._events[c];return d?d.fn?1:d.length:0},o.prototype.emit=function(u,c,d,f,h,m){var v=n?n+u:u;if(!this._events[v])return!1;var _=this._events[v],p=arguments.length,y,g;if(_.fn){switch(_.once&&this.removeListener(u,_.fn,void 0,!0),p){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,c),!0;case 3:return _.fn.call(_.context,c,d),!0;case 4:return _.fn.call(_.context,c,d,f),!0;case 5:return _.fn.call(_.context,c,d,f,h),!0;case 6:return _.fn.call(_.context,c,d,f,h,m),!0}for(g=1,y=new Array(p-1);g<p;g++)y[g-1]=arguments[g];_.fn.apply(_.context,y)}else{var x=_.length,k;for(g=0;g<x;g++)switch(_[g].once&&this.removeListener(u,_[g].fn,void 0,!0),p){case 1:_[g].fn.call(_[g].context);break;case 2:_[g].fn.call(_[g].context,c);break;case 3:_[g].fn.call(_[g].context,c,d);break;case 4:_[g].fn.call(_[g].context,c,d,f);break;default:if(!y)for(k=1,y=new Array(p-1);k<p;k++)y[k-1]=arguments[k];_[g].fn.apply(_[g].context,y)}}return!0},o.prototype.on=function(u,c,d){return a(this,u,c,d,!1)},o.prototype.once=function(u,c,d){return a(this,u,c,d,!0)},o.prototype.removeListener=function(u,c,d,f){var h=n?n+u:u;if(!this._events[h])return this;if(!c)return s(this,h),this;var m=this._events[h];if(m.fn)m.fn===c&&(!f||m.once)&&(!d||m.context===d)&&s(this,h);else{for(var v=0,_=[],p=m.length;v<p;v++)(m[v].fn!==c||f&&!m[v].once||d&&m[v].context!==d)&&_.push(m[v]);_.length?this._events[h]=_.length===1?_[0]:_:s(this,h)}return this},o.prototype.removeAllListeners=function(u){var c;return u?(c=n?n+u:u,this._events[c]&&s(this,c)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,t.exports=o})(e_);var ZI=e_.exports,zl={exports:{}},qI=(t,e)=>(e=e||(()=>{}),t.then(n=>new Promise(r=>{r(e())}).then(()=>n),n=>new Promise(r=>{r(e())}).then(()=>{throw n})));const KI=qI;class t_ extends Error{constructor(e){super(e),this.name="TimeoutError"}}const n_=(t,e,n)=>new Promise((r,i)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){r(t);return}const a=setTimeout(()=>{if(typeof n=="function"){try{r(n())}catch(l){i(l)}return}const s=typeof n=="string"?n:`Promise timed out after ${e} milliseconds`,o=n instanceof Error?n:new t_(s);typeof t.cancel=="function"&&t.cancel(),i(o)},e);KI(t.then(r,i),()=>{clearTimeout(a)})});zl.exports=n_;zl.exports.default=n_;zl.exports.TimeoutError=t_;var JI=zl.exports,oh={},lh={};Object.defineProperty(lh,"__esModule",{value:!0});function YI(t,e,n){let r=0,i=t.length;for(;i>0;){const a=i/2|0;let s=r+a;n(t[s],e)<=0?(r=++s,i-=a+1):i=a}return r}lh.default=YI;Object.defineProperty(oh,"__esModule",{value:!0});const QI=lh;class XI{constructor(){this._queue=[]}enqueue(e,n){n=Object.assign({priority:0},n);const r={priority:n.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=n.priority){this._queue.push(r);return}const i=QI.default(this._queue,r,(a,s)=>s.priority-a.priority);this._queue.splice(i,0,r)}dequeue(){const e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(n=>n.priority===e.priority).map(n=>n.run)}get size(){return this._queue.length}}oh.default=XI;Object.defineProperty(Xw,"__esModule",{value:!0});const eA=ZI,r_=JI,tA=oh,Xs=()=>{},nA=new r_.TimeoutError;class rA extends eA{constructor(e){var n,r,i,a;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=Xs,this._resolveIdle=Xs,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:tA.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(r=(n=e.intervalCap)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(a=(i=e.interval)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=Xs,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=Xs,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(this._intervalId===void 0){const n=this._intervalEnd-e;if(n<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},n)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const n=this._queue.dequeue();return n?(this.emit("active"),n(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,n={}){return new Promise((r,i)=>{const a=async()=>{this._pendingCount++,this._intervalCount++;try{const s=this._timeout===void 0&&n.timeout===void 0?e():r_.default(Promise.resolve(e()),n.timeout===void 0?this._timeout:n.timeout,()=>{(n.throwOnTimeout===void 0?this._throwOnTimeout:n.throwOnTimeout)&&i(nA)});r(await s)}catch(s){i(s)}this._next()};this._queue.enqueue(a,n),this._tryToStartAnother(),this.emit("add")})}async addAll(e,n){return Promise.all(e.map(async r=>this.add(r,n)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{const n=this._resolveEmpty;this._resolveEmpty=()=>{n(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{const n=this._resolveIdle;this._resolveIdle=()=>{n(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}var Fn=Xw.default=rA;const iA=[400,401,403,404,405,406,407,408],aA=[409];let Sg=class{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedResponseHook",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"debug",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.debug=e.debug,"default"in Fn?this.queue=new Fn.default({concurrency:this.maxConcurrency}):this.queue=new Fn({concurrency:this.maxConcurrency}),this.onFailedResponseHook=e==null?void 0:e.onFailedResponseHook}call(e,...n){const r=this.onFailedResponseHook;return this.queue.add(()=>sl(()=>e(...n).catch(i=>{throw i instanceof Error?i:new Error(i)}),{async onFailedAttempt(i){if(i.message.startsWith("Cancel")||i.message.startsWith("TimeoutError")||i.message.startsWith("AbortError")||(i==null?void 0:i.code)==="ECONNABORTED")throw i;const a=i==null?void 0:i.response,s=a==null?void 0:a.status;if(s){if(iA.includes(+s))throw i;if(aA.includes(+s))return;r&&await r(a)}},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,n,...r){return e.signal?Promise.race([this.call(n,...r),new Promise((i,a)=>{var s;(s=e.signal)==null||s.addEventListener("abort",()=>{a(new Error("AbortError"))})})]):this.call(n,...r)}fetch(...e){return this.call(()=>J(this.debug)(...e).then(n=>n.ok?n:Promise.reject(n)))}};function kg(t){return typeof(t==null?void 0:t._getType)=="function"}function Cg(t){const e={type:t._getType(),data:{content:t.content}};return t!=null&&t.additional_kwargs&&Object.keys(t.additional_kwargs).length>0&&(e.data.additional_kwargs={...t.additional_kwargs}),e}const sA=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function te(t,e){if(!sA.test(t)){const n=e!==void 0?`Invalid UUID for ${e}: ${t}`:`Invalid UUID: ${t}`;throw new Error(n)}return t}const Tg={};function i_(t){Tg[t]||(console.warn(t),Tg[t]=!0)}var Id={exports:{}};const oA="2.0.0",a_=256,lA=Number.MAX_SAFE_INTEGER||9007199254740991,uA=16,cA=a_-6,dA=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var Ul={MAX_LENGTH:a_,MAX_SAFE_COMPONENT_LENGTH:uA,MAX_SAFE_BUILD_LENGTH:cA,MAX_SAFE_INTEGER:lA,RELEASE_TYPES:dA,SEMVER_SPEC_VERSION:oA,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},qu={};const fA=typeof process=="object"&&qu&&qu.NODE_DEBUG&&/\bsemver\b/i.test(qu.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};var Bl=fA;(function(t,e){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:i}=Ul,a=Bl;e=t.exports={};const s=e.re=[],o=e.safeRe=[],l=e.src=[],u=e.safeSrc=[],c=e.t={};let d=0;const f="[a-zA-Z0-9-]",h=[["\\s",1],["\\d",i],[f,r]],m=_=>{for(const[p,y]of h)_=_.split(`${p}*`).join(`${p}{0,${y}}`).split(`${p}+`).join(`${p}{1,${y}}`);return _},v=(_,p,y)=>{const g=m(p),x=d++;a(_,x,p),c[_]=x,l[x]=p,u[x]=g,s[x]=new RegExp(p,y?"g":void 0),o[x]=new RegExp(g,y?"g":void 0)};v("NUMERICIDENTIFIER","0|[1-9]\\d*"),v("NUMERICIDENTIFIERLOOSE","\\d+"),v("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${f}*`),v("MAINVERSION",`(${l[c.NUMERICIDENTIFIER]})\\.(${l[c.NUMERICIDENTIFIER]})\\.(${l[c.NUMERICIDENTIFIER]})`),v("MAINVERSIONLOOSE",`(${l[c.NUMERICIDENTIFIERLOOSE]})\\.(${l[c.NUMERICIDENTIFIERLOOSE]})\\.(${l[c.NUMERICIDENTIFIERLOOSE]})`),v("PRERELEASEIDENTIFIER",`(?:${l[c.NONNUMERICIDENTIFIER]}|${l[c.NUMERICIDENTIFIER]})`),v("PRERELEASEIDENTIFIERLOOSE",`(?:${l[c.NONNUMERICIDENTIFIER]}|${l[c.NUMERICIDENTIFIERLOOSE]})`),v("PRERELEASE",`(?:-(${l[c.PRERELEASEIDENTIFIER]}(?:\\.${l[c.PRERELEASEIDENTIFIER]})*))`),v("PRERELEASELOOSE",`(?:-?(${l[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[c.PRERELEASEIDENTIFIERLOOSE]})*))`),v("BUILDIDENTIFIER",`${f}+`),v("BUILD",`(?:\\+(${l[c.BUILDIDENTIFIER]}(?:\\.${l[c.BUILDIDENTIFIER]})*))`),v("FULLPLAIN",`v?${l[c.MAINVERSION]}${l[c.PRERELEASE]}?${l[c.BUILD]}?`),v("FULL",`^${l[c.FULLPLAIN]}$`),v("LOOSEPLAIN",`[v=\\s]*${l[c.MAINVERSIONLOOSE]}${l[c.PRERELEASELOOSE]}?${l[c.BUILD]}?`),v("LOOSE",`^${l[c.LOOSEPLAIN]}$`),v("GTLT","((?:<|>)?=?)"),v("XRANGEIDENTIFIERLOOSE",`${l[c.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),v("XRANGEIDENTIFIER",`${l[c.NUMERICIDENTIFIER]}|x|X|\\*`),v("XRANGEPLAIN",`[v=\\s]*(${l[c.XRANGEIDENTIFIER]})(?:\\.(${l[c.XRANGEIDENTIFIER]})(?:\\.(${l[c.XRANGEIDENTIFIER]})(?:${l[c.PRERELEASE]})?${l[c.BUILD]}?)?)?`),v("XRANGEPLAINLOOSE",`[v=\\s]*(${l[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[c.XRANGEIDENTIFIERLOOSE]})(?:${l[c.PRERELEASELOOSE]})?${l[c.BUILD]}?)?)?`),v("XRANGE",`^${l[c.GTLT]}\\s*${l[c.XRANGEPLAIN]}$`),v("XRANGELOOSE",`^${l[c.GTLT]}\\s*${l[c.XRANGEPLAINLOOSE]}$`),v("COERCEPLAIN",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?`),v("COERCE",`${l[c.COERCEPLAIN]}(?:$|[^\\d])`),v("COERCEFULL",l[c.COERCEPLAIN]+`(?:${l[c.PRERELEASE]})?(?:${l[c.BUILD]})?(?:$|[^\\d])`),v("COERCERTL",l[c.COERCE],!0),v("COERCERTLFULL",l[c.COERCEFULL],!0),v("LONETILDE","(?:~>?)"),v("TILDETRIM",`(\\s*)${l[c.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",v("TILDE",`^${l[c.LONETILDE]}${l[c.XRANGEPLAIN]}$`),v("TILDELOOSE",`^${l[c.LONETILDE]}${l[c.XRANGEPLAINLOOSE]}$`),v("LONECARET","(?:\\^)"),v("CARETTRIM",`(\\s*)${l[c.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",v("CARET",`^${l[c.LONECARET]}${l[c.XRANGEPLAIN]}$`),v("CARETLOOSE",`^${l[c.LONECARET]}${l[c.XRANGEPLAINLOOSE]}$`),v("COMPARATORLOOSE",`^${l[c.GTLT]}\\s*(${l[c.LOOSEPLAIN]})$|^$`),v("COMPARATOR",`^${l[c.GTLT]}\\s*(${l[c.FULLPLAIN]})$|^$`),v("COMPARATORTRIM",`(\\s*)${l[c.GTLT]}\\s*(${l[c.LOOSEPLAIN]}|${l[c.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",v("HYPHENRANGE",`^\\s*(${l[c.XRANGEPLAIN]})\\s+-\\s+(${l[c.XRANGEPLAIN]})\\s*$`),v("HYPHENRANGELOOSE",`^\\s*(${l[c.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[c.XRANGEPLAINLOOSE]})\\s*$`),v("STAR","(<|>)?=?\\s*\\*"),v("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),v("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(Id,Id.exports);var Ts=Id.exports;const hA=Object.freeze({loose:!0}),pA=Object.freeze({}),mA=t=>t?typeof t!="object"?hA:t:pA;var uh=mA;const Og=/^[0-9]+$/,s_=(t,e)=>{const n=Og.test(t),r=Og.test(e);return n&&r&&(t=+t,e=+e),t===e?0:n&&!r?-1:r&&!n?1:t<e?-1:1},gA=(t,e)=>s_(e,t);var o_={compareIdentifiers:s_,rcompareIdentifiers:gA};const eo=Bl,{MAX_LENGTH:Ng,MAX_SAFE_INTEGER:to}=Ul,{safeRe:no,t:ro}=Ts,yA=uh,{compareIdentifiers:si}=o_;let vA=class vn{constructor(e,n){if(n=yA(n),e instanceof vn){if(e.loose===!!n.loose&&e.includePrerelease===!!n.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>Ng)throw new TypeError(`version is longer than ${Ng} characters`);eo("SemVer",e,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const r=e.trim().match(n.loose?no[ro.LOOSE]:no[ro.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>to||this.major<0)throw new TypeError("Invalid major version");if(this.minor>to||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>to||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const a=+i;if(a>=0&&a<to)return a}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(eo("SemVer.compare",this.version,this.options,e),!(e instanceof vn)){if(typeof e=="string"&&e===this.version)return 0;e=new vn(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof vn||(e=new vn(e,this.options)),si(this.major,e.major)||si(this.minor,e.minor)||si(this.patch,e.patch)}comparePre(e){if(e instanceof vn||(e=new vn(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let n=0;do{const r=this.prerelease[n],i=e.prerelease[n];if(eo("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return si(r,i)}while(++n)}compareBuild(e){e instanceof vn||(e=new vn(e,this.options));let n=0;do{const r=this.build[n],i=e.build[n];if(eo("build compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return si(r,i)}while(++n)}inc(e,n,r){if(e.startsWith("pre")){if(!n&&r===!1)throw new Error("invalid increment argument: identifier is empty");if(n){const i=`-${n}`.match(this.options.loose?no[ro.PRERELEASELOOSE]:no[ro.PRERELEASE]);if(!i||i[1]!==n)throw new Error(`invalid identifier: ${n}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n,r),this.inc("pre",n,r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n,r),this.inc("pre",n,r);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const i=Number(r)?1:0;if(this.prerelease.length===0)this.prerelease=[i];else{let a=this.prerelease.length;for(;--a>=0;)typeof this.prerelease[a]=="number"&&(this.prerelease[a]++,a=-2);if(a===-1){if(n===this.prerelease.join(".")&&r===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(n){let a=[n,i];r===!1&&(a=[n]),si(this.prerelease[0],n)===0?isNaN(this.prerelease[1])&&(this.prerelease=a):this.prerelease=a}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var ft=vA;const Ig=ft,wA=(t,e,n=!1)=>{if(t instanceof Ig)return t;try{return new Ig(t,e)}catch(r){if(!n)return null;throw r}};var Xi=wA;const _A=Xi,bA=(t,e)=>{const n=_A(t,e);return n?n.version:null};var xA=bA;const EA=Xi,SA=(t,e)=>{const n=EA(t.trim().replace(/^[=v]+/,""),e);return n?n.version:null};var kA=SA;const Ag=ft,CA=(t,e,n,r,i)=>{typeof n=="string"&&(i=r,r=n,n=void 0);try{return new Ag(t instanceof Ag?t.version:t,n).inc(e,r,i).version}catch{return null}};var TA=CA;const Rg=Xi,OA=(t,e)=>{const n=Rg(t,null,!0),r=Rg(e,null,!0),i=n.compare(r);if(i===0)return null;const a=i>0,s=a?n:r,o=a?r:n,l=!!s.prerelease.length;if(!!o.prerelease.length&&!l){if(!o.patch&&!o.minor)return"major";if(o.compareMain(s)===0)return o.minor&&!o.patch?"minor":"patch"}const c=l?"pre":"";return n.major!==r.major?c+"major":n.minor!==r.minor?c+"minor":n.patch!==r.patch?c+"patch":"prerelease"};var NA=OA;const IA=ft,AA=(t,e)=>new IA(t,e).major;var RA=AA;const PA=ft,jA=(t,e)=>new PA(t,e).minor;var LA=jA;const $A=ft,MA=(t,e)=>new $A(t,e).patch;var DA=MA;const FA=Xi,zA=(t,e)=>{const n=FA(t,e);return n&&n.prerelease.length?n.prerelease:null};var UA=zA;const Pg=ft,BA=(t,e,n)=>new Pg(t,n).compare(new Pg(e,n));var hn=BA;const HA=hn,GA=(t,e,n)=>HA(e,t,n);var VA=GA;const WA=hn,ZA=(t,e)=>WA(t,e,!0);var qA=ZA;const jg=ft,KA=(t,e,n)=>{const r=new jg(t,n),i=new jg(e,n);return r.compare(i)||r.compareBuild(i)};var ch=KA;const JA=ch,YA=(t,e)=>t.sort((n,r)=>JA(n,r,e));var QA=YA;const XA=ch,e2=(t,e)=>t.sort((n,r)=>XA(r,n,e));var t2=e2;const n2=hn,r2=(t,e,n)=>n2(t,e,n)>0;var Hl=r2;const i2=hn,a2=(t,e,n)=>i2(t,e,n)<0;var dh=a2;const s2=hn,o2=(t,e,n)=>s2(t,e,n)===0;var l_=o2;const l2=hn,u2=(t,e,n)=>l2(t,e,n)!==0;var u_=u2;const c2=hn,d2=(t,e,n)=>c2(t,e,n)>=0;var fh=d2;const f2=hn,h2=(t,e,n)=>f2(t,e,n)<=0;var hh=h2;const p2=l_,m2=u_,g2=Hl,y2=fh,v2=dh,w2=hh,_2=(t,e,n,r)=>{switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof n=="object"&&(n=n.version),t===n;case"!==":return typeof t=="object"&&(t=t.version),typeof n=="object"&&(n=n.version),t!==n;case"":case"=":case"==":return p2(t,n,r);case"!=":return m2(t,n,r);case">":return g2(t,n,r);case">=":return y2(t,n,r);case"<":return v2(t,n,r);case"<=":return w2(t,n,r);default:throw new TypeError(`Invalid operator: ${e}`)}};var c_=_2;const b2=ft,x2=Xi,{safeRe:io,t:ao}=Ts,E2=(t,e)=>{if(t instanceof b2)return t;if(typeof t=="number"&&(t=String(t)),typeof t!="string")return null;e=e||{};let n=null;if(!e.rtl)n=t.match(e.includePrerelease?io[ao.COERCEFULL]:io[ao.COERCE]);else{const l=e.includePrerelease?io[ao.COERCERTLFULL]:io[ao.COERCERTL];let u;for(;(u=l.exec(t))&&(!n||n.index+n[0].length!==t.length);)(!n||u.index+u[0].length!==n.index+n[0].length)&&(n=u),l.lastIndex=u.index+u[1].length+u[2].length;l.lastIndex=-1}if(n===null)return null;const r=n[2],i=n[3]||"0",a=n[4]||"0",s=e.includePrerelease&&n[5]?`-${n[5]}`:"",o=e.includePrerelease&&n[6]?`+${n[6]}`:"";return x2(`${r}.${i}.${a}${s}${o}`,e)};var S2=E2;class k2{constructor(){this.max=1e3,this.map=new Map}get(e){const n=this.map.get(e);if(n!==void 0)return this.map.delete(e),this.map.set(e,n),n}delete(e){return this.map.delete(e)}set(e,n){if(!this.delete(e)&&n!==void 0){if(this.map.size>=this.max){const i=this.map.keys().next().value;this.delete(i)}this.map.set(e,n)}return this}}var C2=k2,Ku,Lg;function pn(){if(Lg)return Ku;Lg=1;const t=/\s+/g;class e{constructor(N,z){if(z=i(z),N instanceof e)return N.loose===!!z.loose&&N.includePrerelease===!!z.includePrerelease?N:new e(N.raw,z);if(N instanceof a)return this.raw=N.value,this.set=[[N]],this.formatted=void 0,this;if(this.options=z,this.loose=!!z.loose,this.includePrerelease=!!z.includePrerelease,this.raw=N.trim().replace(t," "),this.set=this.raw.split("||").map(F=>this.parseRange(F.trim())).filter(F=>F.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const F=this.set[0];if(this.set=this.set.filter(T=>!v(T[0])),this.set.length===0)this.set=[F];else if(this.set.length>1){for(const T of this.set)if(T.length===1&&_(T[0])){this.set=[T];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let N=0;N<this.set.length;N++){N>0&&(this.formatted+="||");const z=this.set[N];for(let F=0;F<z.length;F++)F>0&&(this.formatted+=" "),this.formatted+=z[F].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(N){const F=((this.options.includePrerelease&&h)|(this.options.loose&&m))+":"+N,T=r.get(F);if(T)return T;const I=this.options.loose,b=I?l[u.HYPHENRANGELOOSE]:l[u.HYPHENRANGE];N=N.replace(b,Z(this.options.includePrerelease)),s("hyphen replace",N),N=N.replace(l[u.COMPARATORTRIM],c),s("comparator trim",N),N=N.replace(l[u.TILDETRIM],d),s("tilde trim",N),N=N.replace(l[u.CARETTRIM],f),s("caret trim",N);let W=N.split(" ").map(ue=>y(ue,this.options)).join(" ").split(/\s+/).map(ue=>B(ue,this.options));I&&(W=W.filter(ue=>(s("loose invalid filter",ue,this.options),!!ue.match(l[u.COMPARATORLOOSE])))),s("range list",W);const G=new Map,E=W.map(ue=>new a(ue,this.options));for(const ue of E){if(v(ue))return[ue];G.set(ue.value,ue)}G.size>1&&G.has("")&&G.delete("");const oe=[...G.values()];return r.set(F,oe),oe}intersects(N,z){if(!(N instanceof e))throw new TypeError("a Range is required");return this.set.some(F=>p(F,z)&&N.set.some(T=>p(T,z)&&F.every(I=>T.every(b=>I.intersects(b,z)))))}test(N){if(!N)return!1;if(typeof N=="string")try{N=new o(N,this.options)}catch{return!1}for(let z=0;z<this.set.length;z++)if(le(this.set[z],N,this.options))return!0;return!1}}Ku=e;const n=C2,r=new n,i=uh,a=Gl(),s=Bl,o=ft,{safeRe:l,t:u,comparatorTrimReplace:c,tildeTrimReplace:d,caretTrimReplace:f}=Ts,{FLAG_INCLUDE_PRERELEASE:h,FLAG_LOOSE:m}=Ul,v=L=>L.value==="<0.0.0-0",_=L=>L.value==="",p=(L,N)=>{let z=!0;const F=L.slice();let T=F.pop();for(;z&&F.length;)z=F.every(I=>T.intersects(I,N)),T=F.pop();return z},y=(L,N)=>(s("comp",L,N),L=S(L,N),s("caret",L),L=x(L,N),s("tildes",L),L=A(L,N),s("xrange",L),L=j(L,N),s("stars",L),L),g=L=>!L||L.toLowerCase()==="x"||L==="*",x=(L,N)=>L.trim().split(/\s+/).map(z=>k(z,N)).join(" "),k=(L,N)=>{const z=N.loose?l[u.TILDELOOSE]:l[u.TILDE];return L.replace(z,(F,T,I,b,W)=>{s("tilde",L,F,T,I,b,W);let G;return g(T)?G="":g(I)?G=`>=${T}.0.0 <${+T+1}.0.0-0`:g(b)?G=`>=${T}.${I}.0 <${T}.${+I+1}.0-0`:W?(s("replaceTilde pr",W),G=`>=${T}.${I}.${b}-${W} <${T}.${+I+1}.0-0`):G=`>=${T}.${I}.${b} <${T}.${+I+1}.0-0`,s("tilde return",G),G})},S=(L,N)=>L.trim().split(/\s+/).map(z=>C(z,N)).join(" "),C=(L,N)=>{s("caret",L,N);const z=N.loose?l[u.CARETLOOSE]:l[u.CARET],F=N.includePrerelease?"-0":"";return L.replace(z,(T,I,b,W,G)=>{s("caret",L,T,I,b,W,G);let E;return g(I)?E="":g(b)?E=`>=${I}.0.0${F} <${+I+1}.0.0-0`:g(W)?I==="0"?E=`>=${I}.${b}.0${F} <${I}.${+b+1}.0-0`:E=`>=${I}.${b}.0${F} <${+I+1}.0.0-0`:G?(s("replaceCaret pr",G),I==="0"?b==="0"?E=`>=${I}.${b}.${W}-${G} <${I}.${b}.${+W+1}-0`:E=`>=${I}.${b}.${W}-${G} <${I}.${+b+1}.0-0`:E=`>=${I}.${b}.${W}-${G} <${+I+1}.0.0-0`):(s("no pr"),I==="0"?b==="0"?E=`>=${I}.${b}.${W}${F} <${I}.${b}.${+W+1}-0`:E=`>=${I}.${b}.${W}${F} <${I}.${+b+1}.0-0`:E=`>=${I}.${b}.${W} <${+I+1}.0.0-0`),s("caret return",E),E})},A=(L,N)=>(s("replaceXRanges",L,N),L.split(/\s+/).map(z=>U(z,N)).join(" ")),U=(L,N)=>{L=L.trim();const z=N.loose?l[u.XRANGELOOSE]:l[u.XRANGE];return L.replace(z,(F,T,I,b,W,G)=>{s("xRange",L,F,T,I,b,W,G);const E=g(I),oe=E||g(b),ue=oe||g(W),de=ue;return T==="="&&de&&(T=""),G=N.includePrerelease?"-0":"",E?T===">"||T==="<"?F="<0.0.0-0":F="*":T&&de?(oe&&(b=0),W=0,T===">"?(T=">=",oe?(I=+I+1,b=0,W=0):(b=+b+1,W=0)):T==="<="&&(T="<",oe?I=+I+1:b=+b+1),T==="<"&&(G="-0"),F=`${T+I}.${b}.${W}${G}`):oe?F=`>=${I}.0.0${G} <${+I+1}.0.0-0`:ue&&(F=`>=${I}.${b}.0${G} <${I}.${+b+1}.0-0`),s("xRange return",F),F})},j=(L,N)=>(s("replaceStars",L,N),L.trim().replace(l[u.STAR],"")),B=(L,N)=>(s("replaceGTE0",L,N),L.trim().replace(l[N.includePrerelease?u.GTE0PRE:u.GTE0],"")),Z=L=>(N,z,F,T,I,b,W,G,E,oe,ue,de)=>(g(F)?z="":g(T)?z=`>=${F}.0.0${L?"-0":""}`:g(I)?z=`>=${F}.${T}.0${L?"-0":""}`:b?z=`>=${z}`:z=`>=${z}${L?"-0":""}`,g(E)?G="":g(oe)?G=`<${+E+1}.0.0-0`:g(ue)?G=`<${E}.${+oe+1}.0-0`:de?G=`<=${E}.${oe}.${ue}-${de}`:L?G=`<${E}.${oe}.${+ue+1}-0`:G=`<=${G}`,`${z} ${G}`.trim()),le=(L,N,z)=>{for(let F=0;F<L.length;F++)if(!L[F].test(N))return!1;if(N.prerelease.length&&!z.includePrerelease){for(let F=0;F<L.length;F++)if(s(L[F].semver),L[F].semver!==a.ANY&&L[F].semver.prerelease.length>0){const T=L[F].semver;if(T.major===N.major&&T.minor===N.minor&&T.patch===N.patch)return!0}return!1}return!0};return Ku}var Ju,$g;function Gl(){if($g)return Ju;$g=1;const t=Symbol("SemVer ANY");class e{static get ANY(){return t}constructor(c,d){if(d=n(d),c instanceof e){if(c.loose===!!d.loose)return c;c=c.value}c=c.trim().split(/\s+/).join(" "),s("comparator",c,d),this.options=d,this.loose=!!d.loose,this.parse(c),this.semver===t?this.value="":this.value=this.operator+this.semver.version,s("comp",this)}parse(c){const d=this.options.loose?r[i.COMPARATORLOOSE]:r[i.COMPARATOR],f=c.match(d);if(!f)throw new TypeError(`Invalid comparator: ${c}`);this.operator=f[1]!==void 0?f[1]:"",this.operator==="="&&(this.operator=""),f[2]?this.semver=new o(f[2],this.options.loose):this.semver=t}toString(){return this.value}test(c){if(s("Comparator.test",c,this.options.loose),this.semver===t||c===t)return!0;if(typeof c=="string")try{c=new o(c,this.options)}catch{return!1}return a(c,this.operator,this.semver,this.options)}intersects(c,d){if(!(c instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new l(c.value,d).test(this.value):c.operator===""?c.value===""?!0:new l(this.value,d).test(c.semver):(d=n(d),d.includePrerelease&&(this.value==="<0.0.0-0"||c.value==="<0.0.0-0")||!d.includePrerelease&&(this.value.startsWith("<0.0.0")||c.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&c.operator.startsWith(">")||this.operator.startsWith("<")&&c.operator.startsWith("<")||this.semver.version===c.semver.version&&this.operator.includes("=")&&c.operator.includes("=")||a(this.semver,"<",c.semver,d)&&this.operator.startsWith(">")&&c.operator.startsWith("<")||a(this.semver,">",c.semver,d)&&this.operator.startsWith("<")&&c.operator.startsWith(">")))}}Ju=e;const n=uh,{safeRe:r,t:i}=Ts,a=c_,s=Bl,o=ft,l=pn();return Ju}const T2=pn(),O2=(t,e,n)=>{try{e=new T2(e,n)}catch{return!1}return e.test(t)};var Vl=O2;const N2=pn(),I2=(t,e)=>new N2(t,e).set.map(n=>n.map(r=>r.value).join(" ").trim().split(" "));var A2=I2;const R2=ft,P2=pn(),j2=(t,e,n)=>{let r=null,i=null,a=null;try{a=new P2(e,n)}catch{return null}return t.forEach(s=>{a.test(s)&&(!r||i.compare(s)===-1)&&(r=s,i=new R2(r,n))}),r};var L2=j2;const $2=ft,M2=pn(),D2=(t,e,n)=>{let r=null,i=null,a=null;try{a=new M2(e,n)}catch{return null}return t.forEach(s=>{a.test(s)&&(!r||i.compare(s)===1)&&(r=s,i=new $2(r,n))}),r};var F2=D2;const Yu=ft,z2=pn(),Mg=Hl,U2=(t,e)=>{t=new z2(t,e);let n=new Yu("0.0.0");if(t.test(n)||(n=new Yu("0.0.0-0"),t.test(n)))return n;n=null;for(let r=0;r<t.set.length;++r){const i=t.set[r];let a=null;i.forEach(s=>{const o=new Yu(s.semver.version);switch(s.operator){case">":o.prerelease.length===0?o.patch++:o.prerelease.push(0),o.raw=o.format();case"":case">=":(!a||Mg(o,a))&&(a=o);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${s.operator}`)}}),a&&(!n||Mg(n,a))&&(n=a)}return n&&t.test(n)?n:null};var B2=U2;const H2=pn(),G2=(t,e)=>{try{return new H2(t,e).range||"*"}catch{return null}};var V2=G2;const W2=ft,d_=Gl(),{ANY:Z2}=d_,q2=pn(),K2=Vl,Dg=Hl,Fg=dh,J2=hh,Y2=fh,Q2=(t,e,n,r)=>{t=new W2(t,r),e=new q2(e,r);let i,a,s,o,l;switch(n){case">":i=Dg,a=J2,s=Fg,o=">",l=">=";break;case"<":i=Fg,a=Y2,s=Dg,o="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(K2(t,e,r))return!1;for(let u=0;u<e.set.length;++u){const c=e.set[u];let d=null,f=null;if(c.forEach(h=>{h.semver===Z2&&(h=new d_(">=0.0.0")),d=d||h,f=f||h,i(h.semver,d.semver,r)?d=h:s(h.semver,f.semver,r)&&(f=h)}),d.operator===o||d.operator===l||(!f.operator||f.operator===o)&&a(t,f.semver))return!1;if(f.operator===l&&s(t,f.semver))return!1}return!0};var ph=Q2;const X2=ph,eR=(t,e,n)=>X2(t,e,">",n);var tR=eR;const nR=ph,rR=(t,e,n)=>nR(t,e,"<",n);var iR=rR;const zg=pn(),aR=(t,e,n)=>(t=new zg(t,n),e=new zg(e,n),t.intersects(e,n));var sR=aR;const oR=Vl,lR=hn;var uR=(t,e,n)=>{const r=[];let i=null,a=null;const s=t.sort((c,d)=>lR(c,d,n));for(const c of s)oR(c,e,n)?(a=c,i||(i=c)):(a&&r.push([i,a]),a=null,i=null);i&&r.push([i,null]);const o=[];for(const[c,d]of r)c===d?o.push(c):!d&&c===s[0]?o.push("*"):d?c===s[0]?o.push(`<=${d}`):o.push(`${c} - ${d}`):o.push(`>=${c}`);const l=o.join(" || "),u=typeof e.raw=="string"?e.raw:String(e);return l.length<u.length?l:e};const Ug=pn(),mh=Gl(),{ANY:Qu}=mh,pa=Vl,gh=hn,cR=(t,e,n={})=>{if(t===e)return!0;t=new Ug(t,n),e=new Ug(e,n);let r=!1;e:for(const i of t.set){for(const a of e.set){const s=fR(i,a,n);if(r=r||s!==null,s)continue e}if(r)return!1}return!0},dR=[new mh(">=0.0.0-0")],Bg=[new mh(">=0.0.0")],fR=(t,e,n)=>{if(t===e)return!0;if(t.length===1&&t[0].semver===Qu){if(e.length===1&&e[0].semver===Qu)return!0;n.includePrerelease?t=dR:t=Bg}if(e.length===1&&e[0].semver===Qu){if(n.includePrerelease)return!0;e=Bg}const r=new Set;let i,a;for(const h of t)h.operator===">"||h.operator===">="?i=Hg(i,h,n):h.operator==="<"||h.operator==="<="?a=Gg(a,h,n):r.add(h.semver);if(r.size>1)return null;let s;if(i&&a){if(s=gh(i.semver,a.semver,n),s>0)return null;if(s===0&&(i.operator!==">="||a.operator!=="<="))return null}for(const h of r){if(i&&!pa(h,String(i),n)||a&&!pa(h,String(a),n))return null;for(const m of e)if(!pa(h,String(m),n))return!1;return!0}let o,l,u,c,d=a&&!n.includePrerelease&&a.semver.prerelease.length?a.semver:!1,f=i&&!n.includePrerelease&&i.semver.prerelease.length?i.semver:!1;d&&d.prerelease.length===1&&a.operator==="<"&&d.prerelease[0]===0&&(d=!1);for(const h of e){if(c=c||h.operator===">"||h.operator===">=",u=u||h.operator==="<"||h.operator==="<=",i){if(f&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===f.major&&h.semver.minor===f.minor&&h.semver.patch===f.patch&&(f=!1),h.operator===">"||h.operator===">="){if(o=Hg(i,h,n),o===h&&o!==i)return!1}else if(i.operator===">="&&!pa(i.semver,String(h),n))return!1}if(a){if(d&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===d.major&&h.semver.minor===d.minor&&h.semver.patch===d.patch&&(d=!1),h.operator==="<"||h.operator==="<="){if(l=Gg(a,h,n),l===h&&l!==a)return!1}else if(a.operator==="<="&&!pa(a.semver,String(h),n))return!1}if(!h.operator&&(a||i)&&s!==0)return!1}return!(i&&u&&!a&&s!==0||a&&c&&!i&&s!==0||f||d)},Hg=(t,e,n)=>{if(!t)return e;const r=gh(t.semver,e.semver,n);return r>0?t:r<0||e.operator===">"&&t.operator===">="?e:t},Gg=(t,e,n)=>{if(!t)return e;const r=gh(t.semver,e.semver,n);return r<0?t:r>0||e.operator==="<"&&t.operator==="<="?e:t};var hR=cR;const Xu=Ts,Vg=Ul,pR=ft,Wg=o_,mR=Xi,gR=xA,yR=kA,vR=TA,wR=NA,_R=RA,bR=LA,xR=DA,ER=UA,SR=hn,kR=VA,CR=qA,TR=ch,OR=QA,NR=t2,IR=Hl,AR=dh,RR=l_,PR=u_,jR=fh,LR=hh,$R=c_,MR=S2,DR=Gl(),FR=pn(),zR=Vl,UR=A2,BR=L2,HR=F2,GR=B2,VR=V2,WR=ph,ZR=tR,qR=iR,KR=sR,JR=uR,YR=hR;Xu.re,Xu.src,Xu.t,Vg.SEMVER_SPEC_VERSION,Vg.RELEASE_TYPES,Wg.compareIdentifiers,Wg.rcompareIdentifiers;function Jn(t){if(!t||t.split("/").length>2||t.startsWith("/")||t.endsWith("/")||t.split(":").length>2)throw new Error(`Invalid identifier format: ${t}`);const[e,n]=t.split(":"),r=n||"latest";if(e.includes("/")){const[i,a]=e.split("/",2);if(!i||!a)throw new Error(`Invalid identifier format: ${t}`);return[i,a,r]}else{if(!e)throw new Error(`Invalid identifier format: ${t}`);return["-",e,r]}}class QR extends Error{constructor(e){super(e),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="LangSmithConflictError",this.status=409}}async function ne(t,e,n){let r;if(t.ok){n&&(r=await t.text());return}r=await t.text();const i=`Failed to ${e}. Received status [${t.status}]: ${t.statusText}. Server response: ${r}`;if(t.status===409)throw new QR(i);const a=new Error(i);throw a.status=t.status,a}const f_="ERR_CONFLICTING_ENDPOINTS";class XR extends Error{constructor(){super("You cannot provide both LANGSMITH_ENDPOINT / LANGCHAIN_ENDPOINT and LANGSMITH_RUNS_ENDPOINTS."),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:f_}),this.name="ConflictingEndpointsError"}}function eP(t){return typeof t=="object"&&t!==null&&t.code===f_}var Zg="[...]",tP={result:"[Circular]"},ul=[],Ei=[];const nP=new TextEncoder;function rP(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function so(t){return nP.encode(t)}function h_(t){if(t&&typeof t=="object"&&t!==null){if(t instanceof Map)return Object.fromEntries(t);if(t instanceof Set)return Array.from(t);if(t instanceof Date)return t.toISOString();if(t instanceof RegExp)return t.toString();if(t instanceof Error)return{name:t.name,message:t.message}}else if(typeof t=="bigint")return t.toString();return t}function iP(t){return function(e,n){return h_(n)}}function Ct(t,e,n,r,i){var a;try{const s=JSON.stringify(t,iP(n),r);return so(s)}catch(s){if(!((a=s.message)!=null&&a.includes("Converting circular structure to JSON")))return console.warn(`[WARNING]: LangSmith received unserializable value.${e?`
Context: ${e}`:""}`),so("[Unserializable]");Bt("SUPPRESS_CIRCULAR_JSON_WARNINGS")!=="true"&&console.warn(`[WARNING]: LangSmith received circular JSON. This will decrease tracer performance. ${e?`
Context: ${e}`:""}`),typeof i>"u"&&(i=rP()),Ad(t,"",0,[],void 0,0,i);let o;try{Ei.length===0?o=JSON.stringify(t,n,r):o=JSON.stringify(t,aP(n),r)}catch{return so("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;ul.length!==0;){const l=ul.pop();l.length===4?Object.defineProperty(l[0],l[1],l[3]):l[0][l[1]]=l[2]}}return so(o)}}function ec(t,e,n,r){var i=Object.getOwnPropertyDescriptor(r,n);i.get!==void 0?i.configurable?(Object.defineProperty(r,n,{value:t}),ul.push([r,n,e,i])):Ei.push([e,n,t]):(r[n]=t,ul.push([r,n,e]))}function Ad(t,e,n,r,i,a,s){a+=1;var o;if(typeof t=="object"&&t!==null){for(o=0;o<r.length;o++)if(r[o]===t){ec(tP,t,e,i);return}if(typeof s.depthLimit<"u"&&a>s.depthLimit){ec(Zg,t,e,i);return}if(typeof s.edgesLimit<"u"&&n+1>s.edgesLimit){ec(Zg,t,e,i);return}if(r.push(t),Array.isArray(t))for(o=0;o<t.length;o++)Ad(t[o],o,o,r,t,a,s);else{t=h_(t);var l=Object.keys(t);for(o=0;o<l.length;o++){var u=l[o];Ad(t[u],u,o,r,t,a,s)}}r.pop()}}function aP(t){return t=typeof t<"u"?t:function(e,n){return n},function(e,n){if(Ei.length>0)for(var r=0;r<Ei.length;r++){var i=Ei[r];if(i[1]===e&&i[0]===n){n=i[2],Ei.splice(r,1);break}}return t.call(this,e,n)}}function qg(t){const e=Yw(),n=PI(),r=t.extra??{},i=r.metadata;return t.extra={...r,runtime:{...e,...r==null?void 0:r.runtime},metadata:{...n,...n.revision_id||t.revision_id?{revision_id:t.revision_id??n.revision_id}:{},...i}},t}const sP=t=>{const e=(t==null?void 0:t.toString())??Bt("TRACING_SAMPLING_RATE");if(e===void 0)return;const n=parseFloat(e);if(n<0||n>1)throw new Error(`LANGSMITH_TRACING_SAMPLING_RATE must be between 0 and 1 if set. Got: ${n}`);return n},oP=t=>{const n=t.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return n==="localhost"||n==="127.0.0.1"||n==="::1"};async function lP(t){const e=[];for await(const n of t)e.push(n);return e}function tc(t){if(t!==void 0)return t.trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}const uP=async t=>{if((t==null?void 0:t.status)===429){const e=parseInt(t.headers.get("retry-after")??"30",10)*1e3;if(e>0)return await new Promise(n=>setTimeout(n,e)),!0}return!1};function Kg(t){return typeof t=="number"?Number(t.toFixed(4)):t}class cP{constructor(){Object.defineProperty(this,"items",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"sizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:0})}peek(){return this.items[0]}push(e){let n;const r=new Promise(a=>{n=a}),i=Ct(e.item,`Serializing run with id: ${e.item.id}`).length;return this.items.push({action:e.action,payload:e.item,otelContext:e.otelContext,apiKey:e.apiKey,apiUrl:e.apiUrl,itemPromiseResolve:n,itemPromise:r,size:i}),this.sizeBytes+=i,r}pop(e){var i;if(e<1)throw new Error("Number of bytes to pop off may not be less than 1.");const n=[];let r=0;for(;r+(((i=this.peek())==null?void 0:i.size)??0)<e&&this.items.length>0;){const a=this.items.shift();a&&(n.push(a),r+=a.size,this.sizeBytes-=a.size)}if(n.length===0&&this.items.length>0){const a=this.items.shift();n.push(a),r+=a.size,this.sizeBytes-=a.size}return[n.map(a=>({action:a.action,item:a.payload,otelContext:a.otelContext,apiKey:a.apiKey,apiUrl:a.apiUrl})),()=>n.forEach(a=>a.itemPromiseResolve())]}}const dP=20971520,fP=2500,Jg="https://api.smith.langchain.com";class ds{constructor(e={}){var r;Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"webUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchIngestCaller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tenantId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hideInputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hideOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingSampleRate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filteredPostUuids",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"autoBatchTracing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"autoBatchQueue",{enumerable:!0,configurable:!0,writable:!0,value:new cP}),Object.defineProperty(this,"autoBatchTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchAggregationDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:250}),Object.defineProperty(this,"batchSizeBytesLimit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blockOnRootRunFinalization",{enumerable:!0,configurable:!0,writable:!0,value:ln("LANGSMITH_TRACING_BACKGROUND")==="false"}),Object.defineProperty(this,"traceBatchConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:5}),Object.defineProperty(this,"_serverInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_getServerInfoPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"manualFlushMode",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"langSmithToOTELTranslator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"multipartStreamingDisabled",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"debug",{enumerable:!0,configurable:!0,writable:!0,value:ln("LANGSMITH_DEBUG")==="true"});const n=ds.getDefaultClientConfig();if(this.tracingSampleRate=sP(e.tracingSamplingRate),this.apiUrl=tc(e.apiUrl??n.apiUrl)??"",this.apiUrl.endsWith("/")&&(this.apiUrl=this.apiUrl.slice(0,-1)),this.apiKey=tc(e.apiKey??n.apiKey),this.webUrl=tc(e.webUrl??n.webUrl),(r=this.webUrl)!=null&&r.endsWith("/")&&(this.webUrl=this.webUrl.slice(0,-1)),this.timeout_ms=e.timeout_ms??9e4,this.caller=new Sg({...e.callerOptions??{},debug:e.debug??this.debug}),this.traceBatchConcurrency=e.traceBatchConcurrency??this.traceBatchConcurrency,this.traceBatchConcurrency<1)throw new Error("Trace batch concurrency must be positive.");this.debug=e.debug??this.debug,this.batchIngestCaller=new Sg({maxRetries:2,maxConcurrency:this.traceBatchConcurrency,...e.callerOptions??{},onFailedResponseHook:uP,debug:e.debug??this.debug}),this.hideInputs=e.hideInputs??e.anonymizer??n.hideInputs,this.hideOutputs=e.hideOutputs??e.anonymizer??n.hideOutputs,this.autoBatchTracing=e.autoBatchTracing??this.autoBatchTracing,this.blockOnRootRunFinalization=e.blockOnRootRunFinalization??this.blockOnRootRunFinalization,this.batchSizeBytesLimit=e.batchSizeBytesLimit,this.fetchOptions=e.fetchOptions||{},this.manualFlushMode=e.manualFlushMode??this.manualFlushMode,ln("OTEL_ENABLED")==="true"&&(this.langSmithToOTELTranslator=new WI)}static getDefaultClientConfig(){const e=Bt("API_KEY"),n=Bt("ENDPOINT")??Jg,r=Bt("HIDE_INPUTS")==="true",i=Bt("HIDE_OUTPUTS")==="true";return{apiUrl:n,apiKey:e,webUrl:void 0,hideInputs:r,hideOutputs:i}}getHostUrl(){return this.webUrl?this.webUrl:oP(this.apiUrl)?(this.webUrl="http://localhost:3000",this.webUrl):this.apiUrl.endsWith("/api/v1")?(this.webUrl=this.apiUrl.replace("/api/v1",""),this.webUrl):this.apiUrl.includes("/api")&&!this.apiUrl.split(".",1)[0].endsWith("api")?(this.webUrl=this.apiUrl.replace("/api",""),this.webUrl):this.apiUrl.split(".",1)[0].includes("dev")?(this.webUrl="https://dev.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("eu")?(this.webUrl="https://eu.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("beta")?(this.webUrl="https://beta.smith.langchain.com",this.webUrl):(this.webUrl="https://smith.langchain.com",this.webUrl)}get headers(){const e={"User-Agent":`langsmith-js/${Kw}`};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),e}_getPlatformEndpointPath(e){return this.apiUrl.slice(-3)!=="/v1"&&this.apiUrl.slice(-4)!=="/v1/"?`/v1/platform/${e}`:`/platform/${e}`}async processInputs(e){return this.hideInputs===!1?e:this.hideInputs===!0?{}:typeof this.hideInputs=="function"?this.hideInputs(e):e}async processOutputs(e){return this.hideOutputs===!1?e:this.hideOutputs===!0?{}:typeof this.hideOutputs=="function"?this.hideOutputs(e):e}async prepareRunCreateOrUpdateInputs(e){const n={...e};return n.inputs!==void 0&&(n.inputs=await this.processInputs(n.inputs)),n.outputs!==void 0&&(n.outputs=await this.processOutputs(n.outputs)),n}async _getResponse(e,n){const r=(n==null?void 0:n.toString())??"",i=`${this.apiUrl}${e}?${r}`,a=await this.caller.call(J(this.debug),i,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ne(a,`Failed to fetch ${e}`),a}async _get(e,n){return(await this._getResponse(e,n)).json()}async*_getPaginated(e,n=new URLSearchParams,r){let i=Number(n.get("offset"))||0;const a=Number(n.get("limit"))||100;for(;;){n.set("offset",String(i)),n.set("limit",String(a));const s=`${this.apiUrl}${e}?${n}`,o=await this.caller.call(J(this.debug),s,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ne(o,`Failed to fetch ${e}`);const l=r?r(await o.json()):await o.json();if(l.length===0||(yield l,l.length<a))break;i+=l.length}}async*_getCursorPaginatedList(e,n=null,r="POST",i="runs"){const a=n?{...n}:{};for(;;){const o=await(await this.caller.call(J(this.debug),`${this.apiUrl}${e}`,{method:r,headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:JSON.stringify(a)})).json();if(!o||!o[i])break;yield o[i];const l=o.cursors;if(!l||!l.next)break;a.cursor=l.next}}_shouldSample(){return this.tracingSampleRate===void 0?!0:Math.random()<this.tracingSampleRate}_filterForSampling(e,n=!1){if(this.tracingSampleRate===void 0)return e;if(n){const r=[];for(const i of e)this.filteredPostUuids.has(i.id)?this.filteredPostUuids.delete(i.id):r.push(i);return r}else{const r=[];for(const i of e){const a=i.trace_id??i.id;this.filteredPostUuids.has(a)||(i.id===a?this._shouldSample()?r.push(i):this.filteredPostUuids.add(a):r.push(i))}return r}}async _getBatchSizeLimitBytes(){var n;const e=await this._ensureServerInfo();return this.batchSizeBytesLimit??((n=e.batch_ingest_config)==null?void 0:n.size_limit_bytes)??dP}async _getMultiPartSupport(){var n;return((n=(await this._ensureServerInfo()).instance_flags)==null?void 0:n.dataset_examples_multipart_enabled)??!1}drainAutoBatchQueue(e){const n=[];for(;this.autoBatchQueue.items.length>0;){const[r,i]=this.autoBatchQueue.pop(e);if(!r.length){i();break}const a=r.reduce((l,u)=>{const c=u.apiUrl??this.apiUrl,d=u.apiKey??this.apiKey,h=u.apiKey===this.apiKey&&u.apiUrl===this.apiUrl?"default":`${c}|${d}`;return l[h]||(l[h]=[]),l[h].push(u),l},{}),s=[];for(const[l,u]of Object.entries(a)){const c=this._processBatch(u,{apiUrl:l==="default"?void 0:l.split("|")[0],apiKey:l==="default"?void 0:l.split("|")[1]});s.push(c)}const o=Promise.all(s).finally(i);n.push(o)}return Promise.all(n)}async _processBatch(e,n){var r;if(e.length)try{if(this.langSmithToOTELTranslator!==void 0)this._sendBatchToOTELTranslator(e);else{const i={runCreates:e.filter(s=>s.action==="create").map(s=>s.item),runUpdates:e.filter(s=>s.action==="update").map(s=>s.item)},a=await this._ensureServerInfo();(r=a==null?void 0:a.batch_ingest_config)!=null&&r.use_multipart_endpoint?await this.multipartIngestRuns(i,n):await this.batchIngestRuns(i,n)}}catch(i){console.error("Error exporting batch:",i)}}_sendBatchToOTELTranslator(e){if(this.langSmithToOTELTranslator!==void 0){const n=new Map,r=[];for(const i of e)i.item.id&&i.otelContext&&(n.set(i.item.id,i.otelContext),i.action==="create"?r.push({operation:"post",id:i.item.id,trace_id:i.item.trace_id??i.item.id,run:i.item}):r.push({operation:"patch",id:i.item.id,trace_id:i.item.trace_id??i.item.id,run:i.item}));this.langSmithToOTELTranslator.exportBatch(r,n)}}async processRunOperation(e){clearTimeout(this.autoBatchTimeout),this.autoBatchTimeout=void 0,e.action==="create"&&(e.item=qg(e.item));const n=this.autoBatchQueue.push(e);if(this.manualFlushMode)return n;const r=await this._getBatchSizeLimitBytes();return this.autoBatchQueue.sizeBytes>r&&this.drainAutoBatchQueue(r),this.autoBatchQueue.items.length>0&&(this.autoBatchTimeout=setTimeout(()=>{this.autoBatchTimeout=void 0,this.drainAutoBatchQueue(r)},this.autoBatchAggregationDelayMs)),n}async _getServerInfo(){const e=await this.caller.call(J(this.debug),`${this.apiUrl}/info`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(fP),...this.fetchOptions});await ne(e,"get server info");const n=await e.json();return this.debug&&console.log(`
=== LangSmith Server Configuration ===
`+JSON.stringify(n,null,2)+`
`),n}async _ensureServerInfo(){return this._getServerInfoPromise===void 0&&(this._getServerInfoPromise=(async()=>{if(this._serverInfo===void 0)try{this._serverInfo=await this._getServerInfo()}catch(e){console.warn(`[WARNING]: LangSmith failed to fetch info on supported operations with status code ${e.status}. Falling back to batch operations and default limits.`)}return this._serverInfo??{}})()),this._getServerInfoPromise.then(e=>(this._serverInfo===void 0&&(this._getServerInfoPromise=void 0),e))}async _getSettings(){return this.settings||(this.settings=this._get("/settings")),await this.settings}async flush(){const e=await this._getBatchSizeLimitBytes();await this.drainAutoBatchQueue(e)}_cloneCurrentOTELContext(){const e=Qw(),n=BI();if(this.langSmithToOTELTranslator!==void 0){const r=e.getActiveSpan();if(r)return e.setSpan(n.active(),r)}}async createRun(e,n){if(!this._filterForSampling([e]).length)return;const r={...this.headers,"Content-Type":"application/json"},i=e.project_name;delete e.project_name;const a=await this.prepareRunCreateOrUpdateInputs({session_name:i,...e,start_time:e.start_time??Date.now()});if(this.autoBatchTracing&&a.trace_id!==void 0&&a.dotted_order!==void 0){const l=this._cloneCurrentOTELContext();this.processRunOperation({action:"create",item:a,otelContext:l,apiKey:n==null?void 0:n.apiKey,apiUrl:n==null?void 0:n.apiUrl}).catch(console.error);return}const s=qg(a);(n==null?void 0:n.apiKey)!==void 0&&(r["x-api-key"]=n.apiKey);const o=await this.caller.call(J(this.debug),`${(n==null?void 0:n.apiUrl)??this.apiUrl}/runs`,{method:"POST",headers:r,body:Ct(s,`Creating run with id: ${s.id}`),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ne(o,"create run",!0)}async batchIngestRuns({runCreates:e,runUpdates:n},r){if(e===void 0&&n===void 0)return;let i=await Promise.all((e==null?void 0:e.map(l=>this.prepareRunCreateOrUpdateInputs(l)))??[]),a=await Promise.all((n==null?void 0:n.map(l=>this.prepareRunCreateOrUpdateInputs(l)))??[]);if(i.length>0&&a.length>0){const l=i.reduce((c,d)=>(d.id&&(c[d.id]=d),c),{}),u=[];for(const c of a)c.id!==void 0&&l[c.id]?l[c.id]={...l[c.id],...c}:u.push(c);i=Object.values(l),a=u}const s={post:i,patch:a};if(!s.post.length&&!s.patch.length)return;const o={post:[],patch:[]};for(const l of["post","patch"]){const u=l,c=s[u].reverse();let d=c.pop();for(;d!==void 0;)o[u].push(d),d=c.pop()}if(o.post.length>0||o.patch.length>0){const l=o.post.map(u=>u.id).concat(o.patch.map(u=>u.id)).join(",");await this._postBatchIngestRuns(Ct(o,`Ingesting runs with ids: ${l}`),r)}}async _postBatchIngestRuns(e,n){const r={...this.headers,"Content-Type":"application/json",Accept:"application/json"};(n==null?void 0:n.apiKey)!==void 0&&(r["x-api-key"]=n.apiKey);const i=await this.batchIngestCaller.call(J(this.debug),`${(n==null?void 0:n.apiUrl)??this.apiUrl}/runs/batch`,{method:"POST",headers:r,body:e,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ne(i,"batch create run",!0)}async multipartIngestRuns({runCreates:e,runUpdates:n},r){if(e===void 0&&n===void 0)return;const i={};let a=[];for(const d of e??[]){const f=await this.prepareRunCreateOrUpdateInputs(d);f.id!==void 0&&f.attachments!==void 0&&(i[f.id]=f.attachments),delete f.attachments,a.push(f)}let s=[];for(const d of n??[])s.push(await this.prepareRunCreateOrUpdateInputs(d));if(a.find(d=>d.trace_id===void 0||d.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when creating a run');if(s.find(d=>d.trace_id===void 0||d.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when updating a run');if(a.length>0&&s.length>0){const d=a.reduce((h,m)=>(m.id&&(h[m.id]=m),h),{}),f=[];for(const h of s)h.id!==void 0&&d[h.id]?d[h.id]={...d[h.id],...h}:f.push(h);a=Object.values(d),s=f}if(a.length===0&&s.length===0)return;const u=[],c=[];for(const[d,f]of[["post",a],["patch",s]])for(const h of f){const{inputs:m,outputs:v,events:_,attachments:p,...y}=h,g={inputs:m,outputs:v,events:_},x=Ct(y,`Serializing for multipart ingestion of run with id: ${y.id}`);c.push({name:`${d}.${y.id}`,payload:new Blob([x],{type:`application/json; length=${x.length}`})});for(const[k,S]of Object.entries(g)){if(S===void 0)continue;const C=Ct(S,`Serializing ${k} for multipart ingestion of run with id: ${y.id}`);c.push({name:`${d}.${y.id}.${k}`,payload:new Blob([C],{type:`application/json; length=${C.length}`})})}if(y.id!==void 0){const k=i[y.id];if(k){delete i[y.id];for(const[S,C]of Object.entries(k)){let A,U;if(Array.isArray(C)?[A,U]=C:(A=C.mimeType,U=C.data),S.includes(".")){console.warn(`Skipping attachment '${S}' for run ${y.id}: Invalid attachment name. Attachment names must not contain periods ('.'). Please rename the attachment and try again.`);continue}c.push({name:`attachment.${y.id}.${S}`,payload:new Blob([U],{type:`${A}; length=${U.byteLength}`})})}}}u.push(`trace=${y.trace_id},id=${y.id}`)}await this._sendMultipartRequest(c,u.join("; "),r)}async _createNodeFetchBody(e,n){const r=[];for(const s of e)r.push(new Blob([`--${n}\r
`])),r.push(new Blob([`Content-Disposition: form-data; name="${s.name}"\r
`,`Content-Type: ${s.payload.type}\r
\r
`])),r.push(s.payload),r.push(new Blob([`\r
`]));return r.push(new Blob([`--${n}--\r
`])),await new Blob(r).arrayBuffer()}async _createMultipartStream(e,n){const r=new TextEncoder;return new ReadableStream({async start(a){const s=async o=>{typeof o=="string"?a.enqueue(r.encode(o)):a.enqueue(o)};for(const o of e){await s(`--${n}\r
`),await s(`Content-Disposition: form-data; name="${o.name}"\r
`),await s(`Content-Type: ${o.payload.type}\r
\r
`);const u=o.payload.stream().getReader();try{let c;for(;!(c=await u.read()).done;)a.enqueue(c.value)}finally{u.releaseLock()}await s(`\r
`)}await s(`--${n}--\r
`),a.close()}})}async _sendMultipartRequest(e,n,r){const i="----LangSmithFormBoundary"+Math.random().toString(36).slice(2),a=TI(),s=()=>this._createNodeFetchBody(e,i),o=()=>this._createMultipartStream(e,i),l=async u=>{const c={...this.headers,"Content-Type":`multipart/form-data; boundary=${i}`};return(r==null?void 0:r.apiKey)!==void 0&&(c["x-api-key"]=r.apiKey),this.batchIngestCaller.call(J(this.debug),`${(r==null?void 0:r.apiUrl)??this.apiUrl}/runs/multipart`,{method:"POST",headers:c,body:u,duplex:"half",signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})};try{let u,c=!1;!a&&!this.multipartStreamingDisabled?(c=!0,u=await l(await o())):u=await l(await s()),(!this.multipartStreamingDisabled||c)&&u.status===422&&((r==null?void 0:r.apiUrl)??this.apiUrl)!==Jg&&(console.warn(`Streaming multipart upload to ${(r==null?void 0:r.apiUrl)??this.apiUrl}/runs/multipart failed. This usually means the host does not support chunked uploads. Retrying with a buffered upload for operation "${n}".`),this.multipartStreamingDisabled=!0,u=await l(await s())),await ne(u,"ingest multipart runs",!0)}catch(u){console.warn(`${u.message.trim()}

Context: ${n}`)}}async updateRun(e,n,r){te(e),n.inputs&&(n.inputs=await this.processInputs(n.inputs)),n.outputs&&(n.outputs=await this.processOutputs(n.outputs));const i={...n,id:e};if(!this._filterForSampling([i],!0).length)return;if(this.autoBatchTracing&&i.trace_id!==void 0&&i.dotted_order!==void 0){const o=this._cloneCurrentOTELContext();if(n.end_time!==void 0&&i.parent_run_id===void 0&&this.blockOnRootRunFinalization&&!this.manualFlushMode){await this.processRunOperation({action:"update",item:i,otelContext:o,apiKey:r==null?void 0:r.apiKey,apiUrl:r==null?void 0:r.apiUrl}).catch(console.error);return}else this.processRunOperation({action:"update",item:i,otelContext:o,apiKey:r==null?void 0:r.apiKey,apiUrl:r==null?void 0:r.apiUrl}).catch(console.error);return}const a={...this.headers,"Content-Type":"application/json"};(r==null?void 0:r.apiKey)!==void 0&&(a["x-api-key"]=r.apiKey);const s=await this.caller.call(J(this.debug),`${(r==null?void 0:r.apiUrl)??this.apiUrl}/runs/${e}`,{method:"PATCH",headers:a,body:Ct(n,`Serializing payload to update run with id: ${e}`),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ne(s,"update run",!0)}async readRun(e,{loadChildRuns:n}={loadChildRuns:!1}){te(e);let r=await this._get(`/runs/${e}`);return n&&(r=await this._loadChildRuns(r)),r}async getRunUrl({runId:e,run:n,projectOpts:r}){if(n!==void 0){let i;n.session_id?i=n.session_id:r!=null&&r.projectName?i=(await this.readProject({projectName:r==null?void 0:r.projectName})).id:r!=null&&r.projectId?i=r==null?void 0:r.projectId:i=(await this.readProject({projectName:Bt("PROJECT")||"default"})).id;const a=await this._getTenantId();return`${this.getHostUrl()}/o/${a}/projects/p/${i}/r/${n.id}?poll=true`}else if(e!==void 0){const i=await this.readRun(e);if(!i.app_path)throw new Error(`Run ${e} has no app_path`);return`${this.getHostUrl()}${i.app_path}`}else throw new Error("Must provide either runId or run")}async _loadChildRuns(e){var a;const n=await lP(this.listRuns({isRoot:!1,projectId:e.session_id,traceId:e.trace_id})),r={},i={};n.sort((s,o)=>((s==null?void 0:s.dotted_order)??"").localeCompare((o==null?void 0:o.dotted_order)??""));for(const s of n){if(s.parent_run_id===null||s.parent_run_id===void 0)throw new Error(`Child run ${s.id} has no parent`);(a=s.dotted_order)!=null&&a.startsWith(e.dotted_order??"")&&s.id!==e.id&&(s.parent_run_id in r||(r[s.parent_run_id]=[]),r[s.parent_run_id].push(s),i[s.id]=s)}e.child_runs=r[e.id]||[];for(const s in r)s!==e.id&&(i[s].child_runs=r[s]);return e}async*listRuns(e){const{projectId:n,projectName:r,parentRunId:i,traceId:a,referenceExampleId:s,startTime:o,executionOrder:l,isRoot:u,runType:c,error:d,id:f,query:h,filter:m,traceFilter:v,treeFilter:_,limit:p,select:y,order:g}=e;let x=[];if(n&&(x=Array.isArray(n)?n:[n]),r){const A=Array.isArray(r)?r:[r],U=await Promise.all(A.map(j=>this.readProject({projectName:j}).then(B=>B.id)));x.push(...U)}const k=["app_path","completion_cost","completion_tokens","dotted_order","end_time","error","events","extra","feedback_stats","first_token_time","id","inputs","name","outputs","parent_run_id","parent_run_ids","prompt_cost","prompt_tokens","reference_example_id","run_type","session_id","start_time","status","tags","total_cost","total_tokens","trace_id"],S={session:x.length?x:null,run_type:c,reference_example:s,query:h,filter:m,trace_filter:v,tree_filter:_,execution_order:l,parent_run:i,start_time:o?o.toISOString():null,error:d,id:f,limit:p,trace:a,select:y||k,is_root:u,order:g};let C=0;for await(const A of this._getCursorPaginatedList("/runs/query",S))if(p){if(C>=p)break;if(A.length+C>p){yield*A.slice(0,p-C);break}C+=A.length,yield*A}else yield*A}async*listGroupRuns(e){const{projectId:n,projectName:r,groupBy:i,filter:a,startTime:s,endTime:o,limit:l,offset:u}=e,d={session_id:n||(await this.readProject({projectName:r})).id,group_by:i,filter:a,start_time:s?s.toISOString():null,end_time:o?o.toISOString():null,limit:Number(l)||100};let f=Number(u)||0;const h="/runs/group",m=`${this.apiUrl}${h}`;for(;;){const v={...d,offset:f},_=Object.fromEntries(Object.entries(v).filter(([k,S])=>S!==void 0)),p=await this.caller.call(J(),m,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(_),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ne(p,`Failed to fetch ${h}`);const y=await p.json(),{groups:g,total:x}=y;if(g.length===0)break;for(const k of g)yield k;if(f+=g.length,f>=x)break}}async getRunStats({id:e,trace:n,parentRun:r,runType:i,projectNames:a,projectIds:s,referenceExampleIds:o,startTime:l,endTime:u,error:c,query:d,filter:f,traceFilter:h,treeFilter:m,isRoot:v,dataSourceType:_}){let p=s||[];a&&(p=[...s||[],...await Promise.all(a.map(S=>this.readProject({projectName:S}).then(C=>C.id)))]);const g=Object.fromEntries(Object.entries({id:e,trace:n,parent_run:r,run_type:i,session:p,reference_example:o,start_time:l,end_time:u,error:c,query:d,filter:f,trace_filter:h,tree_filter:m,is_root:v,data_source_type:_}).filter(([S,C])=>C!==void 0));return await(await this.caller.call(J(this.debug),`${this.apiUrl}/runs/stats`,{method:"POST",headers:this.headers,body:JSON.stringify(g),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async shareRun(e,{shareId:n}={}){const r={run_id:e,share_token:n||lt()};te(e);const a=await(await this.caller.call(J(this.debug),`${this.apiUrl}/runs/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(a===null||!("share_token"in a))throw new Error("Invalid response from server");return`${this.getHostUrl()}/public/${a.share_token}/r`}async unshareRun(e){te(e);const n=await this.caller.call(J(this.debug),`${this.apiUrl}/runs/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ne(n,"unshare run",!0)}async readRunSharedLink(e){te(e);const r=await(await this.caller.call(J(this.debug),`${this.apiUrl}/runs/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(!(r===null||!("share_token"in r)))return`${this.getHostUrl()}/public/${r.share_token}/r`}async listSharedRuns(e,{runIds:n}={}){const r=new URLSearchParams({share_token:e});if(n!==void 0)for(const s of n)r.append("id",s);return te(e),await(await this.caller.call(J(this.debug),`${this.apiUrl}/public/${e}/runs${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async readDatasetSharedSchema(e,n){if(!e&&!n)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:n})).id),te(e);const i=await(await this.caller.call(J(this.debug),`${this.apiUrl}/datasets/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return i.url=`${this.getHostUrl()}/public/${i.share_token}/d`,i}async shareDataset(e,n){if(!e&&!n)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:n})).id);const r={dataset_id:e};te(e);const a=await(await this.caller.call(J(this.debug),`${this.apiUrl}/datasets/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return a.url=`${this.getHostUrl()}/public/${a.share_token}/d`,a}async unshareDataset(e){te(e);const n=await this.caller.call(J(this.debug),`${this.apiUrl}/datasets/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ne(n,"unshare dataset",!0)}async readSharedDataset(e){return te(e),await(await this.caller.call(J(this.debug),`${this.apiUrl}/public/${e}/datasets`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async listSharedExamples(e,n){const r={};n!=null&&n.exampleIds&&(r.id=n.exampleIds);const i=new URLSearchParams;Object.entries(r).forEach(([o,l])=>{Array.isArray(l)?l.forEach(u=>i.append(o,u)):i.append(o,l)});const a=await this.caller.call(J(this.debug),`${this.apiUrl}/public/${e}/examples?${i.toString()}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),s=await a.json();if(!a.ok)throw"detail"in s?new Error(`Failed to list shared examples.
Status: ${a.status}
Message: ${Array.isArray(s.detail)?s.detail.join(`
`):"Unspecified error"}`):new Error(`Failed to list shared examples: ${a.status} ${a.statusText}`);return s.map(o=>({...o,_hostUrl:this.getHostUrl()}))}async createProject({projectName:e,description:n=null,metadata:r=null,upsert:i=!1,projectExtra:a=null,referenceDatasetId:s=null}){const o=i?"?upsert=true":"",l=`${this.apiUrl}/sessions${o}`,u=a||{};r&&(u.metadata=r);const c={name:e,extra:u,description:n};s!==null&&(c.reference_dataset_id=s);const d=await this.caller.call(J(this.debug),l,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ne(d,"create project"),await d.json()}async updateProject(e,{name:n=null,description:r=null,metadata:i=null,projectExtra:a=null,endTime:s=null}){const o=`${this.apiUrl}/sessions/${e}`;let l=a;i&&(l={...l||{},metadata:i});const u={name:n,extra:l,description:r,end_time:s?new Date(s).toISOString():null},c=await this.caller.call(J(this.debug),o,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ne(c,"update project"),await c.json()}async hasProject({projectId:e,projectName:n}){let r="/sessions";const i=new URLSearchParams;if(e!==void 0&&n!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)te(e),r+=`/${e}`;else if(n!==void 0)i.append("name",n);else throw new Error("Must provide projectName or projectId");const a=await this.caller.call(J(this.debug),`${this.apiUrl}${r}?${i}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});try{const s=await a.json();return a.ok?Array.isArray(s)?s.length>0:!0:!1}catch{return!1}}async readProject({projectId:e,projectName:n,includeStats:r}){let i="/sessions";const a=new URLSearchParams;if(e!==void 0&&n!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)te(e),i+=`/${e}`;else if(n!==void 0)a.append("name",n);else throw new Error("Must provide projectName or projectId");r!==void 0&&a.append("include_stats",r.toString());const s=await this._get(i,a);let o;if(Array.isArray(s)){if(s.length===0)throw new Error(`Project[id=${e}, name=${n}] not found`);o=s[0]}else o=s;return o}async getProjectUrl({projectId:e,projectName:n}){if(e===void 0&&n===void 0)throw new Error("Must provide either projectName or projectId");const r=await this.readProject({projectId:e,projectName:n}),i=await this._getTenantId();return`${this.getHostUrl()}/o/${i}/projects/p/${r.id}`}async getDatasetUrl({datasetId:e,datasetName:n}){if(e===void 0&&n===void 0)throw new Error("Must provide either datasetName or datasetId");const r=await this.readDataset({datasetId:e,datasetName:n}),i=await this._getTenantId();return`${this.getHostUrl()}/o/${i}/datasets/${r.id}`}async _getTenantId(){if(this._tenantId!==null)return this._tenantId;const e=new URLSearchParams({limit:"1"});for await(const n of this._getPaginated("/sessions",e))return this._tenantId=n[0].tenant_id,n[0].tenant_id;throw new Error("No projects found to resolve tenant.")}async*listProjects({projectIds:e,name:n,nameContains:r,referenceDatasetId:i,referenceDatasetName:a,referenceFree:s,metadata:o}={}){const l=new URLSearchParams;if(e!==void 0)for(const u of e)l.append("id",u);if(n!==void 0&&l.append("name",n),r!==void 0&&l.append("name_contains",r),i!==void 0)l.append("reference_dataset",i);else if(a!==void 0){const u=await this.readDataset({datasetName:a});l.append("reference_dataset",u.id)}s!==void 0&&l.append("reference_free",s.toString()),o!==void 0&&l.append("metadata",JSON.stringify(o));for await(const u of this._getPaginated("/sessions",l))yield*u}async deleteProject({projectId:e,projectName:n}){let r;if(e===void 0&&n===void 0)throw new Error("Must provide projectName or projectId");if(e!==void 0&&n!==void 0)throw new Error("Must provide either projectName or projectId, not both");e===void 0?r=(await this.readProject({projectName:n})).id:r=e,te(r);const i=await this.caller.call(J(this.debug),`${this.apiUrl}/sessions/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ne(i,`delete session ${r} (${n})`,!0)}async uploadCsv({csvFile:e,fileName:n,inputKeys:r,outputKeys:i,description:a,dataType:s,name:o}){const l=`${this.apiUrl}/datasets/upload`,u=new FormData;u.append("file",e,n),r.forEach(f=>{u.append("input_keys",f)}),i.forEach(f=>{u.append("output_keys",f)}),a&&u.append("description",a),s&&u.append("data_type",s),o&&u.append("name",o);const c=await this.caller.call(J(this.debug),l,{method:"POST",headers:this.headers,body:u,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ne(c,"upload CSV"),await c.json()}async createDataset(e,{description:n,dataType:r,inputsSchema:i,outputsSchema:a,metadata:s}={}){const o={name:e,description:n,extra:s?{metadata:s}:void 0};r&&(o.data_type=r),i&&(o.inputs_schema_definition=i),a&&(o.outputs_schema_definition=a);const l=await this.caller.call(J(this.debug),`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ne(l,"create dataset"),await l.json()}async readDataset({datasetId:e,datasetName:n}){let r="/datasets";const i=new URLSearchParams({limit:"1"});if(e&&n)throw new Error("Must provide either datasetName or datasetId, not both");if(e)te(e),r+=`/${e}`;else if(n)i.append("name",n);else throw new Error("Must provide datasetName or datasetId");const a=await this._get(r,i);let s;if(Array.isArray(a)){if(a.length===0)throw new Error(`Dataset[id=${e}, name=${n}] not found`);s=a[0]}else s=a;return s}async hasDataset({datasetId:e,datasetName:n}){try{return await this.readDataset({datasetId:e,datasetName:n}),!0}catch(r){if(r instanceof Error&&r.message.toLocaleLowerCase().includes("not found"))return!1;throw r}}async diffDatasetVersions({datasetId:e,datasetName:n,fromVersion:r,toVersion:i}){let a=e;if(a===void 0&&n===void 0)throw new Error("Must provide either datasetName or datasetId");if(a!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");a===void 0&&(a=(await this.readDataset({datasetName:n})).id);const s=new URLSearchParams({from_version:typeof r=="string"?r:r.toISOString(),to_version:typeof i=="string"?i:i.toISOString()});return await this._get(`/datasets/${a}/versions/diff`,s)}async readDatasetOpenaiFinetuning({datasetId:e,datasetName:n}){const r="/datasets";if(e===void 0)if(n!==void 0)e=(await this.readDataset({datasetName:n})).id;else throw new Error("Must provide either datasetName or datasetId");return(await(await this._getResponse(`${r}/${e}/openai_ft`)).text()).trim().split(`
`).map(o=>JSON.parse(o))}async*listDatasets({limit:e=100,offset:n=0,datasetIds:r,datasetName:i,datasetNameContains:a,metadata:s}={}){const o="/datasets",l=new URLSearchParams({limit:e.toString(),offset:n.toString()});if(r!==void 0)for(const u of r)l.append("id",u);i!==void 0&&l.append("name",i),a!==void 0&&l.append("name_contains",a),s!==void 0&&l.append("metadata",JSON.stringify(s));for await(const u of this._getPaginated(o,l))yield*u}async updateDataset(e){const{datasetId:n,datasetName:r,...i}=e;if(!n&&!r)throw new Error("Must provide either datasetName or datasetId");const a=n??(await this.readDataset({datasetName:r})).id;te(a);const s=await this.caller.call(J(this.debug),`${this.apiUrl}/datasets/${a}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(i),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ne(s,"update dataset"),await s.json()}async updateDatasetTag(e){const{datasetId:n,datasetName:r,asOf:i,tag:a}=e;if(!n&&!r)throw new Error("Must provide either datasetName or datasetId");const s=n??(await this.readDataset({datasetName:r})).id;te(s);const o=await this.caller.call(J(this.debug),`${this.apiUrl}/datasets/${s}/tags`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({as_of:typeof i=="string"?i:i.toISOString(),tag:a}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ne(o,"update dataset tags")}async deleteDataset({datasetId:e,datasetName:n}){let r="/datasets",i=e;if(e!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(n!==void 0&&(i=(await this.readDataset({datasetName:n})).id),i!==void 0)te(i),r+=`/${i}`;else throw new Error("Must provide datasetName or datasetId");const a=await this.caller.call(J(this.debug),this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ne(a,`delete ${r}`),await a.json()}async indexDataset({datasetId:e,datasetName:n,tag:r}){let i=e;if(!i&&!n)throw new Error("Must provide either datasetName or datasetId");if(i&&n)throw new Error("Must provide either datasetName or datasetId, not both");i||(i=(await this.readDataset({datasetName:n})).id),te(i);const a={tag:r},s=await this.caller.call(J(this.debug),`${this.apiUrl}/datasets/${i}/index`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ne(s,"index dataset"),await s.json()}async similarExamples(e,n,r,{filter:i}={}){const a={limit:r,inputs:e};i!==void 0&&(a.filter=i),te(n);const s=await this.caller.call(J(this.debug),`${this.apiUrl}/datasets/${n}/search`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ne(s,"fetch similar examples"),(await s.json()).examples}async createExample(e,n,r){var c;if(Yg(e)&&(n!==void 0||r!==void 0))throw new Error("Cannot provide outputs or options when using ExampleCreate object");let i=n?r==null?void 0:r.datasetId:e.dataset_id;const a=n?r==null?void 0:r.datasetName:e.dataset_name;if(i===void 0&&a===void 0)throw new Error("Must provide either datasetName or datasetId");if(i!==void 0&&a!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");i===void 0&&(i=(await this.readDataset({datasetName:a})).id);const s=(n?r==null?void 0:r.createdAt:e.created_at)||new Date;let o;Yg(e)?o=e:o={inputs:e,outputs:n,created_at:s==null?void 0:s.toISOString(),id:r==null?void 0:r.exampleId,metadata:r==null?void 0:r.metadata,split:r==null?void 0:r.split,source_run_id:r==null?void 0:r.sourceRunId,use_source_run_io:r==null?void 0:r.useSourceRunIO,use_source_run_attachments:r==null?void 0:r.useSourceRunAttachments,attachments:r==null?void 0:r.attachments};const l=await this._uploadExamplesMultipart(i,[o]);return await this.readExample(((c=l.example_ids)==null?void 0:c[0])??lt())}async createExamples(e){if(Array.isArray(e)){if(e.length===0)return[];const y=e;let g=y[0].dataset_id;const x=y[0].dataset_name;if(g===void 0&&x===void 0)throw new Error("Must provide either datasetName or datasetId");if(g!==void 0&&x!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");g===void 0&&(g=(await this.readDataset({datasetName:x})).id);const k=await this._uploadExamplesMultipart(g,y);return await Promise.all(k.example_ids.map(C=>this.readExample(C)))}const{inputs:n,outputs:r,metadata:i,splits:a,sourceRunIds:s,useSourceRunIOs:o,useSourceRunAttachments:l,attachments:u,exampleIds:c,datasetId:d,datasetName:f}=e;if(n===void 0)throw new Error("Must provide inputs when using legacy parameters");let h=d;const m=f;if(h===void 0&&m===void 0)throw new Error("Must provide either datasetName or datasetId");if(h!==void 0&&m!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");h===void 0&&(h=(await this.readDataset({datasetName:m})).id);const v=n.map((y,g)=>({dataset_id:h,inputs:y,outputs:r==null?void 0:r[g],metadata:i==null?void 0:i[g],split:a==null?void 0:a[g],id:c==null?void 0:c[g],attachments:u==null?void 0:u[g],source_run_id:s==null?void 0:s[g],use_source_run_io:o==null?void 0:o[g],use_source_run_attachments:l==null?void 0:l[g]})),_=await this._uploadExamplesMultipart(h,v);return await Promise.all(_.example_ids.map(y=>this.readExample(y)))}async createLLMExample(e,n,r){return this.createExample({input:e},{output:n},r)}async createChatExample(e,n,r){const i=e.map(s=>kg(s)?Cg(s):s),a=kg(n)?Cg(n):n;return this.createExample({input:i},{output:a},r)}async readExample(e){te(e);const n=`/examples/${e}`,r=await this._get(n),{attachment_urls:i,...a}=r,s=a;return i&&(s.attachments=Object.entries(i).reduce((o,[l,u])=>(o[l.slice(11)]={presigned_url:u.presigned_url,mime_type:u.mime_type},o),{})),s}async*listExamples({datasetId:e,datasetName:n,exampleIds:r,asOf:i,splits:a,inlineS3Urls:s,metadata:o,limit:l,offset:u,filter:c,includeAttachments:d}={}){let f;if(e!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)f=e;else if(n!==void 0)f=(await this.readDataset({datasetName:n})).id;else throw new Error("Must provide a datasetName or datasetId");const h=new URLSearchParams({dataset:f}),m=i?typeof i=="string"?i:i==null?void 0:i.toISOString():void 0;m&&h.append("as_of",m);const v=s??!0;if(h.append("inline_s3_urls",v.toString()),r!==void 0)for(const p of r)h.append("id",p);if(a!==void 0)for(const p of a)h.append("splits",p);if(o!==void 0){const p=JSON.stringify(o);h.append("metadata",p)}l!==void 0&&h.append("limit",l.toString()),u!==void 0&&h.append("offset",u.toString()),c!==void 0&&h.append("filter",c),d===!0&&["attachment_urls","outputs","metadata"].forEach(p=>h.append("select",p));let _=0;for await(const p of this._getPaginated("/examples",h)){for(const y of p){const{attachment_urls:g,...x}=y,k=x;g&&(k.attachments=Object.entries(g).reduce((S,[C,A])=>(S[C.slice(11)]={presigned_url:A.presigned_url,mime_type:A.mime_type||void 0},S),{})),yield k,_++}if(l!==void 0&&_>=l)break}}async deleteExample(e){te(e);const n=`/examples/${e}`,r=await this.caller.call(J(this.debug),this.apiUrl+n,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ne(r,`delete ${n}`),await r.json()}async updateExample(e,n){let r;n?r=e:r=e.id,te(r);let i;n?i={id:r,...n}:i=e;let a;return i.dataset_id!==void 0?a=i.dataset_id:a=(await this.readExample(r)).dataset_id,this._updateExamplesMultipart(a,[i])}async updateExamples(e){let n;return e[0].dataset_id===void 0?n=(await this.readExample(e[0].id)).dataset_id:n=e[0].dataset_id,this._updateExamplesMultipart(n,e)}async readDatasetVersion({datasetId:e,datasetName:n,asOf:r,tag:i}){let a;if(e?a=e:a=(await this.readDataset({datasetName:n})).id,te(a),r&&i||!r&&!i)throw new Error("Exactly one of asOf and tag must be specified.");const s=new URLSearchParams;r!==void 0&&s.append("as_of",typeof r=="string"?r:r.toISOString()),i!==void 0&&s.append("tag",i);const o=await this.caller.call(J(this.debug),`${this.apiUrl}/datasets/${a}/version?${s.toString()}`,{method:"GET",headers:{...this.headers},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ne(o,"read dataset version"),await o.json()}async listDatasetSplits({datasetId:e,datasetName:n,asOf:r}){let i;if(e===void 0&&n===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?i=(await this.readDataset({datasetName:n})).id:i=e,te(i);const a=new URLSearchParams,s=r?typeof r=="string"?r:r==null?void 0:r.toISOString():void 0;return s&&a.append("as_of",s),await this._get(`/datasets/${i}/splits`,a)}async updateDatasetSplits({datasetId:e,datasetName:n,splitName:r,exampleIds:i,remove:a=!1}){let s;if(e===void 0&&n===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?s=(await this.readDataset({datasetName:n})).id:s=e,te(s);const o={split_name:r,examples:i.map(u=>(te(u),u)),remove:a},l=await this.caller.call(J(this.debug),`${this.apiUrl}/datasets/${s}/splits`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ne(l,"update dataset splits",!0)}async evaluateRun(e,n,{sourceInfo:r,loadChildRuns:i,referenceExample:a}={loadChildRuns:!1}){i_("This method is deprecated and will be removed in future LangSmith versions, use `evaluate` from `langsmith/evaluation` instead.");let s;if(typeof e=="string")s=await this.readRun(e,{loadChildRuns:i});else if(typeof e=="object"&&"id"in e)s=e;else throw new Error(`Invalid run type: ${typeof e}`);s.reference_example_id!==null&&s.reference_example_id!==void 0&&(a=await this.readExample(s.reference_example_id));const o=await n.evaluateRun(s,a),[l,u]=await this._logEvaluationFeedback(o,s,r);return u[0]}async createFeedback(e,n,{score:r,value:i,correction:a,comment:s,sourceInfo:o,feedbackSourceType:l="api",sourceRunId:u,feedbackId:c,feedbackConfig:d,projectId:f,comparativeExperimentId:h}){var y;if(!e&&!f)throw new Error("One of runId or projectId must be provided");if(e&&f)throw new Error("Only one of runId or projectId can be provided");const m={type:l??"api",metadata:o??{}};u!==void 0&&(m==null?void 0:m.metadata)!==void 0&&!m.metadata.__run&&(m.metadata.__run={run_id:u}),(m==null?void 0:m.metadata)!==void 0&&((y=m.metadata.__run)==null?void 0:y.run_id)!==void 0&&te(m.metadata.__run.run_id);const v={id:c??lt(),run_id:e,key:n,score:Kg(r),value:i,correction:a,comment:s,feedback_source:m,comparative_experiment_id:h,feedbackConfig:d,session_id:f},_=`${this.apiUrl}/feedback`,p=await this.caller.call(J(this.debug),_,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(v),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ne(p,"create feedback",!0),v}async updateFeedback(e,{score:n,value:r,correction:i,comment:a}){const s={};n!=null&&(s.score=Kg(n)),r!=null&&(s.value=r),i!=null&&(s.correction=i),a!=null&&(s.comment=a),te(e);const o=await this.caller.call(J(this.debug),`${this.apiUrl}/feedback/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ne(o,"update feedback",!0)}async readFeedback(e){te(e);const n=`/feedback/${e}`;return await this._get(n)}async deleteFeedback(e){te(e);const n=`/feedback/${e}`,r=await this.caller.call(J(this.debug),this.apiUrl+n,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ne(r,`delete ${n}`),await r.json()}async*listFeedback({runIds:e,feedbackKeys:n,feedbackSourceTypes:r}={}){const i=new URLSearchParams;if(e&&i.append("run",e.join(",")),n)for(const a of n)i.append("key",a);if(r)for(const a of r)i.append("source",a);for await(const a of this._getPaginated("/feedback",i))yield*a}async createPresignedFeedbackToken(e,n,{expiration:r,feedbackConfig:i}={}){const a={run_id:e,feedback_key:n,feedback_config:i};return r?typeof r=="string"?a.expires_at=r:(r!=null&&r.hours||r!=null&&r.minutes||r!=null&&r.days)&&(a.expires_in=r):a.expires_in={hours:3},await(await this.caller.call(J(this.debug),`${this.apiUrl}/feedback/tokens`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async createComparativeExperiment({name:e,experimentIds:n,referenceDatasetId:r,createdAt:i,description:a,metadata:s,id:o}){var c;if(n.length===0)throw new Error("At least one experiment is required");if(r||(r=(await this.readProject({projectId:n[0]})).reference_dataset_id),!r==null)throw new Error("A reference dataset is required");const l={id:o,name:e,experiment_ids:n,reference_dataset_id:r,description:a,created_at:(c=i??new Date)==null?void 0:c.toISOString(),extra:{}};return s&&(l.extra.metadata=s),await(await this.caller.call(J(this.debug),`${this.apiUrl}/datasets/comparative`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async*listPresignedFeedbackTokens(e){te(e);const n=new URLSearchParams({run_id:e});for await(const r of this._getPaginated("/feedback/tokens",n))yield*r}_selectEvalResults(e){let n;return"results"in e?n=e.results:Array.isArray(e)?n=e:n=[e],n}async _logEvaluationFeedback(e,n,r){const i=this._selectEvalResults(e),a=[];for(const s of i){let o=r||{};s.evaluatorInfo&&(o={...s.evaluatorInfo,...o});let l=null;s.targetRunId?l=s.targetRunId:n&&(l=n.id),a.push(await this.createFeedback(l,s.key,{score:s.score,value:s.value,comment:s.comment,correction:s.correction,sourceInfo:o,sourceRunId:s.sourceRunId,feedbackConfig:s.feedbackConfig,feedbackSourceType:"model"}))}return[i,a]}async logEvaluationFeedback(e,n,r){const[i]=await this._logEvaluationFeedback(e,n,r);return i}async*listAnnotationQueues(e={}){const{queueIds:n,name:r,nameContains:i,limit:a}=e,s=new URLSearchParams;n&&n.forEach((l,u)=>{te(l,`queueIds[${u}]`),s.append("ids",l)}),r&&s.append("name",r),i&&s.append("name_contains",i),s.append("limit",(a!==void 0?Math.min(a,100):100).toString());let o=0;for await(const l of this._getPaginated("/annotation-queues",s))if(yield*l,o++,a!==void 0&&o>=a)break}async createAnnotationQueue(e){const{name:n,description:r,queueId:i,rubricInstructions:a}=e,s={name:n,description:r,id:i||lt(),rubric_instructions:a},o=await this.caller.call(J(this.debug),`${this.apiUrl}/annotation-queues`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(Object.fromEntries(Object.entries(s).filter(([u,c])=>c!==void 0))),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ne(o,"create annotation queue"),await o.json()}async readAnnotationQueue(e){const n=await this.caller.call(J(this.debug),`${this.apiUrl}/annotation-queues/${te(e,"queueId")}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ne(n,"read annotation queue"),await n.json()}async updateAnnotationQueue(e,n){const{name:r,description:i,rubricInstructions:a}=n,s=await this.caller.call(J(this.debug),`${this.apiUrl}/annotation-queues/${te(e,"queueId")}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({name:r,description:i,rubric_instructions:a}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ne(s,"update annotation queue")}async deleteAnnotationQueue(e){const n=await this.caller.call(J(this.debug),`${this.apiUrl}/annotation-queues/${te(e,"queueId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ne(n,"delete annotation queue")}async addRunsToAnnotationQueue(e,n){const r=await this.caller.call(J(this.debug),`${this.apiUrl}/annotation-queues/${te(e,"queueId")}/runs`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(n.map((i,a)=>te(i,`runIds[${a}]`).toString())),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ne(r,"add runs to annotation queue")}async getRunFromAnnotationQueue(e,n){const r=`/annotation-queues/${te(e,"queueId")}/run`,i=await this.caller.call(J(this.debug),`${this.apiUrl}${r}/${n}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ne(i,"get run from annotation queue"),await i.json()}async deleteRunFromAnnotationQueue(e,n){const r=await this.caller.call(J(this.debug),`${this.apiUrl}/annotation-queues/${te(e,"queueId")}/runs/${te(n,"queueRunId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ne(r,"delete run from annotation queue")}async getSizeFromAnnotationQueue(e){const n=await this.caller.call(J(this.debug),`${this.apiUrl}/annotation-queues/${te(e,"queueId")}/size`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ne(n,"get size from annotation queue"),await n.json()}async _currentTenantIsOwner(e){const n=await this._getSettings();return e=="-"||n.tenant_handle===e}async _ownerConflictError(e,n){const r=await this._getSettings();return new Error(`Cannot ${e} for another tenant.

      Current tenant: ${r.tenant_handle}

      Requested tenant: ${n}`)}async _getLatestCommitHash(e){const n=await this.caller.call(J(this.debug),`${this.apiUrl}/commits/${e}/?limit=1&offset=0`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),r=await n.json();if(!n.ok){const i=typeof r.detail=="string"?r.detail:JSON.stringify(r.detail),a=new Error(`Error ${n.status}: ${n.statusText}
${i}`);throw a.statusCode=n.status,a}if(r.commits.length!==0)return r.commits[0].commit_hash}async _likeOrUnlikePrompt(e,n){const[r,i,a]=Jn(e),s=await this.caller.call(J(this.debug),`${this.apiUrl}/likes/${r}/${i}`,{method:"POST",body:JSON.stringify({like:n}),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ne(s,`${n?"like":"unlike"} prompt`),await s.json()}async _getPromptUrl(e){const[n,r,i]=Jn(e);if(await this._currentTenantIsOwner(n)){const a=await this._getSettings();return i!=="latest"?`${this.getHostUrl()}/prompts/${r}/${i.substring(0,8)}?organizationId=${a.id}`:`${this.getHostUrl()}/prompts/${r}?organizationId=${a.id}`}else return i!=="latest"?`${this.getHostUrl()}/hub/${n}/${r}/${i.substring(0,8)}`:`${this.getHostUrl()}/hub/${n}/${r}`}async promptExists(e){return!!await this.getPrompt(e)}async likePrompt(e){return this._likeOrUnlikePrompt(e,!0)}async unlikePrompt(e){return this._likeOrUnlikePrompt(e,!1)}async*listCommits(e){for await(const n of this._getPaginated(`/commits/${e}/`,new URLSearchParams,r=>r.commits))yield*n}async*listPrompts(e){const n=new URLSearchParams;n.append("sort_field",(e==null?void 0:e.sortField)??"updated_at"),n.append("sort_direction","desc"),n.append("is_archived",(!!(e!=null&&e.isArchived)).toString()),(e==null?void 0:e.isPublic)!==void 0&&n.append("is_public",e.isPublic.toString()),e!=null&&e.query&&n.append("query",e.query);for await(const r of this._getPaginated("/repos",n,i=>i.repos))yield*r}async getPrompt(e){const[n,r,i]=Jn(e),a=await this.caller.call(J(this.debug),`${this.apiUrl}/repos/${n}/${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(a.status===404)return null;await ne(a,"get prompt");const s=await a.json();return s.repo?s.repo:null}async createPrompt(e,n){const r=await this._getSettings();if(n!=null&&n.isPublic&&!r.tenant_handle)throw new Error(`Cannot create a public prompt without first

        creating a LangChain Hub handle.
        You can add a handle by creating a public prompt at:

        https://smith.langchain.com/prompts`);const[i,a,s]=Jn(e);if(!await this._currentTenantIsOwner(i))throw await this._ownerConflictError("create a prompt",i);const o={repo_handle:a,...(n==null?void 0:n.description)&&{description:n.description},...(n==null?void 0:n.readme)&&{readme:n.readme},...(n==null?void 0:n.tags)&&{tags:n.tags},is_public:!!(n!=null&&n.isPublic)},l=await this.caller.call(J(this.debug),`${this.apiUrl}/repos/`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ne(l,"create prompt");const{repo:u}=await l.json();return u}async createCommit(e,n,r){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[i,a,s]=Jn(e),o=(r==null?void 0:r.parentCommitHash)==="latest"||!(r!=null&&r.parentCommitHash)?await this._getLatestCommitHash(`${i}/${a}`):r==null?void 0:r.parentCommitHash,l={manifest:JSON.parse(JSON.stringify(n)),parent_commit:o},u=await this.caller.call(J(this.debug),`${this.apiUrl}/commits/${i}/${a}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ne(u,"create commit");const c=await u.json();return this._getPromptUrl(`${i}/${a}${c.commit_hash?`:${c.commit_hash}`:""}`)}async updateExamplesMultipart(e,n=[]){return this._updateExamplesMultipart(e,n)}async _updateExamplesMultipart(e,n=[]){var o;if(!await this._getMultiPartSupport())throw new Error("Your LangSmith deployment does not allow using the multipart examples endpoint, please upgrade your deployment to the latest version.");const r=new FormData;for(const l of n){const u=l.id,c={...l.metadata&&{metadata:l.metadata},...l.split&&{split:l.split}},d=Ct(c,`Serializing body for example with id: ${u}`),f=new Blob([d],{type:"application/json"});if(r.append(u,f),l.inputs){const h=Ct(l.inputs,`Serializing inputs for example with id: ${u}`),m=new Blob([h],{type:"application/json"});r.append(`${u}.inputs`,m)}if(l.outputs){const h=Ct(l.outputs,`Serializing outputs whle updating example with id: ${u}`),m=new Blob([h],{type:"application/json"});r.append(`${u}.outputs`,m)}if(l.attachments)for(const[h,m]of Object.entries(l.attachments)){let v,_;Array.isArray(m)?[v,_]=m:(v=m.mimeType,_=m.data);const p=new Blob([_],{type:`${v}; length=${_.byteLength}`});r.append(`${u}.attachment.${h}`,p)}if(l.attachments_operations){const h=Ct(l.attachments_operations,`Serializing attachments while updating example with id: ${u}`),m=new Blob([h],{type:"application/json"});r.append(`${u}.attachments_operations`,m)}}const i=e??((o=n[0])==null?void 0:o.dataset_id);return await(await this.caller.call(J(this.debug),`${this.apiUrl}${this._getPlatformEndpointPath(`datasets/${i}/examples`)}`,{method:"PATCH",headers:this.headers,body:r})).json()}async uploadExamplesMultipart(e,n=[]){return this._uploadExamplesMultipart(e,n)}async _uploadExamplesMultipart(e,n=[]){if(!await this._getMultiPartSupport())throw new Error("Your LangSmith deployment does not allow using the multipart examples endpoint, please upgrade your deployment to the latest version.");const r=new FormData;for(const s of n){const o=(s.id??lt()).toString(),l={created_at:s.created_at,...s.metadata&&{metadata:s.metadata},...s.split&&{split:s.split},...s.source_run_id&&{source_run_id:s.source_run_id},...s.use_source_run_io&&{use_source_run_io:s.use_source_run_io},...s.use_source_run_attachments&&{use_source_run_attachments:s.use_source_run_attachments}},u=Ct(l,`Serializing body for uploaded example with id: ${o}`),c=new Blob([u],{type:"application/json"});if(r.append(o,c),s.inputs){const d=Ct(s.inputs,`Serializing inputs for uploaded example with id: ${o}`),f=new Blob([d],{type:"application/json"});r.append(`${o}.inputs`,f)}if(s.outputs){const d=Ct(s.outputs,`Serializing outputs for uploaded example with id: ${o}`),f=new Blob([d],{type:"application/json"});r.append(`${o}.outputs`,f)}if(s.attachments)for(const[d,f]of Object.entries(s.attachments)){let h,m;Array.isArray(f)?[h,m]=f:(h=f.mimeType,m=f.data);const v=new Blob([m],{type:`${h}; length=${m.byteLength}`});r.append(`${o}.attachment.${d}`,v)}}const i=await this.caller.call(J(this.debug),`${this.apiUrl}${this._getPlatformEndpointPath(`datasets/${e}/examples`)}`,{method:"POST",headers:this.headers,body:r});return await ne(i,"upload examples"),await i.json()}async updatePrompt(e,n){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[r,i]=Jn(e);if(!await this._currentTenantIsOwner(r))throw await this._ownerConflictError("update a prompt",r);const a={};if((n==null?void 0:n.description)!==void 0&&(a.description=n.description),(n==null?void 0:n.readme)!==void 0&&(a.readme=n.readme),(n==null?void 0:n.tags)!==void 0&&(a.tags=n.tags),(n==null?void 0:n.isPublic)!==void 0&&(a.is_public=n.isPublic),(n==null?void 0:n.isArchived)!==void 0&&(a.is_archived=n.isArchived),Object.keys(a).length===0)throw new Error("No valid update options provided");const s=await this.caller.call(J(this.debug),`${this.apiUrl}/repos/${r}/${i}`,{method:"PATCH",body:JSON.stringify(a),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ne(s,"update prompt"),s.json()}async deletePrompt(e){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[n,r,i]=Jn(e);if(!await this._currentTenantIsOwner(n))throw await this._ownerConflictError("delete a prompt",n);return await(await this.caller.call(J(this.debug),`${this.apiUrl}/repos/${n}/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async pullPromptCommit(e,n){const[r,i,a]=Jn(e),s=await this.caller.call(J(this.debug),`${this.apiUrl}/commits/${r}/${i}/${a}${n!=null&&n.includeModel?"?include_model=true":""}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ne(s,"pull prompt commit");const o=await s.json();return{owner:r,repo:i,commit_hash:o.commit_hash,manifest:o.manifest,examples:o.examples}}async _pullPrompt(e,n){const r=await this.pullPromptCommit(e,{includeModel:n==null?void 0:n.includeModel});return JSON.stringify(r.manifest)}async pushPrompt(e,n){return await this.promptExists(e)?n&&Object.keys(n).some(i=>i!=="object")&&await this.updatePrompt(e,{description:n==null?void 0:n.description,readme:n==null?void 0:n.readme,tags:n==null?void 0:n.tags,isPublic:n==null?void 0:n.isPublic}):await this.createPrompt(e,{description:n==null?void 0:n.description,readme:n==null?void 0:n.readme,tags:n==null?void 0:n.tags,isPublic:n==null?void 0:n.isPublic}),n!=null&&n.object?await this.createCommit(e,n==null?void 0:n.object,{parentCommitHash:n==null?void 0:n.parentCommitHash}):await this._getPromptUrl(e)}async clonePublicDataset(e,n={}){const{sourceApiUrl:r=this.apiUrl,datasetName:i}=n,[a,s]=this.parseTokenOrUrl(e,r),o=new ds({apiUrl:a,apiKey:"placeholder"}),l=await o.readSharedDataset(s),u=i||l.name;try{if(await this.hasDataset({datasetId:u})){console.log(`Dataset ${u} already exists in your tenant. Skipping.`);return}}catch{}const c=await o.listSharedExamples(s),d=await this.createDataset(u,{description:l.description,dataType:l.data_type||"kv",inputsSchema:l.inputs_schema_definition??void 0,outputsSchema:l.outputs_schema_definition??void 0});try{await this.createExamples({inputs:c.map(f=>f.inputs),outputs:c.flatMap(f=>f.outputs?[f.outputs]:[]),datasetId:d.id})}catch(f){throw console.error(`An error occurred while creating dataset ${u}. You should delete it manually.`),f}}parseTokenOrUrl(e,n,r=2,i="dataset"){try{return te(e),[n,e]}catch{}try{const s=new URL(e).pathname.split("/").filter(o=>o!=="");if(s.length>=r){const o=s[s.length-r];return[n,o]}else throw new Error(`Invalid public ${i} URL: ${e}`)}catch{throw new Error(`Invalid public ${i} URL or token: ${e}`)}}async awaitPendingTraceBatches(){var e,n;if(this.manualFlushMode)return console.warn("[WARNING]: When tracing in manual flush mode, you must call `await client.flush()` manually to submit trace batches."),Promise.resolve();await Promise.all([...this.autoBatchQueue.items.map(({itemPromise:r})=>r),this.batchIngestCaller.queue.onIdle()]),this.langSmithToOTELTranslator!==void 0&&await((n=(e=HI())==null?void 0:e.DEFAULT_LANGSMITH_SPAN_PROCESSOR)==null?void 0:n.forceFlush())}}function Yg(t){return"dataset_id"in t||"dataset_name"in t}const hP=t=>!!["TRACING_V2","TRACING"].find(n=>Bt(n)==="true"),nc=Symbol.for("lc:context_variables");function pP(t){return t.replace(/[-:.]/g,"")}function p_(t,e,n=1){const r=n.toFixed(0).slice(0,3).padStart(3,"0"),i=`${new Date(t).toISOString().slice(0,-1)}${r}Z`;return{dottedOrder:pP(i)+e,microsecondPrecisionDatestring:i}}class cl{constructor(e,n,r,i){Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"replicas",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.metadata=e,this.tags=n,this.project_name=r,this.replicas=i}static fromHeader(e){const n=e.split(",");let r={},i=[],a,s;for(const o of n){const[l,u]=o.split("="),c=decodeURIComponent(u);l==="langsmith-metadata"?r=JSON.parse(c):l==="langsmith-tags"?i=c.split(","):l==="langsmith-project"?a=c:l==="langsmith-replicas"&&(s=JSON.parse(c))}return new cl(r,i,a,s)}toHeader(){const e=[];return this.metadata&&Object.keys(this.metadata).length>0&&e.push(`langsmith-metadata=${encodeURIComponent(JSON.stringify(this.metadata))}`),this.tags&&this.tags.length>0&&e.push(`langsmith-tags=${encodeURIComponent(this.tags.join(","))}`),this.project_name&&e.push(`langsmith-project=${encodeURIComponent(this.project_name)}`),e.join(",")}}class mt{constructor(e){var o;if(Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"run_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_runs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"end_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extra",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serialized",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reference_example_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"trace_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dotted_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"attachments",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"replicas",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_serialized_start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),mP(e)){Object.assign(this,{...e});return}const n=mt.getDefaultConfig(),{metadata:r,...i}=e,a=i.client??mt.getSharedClient(),s={...r,...(o=i==null?void 0:i.extra)==null?void 0:o.metadata};if(i.extra={...i.extra,metadata:s},Object.assign(this,{...n,...i,client:a}),this.trace_id||(this.parent_run?this.trace_id=this.parent_run.trace_id??this.id:this.trace_id=this.id),this.replicas=_P(this.replicas),this.execution_order??(this.execution_order=1),this.child_execution_order??(this.child_execution_order=1),!this.dotted_order){const{dottedOrder:l,microsecondPrecisionDatestring:u}=p_(this.start_time,this.id,this.execution_order);this.parent_run?this.dotted_order=this.parent_run.dotted_order+"."+l:this.dotted_order=l,this._serialized_start_time=u}}set metadata(e){var n;this.extra={...this.extra,metadata:{...(n=this.extra)==null?void 0:n.metadata,...e}}}get metadata(){var e;return(e=this.extra)==null?void 0:e.metadata}static getDefaultConfig(){return{id:lt(),run_type:"chain",project_name:qw(),child_runs:[],api_url:ln("LANGCHAIN_ENDPOINT")??"http://localhost:1984",api_key:ln("LANGCHAIN_API_KEY"),caller_options:{},start_time:Date.now(),serialized:{},inputs:{},extra:{}}}static getSharedClient(){return mt.sharedClient||(mt.sharedClient=new ds),mt.sharedClient}createChild(e){var l,u,c,d,f,h;const n=this.child_execution_order+1,r=new mt({...e,parent_run:this,project_name:this.project_name,replicas:this.replicas,client:this.client,tracingEnabled:this.tracingEnabled,execution_order:n,child_execution_order:n});nc in this&&(r[nc]=this[nc]);const i=Symbol.for("lc:child_config"),a=((l=e.extra)==null?void 0:l[i])??this.extra[i];if(yP(a)){const m={...a},v=gP(m.callbacks)?(c=(u=m.callbacks).copy)==null?void 0:c.call(u):void 0;v&&(Object.assign(v,{_parentRunId:r.id}),(h=(f=(d=v.handlers)==null?void 0:d.find(m_))==null?void 0:f.updateFromRunTree)==null||h.call(f,r),m.callbacks=v),r.extra[i]=m}const s=new Set;let o=this;for(;o!=null&&!s.has(o.id);)s.add(o.id),o.child_execution_order=Math.max(o.child_execution_order,n),o=o.parent_run;return this.child_runs.push(r),r}async end(e,n,r=Date.now(),i){this.outputs=this.outputs??e,this.error=this.error??n,this.end_time=this.end_time??r,i&&Object.keys(i).length>0&&(this.extra=this.extra?{...this.extra,metadata:{...this.extra.metadata,...i}}:{metadata:i})}_convertToCreate(e,n,r=!0){var o,l;const i=e.extra??{};if(((o=i==null?void 0:i.runtime)==null?void 0:o.library)===void 0&&(i.runtime||(i.runtime={}),n))for(const[u,c]of Object.entries(n))i.runtime[u]||(i.runtime[u]=c);let a,s;return r?(s=((l=e.parent_run)==null?void 0:l.id)??e.parent_run_id,a=[]):(a=e.child_runs.map(u=>this._convertToCreate(u,n,r)),s=void 0),{id:e.id,name:e.name,start_time:e._serialized_start_time??e.start_time,end_time:e.end_time,run_type:e.run_type,reference_example_id:e.reference_example_id,extra:i,serialized:e.serialized,error:e.error,inputs:e.inputs,outputs:e.outputs,session_name:e.project_name,child_runs:a,parent_run_id:s,trace_id:e.trace_id,dotted_order:e.dotted_order,tags:e.tags,attachments:e.attachments,events:e.events}}_remapForProject(e,n,r=!0){const i=this._convertToCreate(this,n,r);if(e===this.project_name)return i;const a=d=>gg(`${d}:${e}`,gg.DNS),s=a(i.id),o=i.trace_id?a(i.trace_id):void 0,l=i.parent_run_id?a(i.parent_run_id):void 0;let u;if(i.dotted_order){const d=vP(i.dotted_order),f=[];for(let m=0;m<d.length-1;m++){const[v,_]=d[m],p=a(_);f.push(v.toISOString().replace(/[-:]/g,"").replace(".","")+p)}const[h]=d[d.length-1];f.push(h.toISOString().replace(/[-:]/g,"").replace(".","")+s),u=f.join(".")}else u=void 0;return{...i,id:s,trace_id:o,parent_run_id:l,dotted_order:u,session_name:e}}async postRun(e=!0){try{const n=Yw();if(this.replicas&&this.replicas.length>0)for(const{projectName:r,apiKey:i,apiUrl:a}of this.replicas){const s=this._remapForProject(r??this.project_name,n,!0);await this.client.createRun(s,{apiKey:i,apiUrl:a})}else{const r=this._convertToCreate(this,n,e);await this.client.createRun(r)}if(!e){i_("Posting with excludeChildRuns=false is deprecated and will be removed in a future version.");for(const r of this.child_runs)await r.postRun(!1)}}catch(n){console.error(`Error in postRun for run ${this.id}:`,n)}}async patchRun(){var e;if(this.replicas&&this.replicas.length>0)for(const{projectName:n,apiKey:r,apiUrl:i,updates:a}of this.replicas){const s=this._remapForProject(n??this.project_name);await this.client.updateRun(s.id,{inputs:s.inputs,outputs:s.outputs,error:s.error,parent_run_id:s.parent_run_id,session_name:s.session_name,reference_example_id:s.reference_example_id,end_time:s.end_time,dotted_order:s.dotted_order,trace_id:s.trace_id,events:s.events,tags:s.tags,extra:s.extra,attachments:this.attachments,...a},{apiKey:r,apiUrl:i})}else try{const n={end_time:this.end_time,error:this.error,inputs:this.inputs,outputs:this.outputs,parent_run_id:((e=this.parent_run)==null?void 0:e.id)??this.parent_run_id,reference_example_id:this.reference_example_id,extra:this.extra,events:this.events,dotted_order:this.dotted_order,trace_id:this.trace_id,tags:this.tags,attachments:this.attachments,session_name:this.project_name};await this.client.updateRun(this.id,n)}catch(n){console.error(`Error in patchRun for run ${this.id}`,n)}}toJSON(){return this._convertToCreate(this,void 0,!1)}addEvent(e){this.events||(this.events=[]),typeof e=="string"?this.events.push({name:"event",time:new Date().toISOString(),message:e}):this.events.push({...e,time:e.time??new Date().toISOString()})}static fromRunnableConfig(e,n){var u,c,d,f;const r=e==null?void 0:e.callbacks;let i,a,s,o=hP();if(r){const h=((u=r==null?void 0:r.getParentRunId)==null?void 0:u.call(r))??"",m=(c=r==null?void 0:r.handlers)==null?void 0:c.find(v=>(v==null?void 0:v.name)=="langchain_tracer");i=(d=m==null?void 0:m.getRun)==null?void 0:d.call(m,h),a=m==null?void 0:m.projectName,s=m==null?void 0:m.client,o=o||!!m}return i?new mt({name:i.name,id:i.id,trace_id:i.trace_id,dotted_order:i.dotted_order,client:s,tracingEnabled:o,project_name:a,tags:[...new Set(((i==null?void 0:i.tags)??[]).concat((e==null?void 0:e.tags)??[]))],extra:{metadata:{...(f=i==null?void 0:i.extra)==null?void 0:f.metadata,...e==null?void 0:e.metadata}}}).createChild(n):new mt({...n,client:s,tracingEnabled:o,project_name:a})}static fromDottedOrder(e){return this.fromHeaders({"langsmith-trace":e})}static fromHeaders(e,n){var u;const r="get"in e&&typeof e.get=="function"?{"langsmith-trace":e.get("langsmith-trace"),baggage:e.get("baggage")}:e,i=r["langsmith-trace"];if(!i||typeof i!="string")return;const a=i.trim(),s=a.split(".").map(c=>{const[d,f]=c.split("Z");return{strTime:d,time:Date.parse(d+"Z"),uuid:f}}),o=s[0].uuid,l={...n,name:(n==null?void 0:n.name)??"parent",run_type:(n==null?void 0:n.run_type)??"chain",start_time:(n==null?void 0:n.start_time)??Date.now(),id:(u=s.at(-1))==null?void 0:u.uuid,trace_id:o,dotted_order:a};if(r.baggage&&typeof r.baggage=="string"){const c=cl.fromHeader(r.baggage);l.metadata=c.metadata,l.tags=c.tags,l.project_name=c.project_name,l.replicas=c.replicas}return new mt(l)}toHeaders(e){var r;const n={"langsmith-trace":this.dotted_order,baggage:new cl((r=this.extra)==null?void 0:r.metadata,this.tags,this.project_name,this.replicas).toHeader()};if(e)for(const[i,a]of Object.entries(n))e.set(i,a);return n}}Object.defineProperty(mt,"sharedClient",{enumerable:!0,configurable:!0,writable:!0,value:null});function mP(t){return t!==void 0&&typeof t.createChild=="function"&&typeof t.postRun=="function"}function m_(t){return typeof t=="object"&&t!=null&&typeof t.name=="string"&&t.name==="langchain_tracer"}function Qg(t){return Array.isArray(t)&&t.some(e=>m_(e))}function gP(t){return typeof t=="object"&&t!=null&&Array.isArray(t.handlers)}function yP(t){var e;return t!==void 0&&typeof t.callbacks=="object"&&(Qg((e=t.callbacks)==null?void 0:e.handlers)||Qg(t.callbacks))}function vP(t){return t.split(".").map(n=>{const r=n.slice(0,-36),i=n.slice(-36),a=parseInt(r.slice(0,4)),s=parseInt(r.slice(4,6))-1,o=parseInt(r.slice(6,8)),l=parseInt(r.slice(9,11)),u=parseInt(r.slice(11,13)),c=parseInt(r.slice(13,15)),d=parseInt(r.slice(15,21));return[new Date(a,s,o,l,u,c,d/1e3),i]})}function wP(){const t=ln("LANGSMITH_RUNS_ENDPOINTS");if(!t)return[];try{const e=JSON.parse(t);return bP(e),Object.entries(e).map(([n,r])=>({apiUrl:n.replace(/\/$/,""),apiKey:r}))}catch(e){if(eP(e))throw e;return console.warn("Invalid LANGSMITH_RUNS_ENDPOINTS  must be valid JSON mapping of url->apiKey"),[]}}function _P(t){return t?t.map(e=>Array.isArray(e)?{projectName:e[0],updates:e[1]}:e):wP()}function bP(t){if(Object.keys(t).length>0&&Bt("ENDPOINT"))throw new XR}class xP{}function EP(t){return"lc_prefer_streaming"in t&&t.lc_prefer_streaming}class Os extends xP{get lc_namespace(){return["langchain_core","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,Lw(this.constructor)]}constructor(e){super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreCustomEvent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"raiseError",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:zr("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent,this.ignoreRetriever=e.ignoreRetriever??this.ignoreRetriever,this.ignoreCustomEvent=e.ignoreCustomEvent??this.ignoreCustomEvent,this.raiseError=e.raiseError??this.raiseError,this.awaitHandlers=this.raiseError||(e._awaitHandler??this.awaitHandlers))}copy(){return new this.constructor(this)}toJSON(){return qr.prototype.toJSON.call(this)}toJSONNotImplemented(){return qr.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){class n extends Os{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:lt()}),Object.assign(this,e)}}return new n}}const SP=t=>{const e=t;return e!==void 0&&typeof e.copy=="function"&&typeof e.name=="string"&&typeof e.awaitHandlers=="boolean"},kP=t=>{if(t)return t.events=t.events??[],t.child_runs=t.child_runs??[],t};function Rd(t,e){if(t)return new mt({...t,start_time:t._serialized_start_time??t.start_time,parent_run:Rd(e),child_runs:t.child_runs.map(n=>Rd(n)).filter(n=>n!==void 0),extra:{...t.extra,runtime:EO()},tracingEnabled:!1})}function rc(t,e){return t&&!Array.isArray(t)&&typeof t=="object"?t:{[e]:t}}function ma(t){return typeof t._addRunToRunMap=="function"}class Ns extends Os{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"runTreeMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"usesRunTreeMap",{enumerable:!0,configurable:!0,writable:!0,value:!1})}copy(){return this}getRunById(e){if(e!==void 0)return this.usesRunTreeMap?kP(this.runTreeMap.get(e)):this.runMap.get(e)}stringifyError(e){return e instanceof Error?e.message+(e!=null&&e.stack?`

${e.stack}`:""):typeof e=="string"?e:`${e}`}_addChildRun(e,n){e.child_runs.push(n)}_addRunToRunMap(e){const{dottedOrder:n,microsecondPrecisionDatestring:r}=p_(new Date(e.start_time).getTime(),e.id,e.execution_order),i={...e},a=this.getRunById(i.parent_run_id);if(i.parent_run_id!==void 0?a&&(this._addChildRun(a,i),a.child_execution_order=Math.max(a.child_execution_order,i.child_execution_order),i.trace_id=a.trace_id,a.dotted_order!==void 0&&(i.dotted_order=[a.dotted_order,n].join("."),i._serialized_start_time=r)):(i.trace_id=i.id,i.dotted_order=n,i._serialized_start_time=r),this.usesRunTreeMap){const s=Rd(i,a);s!==void 0&&this.runTreeMap.set(i.id,s)}else this.runMap.set(i.id,i);return i}async _endTrace(e){var r;const n=e.parent_run_id!==void 0&&this.getRunById(e.parent_run_id);n?n.child_execution_order=Math.max(n.child_execution_order,e.child_execution_order):await this.persistRun(e),await((r=this.onRunUpdate)==null?void 0:r.call(this,e)),this.usesRunTreeMap?this.runTreeMap.delete(e.id):this.runMap.delete(e.id)}_getExecutionOrder(e){const n=e!==void 0&&this.getRunById(e);return n?n.child_execution_order+1:1}_createRunForLLMStart(e,n,r,i,a,s,o,l){const u=this._getExecutionOrder(i),c=Date.now(),d=o?{...a,metadata:o}:a,f={id:r,name:l??e.id[e.id.length-1],parent_run_id:i,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:{prompts:n},execution_order:u,child_runs:[],child_execution_order:u,run_type:"llm",extra:d??{},tags:s||[]};return this._addRunToRunMap(f)}async handleLLMStart(e,n,r,i,a,s,o,l){var c,d;const u=this.getRunById(r)??this._createRunForLLMStart(e,n,r,i,a,s,o,l);return await((c=this.onRunCreate)==null?void 0:c.call(this,u)),await((d=this.onLLMStart)==null?void 0:d.call(this,u)),u}_createRunForChatModelStart(e,n,r,i,a,s,o,l){const u=this._getExecutionOrder(i),c=Date.now(),d=o?{...a,metadata:o}:a,f={id:r,name:l??e.id[e.id.length-1],parent_run_id:i,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:{messages:n},execution_order:u,child_runs:[],child_execution_order:u,run_type:"llm",extra:d??{},tags:s||[]};return this._addRunToRunMap(f)}async handleChatModelStart(e,n,r,i,a,s,o,l){var c,d;const u=this.getRunById(r)??this._createRunForChatModelStart(e,n,r,i,a,s,o,l);return await((c=this.onRunCreate)==null?void 0:c.call(this,u)),await((d=this.onLLMStart)==null?void 0:d.call(this,u)),u}async handleLLMEnd(e,n,r,i,a){var o;const s=this.getRunById(n);if(!s||(s==null?void 0:s.run_type)!=="llm")throw new Error("No LLM run to end.");return s.end_time=Date.now(),s.outputs=e,s.events.push({name:"end",time:new Date(s.end_time).toISOString()}),s.extra={...s.extra,...a},await((o=this.onLLMEnd)==null?void 0:o.call(this,s)),await this._endTrace(s),s}async handleLLMError(e,n,r,i,a){var o;const s=this.getRunById(n);if(!s||(s==null?void 0:s.run_type)!=="llm")throw new Error("No LLM run to end.");return s.end_time=Date.now(),s.error=this.stringifyError(e),s.events.push({name:"error",time:new Date(s.end_time).toISOString()}),s.extra={...s.extra,...a},await((o=this.onLLMError)==null?void 0:o.call(this,s)),await this._endTrace(s),s}_createRunForChainStart(e,n,r,i,a,s,o,l){const u=this._getExecutionOrder(i),c=Date.now(),d={id:r,name:l??e.id[e.id.length-1],parent_run_id:i,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:n,execution_order:u,child_execution_order:u,run_type:o??"chain",child_runs:[],extra:s?{metadata:s}:{},tags:a||[]};return this._addRunToRunMap(d)}async handleChainStart(e,n,r,i,a,s,o,l){var c,d;const u=this.getRunById(r)??this._createRunForChainStart(e,n,r,i,a,s,o,l);return await((c=this.onRunCreate)==null?void 0:c.call(this,u)),await((d=this.onChainStart)==null?void 0:d.call(this,u)),u}async handleChainEnd(e,n,r,i,a){var o;const s=this.getRunById(n);if(!s)throw new Error("No chain run to end.");return s.end_time=Date.now(),s.outputs=rc(e,"output"),s.events.push({name:"end",time:new Date(s.end_time).toISOString()}),(a==null?void 0:a.inputs)!==void 0&&(s.inputs=rc(a.inputs,"input")),await((o=this.onChainEnd)==null?void 0:o.call(this,s)),await this._endTrace(s),s}async handleChainError(e,n,r,i,a){var o;const s=this.getRunById(n);if(!s)throw new Error("No chain run to end.");return s.end_time=Date.now(),s.error=this.stringifyError(e),s.events.push({name:"error",time:new Date(s.end_time).toISOString()}),(a==null?void 0:a.inputs)!==void 0&&(s.inputs=rc(a.inputs,"input")),await((o=this.onChainError)==null?void 0:o.call(this,s)),await this._endTrace(s),s}_createRunForToolStart(e,n,r,i,a,s,o){const l=this._getExecutionOrder(i),u=Date.now(),c={id:r,name:o??e.id[e.id.length-1],parent_run_id:i,start_time:u,serialized:e,events:[{name:"start",time:new Date(u).toISOString()}],inputs:{input:n},execution_order:l,child_execution_order:l,run_type:"tool",child_runs:[],extra:s?{metadata:s}:{},tags:a||[]};return this._addRunToRunMap(c)}async handleToolStart(e,n,r,i,a,s,o){var u,c;const l=this.getRunById(r)??this._createRunForToolStart(e,n,r,i,a,s,o);return await((u=this.onRunCreate)==null?void 0:u.call(this,l)),await((c=this.onToolStart)==null?void 0:c.call(this,l)),l}async handleToolEnd(e,n){var i;const r=this.getRunById(n);if(!r||(r==null?void 0:r.run_type)!=="tool")throw new Error("No tool run to end");return r.end_time=Date.now(),r.outputs={output:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await((i=this.onToolEnd)==null?void 0:i.call(this,r)),await this._endTrace(r),r}async handleToolError(e,n){var i;const r=this.getRunById(n);if(!r||(r==null?void 0:r.run_type)!=="tool")throw new Error("No tool run to end");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await((i=this.onToolError)==null?void 0:i.call(this,r)),await this._endTrace(r),r}async handleAgentAction(e,n){var a;const r=this.getRunById(n);if(!r||(r==null?void 0:r.run_type)!=="chain")return;const i=r;i.actions=i.actions||[],i.actions.push(e),i.events.push({name:"agent_action",time:new Date().toISOString(),kwargs:{action:e}}),await((a=this.onAgentAction)==null?void 0:a.call(this,r))}async handleAgentEnd(e,n){var i;const r=this.getRunById(n);!r||(r==null?void 0:r.run_type)!=="chain"||(r.events.push({name:"agent_end",time:new Date().toISOString(),kwargs:{action:e}}),await((i=this.onAgentEnd)==null?void 0:i.call(this,r)))}_createRunForRetrieverStart(e,n,r,i,a,s,o){const l=this._getExecutionOrder(i),u=Date.now(),c={id:r,name:o??e.id[e.id.length-1],parent_run_id:i,start_time:u,serialized:e,events:[{name:"start",time:new Date(u).toISOString()}],inputs:{query:n},execution_order:l,child_execution_order:l,run_type:"retriever",child_runs:[],extra:s?{metadata:s}:{},tags:a||[]};return this._addRunToRunMap(c)}async handleRetrieverStart(e,n,r,i,a,s,o){var u,c;const l=this.getRunById(r)??this._createRunForRetrieverStart(e,n,r,i,a,s,o);return await((u=this.onRunCreate)==null?void 0:u.call(this,l)),await((c=this.onRetrieverStart)==null?void 0:c.call(this,l)),l}async handleRetrieverEnd(e,n){var i;const r=this.getRunById(n);if(!r||(r==null?void 0:r.run_type)!=="retriever")throw new Error("No retriever run to end");return r.end_time=Date.now(),r.outputs={documents:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await((i=this.onRetrieverEnd)==null?void 0:i.call(this,r)),await this._endTrace(r),r}async handleRetrieverError(e,n){var i;const r=this.getRunById(n);if(!r||(r==null?void 0:r.run_type)!=="retriever")throw new Error("No retriever run to end");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await((i=this.onRetrieverError)==null?void 0:i.call(this,r)),await this._endTrace(r),r}async handleText(e,n){var i;const r=this.getRunById(n);!r||(r==null?void 0:r.run_type)!=="chain"||(r.events.push({name:"text",time:new Date().toISOString(),kwargs:{text:e}}),await((i=this.onText)==null?void 0:i.call(this,r)))}async handleLLMNewToken(e,n,r,i,a,s){var l;const o=this.getRunById(r);if(!o||(o==null?void 0:o.run_type)!=="llm")throw new Error('Invalid "runId" provided to "handleLLMNewToken" callback.');return o.events.push({name:"new_token",time:new Date().toISOString(),kwargs:{token:e,idx:n,chunk:s==null?void 0:s.chunk}}),await((l=this.onLLMNewToken)==null?void 0:l.call(this,o,e,{chunk:s==null?void 0:s.chunk})),o}}var yh={exports:{}};yh.exports;(function(t){const n=(a=0)=>s=>`\x1B[${38+a};5;${s}m`,r=(a=0)=>(s,o,l)=>`\x1B[${38+a};2;${s};${o};${l}m`;function i(){const a=new Map,s={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};s.color.gray=s.color.blackBright,s.bgColor.bgGray=s.bgColor.bgBlackBright,s.color.grey=s.color.blackBright,s.bgColor.bgGrey=s.bgColor.bgBlackBright;for(const[o,l]of Object.entries(s)){for(const[u,c]of Object.entries(l))s[u]={open:`\x1B[${c[0]}m`,close:`\x1B[${c[1]}m`},l[u]=s[u],a.set(c[0],c[1]);Object.defineProperty(s,o,{value:l,enumerable:!1})}return Object.defineProperty(s,"codes",{value:a,enumerable:!1}),s.color.close="\x1B[39m",s.bgColor.close="\x1B[49m",s.color.ansi256=n(),s.color.ansi16m=r(),s.bgColor.ansi256=n(10),s.bgColor.ansi16m=r(10),Object.defineProperties(s,{rgbToAnsi256:{value:(o,l,u)=>o===l&&l===u?o<8?16:o>248?231:Math.round((o-8)/247*24)+232:16+36*Math.round(o/255*5)+6*Math.round(l/255*5)+Math.round(u/255*5),enumerable:!1},hexToRgb:{value:o=>{const l=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(o.toString(16));if(!l)return[0,0,0];let{colorString:u}=l.groups;u.length===3&&(u=u.split("").map(d=>d+d).join(""));const c=Number.parseInt(u,16);return[c>>16&255,c>>8&255,c&255]},enumerable:!1},hexToAnsi256:{value:o=>s.rgbToAnsi256(...s.hexToRgb(o)),enumerable:!1}}),s}Object.defineProperty(t,"exports",{enumerable:!0,get:i})})(yh);var CP=yh.exports;const g_=ms(CP);function at(t,e){return`${t.open}${e}${t.close}`}function Mt(t,e){try{return JSON.stringify(t,null,2)}catch{return e}}function Xg(t){return typeof t=="string"?t.trim():t==null?t:Mt(t,t.toString())}function Yn(t){if(!t.end_time)return"";const e=t.end_time-t.start_time;return e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`}const{color:ht}=g_;class ey extends Ns{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){const n=[];let r=e;for(;r.parent_run_id;){const i=this.runMap.get(r.parent_run_id);if(i)n.push(i),r=i;else break}return n}getBreadcrumbs(e){const r=[...this.getParents(e).reverse(),e].map((i,a,s)=>{const o=`${i.execution_order}:${i.run_type}:${i.name}`;return a===s.length-1?at(g_.bold,o):o}).join(" > ");return at(ht.grey,r)}onChainStart(e){const n=this.getBreadcrumbs(e);console.log(`${at(ht.green,"[chain/start]")} [${n}] Entering Chain run with input: ${Mt(e.inputs,"[inputs]")}`)}onChainEnd(e){const n=this.getBreadcrumbs(e);console.log(`${at(ht.cyan,"[chain/end]")} [${n}] [${Yn(e)}] Exiting Chain run with output: ${Mt(e.outputs,"[outputs]")}`)}onChainError(e){const n=this.getBreadcrumbs(e);console.log(`${at(ht.red,"[chain/error]")} [${n}] [${Yn(e)}] Chain run errored with error: ${Mt(e.error,"[error]")}`)}onLLMStart(e){const n=this.getBreadcrumbs(e),r="prompts"in e.inputs?{prompts:e.inputs.prompts.map(i=>i.trim())}:e.inputs;console.log(`${at(ht.green,"[llm/start]")} [${n}] Entering LLM run with input: ${Mt(r,"[inputs]")}`)}onLLMEnd(e){const n=this.getBreadcrumbs(e);console.log(`${at(ht.cyan,"[llm/end]")} [${n}] [${Yn(e)}] Exiting LLM run with output: ${Mt(e.outputs,"[response]")}`)}onLLMError(e){const n=this.getBreadcrumbs(e);console.log(`${at(ht.red,"[llm/error]")} [${n}] [${Yn(e)}] LLM run errored with error: ${Mt(e.error,"[error]")}`)}onToolStart(e){const n=this.getBreadcrumbs(e);console.log(`${at(ht.green,"[tool/start]")} [${n}] Entering Tool run with input: "${Xg(e.inputs.input)}"`)}onToolEnd(e){var r;const n=this.getBreadcrumbs(e);console.log(`${at(ht.cyan,"[tool/end]")} [${n}] [${Yn(e)}] Exiting Tool run with output: "${Xg((r=e.outputs)==null?void 0:r.output)}"`)}onToolError(e){const n=this.getBreadcrumbs(e);console.log(`${at(ht.red,"[tool/error]")} [${n}] [${Yn(e)}] Tool run errored with error: ${Mt(e.error,"[error]")}`)}onRetrieverStart(e){const n=this.getBreadcrumbs(e);console.log(`${at(ht.green,"[retriever/start]")} [${n}] Entering Retriever run with input: ${Mt(e.inputs,"[inputs]")}`)}onRetrieverEnd(e){const n=this.getBreadcrumbs(e);console.log(`${at(ht.cyan,"[retriever/end]")} [${n}] [${Yn(e)}] Exiting Retriever run with output: ${Mt(e.outputs,"[outputs]")}`)}onRetrieverError(e){const n=this.getBreadcrumbs(e);console.log(`${at(ht.red,"[retriever/error]")} [${n}] [${Yn(e)}] Retriever run errored with error: ${Mt(e.error,"[error]")}`)}onAgentAction(e){const n=e,r=this.getBreadcrumbs(e);console.log(`${at(ht.blue,"[agent/action]")} [${r}] Agent selected action: ${Mt(n.actions[n.actions.length-1],"[action]")}`)}}let ic;const TP=()=>{if(ic===void 0){const t=zr("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"?{blockOnRootRunFinalization:!0}:{};ic=new ds(t)}return ic};class Fa extends Ns{constructor(e={}){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"replicas",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"usesRunTreeMap",{enumerable:!0,configurable:!0,writable:!0,value:!0});const{exampleId:n,projectName:r,client:i,replicas:a}=e;this.projectName=r??qw(),this.replicas=a,this.exampleId=n,this.client=i??TP();const s=Fa.getTraceableRunTree();s&&this.updateFromRunTree(s)}async persistRun(e){}async onRunCreate(e){const n=this.getRunTreeWithTracingConfig(e.id);await(n==null?void 0:n.postRun())}async onRunUpdate(e){const n=this.getRunTreeWithTracingConfig(e.id);await(n==null?void 0:n.patchRun())}getRun(e){return this.runTreeMap.get(e)}updateFromRunTree(e){let n=e;const r=new Set;for(;n.parent_run&&!(r.has(n.id)||(r.add(n.id),!n.parent_run));)n=n.parent_run;r.clear();const i=[n];for(;i.length>0;){const a=i.shift();!a||r.has(a.id)||(r.add(a.id),this.runTreeMap.set(a.id,a),a.child_runs&&i.push(...a.child_runs))}this.client=e.client??this.client,this.replicas=e.replicas??this.replicas,this.projectName=e.project_name??this.projectName,this.exampleId=e.reference_example_id??this.exampleId}getRunTreeWithTracingConfig(e){const n=this.runTreeMap.get(e);if(n)return new mt({...n,client:this.client,project_name:this.projectName,replicas:this.replicas,reference_example_id:this.exampleId,tracingEnabled:!0})}static getTraceableRunTree(){try{return VN(!0)}catch{return}}}const y_=Symbol.for("ls:tracing_async_local_storage"),Co=Symbol.for("lc:context_variables"),OP=t=>{globalThis[y_]=t},fs=()=>globalThis[y_];let za;function NP(){const t="default"in Fn?Fn.default:Fn;return new t({autoStart:!0,concurrency:1})}function IP(){return typeof za>"u"&&(za=NP()),za}async function Fe(t,e){if(e===!0){const n=fs();n!==void 0?await n.run(void 0,async()=>t()):await t()}else za=IP(),za.add(async()=>{const n=fs();n!==void 0?await n.run(void 0,async()=>t()):await t()})}const AP=t=>!!["LANGSMITH_TRACING_V2","LANGCHAIN_TRACING_V2","LANGSMITH_TRACING","LANGCHAIN_TRACING"].find(n=>zr(n)==="true");function v_(t){var r;const e=fs();if(e===void 0)return;const n=e.getStore();return(r=n==null?void 0:n[Co])==null?void 0:r[t]}const RP=Symbol("lc:configure_hooks"),PP=()=>v_(RP)||[];class jP{setHandler(e){return this.setHandlers([e])}}class Wl{constructor(e,n,r,i,a,s,o,l){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:l})}get parentRunId(){return this._parentRunId}async handleText(e){await Promise.all(this.handlers.map(n=>Fe(async()=>{var r;try{await((r=n.handleText)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(i){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleText: ${i}`),n.raiseError)throw i}},n.awaitHandlers)))}async handleCustomEvent(e,n,r,i,a){await Promise.all(this.handlers.map(s=>Fe(async()=>{var o;try{await((o=s.handleCustomEvent)==null?void 0:o.call(s,e,n,this.runId,this.tags,this.metadata))}catch(l){if((s.raiseError?console.error:console.warn)(`Error in handler ${s.constructor.name}, handleCustomEvent: ${l}`),s.raiseError)throw l}},s.awaitHandlers)))}}class LP extends Wl{getChild(e){const n=new vt(this.runId);return n.setHandlers(this.inheritableHandlers),n.addTags(this.inheritableTags),n.addMetadata(this.inheritableMetadata),e&&n.addTags([e],!1),n}async handleRetrieverEnd(e){await Promise.all(this.handlers.map(n=>Fe(async()=>{var r;if(!n.ignoreRetriever)try{await((r=n.handleRetrieverEnd)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(i){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleRetriever`),n.raiseError)throw i}},n.awaitHandlers)))}async handleRetrieverError(e){await Promise.all(this.handlers.map(n=>Fe(async()=>{var r;if(!n.ignoreRetriever)try{await((r=n.handleRetrieverError)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(i){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleRetrieverError: ${i}`),n.raiseError)throw e}},n.awaitHandlers)))}}class ty extends Wl{async handleLLMNewToken(e,n,r,i,a,s){await Promise.all(this.handlers.map(o=>Fe(async()=>{var l;if(!o.ignoreLLM)try{await((l=o.handleLLMNewToken)==null?void 0:l.call(o,e,n??{prompt:0,completion:0},this.runId,this._parentRunId,this.tags,s))}catch(u){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleLLMNewToken: ${u}`),o.raiseError)throw u}},o.awaitHandlers)))}async handleLLMError(e,n,r,i,a){await Promise.all(this.handlers.map(s=>Fe(async()=>{var o;if(!s.ignoreLLM)try{await((o=s.handleLLMError)==null?void 0:o.call(s,e,this.runId,this._parentRunId,this.tags,a))}catch(l){if((s.raiseError?console.error:console.warn)(`Error in handler ${s.constructor.name}, handleLLMError: ${l}`),s.raiseError)throw l}},s.awaitHandlers)))}async handleLLMEnd(e,n,r,i,a){await Promise.all(this.handlers.map(s=>Fe(async()=>{var o;if(!s.ignoreLLM)try{await((o=s.handleLLMEnd)==null?void 0:o.call(s,e,this.runId,this._parentRunId,this.tags,a))}catch(l){if((s.raiseError?console.error:console.warn)(`Error in handler ${s.constructor.name}, handleLLMEnd: ${l}`),s.raiseError)throw l}},s.awaitHandlers)))}}class $P extends Wl{getChild(e){const n=new vt(this.runId);return n.setHandlers(this.inheritableHandlers),n.addTags(this.inheritableTags),n.addMetadata(this.inheritableMetadata),e&&n.addTags([e],!1),n}async handleChainError(e,n,r,i,a){await Promise.all(this.handlers.map(s=>Fe(async()=>{var o;if(!s.ignoreChain)try{await((o=s.handleChainError)==null?void 0:o.call(s,e,this.runId,this._parentRunId,this.tags,a))}catch(l){if((s.raiseError?console.error:console.warn)(`Error in handler ${s.constructor.name}, handleChainError: ${l}`),s.raiseError)throw l}},s.awaitHandlers)))}async handleChainEnd(e,n,r,i,a){await Promise.all(this.handlers.map(s=>Fe(async()=>{var o;if(!s.ignoreChain)try{await((o=s.handleChainEnd)==null?void 0:o.call(s,e,this.runId,this._parentRunId,this.tags,a))}catch(l){if((s.raiseError?console.error:console.warn)(`Error in handler ${s.constructor.name}, handleChainEnd: ${l}`),s.raiseError)throw l}},s.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(n=>Fe(async()=>{var r;if(!n.ignoreAgent)try{await((r=n.handleAgentAction)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(i){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleAgentAction: ${i}`),n.raiseError)throw i}},n.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(n=>Fe(async()=>{var r;if(!n.ignoreAgent)try{await((r=n.handleAgentEnd)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(i){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleAgentEnd: ${i}`),n.raiseError)throw i}},n.awaitHandlers)))}}class MP extends Wl{getChild(e){const n=new vt(this.runId);return n.setHandlers(this.inheritableHandlers),n.addTags(this.inheritableTags),n.addMetadata(this.inheritableMetadata),e&&n.addTags([e],!1),n}async handleToolError(e){await Promise.all(this.handlers.map(n=>Fe(async()=>{var r;if(!n.ignoreAgent)try{await((r=n.handleToolError)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(i){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleToolError: ${i}`),n.raiseError)throw i}},n.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(n=>Fe(async()=>{var r;if(!n.ignoreAgent)try{await((r=n.handleToolEnd)==null?void 0:r.call(n,e,this.runId,this._parentRunId,this.tags))}catch(i){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleToolEnd: ${i}`),n.raiseError)throw i}},n.awaitHandlers)))}}class vt extends jP{constructor(e,n){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=(n==null?void 0:n.handlers)??this.handlers,this.inheritableHandlers=(n==null?void 0:n.inheritableHandlers)??this.inheritableHandlers,this.tags=(n==null?void 0:n.tags)??this.tags,this.inheritableTags=(n==null?void 0:n.inheritableTags)??this.inheritableTags,this.metadata=(n==null?void 0:n.metadata)??this.metadata,this.inheritableMetadata=(n==null?void 0:n.inheritableMetadata)??this.inheritableMetadata,this._parentRunId=e}getParentRunId(){return this._parentRunId}async handleLLMStart(e,n,r=void 0,i=void 0,a=void 0,s=void 0,o=void 0,l=void 0){return Promise.all(n.map(async(u,c)=>{const d=c===0&&r?r:lt();return await Promise.all(this.handlers.map(f=>{if(!f.ignoreLLM)return ma(f)&&f._createRunForLLMStart(e,[u],d,this._parentRunId,a,this.tags,this.metadata,l),Fe(async()=>{var h;try{await((h=f.handleLLMStart)==null?void 0:h.call(f,e,[u],d,this._parentRunId,a,this.tags,this.metadata,l))}catch(m){if((f.raiseError?console.error:console.warn)(`Error in handler ${f.constructor.name}, handleLLMStart: ${m}`),f.raiseError)throw m}},f.awaitHandlers)})),new ty(d,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(e,n,r=void 0,i=void 0,a=void 0,s=void 0,o=void 0,l=void 0){return Promise.all(n.map(async(u,c)=>{const d=c===0&&r?r:lt();return await Promise.all(this.handlers.map(f=>{if(!f.ignoreLLM)return ma(f)&&f._createRunForChatModelStart(e,[u],d,this._parentRunId,a,this.tags,this.metadata,l),Fe(async()=>{var h,m;try{if(f.handleChatModelStart)await((h=f.handleChatModelStart)==null?void 0:h.call(f,e,[u],d,this._parentRunId,a,this.tags,this.metadata,l));else if(f.handleLLMStart){const v=Dw(u);await((m=f.handleLLMStart)==null?void 0:m.call(f,e,[v],d,this._parentRunId,a,this.tags,this.metadata,l))}}catch(v){if((f.raiseError?console.error:console.warn)(`Error in handler ${f.constructor.name}, handleLLMStart: ${v}`),f.raiseError)throw v}},f.awaitHandlers)})),new ty(d,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(e,n,r=lt(),i=void 0,a=void 0,s=void 0,o=void 0){return await Promise.all(this.handlers.map(l=>{if(!l.ignoreChain)return ma(l)&&l._createRunForChainStart(e,n,r,this._parentRunId,this.tags,this.metadata,i,o),Fe(async()=>{var u;try{await((u=l.handleChainStart)==null?void 0:u.call(l,e,n,r,this._parentRunId,this.tags,this.metadata,i,o))}catch(c){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleChainStart: ${c}`),l.raiseError)throw c}},l.awaitHandlers)})),new $P(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,n,r=lt(),i=void 0,a=void 0,s=void 0,o=void 0){return await Promise.all(this.handlers.map(l=>{if(!l.ignoreAgent)return ma(l)&&l._createRunForToolStart(e,n,r,this._parentRunId,this.tags,this.metadata,o),Fe(async()=>{var u;try{await((u=l.handleToolStart)==null?void 0:u.call(l,e,n,r,this._parentRunId,this.tags,this.metadata,o))}catch(c){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleToolStart: ${c}`),l.raiseError)throw c}},l.awaitHandlers)})),new MP(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleRetrieverStart(e,n,r=lt(),i=void 0,a=void 0,s=void 0,o=void 0){return await Promise.all(this.handlers.map(l=>{if(!l.ignoreRetriever)return ma(l)&&l._createRunForRetrieverStart(e,n,r,this._parentRunId,this.tags,this.metadata,o),Fe(async()=>{var u;try{await((u=l.handleRetrieverStart)==null?void 0:u.call(l,e,n,r,this._parentRunId,this.tags,this.metadata,o))}catch(c){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleRetrieverStart: ${c}`),l.raiseError)throw c}},l.awaitHandlers)})),new LP(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleCustomEvent(e,n,r,i,a){await Promise.all(this.handlers.map(s=>Fe(async()=>{var o;if(!s.ignoreCustomEvent)try{await((o=s.handleCustomEvent)==null?void 0:o.call(s,e,n,r,this.tags,this.metadata))}catch(l){if((s.raiseError?console.error:console.warn)(`Error in handler ${s.constructor.name}, handleCustomEvent: ${l}`),s.raiseError)throw l}},s.awaitHandlers)))}addHandler(e,n=!0){this.handlers.push(e),n&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(n=>n!==e),this.inheritableHandlers=this.inheritableHandlers.filter(n=>n!==e)}setHandlers(e,n=!0){this.handlers=[],this.inheritableHandlers=[];for(const r of e)this.addHandler(r,n)}addTags(e,n=!0){this.removeTags(e),this.tags.push(...e),n&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter(n=>!e.includes(n)),this.inheritableTags=this.inheritableTags.filter(n=>!e.includes(n))}addMetadata(e,n=!0){this.metadata={...this.metadata,...e},n&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(const n of Object.keys(e))delete this.metadata[n],delete this.inheritableMetadata[n]}copy(e=[],n=!0){const r=new vt(this._parentRunId);for(const i of this.handlers){const a=this.inheritableHandlers.includes(i);r.addHandler(i,a)}for(const i of this.tags){const a=this.inheritableTags.includes(i);r.addTags([i],a)}for(const i of Object.keys(this.metadata)){const a=Object.keys(this.inheritableMetadata).includes(i);r.addMetadata({[i]:this.metadata[i]},a)}for(const i of e)r.handlers.filter(a=>a.name==="console_callback_handler").some(a=>a.name===i.name)||r.addHandler(i,n);return r}static fromHandlers(e){class n extends Os{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:lt()}),Object.assign(this,e)}}const r=new this;return r.addHandler(new n),r}static configure(e,n,r,i,a,s,o){return this._configureSync(e,n,r,i,a,s,o)}static _configureSync(e,n,r,i,a,s,o){var f,h;let l;(e||n)&&(Array.isArray(e)||!e?(l=new vt,l.setHandlers((e==null?void 0:e.map(dl))??[],!0)):l=e,l=l.copy(Array.isArray(n)?n.map(dl):n==null?void 0:n.handlers,!1));const u=zr("LANGCHAIN_VERBOSE")==="true"||(o==null?void 0:o.verbose),c=((f=Fa.getTraceableRunTree())==null?void 0:f.tracingEnabled)||AP(),d=c||(zr("LANGCHAIN_TRACING")??!1);if(u||d){if(l||(l=new vt),u&&!l.handlers.some(m=>m.name===ey.prototype.name)){const m=new ey;l.addHandler(m,!0)}if(d&&!l.handlers.some(m=>m.name==="langchain_tracer")&&c){const m=new Fa;l.addHandler(m,!0),l._parentRunId=((h=Fa.getTraceableRunTree())==null?void 0:h.id)??l._parentRunId}}for(const{contextVar:m,inheritable:v=!0,handlerClass:_,envVar:p}of PP()){const y=p&&zr(p)==="true"&&_;let g;const x=m!==void 0?v_(m):void 0;x&&SP(x)?g=x:y&&(g=new _({})),g!==void 0&&(l||(l=new vt),l.handlers.some(k=>k.name===g.name)||l.addHandler(g,v))}return(r||i)&&l&&(l.addTags(r??[]),l.addTags(i??[],!1)),(a||s)&&l&&(l.addMetadata(a??{}),l.addMetadata(s??{},!1)),l}}function dl(t){return"name"in t?t:Os.fromMethods(t)}class DP{getStore(){}run(e,n){return n()}enterWith(e){}}const FP=new DP,ny=Symbol.for("lc:child_config");class zP{getInstance(){return fs()??FP}getRunnableConfig(){var n,r;return(r=(n=this.getInstance().getStore())==null?void 0:n.extra)==null?void 0:r[ny]}runWithConfig(e,n,r){var c;const i=vt._configureSync(e==null?void 0:e.callbacks,void 0,e==null?void 0:e.tags,void 0,e==null?void 0:e.metadata),a=this.getInstance(),s=a.getStore(),o=i==null?void 0:i.getParentRunId(),l=(c=i==null?void 0:i.handlers)==null?void 0:c.find(d=>(d==null?void 0:d.name)==="langchain_tracer");let u;return l&&o?u=l.getRunTreeWithTracingConfig(o):r||(u=new mt({name:"<runnable_lambda>",tracingEnabled:!1})),u&&(u.extra={...u.extra,[ny]:e}),s!==void 0&&s[Co]!==void 0&&(u===void 0&&(u={}),u[Co]=s[Co]),a.run(u,n)}initializeGlobalInstance(e){fs()===void 0&&OP(e)}}const Sr=new zP,ac=25;async function un(t){return vt._configureSync(t==null?void 0:t.callbacks,void 0,t==null?void 0:t.tags,void 0,t==null?void 0:t.metadata)}function ry(...t){const e={};for(const n of t.filter(r=>!!r))for(const r of Object.keys(n))if(r==="metadata")e[r]={...e[r],...n[r]};else if(r==="tags"){const i=e[r]??[];e[r]=[...new Set(i.concat(n[r]??[]))]}else if(r==="configurable")e[r]={...e[r],...n[r]};else if(r==="timeout")e.timeout===void 0?e.timeout=n.timeout:n.timeout!==void 0&&(e.timeout=Math.min(e.timeout,n.timeout));else if(r==="signal")e.signal===void 0?e.signal=n.signal:n.signal!==void 0&&("any"in AbortSignal?e.signal=AbortSignal.any([e.signal,n.signal]):e.signal=n.signal);else if(r==="callbacks"){const i=e.callbacks,a=n.callbacks;if(Array.isArray(a))if(!i)e.callbacks=a;else if(Array.isArray(i))e.callbacks=i.concat(a);else{const s=i.copy();for(const o of a)s.addHandler(dl(o),!0);e.callbacks=s}else if(a)if(!i)e.callbacks=a;else if(Array.isArray(i)){const s=a.copy();for(const o of i)s.addHandler(dl(o),!0);e.callbacks=s}else e.callbacks=new vt(a._parentRunId,{handlers:i.handlers.concat(a.handlers),inheritableHandlers:i.inheritableHandlers.concat(a.inheritableHandlers),tags:Array.from(new Set(i.tags.concat(a.tags))),inheritableTags:Array.from(new Set(i.inheritableTags.concat(a.inheritableTags))),metadata:{...i.metadata,...a.metadata}})}else{const i=r;e[i]=n[i]??e[i]}return e}const UP=new Set(["string","number","boolean"]);function ge(t){var r;const e=Sr.getRunnableConfig();let n={tags:[],metadata:{},recursionLimit:25,runId:void 0};if(e){const{runId:i,runName:a,...s}=e;n=Object.entries(s).reduce((o,[l,u])=>(u!==void 0&&(o[l]=u),o),n)}if(t&&(n=Object.entries(t).reduce((i,[a,s])=>(s!==void 0&&(i[a]=s),i),n)),n!=null&&n.configurable)for(const i of Object.keys(n.configurable))UP.has(typeof n.configurable[i])&&!((r=n.metadata)!=null&&r[i])&&(n.metadata||(n.metadata={}),n.metadata[i]=n.configurable[i]);if(n.timeout!==void 0){if(n.timeout<=0)throw new Error("Timeout must be a positive number");const i=AbortSignal.timeout(n.timeout);n.signal!==void 0?"any"in AbortSignal&&(n.signal=AbortSignal.any([n.signal,i])):n.signal=i,delete n.timeout}return n}function nt(t={},{callbacks:e,maxConcurrency:n,recursionLimit:r,runName:i,configurable:a,runId:s}={}){const o=ge(t);return e!==void 0&&(delete o.runName,o.callbacks=e),r!==void 0&&(o.recursionLimit=r),n!==void 0&&(o.maxConcurrency=n),i!==void 0&&(o.runName=i),a!==void 0&&(o.configurable={...o.configurable,...a}),s!==void 0&&delete o.runId,o}function Gi(t){return t?{configurable:t.configurable,recursionLimit:t.recursionLimit,callbacks:t.callbacks,tags:t.tags,metadata:t.metadata,maxConcurrency:t.maxConcurrency,timeout:t.timeout,signal:t.signal}:void 0}async function kr(t,e){if(e===void 0)return t;let n;return Promise.race([t.catch(r=>{if(!(e!=null&&e.aborted))throw r}),new Promise((r,i)=>{n=()=>{i(new Error("Aborted"))},e.addEventListener("abort",n),e.aborted&&i(new Error("Aborted"))})]).finally(()=>e.removeEventListener("abort",n))}class Pt extends ReadableStream{constructor(){super(...arguments),Object.defineProperty(this,"reader",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}ensureReader(){this.reader||(this.reader=this.getReader())}async next(){this.ensureReader();try{const e=await this.reader.read();return e.done?(this.reader.releaseLock(),{done:!0,value:void 0}):{done:!1,value:e.value}}catch(e){throw this.reader.releaseLock(),e}}async return(){if(this.ensureReader(),this.locked){const e=this.reader.cancel();this.reader.releaseLock(),await e}return{done:!0,value:void 0}}async throw(e){if(this.ensureReader(),this.locked){const n=this.reader.cancel();this.reader.releaseLock(),await n}throw e}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}static fromReadableStream(e){const n=e.getReader();return new Pt({start(r){return i();function i(){return n.read().then(({done:a,value:s})=>{if(a){r.close();return}return r.enqueue(s),i()})}},cancel(){n.releaseLock()}})}static fromAsyncGenerator(e){return new Pt({async pull(n){const{value:r,done:i}=await e.next();i&&n.close(),n.enqueue(r)},async cancel(n){await e.return(n)}})}}function w_(t,e=2){const n=Array.from({length:e},()=>[]);return n.map(async function*(i){for(;;)if(i.length===0){const a=await t.next();for(const s of n)s.push(a)}else{if(i[0].done)return;yield i.shift().value}})}function cn(t,e){if(Array.isArray(t)&&Array.isArray(e))return t.concat(e);if(typeof t=="string"&&typeof e=="string")return t+e;if(typeof t=="number"&&typeof e=="number")return t+e;if("concat"in t&&typeof t.concat=="function")return t.concat(e);if(typeof t=="object"&&typeof e=="object"){const n={...t};for(const[r,i]of Object.entries(e))r in n&&!Array.isArray(n[r])?n[r]=cn(n[r],i):n[r]=i;return n}else throw new Error(`Cannot concat ${typeof t} and ${typeof e}`)}class ea{constructor(e){var n;Object.defineProperty(this,"generator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResult",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResultUsed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.generator=e.generator,this.config=e.config,this.signal=e.signal??((n=this.config)==null?void 0:n.signal),this.setup=new Promise((r,i)=>{Sr.runWithConfig(Gi(e.config),async()=>{this.firstResult=e.generator.next(),e.startSetup?this.firstResult.then(e.startSetup).then(r,i):this.firstResult.then(a=>r(void 0),i)},!0)})}async next(...e){var n;return(n=this.signal)==null||n.throwIfAborted(),this.firstResultUsed?Sr.runWithConfig(Gi(this.config),this.signal?async()=>kr(this.generator.next(...e),this.signal):async()=>this.generator.next(...e),!0):(this.firstResultUsed=!0,this.firstResult)}async return(e){return this.generator.return(e)}async throw(e){return this.generator.throw(e)}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}}async function BP(t,e,n,r,...i){const a=new ea({generator:e,startSetup:n,signal:r}),s=await a.setup;return{output:t(a,s,...i),setup:s}}class nr{constructor(e){Object.defineProperty(this,"ops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.ops=e.ops??[]}concat(e){const n=this.ops.concat(e.ops),r=ol({},n);return new hs({ops:n,state:r[r.length-1].newDocument})}}class hs extends nr{constructor(e){super(e),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.state=e.state}concat(e){const n=this.ops.concat(e.ops),r=ol(this.state,e.ops);return new hs({ops:n,state:r[r.length-1].newDocument})}static fromRunLogPatch(e){const n=ol({},e.ops);return new hs({ops:e.ops,state:n[n.length-1].newDocument})}}const HP=t=>t.name==="log_stream_tracer";async function iy(t,e){if(e==="original")throw new Error("Do not assign inputs with original schema drop the key for now. When inputs are added to streamLog they should be added with standardized schema for streaming events.");const{inputs:n}=t;if(["retriever","llm","prompt"].includes(t.run_type))return n;if(!(Object.keys(n).length===1&&(n==null?void 0:n.input)===""))return n.input}async function ay(t,e){const{outputs:n}=t;return e==="original"||["retriever","llm","prompt"].includes(t.run_type)?n:n!==void 0&&Object.keys(n).length===1&&(n==null?void 0:n.output)!==void 0?n.output:n}function GP(t){return t!==void 0&&t.message!==void 0}class sy extends Ns{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_schemaFormat",{enumerable:!0,configurable:!0,writable:!0,value:"original"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"keyMapByRunId",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"counterMapByRunName",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"log_stream_tracer"}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this._schemaFormat=(e==null?void 0:e._schemaFormat)??this._schemaFormat,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=Pt.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){if(e.id===this.rootId)return!1;const n=e.tags??[];let r=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(e.run_type)),this.includeTags!==void 0&&(r=r||n.find(i=>{var a;return(a=this.includeTags)==null?void 0:a.includes(i)})!==void 0),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(e.run_type)),this.excludeTags!==void 0&&(r=r&&n.every(i=>{var a;return!((a=this.excludeTags)!=null&&a.includes(i))})),r}async*tapOutputIterable(e,n){for await(const r of n){if(e!==this.rootId){const i=this.keyMapByRunId[e];i&&await this.writer.write(new nr({ops:[{op:"add",path:`/logs/${i}/streamed_output/-`,value:r}]}))}yield r}}async onRunCreate(e){var i;if(this.rootId===void 0&&(this.rootId=e.id,await this.writer.write(new nr({ops:[{op:"replace",path:"",value:{id:e.id,name:e.name,type:e.run_type,streamed_output:[],final_output:void 0,logs:{}}}]}))),!this._includeRun(e))return;this.counterMapByRunName[e.name]===void 0&&(this.counterMapByRunName[e.name]=0),this.counterMapByRunName[e.name]+=1;const n=this.counterMapByRunName[e.name];this.keyMapByRunId[e.id]=n===1?e.name:`${e.name}:${n}`;const r={id:e.id,name:e.name,type:e.run_type,tags:e.tags??[],metadata:((i=e.extra)==null?void 0:i.metadata)??{},start_time:new Date(e.start_time).toISOString(),streamed_output:[],streamed_output_str:[],final_output:void 0,end_time:void 0};this._schemaFormat==="streaming_events"&&(r.inputs=await iy(e,this._schemaFormat)),await this.writer.write(new nr({ops:[{op:"add",path:`/logs/${this.keyMapByRunId[e.id]}`,value:r}]}))}async onRunUpdate(e){try{const n=this.keyMapByRunId[e.id];if(n===void 0)return;const r=[];this._schemaFormat==="streaming_events"&&r.push({op:"replace",path:`/logs/${n}/inputs`,value:await iy(e,this._schemaFormat)}),r.push({op:"add",path:`/logs/${n}/final_output`,value:await ay(e,this._schemaFormat)}),e.end_time!==void 0&&r.push({op:"add",path:`/logs/${n}/end_time`,value:new Date(e.end_time).toISOString()});const i=new nr({ops:r});await this.writer.write(i)}finally{if(e.id===this.rootId){const n=new nr({ops:[{op:"replace",path:"/final_output",value:await ay(e,this._schemaFormat)}]});await this.writer.write(n),this.autoClose&&await this.writer.close()}}}async onLLMNewToken(e,n,r){const i=this.keyMapByRunId[e.id];if(i===void 0)return;const a=e.inputs.messages!==void 0;let s;a?GP(r==null?void 0:r.chunk)?s=r==null?void 0:r.chunk:s=new Qi({id:`run-${e.id}`,content:n}):s=n;const o=new nr({ops:[{op:"add",path:`/logs/${i}/streamed_output_str/-`,value:n},{op:"add",path:`/logs/${i}/streamed_output/-`,value:s}]});await this.writer.write(o)}}const oy="__run";class Vi{constructor(e){Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generationInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.text=e.text,this.generationInfo=e.generationInfo}concat(e){return new Vi({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo}})}}class ps extends Vi{constructor(e){super(e),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.message=e.message}concat(e){return new ps({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo},message:this.message.concat(e.message)})}}function oo({name:t,serialized:e}){return t!==void 0?t:(e==null?void 0:e.name)!==void 0?e.name:(e==null?void 0:e.id)!==void 0&&Array.isArray(e==null?void 0:e.id)?e.id[e.id.length-1]:"Unnamed"}const VP=t=>t.name==="event_stream_tracer";class WP extends Ns{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runInfoMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"tappedPromises",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"event_stream_tracer"}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=Pt.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){const n=e.tags??[];let r=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(e.runType)),this.includeTags!==void 0&&(r=r||n.find(i=>{var a;return(a=this.includeTags)==null?void 0:a.includes(i)})!==void 0),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(e.runType)),this.excludeTags!==void 0&&(r=r&&n.every(i=>{var a;return!((a=this.excludeTags)!=null&&a.includes(i))})),r}async*tapOutputIterable(e,n){const r=await n.next();if(r.done)return;const i=this.runInfoMap.get(e);if(i===void 0){yield r.value;return}function a(o,l){return o==="llm"&&typeof l=="string"?new Vi({text:l}):l}let s=this.tappedPromises.get(e);if(s===void 0){let o;s=new Promise(l=>{o=l}),this.tappedPromises.set(e,s);try{const l={event:`on_${i.runType}_stream`,run_id:e,name:i.name,tags:i.tags,metadata:i.metadata,data:{}};await this.send({...l,data:{chunk:a(i.runType,r.value)}},i),yield r.value;for await(const u of n)i.runType!=="tool"&&i.runType!=="retriever"&&await this.send({...l,data:{chunk:a(i.runType,u)}},i),yield u}finally{o()}}else{yield r.value;for await(const o of n)yield o}}async send(e,n){this._includeRun(n)&&await this.writer.write(e)}async sendEndEvent(e,n){const r=this.tappedPromises.get(e.run_id);r!==void 0?r.then(()=>{this.send(e,n)}):await this.send(e,n)}async onLLMStart(e){var s,o;const n=oo(e),r=e.inputs.messages!==void 0?"chat_model":"llm",i={tags:e.tags??[],metadata:((s=e.extra)==null?void 0:s.metadata)??{},name:n,runType:r,inputs:e.inputs};this.runInfoMap.set(e.id,i);const a=`on_${r}_start`;await this.send({event:a,data:{input:e.inputs},name:n,tags:e.tags??[],run_id:e.id,metadata:((o=e.extra)==null?void 0:o.metadata)??{}},i)}async onLLMNewToken(e,n,r){const i=this.runInfoMap.get(e.id);let a,s;if(i===void 0)throw new Error(`onLLMNewToken: Run ID ${e.id} not found in run map.`);if(this.runInfoMap.size!==1){if(i.runType==="chat_model")s="on_chat_model_stream",(r==null?void 0:r.chunk)===void 0?a=new Qi({content:n,id:`run-${e.id}`}):a=r.chunk.message;else if(i.runType==="llm")s="on_llm_stream",(r==null?void 0:r.chunk)===void 0?a=new Vi({text:n}):a=r.chunk;else throw new Error(`Unexpected run type ${i.runType}`);await this.send({event:s,data:{chunk:a},run_id:e.id,name:i.name,tags:i.tags,metadata:i.metadata},i)}}async onLLMEnd(e){var s,o,l;const n=this.runInfoMap.get(e.id);this.runInfoMap.delete(e.id);let r;if(n===void 0)throw new Error(`onLLMEnd: Run ID ${e.id} not found in run map.`);const i=(s=e.outputs)==null?void 0:s.generations;let a;if(n.runType==="chat_model"){for(const u of i??[]){if(a!==void 0)break;a=(o=u[0])==null?void 0:o.message}r="on_chat_model_end"}else if(n.runType==="llm")a={generations:i==null?void 0:i.map(u=>u.map(c=>({text:c.text,generationInfo:c.generationInfo}))),llmOutput:((l=e.outputs)==null?void 0:l.llmOutput)??{}},r="on_llm_end";else throw new Error(`onLLMEnd: Unexpected run type: ${n.runType}`);await this.sendEndEvent({event:r,data:{output:a,input:n.inputs},run_id:e.id,name:n.name,tags:n.tags,metadata:n.metadata},n)}async onChainStart(e){var s,o;const n=oo(e),r=e.run_type??"chain",i={tags:e.tags??[],metadata:((s=e.extra)==null?void 0:s.metadata)??{},name:n,runType:e.run_type};let a={};e.inputs.input===""&&Object.keys(e.inputs).length===1?(a={},i.inputs={}):e.inputs.input!==void 0?(a.input=e.inputs.input,i.inputs=e.inputs.input):(a.input=e.inputs,i.inputs=e.inputs),this.runInfoMap.set(e.id,i),await this.send({event:`on_${r}_start`,data:a,name:n,tags:e.tags??[],run_id:e.id,metadata:((o=e.extra)==null?void 0:o.metadata)??{}},i)}async onChainEnd(e){var o;const n=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),n===void 0)throw new Error(`onChainEnd: Run ID ${e.id} not found in run map.`);const r=`on_${e.run_type}_end`,i=e.inputs??n.inputs??{},s={output:((o=e.outputs)==null?void 0:o.output)??e.outputs,input:i};i.input&&Object.keys(i).length===1&&(s.input=i.input,n.inputs=i.input),await this.sendEndEvent({event:r,data:s,run_id:e.id,name:n.name,tags:n.tags,metadata:n.metadata??{}},n)}async onToolStart(e){var i,a;const n=oo(e),r={tags:e.tags??[],metadata:((i=e.extra)==null?void 0:i.metadata)??{},name:n,runType:"tool",inputs:e.inputs??{}};this.runInfoMap.set(e.id,r),await this.send({event:"on_tool_start",data:{input:e.inputs??{}},name:n,run_id:e.id,tags:e.tags??[],metadata:((a=e.extra)==null?void 0:a.metadata)??{}},r)}async onToolEnd(e){var i;const n=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),n===void 0)throw new Error(`onToolEnd: Run ID ${e.id} not found in run map.`);if(n.inputs===void 0)throw new Error(`onToolEnd: Run ID ${e.id} is a tool call, and is expected to have traced inputs.`);const r=((i=e.outputs)==null?void 0:i.output)===void 0?e.outputs:e.outputs.output;await this.sendEndEvent({event:"on_tool_end",data:{output:r,input:n.inputs},run_id:e.id,name:n.name,tags:n.tags,metadata:n.metadata},n)}async onRetrieverStart(e){var a,s;const n=oo(e),i={tags:e.tags??[],metadata:((a=e.extra)==null?void 0:a.metadata)??{},name:n,runType:"retriever",inputs:{query:e.inputs.query}};this.runInfoMap.set(e.id,i),await this.send({event:"on_retriever_start",data:{input:{query:e.inputs.query}},name:n,tags:e.tags??[],run_id:e.id,metadata:((s=e.extra)==null?void 0:s.metadata)??{}},i)}async onRetrieverEnd(e){var r;const n=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),n===void 0)throw new Error(`onRetrieverEnd: Run ID ${e.id} not found in run map.`);await this.sendEndEvent({event:"on_retriever_end",data:{output:((r=e.outputs)==null?void 0:r.documents)??e.outputs,input:n.inputs},run_id:e.id,name:n.name,tags:n.tags,metadata:n.metadata},n)}async handleCustomEvent(e,n,r){const i=this.runInfoMap.get(r);if(i===void 0)throw new Error(`handleCustomEvent: Run ID ${r} not found in run map.`);await this.send({event:"on_custom_event",run_id:r,name:e,tags:i.tags,metadata:i.metadata,data:n},i)}async finish(){const e=[...this.tappedPromises.values()];Promise.all(e).finally(()=>{this.writer.close()})}}const ZP=[400,401,402,403,404,405,406,407,409],qP=t=>{var n,r;if(t.message.startsWith("Cancel")||t.message.startsWith("AbortError")||t.name==="AbortError"||(t==null?void 0:t.code)==="ECONNABORTED")throw t;const e=((n=t==null?void 0:t.response)==null?void 0:n.status)??(t==null?void 0:t.status);if(e&&ZP.includes(+e))throw t;if(((r=t==null?void 0:t.error)==null?void 0:r.code)==="insufficient_quota"){const i=new Error(t==null?void 0:t.message);throw i.name="InsufficientQuotaError",i}};class vh{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.onFailedAttempt=e.onFailedAttempt??qP;const n="default"in Fn?Fn.default:Fn;this.queue=new n({concurrency:this.maxConcurrency})}call(e,...n){return this.queue.add(()=>sl(()=>e(...n).catch(r=>{throw r instanceof Error?r:new Error(r)}),{onFailedAttempt:this.onFailedAttempt,retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,n,...r){return e.signal?Promise.race([this.call(n,...r),new Promise((i,a)=>{var s;(s=e.signal)==null||s.addEventListener("abort",()=>{a(new Error("AbortError"))})})]):this.call(n,...r)}fetch(...e){return this.call(()=>fetch(...e).then(n=>n.ok?n:Promise.reject(n)))}}class __ extends Ns{constructor({config:e,onStart:n,onEnd:r,onError:i}){super({_awaitHandler:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RootListenersTracer"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnStart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnEnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.config=e,this.argOnStart=n,this.argOnEnd=r,this.argOnError=i}persistRun(e){return Promise.resolve()}async onRunCreate(e){this.rootId||(this.rootId=e.id,this.argOnStart&&await this.argOnStart(e,this.config))}async onRunUpdate(e){e.id===this.rootId&&(e.error?this.argOnError&&await this.argOnError(e,this.config):this.argOnEnd&&await this.argOnEnd(e,this.config))}}function wh(t){return t?t.lc_runnable:!1}class KP{constructor(e){Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.includeNames=e.includeNames,this.includeTypes=e.includeTypes,this.includeTags=e.includeTags,this.excludeNames=e.excludeNames,this.excludeTypes=e.excludeTypes,this.excludeTags=e.excludeTags}includeEvent(e,n){let r=this.includeNames===void 0&&this.includeTypes===void 0&&this.includeTags===void 0;const i=e.tags??[];return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(n)),this.includeTags!==void 0&&(r=r||i.some(a=>{var s;return(s=this.includeTags)==null?void 0:s.includes(a)})),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(n)),this.excludeTags!==void 0&&(r=r&&i.every(a=>{var s;return!((s=this.excludeTags)!=null&&s.includes(a))})),r}}function sc(t){return t.replace(/[^a-zA-Z-_0-9]/g,"_")}const JP=["*","_","`"];function YP(t){let e="";for(const[n,r]of Object.entries(t))e+=`	classDef ${n} ${r};
`;return e}function QP(t,e,n){const{firstNode:r,lastNode:i,nodeColors:a,withStyles:s=!0,curveStyle:o="linear",wrapLabelNWords:l=9}=n??{};let u=s?`%%{init: {'flowchart': {'curve': '${o}'}}}%%
graph TD;
`:`graph TD;
`;if(s){const h="default",m={[h]:"{0}({1})"};r!==void 0&&(m[r]="{0}([{1}]):::first"),i!==void 0&&(m[i]="{0}([{1}]):::last");for(const[v,_]of Object.entries(t)){const p=_.name.split(":").pop()??"";let g=JP.some(k=>p.startsWith(k)&&p.endsWith(k))?`<p>${p}</p>`:p;Object.keys(_.metadata??{}).length&&(g+=`<hr/><small><em>${Object.entries(_.metadata??{}).map(([k,S])=>`${k} = ${S}`).join(`
`)}</em></small>`);const x=(m[v]??m[h]).replace("{0}",sc(v)).replace("{1}",g);u+=`	${x}
`}}const c={};for(const h of e){const m=h.source.split(":"),v=h.target.split(":"),_=m.filter((p,y)=>p===v[y]).join(":");c[_]||(c[_]=[]),c[_].push(h)}const d=new Set;function f(h,m){const v=h.length===1&&h[0].source===h[0].target;if(m&&!v){const _=m.split(":").pop();if(d.has(_))throw new Error(`Found duplicate subgraph '${_}' -- this likely means that you're reusing a subgraph node with the same name. Please adjust your graph to have subgraph nodes with unique names.`);d.add(_),u+=`	subgraph ${_}
`}for(const _ of h){const{source:p,target:y,data:g,conditional:x}=_;let k="";if(g!==void 0){let S=g;const C=S.split(" ");C.length>l&&(S=Array.from({length:Math.ceil(C.length/l)},(A,U)=>C.slice(U*l,(U+1)*l).join(" ")).join("&nbsp;<br>&nbsp;")),k=x?` -. &nbsp;${S}&nbsp; .-> `:` -- &nbsp;${S}&nbsp; --> `}else k=x?" -.-> ":" --> ";u+=`	${sc(p)}${k}${sc(y)};
`}for(const _ in c)_.startsWith(`${m}:`)&&_!==m&&f(c[_],_);m&&!v&&(u+=`	end
`)}f(c[""]??[],"");for(const h in c)!h.includes(":")&&h!==""&&f(c[h],h);return s&&(u+=YP(a??{})),u}async function XP(t,e){let{backgroundColor:n="white"}=e??{};const r=btoa(t);n!==void 0&&(/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(n)||(n=`!${n}`));const i=`https://mermaid.ink/img/${r}?bgColor=${n}`,a=await fetch(i);if(!a.ok)throw new Error(["Failed to render the graph using the Mermaid.INK API.",`Status code: ${a.status}`,`Status text: ${a.statusText}`].join(`
`));return await a.blob()}function Zl(t,e,n){function r(o,l){var u;Object.defineProperty(o,"_zod",{value:o._zod??{},enumerable:!1}),(u=o._zod).traits??(u.traits=new Set),o._zod.traits.add(t),e(o,l);for(const c in s.prototype)c in o||Object.defineProperty(o,c,{value:s.prototype[c].bind(o)});o._zod.constr=s,o._zod.def=l}const i=(n==null?void 0:n.Parent)??Object;class a extends i{}Object.defineProperty(a,"name",{value:t});function s(o){var l;const u=n!=null&&n.Parent?new a:this;r(u,o),(l=u._zod).deferred??(l.deferred=[]);for(const c of u._zod.deferred)c();return u}return Object.defineProperty(s,"init",{value:r}),Object.defineProperty(s,Symbol.hasInstance,{value:o=>{var l,u;return n!=null&&n.Parent&&o instanceof n.Parent?!0:(u=(l=o==null?void 0:o._zod)==null?void 0:l.traits)==null?void 0:u.has(t)}}),Object.defineProperty(s,"name",{value:t}),s}class fl extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const ej={};function ql(t){return ej}function tj(t){const e=Object.values(t).filter(r=>typeof r=="number");return Object.entries(t).filter(([r,i])=>e.indexOf(+r)===-1).map(([r,i])=>i)}function nj(t,e){return typeof e=="bigint"?e.toString():e}const b_=Error.captureStackTrace?Error.captureStackTrace:(...t)=>{};function hl(t,e,n){const r=new t._zod.constr(e??t._zod.def);return(!e||n!=null&&n.parent)&&(r._zod.parent=t),r}function rj(t){return{}}function oc(t,e=0){var n;for(let r=e;r<t.issues.length;r++)if(((n=t.issues[r])==null?void 0:n.continue)!==!0)return!0;return!1}function lo(t){return typeof t=="string"?t:t==null?void 0:t.message}function Kl(t,e,n){var i,a,s,o,l,u;const r={...t,path:t.path??[]};if(!t.message){const c=lo((s=(a=(i=t.inst)==null?void 0:i._zod.def)==null?void 0:a.error)==null?void 0:s.call(a,t))??lo((o=e==null?void 0:e.error)==null?void 0:o.call(e,t))??lo((l=n.customError)==null?void 0:l.call(n,t))??lo((u=n.localeError)==null?void 0:u.call(n,t))??"Invalid input";r.message=c}return delete r.inst,delete r.continue,e!=null&&e.reportInput||delete r.input,r}const x_=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),Object.defineProperty(t,"message",{get(){return JSON.stringify(e,nj,2)},enumerable:!0}),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},ij=Zl("$ZodError",x_),Jl=Zl("$ZodError",x_,{Parent:Error}),aj=t=>(e,n,r,i)=>{const a=r?Object.assign(r,{async:!1}):{async:!1},s=e._zod.run({value:n,issues:[]},a);if(s instanceof Promise)throw new fl;if(s.issues.length){const o=new((i==null?void 0:i.Err)??t)(s.issues.map(l=>Kl(l,a,ql())));throw b_(o,i==null?void 0:i.callee),o}return s.value},sj=aj(Jl),oj=t=>async(e,n,r,i)=>{const a=r?Object.assign(r,{async:!0}):{async:!0};let s=e._zod.run({value:n,issues:[]},a);if(s instanceof Promise&&(s=await s),s.issues.length){const o=new((i==null?void 0:i.Err)??t)(s.issues.map(l=>Kl(l,a,ql())));throw b_(o,i==null?void 0:i.callee),o}return s.value},lj=oj(Jl),uj=t=>(e,n,r)=>{const i=r?{...r,async:!1}:{async:!1},a=e._zod.run({value:n,issues:[]},i);if(a instanceof Promise)throw new fl;return a.issues.length?{success:!1,error:new(t??ij)(a.issues.map(s=>Kl(s,i,ql())))}:{success:!0,data:a.value}},cj=uj(Jl),dj=t=>async(e,n,r)=>{const i=r?Object.assign(r,{async:!0}):{async:!0};let a=e._zod.run({value:n,issues:[]},i);return a instanceof Promise&&(a=await a),a.issues.length?{success:!1,error:new t(a.issues.map(s=>Kl(s,i,ql())))}:{success:!0,data:a.value}},fj=dj(Jl),hj={major:4,minor:0,patch:0},pj=Zl("$ZodType",(t,e)=>{var i;var n;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=hj;const r=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&r.unshift(t);for(const a of r)for(const s of a._zod.onattach)s(t);if(r.length===0)(n=t._zod).deferred??(n.deferred=[]),(i=t._zod.deferred)==null||i.push(()=>{t._zod.run=t._zod.parse});else{const a=(s,o,l)=>{let u=oc(s),c;for(const d of o){if(d._zod.def.when){if(!d._zod.def.when(s))continue}else if(u)continue;const f=s.issues.length,h=d._zod.check(s);if(h instanceof Promise&&(l==null?void 0:l.async)===!1)throw new fl;if(c||h instanceof Promise)c=(c??Promise.resolve()).then(async()=>{await h,s.issues.length!==f&&(u||(u=oc(s,f)))});else{if(s.issues.length===f)continue;u||(u=oc(s,f))}}return c?c.then(()=>s):s};t._zod.run=(s,o)=>{const l=t._zod.parse(s,o);if(l instanceof Promise){if(o.async===!1)throw new fl;return l.then(u=>a(u,r,o))}return a(l,r,o)}}t["~standard"]={validate:a=>{var s;try{const o=cj(t,a);return o.success?{value:o.data}:{issues:(s=o.error)==null?void 0:s.issues}}catch{return fj(t,a).then(l=>{var u;return l.success?{value:l.data}:{issues:(u=l.error)==null?void 0:u.issues}})}},vendor:"zod",version:1}}),mj=Zl("$ZodNever",(t,e)=>{pj.init(t,e),t._zod.parse=(n,r)=>(n.issues.push({expected:"never",code:"invalid_type",input:n.value,inst:t}),n)});class E_{constructor(){this._map=new Map,this._idmap=new Map}add(e,...n){const r=n[0];if(this._map.set(e,r),r&&typeof r=="object"&&"id"in r){if(this._idmap.has(r.id))throw new Error(`ID ${r.id} already exists in the registry`);this._idmap.set(r.id,e)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(e){const n=this._map.get(e);return n&&typeof n=="object"&&"id"in n&&this._idmap.delete(n.id),this._map.delete(e),this}get(e){const n=e._zod.parent;if(n){const r={...this.get(n)??{}};return delete r.id,{...r,...this._map.get(e)}}return this._map.get(e)}has(e){return this._map.has(e)}}function gj(){return new E_}const ur=gj();function yj(t,e){return new t({type:"never",...rj()})}class ly{constructor(e){this.counter=0,this.metadataRegistry=(e==null?void 0:e.metadata)??ur,this.target=(e==null?void 0:e.target)??"draft-2020-12",this.unrepresentable=(e==null?void 0:e.unrepresentable)??"throw",this.override=(e==null?void 0:e.override)??(()=>{}),this.io=(e==null?void 0:e.io)??"output",this.seen=new Map}process(e,n={path:[],schemaPath:[]}){var d,f,h;var r;const i=e._zod.def,a={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},s=this.seen.get(e);if(s)return s.count++,n.schemaPath.includes(e)&&(s.cycle=n.path),s.schema;const o={schema:{},count:1,cycle:void 0,path:n.path};this.seen.set(e,o);const l=(f=(d=e._zod).toJSONSchema)==null?void 0:f.call(d);if(l)o.schema=l;else{const m={...n,schemaPath:[...n.schemaPath,e],path:n.path},v=e._zod.parent;if(v)o.ref=v,this.process(v,m),this.seen.get(v).isParent=!0;else{const _=o.schema;switch(i.type){case"string":{const p=_;p.type="string";const{minimum:y,maximum:g,format:x,patterns:k,contentEncoding:S}=e._zod.bag;if(typeof y=="number"&&(p.minLength=y),typeof g=="number"&&(p.maxLength=g),x&&(p.format=a[x]??x,p.format===""&&delete p.format),S&&(p.contentEncoding=S),k&&k.size>0){const C=[...k];C.length===1?p.pattern=C[0].source:C.length>1&&(o.schema.allOf=[...C.map(A=>({...this.target==="draft-7"?{type:"string"}:{},pattern:A.source}))])}break}case"number":{const p=_,{minimum:y,maximum:g,format:x,multipleOf:k,exclusiveMaximum:S,exclusiveMinimum:C}=e._zod.bag;typeof x=="string"&&x.includes("int")?p.type="integer":p.type="number",typeof C=="number"&&(p.exclusiveMinimum=C),typeof y=="number"&&(p.minimum=y,typeof C=="number"&&(C>=y?delete p.minimum:delete p.exclusiveMinimum)),typeof S=="number"&&(p.exclusiveMaximum=S),typeof g=="number"&&(p.maximum=g,typeof S=="number"&&(S<=g?delete p.maximum:delete p.exclusiveMaximum)),typeof k=="number"&&(p.multipleOf=k);break}case"boolean":{const p=_;p.type="boolean";break}case"bigint":{if(this.unrepresentable==="throw")throw new Error("BigInt cannot be represented in JSON Schema");break}case"symbol":{if(this.unrepresentable==="throw")throw new Error("Symbols cannot be represented in JSON Schema");break}case"null":{_.type="null";break}case"any":break;case"unknown":break;case"undefined":{if(this.unrepresentable==="throw")throw new Error("Undefined cannot be represented in JSON Schema");break}case"void":{if(this.unrepresentable==="throw")throw new Error("Void cannot be represented in JSON Schema");break}case"never":{_.not={};break}case"date":{if(this.unrepresentable==="throw")throw new Error("Date cannot be represented in JSON Schema");break}case"array":{const p=_,{minimum:y,maximum:g}=e._zod.bag;typeof y=="number"&&(p.minItems=y),typeof g=="number"&&(p.maxItems=g),p.type="array",p.items=this.process(i.element,{...m,path:[...m.path,"items"]});break}case"object":{const p=_;p.type="object",p.properties={};const y=i.shape;for(const k in y)p.properties[k]=this.process(y[k],{...m,path:[...m.path,"properties",k]});const g=new Set(Object.keys(y)),x=new Set([...g].filter(k=>{const S=i.shape[k]._zod;return this.io==="input"?S.optin===void 0:S.optout===void 0}));x.size>0&&(p.required=Array.from(x)),((h=i.catchall)==null?void 0:h._zod.def.type)==="never"?p.additionalProperties=!1:i.catchall?i.catchall&&(p.additionalProperties=this.process(i.catchall,{...m,path:[...m.path,"additionalProperties"]})):this.io==="output"&&(p.additionalProperties=!1);break}case"union":{const p=_;p.anyOf=i.options.map((y,g)=>this.process(y,{...m,path:[...m.path,"anyOf",g]}));break}case"intersection":{const p=_,y=this.process(i.left,{...m,path:[...m.path,"allOf",0]}),g=this.process(i.right,{...m,path:[...m.path,"allOf",1]}),x=S=>"allOf"in S&&Object.keys(S).length===1,k=[...x(y)?y.allOf:[y],...x(g)?g.allOf:[g]];p.allOf=k;break}case"tuple":{const p=_;p.type="array";const y=i.items.map((k,S)=>this.process(k,{...m,path:[...m.path,"prefixItems",S]}));if(this.target==="draft-2020-12"?p.prefixItems=y:p.items=y,i.rest){const k=this.process(i.rest,{...m,path:[...m.path,"items"]});this.target==="draft-2020-12"?p.items=k:p.additionalItems=k}i.rest&&(p.items=this.process(i.rest,{...m,path:[...m.path,"items"]}));const{minimum:g,maximum:x}=e._zod.bag;typeof g=="number"&&(p.minItems=g),typeof x=="number"&&(p.maxItems=x);break}case"record":{const p=_;p.type="object",p.propertyNames=this.process(i.keyType,{...m,path:[...m.path,"propertyNames"]}),p.additionalProperties=this.process(i.valueType,{...m,path:[...m.path,"additionalProperties"]});break}case"map":{if(this.unrepresentable==="throw")throw new Error("Map cannot be represented in JSON Schema");break}case"set":{if(this.unrepresentable==="throw")throw new Error("Set cannot be represented in JSON Schema");break}case"enum":{const p=_,y=tj(i.entries);y.every(g=>typeof g=="number")&&(p.type="number"),y.every(g=>typeof g=="string")&&(p.type="string"),p.enum=y;break}case"literal":{const p=_,y=[];for(const g of i.values)if(g===void 0){if(this.unrepresentable==="throw")throw new Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof g=="bigint"){if(this.unrepresentable==="throw")throw new Error("BigInt literals cannot be represented in JSON Schema");y.push(Number(g))}else y.push(g);if(y.length!==0)if(y.length===1){const g=y[0];p.type=g===null?"null":typeof g,p.const=g}else y.every(g=>typeof g=="number")&&(p.type="number"),y.every(g=>typeof g=="string")&&(p.type="string"),y.every(g=>typeof g=="boolean")&&(p.type="string"),y.every(g=>g===null)&&(p.type="null"),p.enum=y;break}case"file":{const p=_,y={type:"string",format:"binary",contentEncoding:"binary"},{minimum:g,maximum:x,mime:k}=e._zod.bag;g!==void 0&&(y.minLength=g),x!==void 0&&(y.maxLength=x),k?k.length===1?(y.contentMediaType=k[0],Object.assign(p,y)):p.anyOf=k.map(S=>({...y,contentMediaType:S})):Object.assign(p,y);break}case"transform":{if(this.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema");break}case"nullable":{const p=this.process(i.innerType,m);_.anyOf=[p,{type:"null"}];break}case"nonoptional":{this.process(i.innerType,m),o.ref=i.innerType;break}case"success":{const p=_;p.type="boolean";break}case"default":{this.process(i.innerType,m),o.ref=i.innerType,_.default=JSON.parse(JSON.stringify(i.defaultValue));break}case"prefault":{this.process(i.innerType,m),o.ref=i.innerType,this.io==="input"&&(_._prefault=JSON.parse(JSON.stringify(i.defaultValue)));break}case"catch":{this.process(i.innerType,m),o.ref=i.innerType;let p;try{p=i.catchValue(void 0)}catch{throw new Error("Dynamic catch values are not supported in JSON Schema")}_.default=p;break}case"nan":{if(this.unrepresentable==="throw")throw new Error("NaN cannot be represented in JSON Schema");break}case"template_literal":{const p=_,y=e._zod.pattern;if(!y)throw new Error("Pattern not found in template literal");p.type="string",p.pattern=y.source;break}case"pipe":{const p=this.io==="input"?i.in._zod.def.type==="transform"?i.out:i.in:i.out;this.process(p,m),o.ref=p;break}case"readonly":{this.process(i.innerType,m),o.ref=i.innerType,_.readOnly=!0;break}case"promise":{this.process(i.innerType,m),o.ref=i.innerType;break}case"optional":{this.process(i.innerType,m),o.ref=i.innerType;break}case"lazy":{const p=e._zod.innerType;this.process(p,m),o.ref=p;break}case"custom":{if(this.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema");break}}}}const u=this.metadataRegistry.get(e);return u&&Object.assign(o.schema,u),this.io==="input"&&Me(e)&&(delete o.schema.examples,delete o.schema.default),this.io==="input"&&o.schema._prefault&&((r=o.schema).default??(r.default=o.schema._prefault)),delete o.schema._prefault,this.seen.get(e).schema}emit(e,n){var c,d,f,h,m,v;const r={cycles:(n==null?void 0:n.cycles)??"ref",reused:(n==null?void 0:n.reused)??"inline",external:(n==null?void 0:n.external)??void 0},i=this.seen.get(e);if(!i)throw new Error("Unprocessed schema. This is a bug in Zod.");const a=_=>{var k;const p=this.target==="draft-2020-12"?"$defs":"definitions";if(r.external){const S=(k=r.external.registry.get(_[0]))==null?void 0:k.id,C=r.external.uri??(U=>U);if(S)return{ref:C(S)};const A=_[1].defId??_[1].schema.id??`schema${this.counter++}`;return _[1].defId=A,{defId:A,ref:`${C("__shared")}#/${p}/${A}`}}if(_[1]===i)return{ref:"#"};const g=`#/${p}/`,x=_[1].schema.id??`__schema${this.counter++}`;return{defId:x,ref:g+x}},s=_=>{if(_[1].schema.$ref)return;const p=_[1],{ref:y,defId:g}=a(_);p.def={...p.schema},g&&(p.defId=g);const x=p.schema;for(const k in x)delete x[k];x.$ref=y};if(r.cycles==="throw")for(const _ of this.seen.entries()){const p=_[1];if(p.cycle)throw new Error(`Cycle detected: #/${(c=p.cycle)==null?void 0:c.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(const _ of this.seen.entries()){const p=_[1];if(e===_[0]){s(_);continue}if(r.external){const g=(d=r.external.registry.get(_[0]))==null?void 0:d.id;if(e!==_[0]&&g){s(_);continue}}if((f=this.metadataRegistry.get(_[0]))==null?void 0:f.id){s(_);continue}if(p.cycle){s(_);continue}if(p.count>1&&r.reused==="ref"){s(_);continue}}const o=(_,p)=>{const y=this.seen.get(_),g=y.def??y.schema,x={...g};if(y.ref===null)return;const k=y.ref;if(y.ref=null,k){o(k,p);const S=this.seen.get(k).schema;S.$ref&&p.target==="draft-7"?(g.allOf=g.allOf??[],g.allOf.push(S)):(Object.assign(g,S),Object.assign(g,x))}y.isParent||this.override({zodSchema:_,jsonSchema:g,path:y.path??[]})};for(const _ of[...this.seen.entries()].reverse())o(_[0],{target:this.target});const l={};if(this.target==="draft-2020-12"?l.$schema="https://json-schema.org/draft/2020-12/schema":this.target==="draft-7"?l.$schema="http://json-schema.org/draft-07/schema#":console.warn(`Invalid target: ${this.target}`),(h=r.external)!=null&&h.uri){const _=(m=r.external.registry.get(e))==null?void 0:m.id;if(!_)throw new Error("Schema is missing an `id` property");l.$id=r.external.uri(_)}Object.assign(l,i.def);const u=((v=r.external)==null?void 0:v.defs)??{};for(const _ of this.seen.entries()){const p=_[1];p.def&&p.defId&&(u[p.defId]=p.def)}r.external||Object.keys(u).length>0&&(this.target==="draft-2020-12"?l.$defs=u:l.definitions=u);try{return JSON.parse(JSON.stringify(l))}catch{throw new Error("Error converting schema to JSON.")}}}function uy(t,e){if(t instanceof E_){const r=new ly(e),i={};for(const o of t._idmap.entries()){const[l,u]=o;r.process(u)}const a={},s={registry:t,uri:e==null?void 0:e.uri,defs:i};for(const o of t._idmap.entries()){const[l,u]=o;a[l]=r.emit(u,{...e,external:s})}if(Object.keys(i).length>0){const o=r.target==="draft-2020-12"?"$defs":"definitions";a.__shared={[o]:i}}return{schemas:a}}const n=new ly(e);return n.process(t),n.emit(t,e)}function Me(t,e){const n=e??{seen:new Set};if(n.seen.has(t))return!1;n.seen.add(t);const i=t._zod.def;switch(i.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":return!1;case"array":return Me(i.element,n);case"object":{for(const a in i.shape)if(Me(i.shape[a],n))return!0;return!1}case"union":{for(const a of i.options)if(Me(a,n))return!0;return!1}case"intersection":return Me(i.left,n)||Me(i.right,n);case"tuple":{for(const a of i.items)if(Me(a,n))return!0;return!!(i.rest&&Me(i.rest,n))}case"record":return Me(i.keyType,n)||Me(i.valueType,n);case"map":return Me(i.keyType,n)||Me(i.valueType,n);case"set":return Me(i.valueType,n);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":return Me(i.innerType,n);case"lazy":return Me(i.getter(),n);case"default":return Me(i.innerType,n);case"prefault":return Me(i.innerType,n);case"custom":return!1;case"transform":return!0;case"pipe":return Me(i.in,n)||Me(i.out,n);case"success":return!1;case"catch":return!1}throw new Error(`Unknown schema type: ${i.type}`)}const vj=Symbol("Let zodToJsonSchema decide on which parser to use"),wj={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},_j=t=>({...wj,...t}),bj=t=>{const e=_j(t),n=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,flags:{hasReferencedOpenAiAnyType:!1},currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([r,i])=>[i._def,{def:i._def,path:[...e.basePath,e.definitionPath,r],jsonSchema:void 0}]))}};function S_(t,e,n,r){r!=null&&r.errorMessages&&n&&(t.errorMessage={...t.errorMessage,[e]:n})}function ve(t,e,n,r,i){t[e]=n,S_(t,e,r,i)}const k_=(t,e)=>{let n=0;for(;n<t.length&&n<e.length&&t[n]===e[n];n++);return[(t.length-n).toString(),...e.slice(n)].join("/")};function jt(t){if(t.target!=="openAi")return{};const e=[...t.basePath,t.definitionPath,t.openAiAnyTypeName];return t.flags.hasReferencedOpenAiAnyType=!0,{$ref:t.$refStrategy==="relative"?k_(e,t.currentPath):e.join("/")}}function xj(t,e){var r,i,a;const n={type:"array"};return(r=t.type)!=null&&r._def&&((a=(i=t.type)==null?void 0:i._def)==null?void 0:a.typeName)!==M.ZodAny&&(n.items=ye(t.type._def,{...e,currentPath:[...e.currentPath,"items"]})),t.minLength&&ve(n,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&ve(n,"maxItems",t.maxLength.value,t.maxLength.message,e),t.exactLength&&(ve(n,"minItems",t.exactLength.value,t.exactLength.message,e),ve(n,"maxItems",t.exactLength.value,t.exactLength.message,e)),n}function Ej(t,e){const n={type:"integer",format:"int64"};if(!t.checks)return n;for(const r of t.checks)switch(r.kind){case"min":e.target==="jsonSchema7"?r.inclusive?ve(n,"minimum",r.value,r.message,e):ve(n,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(n.exclusiveMinimum=!0),ve(n,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?ve(n,"maximum",r.value,r.message,e):ve(n,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(n.exclusiveMaximum=!0),ve(n,"maximum",r.value,r.message,e));break;case"multipleOf":ve(n,"multipleOf",r.value,r.message,e);break}return n}function Sj(){return{type:"boolean"}}function C_(t,e){return ye(t.type._def,e)}const kj=(t,e)=>ye(t.innerType._def,e);function T_(t,e,n){const r=n??e.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((i,a)=>T_(t,e,i))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return Cj(t,e)}}const Cj=(t,e)=>{const n={type:"integer",format:"unix-time"};if(e.target==="openApi3")return n;for(const r of t.checks)switch(r.kind){case"min":ve(n,"minimum",r.value,r.message,e);break;case"max":ve(n,"maximum",r.value,r.message,e);break}return n};function Tj(t,e){return{...ye(t.innerType._def,e),default:t.defaultValue()}}function Oj(t,e){return e.effectStrategy==="input"?ye(t.schema._def,e):jt(e)}function Nj(t){return{type:"string",enum:Array.from(t.values)}}const Ij=t=>"type"in t&&t.type==="string"?!1:"allOf"in t;function Aj(t,e){const n=[ye(t.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),ye(t.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(a=>!!a);let r=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const i=[];return n.forEach(a=>{if(Ij(a))i.push(...a.allOf),a.unevaluatedProperties===void 0&&(r=void 0);else{let s=a;if("additionalProperties"in a&&a.additionalProperties===!1){const{additionalProperties:o,...l}=a;s=l}else r=void 0;i.push(s)}}),i.length?{allOf:i,...r}:void 0}function Rj(t,e){const n=typeof t.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(t.value)?"array":"object"}:e.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[t.value]}:{type:n==="bigint"?"integer":n,const:t.value}}let lc;const Xt={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(lc===void 0&&(lc=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),lc),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function O_(t,e){const n={type:"string"};if(t.checks)for(const r of t.checks)switch(r.kind){case"min":ve(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,e);break;case"max":ve(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,e);break;case"email":switch(e.emailStrategy){case"format:email":en(n,"email",r.message,e);break;case"format:idn-email":en(n,"idn-email",r.message,e);break;case"pattern:zod":st(n,Xt.email,r.message,e);break}break;case"url":en(n,"uri",r.message,e);break;case"uuid":en(n,"uuid",r.message,e);break;case"regex":st(n,r.regex,r.message,e);break;case"cuid":st(n,Xt.cuid,r.message,e);break;case"cuid2":st(n,Xt.cuid2,r.message,e);break;case"startsWith":st(n,RegExp(`^${uc(r.value,e)}`),r.message,e);break;case"endsWith":st(n,RegExp(`${uc(r.value,e)}$`),r.message,e);break;case"datetime":en(n,"date-time",r.message,e);break;case"date":en(n,"date",r.message,e);break;case"time":en(n,"time",r.message,e);break;case"duration":en(n,"duration",r.message,e);break;case"length":ve(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,e),ve(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,e);break;case"includes":{st(n,RegExp(uc(r.value,e)),r.message,e);break}case"ip":{r.version!=="v6"&&en(n,"ipv4",r.message,e),r.version!=="v4"&&en(n,"ipv6",r.message,e);break}case"base64url":st(n,Xt.base64url,r.message,e);break;case"jwt":st(n,Xt.jwt,r.message,e);break;case"cidr":{r.version!=="v6"&&st(n,Xt.ipv4Cidr,r.message,e),r.version!=="v4"&&st(n,Xt.ipv6Cidr,r.message,e);break}case"emoji":st(n,Xt.emoji(),r.message,e);break;case"ulid":{st(n,Xt.ulid,r.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{en(n,"binary",r.message,e);break}case"contentEncoding:base64":{ve(n,"contentEncoding","base64",r.message,e);break}case"pattern:zod":{st(n,Xt.base64,r.message,e);break}}break}case"nanoid":st(n,Xt.nanoid,r.message,e)}return n}function uc(t,e){return e.patternStrategy==="escape"?jj(t):t}const Pj=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function jj(t){let e="";for(let n=0;n<t.length;n++)Pj.has(t[n])||(e+="\\"),e+=t[n];return e}function en(t,e,n,r){var i;t.format||(i=t.anyOf)!=null&&i.some(a=>a.format)?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push({format:t.format,...t.errorMessage&&r.errorMessages&&{errorMessage:{format:t.errorMessage.format}}}),delete t.format,t.errorMessage&&(delete t.errorMessage.format,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.anyOf.push({format:e,...n&&r.errorMessages&&{errorMessage:{format:n}}})):ve(t,"format",e,n,r)}function st(t,e,n,r){var i;t.pattern||(i=t.allOf)!=null&&i.some(a=>a.pattern)?(t.allOf||(t.allOf=[]),t.pattern&&(t.allOf.push({pattern:t.pattern,...t.errorMessage&&r.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}}}),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.allOf.push({pattern:cy(e,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):ve(t,"pattern",cy(e,r),n,r)}function cy(t,e){var l;if(!e.applyRegexFlags||!t.flags)return t.source;const n={i:t.flags.includes("i"),m:t.flags.includes("m"),s:t.flags.includes("s")},r=n.i?t.source.toLowerCase():t.source;let i="",a=!1,s=!1,o=!1;for(let u=0;u<r.length;u++){if(a){i+=r[u],a=!1;continue}if(n.i){if(s){if(r[u].match(/[a-z]/)){o?(i+=r[u],i+=`${r[u-2]}-${r[u]}`.toUpperCase(),o=!1):r[u+1]==="-"&&((l=r[u+2])!=null&&l.match(/[a-z]/))?(i+=r[u],o=!0):i+=`${r[u]}${r[u].toUpperCase()}`;continue}}else if(r[u].match(/[a-z]/)){i+=`[${r[u]}${r[u].toUpperCase()}]`;continue}}if(n.m){if(r[u]==="^"){i+=`(^|(?<=[\r
]))`;continue}else if(r[u]==="$"){i+=`($|(?=[\r
]))`;continue}}if(n.s&&r[u]==="."){i+=s?`${r[u]}\r
`:`[${r[u]}\r
]`;continue}i+=r[u],r[u]==="\\"?a=!0:s&&r[u]==="]"?s=!1:!s&&r[u]==="["&&(s=!0)}try{new RegExp(i)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),t.source}return i}function N_(t,e){var r,i,a,s,o,l;if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&((r=t.keyType)==null?void 0:r._def.typeName)===M.ZodEnum)return{type:"object",required:t.keyType._def.values,properties:t.keyType._def.values.reduce((u,c)=>({...u,[c]:ye(t.valueType._def,{...e,currentPath:[...e.currentPath,"properties",c]})??jt(e)}),{}),additionalProperties:e.rejectedAdditionalProperties};const n={type:"object",additionalProperties:ye(t.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??e.allowedAdditionalProperties};if(e.target==="openApi3")return n;if(((i=t.keyType)==null?void 0:i._def.typeName)===M.ZodString&&((a=t.keyType._def.checks)!=null&&a.length)){const{type:u,...c}=O_(t.keyType._def,e);return{...n,propertyNames:c}}else{if(((s=t.keyType)==null?void 0:s._def.typeName)===M.ZodEnum)return{...n,propertyNames:{enum:t.keyType._def.values}};if(((o=t.keyType)==null?void 0:o._def.typeName)===M.ZodBranded&&t.keyType._def.type._def.typeName===M.ZodString&&((l=t.keyType._def.type._def.checks)!=null&&l.length)){const{type:u,...c}=C_(t.keyType._def,e);return{...n,propertyNames:c}}}return n}function Lj(t,e){if(e.mapStrategy==="record")return N_(t,e);const n=ye(t.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||jt(e),r=ye(t.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||jt(e);return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function $j(t){const e=t.values,r=Object.keys(t.values).filter(a=>typeof e[e[a]]!="number").map(a=>e[a]),i=Array.from(new Set(r.map(a=>typeof a)));return{type:i.length===1?i[0]==="string"?"string":"number":["string","number"],enum:r}}function Mj(t){return t.target==="openAi"?void 0:{not:jt({...t,currentPath:[...t.currentPath,"not"]})}}function Dj(t){return t.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const pl={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Fj(t,e){if(e.target==="openApi3")return dy(t,e);const n=t.options instanceof Map?Array.from(t.options.values()):t.options;if(n.every(r=>r._def.typeName in pl&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((i,a)=>{const s=pl[a._def.typeName];return s&&!i.includes(s)?[...i,s]:i},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((i,a)=>{const s=typeof a._def.value;switch(s){case"string":case"number":case"boolean":return[...i,s];case"bigint":return[...i,"integer"];case"object":if(a._def.value===null)return[...i,"null"];case"symbol":case"undefined":case"function":default:return i}},[]);if(r.length===n.length){const i=r.filter((a,s,o)=>o.indexOf(a)===s);return{type:i.length>1?i:i[0],enum:n.reduce((a,s)=>a.includes(s._def.value)?a:[...a,s._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,i)=>[...r,...i._def.values.filter(a=>!r.includes(a))],[])};return dy(t,e)}const dy=(t,e)=>{const n=(t.options instanceof Map?Array.from(t.options.values()):t.options).map((r,i)=>ye(r._def,{...e,currentPath:[...e.currentPath,"anyOf",`${i}`]})).filter(r=>!!r&&(!e.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function zj(t,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return e.target==="openApi3"?{type:pl[t.innerType._def.typeName],nullable:!0}:{type:[pl[t.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const r=ye(t.innerType._def,{...e,currentPath:[...e.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=ye(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function Uj(t,e){const n={type:"number"};if(!t.checks)return n;for(const r of t.checks)switch(r.kind){case"int":n.type="integer",S_(n,"type",r.message,e);break;case"min":e.target==="jsonSchema7"?r.inclusive?ve(n,"minimum",r.value,r.message,e):ve(n,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(n.exclusiveMinimum=!0),ve(n,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?ve(n,"maximum",r.value,r.message,e):ve(n,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(n.exclusiveMaximum=!0),ve(n,"maximum",r.value,r.message,e));break;case"multipleOf":ve(n,"multipleOf",r.value,r.message,e);break}return n}function Bj(t,e){const n=e.target==="openAi",r={type:"object",properties:{}},i=[],a=t.shape();for(const o in a){let l=a[o];if(l===void 0||l._def===void 0)continue;let u=Gj(l);u&&n&&(l._def.typeName==="ZodOptional"&&(l=l._def.innerType),l.isNullable()||(l=l.nullable()),u=!1);const c=ye(l._def,{...e,currentPath:[...e.currentPath,"properties",o],propertyPath:[...e.currentPath,"properties",o]});c!==void 0&&(r.properties[o]=c,u||i.push(o))}i.length&&(r.required=i);const s=Hj(t,e);return s!==void 0&&(r.additionalProperties=s),r}function Hj(t,e){if(t.catchall._def.typeName!=="ZodNever")return ye(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]});switch(t.unknownKeys){case"passthrough":return e.allowedAdditionalProperties;case"strict":return e.rejectedAdditionalProperties;case"strip":return e.removeAdditionalStrategy==="strict"?e.allowedAdditionalProperties:e.rejectedAdditionalProperties}}function Gj(t){try{return t.isOptional()}catch{return!0}}const Vj=(t,e)=>{var r;if(e.currentPath.toString()===((r=e.propertyPath)==null?void 0:r.toString()))return ye(t.innerType._def,e);const n=ye(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return n?{anyOf:[{not:jt(e)},n]}:jt(e)},Wj=(t,e)=>{if(e.pipeStrategy==="input")return ye(t.in._def,e);if(e.pipeStrategy==="output")return ye(t.out._def,e);const n=ye(t.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),r=ye(t.out._def,{...e,currentPath:[...e.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(i=>i!==void 0)}};function Zj(t,e){return ye(t.type._def,e)}function qj(t,e){const r={type:"array",uniqueItems:!0,items:ye(t.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return t.minSize&&ve(r,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&ve(r,"maxItems",t.maxSize.value,t.maxSize.message,e),r}function Kj(t,e){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((n,r)=>ye(n._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:ye(t.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((n,r)=>ye(n._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function Jj(t){return{not:jt(t)}}function Yj(t){return jt(t)}const Qj=(t,e)=>ye(t.innerType._def,e),Xj=(t,e,n)=>{switch(e){case M.ZodString:return O_(t,n);case M.ZodNumber:return Uj(t,n);case M.ZodObject:return Bj(t,n);case M.ZodBigInt:return Ej(t,n);case M.ZodBoolean:return Sj();case M.ZodDate:return T_(t,n);case M.ZodUndefined:return Jj(n);case M.ZodNull:return Dj(n);case M.ZodArray:return xj(t,n);case M.ZodUnion:case M.ZodDiscriminatedUnion:return Fj(t,n);case M.ZodIntersection:return Aj(t,n);case M.ZodTuple:return Kj(t,n);case M.ZodRecord:return N_(t,n);case M.ZodLiteral:return Rj(t,n);case M.ZodEnum:return Nj(t);case M.ZodNativeEnum:return $j(t);case M.ZodNullable:return zj(t,n);case M.ZodOptional:return Vj(t,n);case M.ZodMap:return Lj(t,n);case M.ZodSet:return qj(t,n);case M.ZodLazy:return()=>t.getter()._def;case M.ZodPromise:return Zj(t,n);case M.ZodNaN:case M.ZodNever:return Mj(n);case M.ZodEffects:return Oj(t,n);case M.ZodAny:return jt(n);case M.ZodUnknown:return Yj(n);case M.ZodDefault:return Tj(t,n);case M.ZodBranded:return C_(t,n);case M.ZodReadonly:return Qj(t,n);case M.ZodCatch:return kj(t,n);case M.ZodPipeline:return Wj(t,n);case M.ZodFunction:case M.ZodVoid:case M.ZodSymbol:return;default:return(r=>{})()}};function ye(t,e,n=!1){var o;const r=e.seen.get(t);if(e.override){const l=(o=e.override)==null?void 0:o.call(e,t,e,r,n);if(l!==vj)return l}if(r&&!n){const l=eL(r,e);if(l!==void 0)return l}const i={def:t,path:e.currentPath,jsonSchema:void 0};e.seen.set(t,i);const a=Xj(t,t.typeName,e),s=typeof a=="function"?ye(a(),e):a;if(s&&tL(t,e,s),e.postProcess){const l=e.postProcess(s,t,e);return i.jsonSchema=s,l}return i.jsonSchema=s,s}const eL=(t,e)=>{switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"relative":return{$ref:k_(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every((n,r)=>e.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),jt(e)):e.$refStrategy==="seen"?jt(e):void 0}},tL=(t,e,n)=>(t.description&&(n.description=t.description,e.markdownDescription&&(n.markdownDescription=t.description)),n),nL=(t,e)=>{const n=bj(e);let r;const i=e==null?void 0:e.name,a=ye(t._def,n,!1)??jt(n);n.flags.hasReferencedOpenAiAnyType&&(r||(r={}),r[n.openAiAnyTypeName]||(r[n.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:n.$refStrategy==="relative"?"1":[...n.basePath,n.definitionPath,n.openAiAnyTypeName].join("/")}}));const s=i===void 0?r?{...a,[n.definitionPath]:r}:a:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,i].join("/"),[n.definitionPath]:{...r,[i]:a}};return n.target==="jsonSchema7"?s.$schema="http://json-schema.org/draft-07/schema#":(n.target==="jsonSchema2019-09"||n.target==="openAi")&&(s.$schema="https://json-schema.org/draft/2019-09/schema#"),n.target==="openAi"&&("anyOf"in s||"oneOf"in s||"allOf"in s||"type"in s&&Array.isArray(s.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),s};function Pd(t,e){const n=typeof t;if(n!==typeof e)return!1;if(Array.isArray(t)){if(!Array.isArray(e))return!1;const r=t.length;if(r!==e.length)return!1;for(let i=0;i<r;i++)if(!Pd(t[i],e[i]))return!1;return!0}if(n==="object"){if(!t||!e)return t===e;const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const s of r)if(!Pd(t[s],e[s]))return!1;return!0}return t===e}function Nn(t){if(typeof t!="object"||t===null)return!1;const e=t;if(!("_zod"in e))return!1;const n=e._zod;return typeof n=="object"&&n!==null&&"def"in n}function Wn(t){if(typeof t!="object"||t===null)return!1;const e=t;if(!("_def"in e)||"_zod"in e)return!1;const n=e._def;return typeof n=="object"&&n!=null&&"typeName"in n}function Is(t){return!t||typeof t!="object"||Array.isArray(t)?!1:!!(Nn(t)||Wn(t))}async function rL(t,e){if(Nn(t))try{return{success:!0,data:await lj(t,e)}}catch(n){return{success:!1,error:n}}if(Wn(t))return t.safeParse(e);throw new Error("Schema must be an instance of z3.ZodType or z4.$ZodType")}async function iL(t,e){if(Nn(t))return sj(t,e);if(Wn(t))return t.parse(e);throw new Error("Schema must be an instance of z3.ZodType or z4.$ZodType")}function I_(t){var e;if(Nn(t))return(e=ur.get(t))==null?void 0:e.description;if(Wn(t)||"description"in t&&typeof t.description=="string")return t.description}function aL(t){return Is(t)?Wn(t)?t._def.typeName==="ZodString":Nn(t)?t._zod.def.type==="string":!1:!1}function Ua(t){return Nn(t)?typeof t=="object"&&t!==null&&"_zod"in t&&typeof t._zod=="object"&&t._zod!==null&&"def"in t._zod&&typeof t._zod.def=="object"&&t._zod.def!==null&&"type"in t._zod.def&&t._zod.def.type==="object":!1}function A_(t){return Nn(t)?typeof t=="object"&&t!==null&&"_zod"in t&&typeof t._zod=="object"&&t._zod!==null&&"def"in t._zod&&typeof t._zod.def=="object"&&t._zod.def!==null&&"type"in t._zod.def&&t._zod.def.type==="array":!1}function jd(t,e=!1){if(Wn(t))return t.strict();if(Ua(t)){const n=t._zod.def.shape;if(e)for(const[a,s]of Object.entries(t._zod.def.shape)){if(Ua(s)){const l=jd(s,e);n[a]=l}else if(A_(s)){let l=s._zod.def.element;Ua(l)&&(l=jd(l,e)),n[a]=hl(s,{...s._zod.def,element:l})}else n[a]=s;const o=ur.get(s);o&&ur.add(n[a],o)}const r=hl(t,{...t._zod.def,shape:n,catchall:yj(mj)}),i=ur.get(t);return i&&ur.add(r,i),r}throw new Error("Schema must be an instance of z3.ZodObject or z4.$ZodObject")}function sL(t){return Wn(t)&&"typeName"in t._def&&t._def.typeName==="ZodEffects"}function oL(t){return Nn(t)&&t._zod.def.type==="pipe"}function xa(t,e=!1){if(Wn(t))return sL(t)?xa(t._def.schema,e):t;if(Nn(t)){let n=t;if(oL(t)&&(n=xa(t._zod.def.in,e)),e){if(Ua(n)){const i=n._zod.def.shape;for(const[a,s]of Object.entries(n._zod.def.shape))i[a]=xa(s,e);n=hl(n,{...n._zod.def,shape:i})}else if(A_(n)){const i=xa(n._zod.def.element,e);n=hl(n,{...n._zod.def,element:i})}}const r=ur.get(t);return r&&ur.add(n,r),n}throw new Error("Schema must be an instance of z3.ZodType or z4.$ZodType")}function _h(t){if(Nn(t)){const e=xa(t,!0);if(Ua(e)){const n=jd(e,!0);return uy(n)}else return uy(t)}return Wn(t)?nL(t):t}function lL(t,e){if(t!==void 0&&!$a(t))return t;if(wh(e))try{let n=e.getName();return n=n.startsWith("Runnable")?n.slice(8):n,n}catch{return e.getName()}else return e.name??"UnknownSchema"}function uL(t){return wh(t.data)?{type:"runnable",data:{id:t.data.lc_id,name:t.data.getName()}}:{type:"schema",data:{..._h(t.data.schema),title:t.data.name}}}class Yl{constructor(e){Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"edges",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.nodes=(e==null?void 0:e.nodes)??this.nodes,this.edges=(e==null?void 0:e.edges)??this.edges}toJSON(){const e={};return Object.values(this.nodes).forEach((n,r)=>{e[n.id]=$a(n.id)?r:n.id}),{nodes:Object.values(this.nodes).map(n=>({id:e[n.id],...uL(n)})),edges:this.edges.map(n=>{const r={source:e[n.source],target:e[n.target]};return typeof n.data<"u"&&(r.data=n.data),typeof n.conditional<"u"&&(r.conditional=n.conditional),r})}}addNode(e,n,r){if(n!==void 0&&this.nodes[n]!==void 0)throw new Error(`Node with id ${n} already exists`);const i=n??lt(),a={id:i,data:e,name:lL(n,e),metadata:r};return this.nodes[i]=a,a}removeNode(e){delete this.nodes[e.id],this.edges=this.edges.filter(n=>n.source!==e.id&&n.target!==e.id)}addEdge(e,n,r,i){if(this.nodes[e.id]===void 0)throw new Error(`Source node ${e.id} not in graph`);if(this.nodes[n.id]===void 0)throw new Error(`Target node ${n.id} not in graph`);const a={source:e.id,target:n.id,data:r,conditional:i};return this.edges.push(a),a}firstNode(){return fy(this)}lastNode(){return hy(this)}extend(e,n=""){let r=n;Object.values(e.nodes).map(u=>u.id).every($a)&&(r="");const a=u=>r?`${r}:${u}`:u;Object.entries(e.nodes).forEach(([u,c])=>{this.nodes[a(u)]={...c,id:a(u)}});const s=e.edges.map(u=>({...u,source:a(u.source),target:a(u.target)}));this.edges=[...this.edges,...s];const o=e.firstNode(),l=e.lastNode();return[o?{id:a(o.id),data:o.data}:void 0,l?{id:a(l.id),data:l.data}:void 0]}trimFirstNode(){const e=this.firstNode();e&&fy(this,[e.id])&&this.removeNode(e)}trimLastNode(){const e=this.lastNode();e&&hy(this,[e.id])&&this.removeNode(e)}reid(){const e=Object.fromEntries(Object.values(this.nodes).map(i=>[i.id,i.name])),n=new Map;Object.values(e).forEach(i=>{n.set(i,(n.get(i)||0)+1)});const r=i=>{const a=e[i];return $a(i)&&n.get(a)===1?a:i};return new Yl({nodes:Object.fromEntries(Object.entries(this.nodes).map(([i,a])=>[r(i),{...a,id:r(i)}])),edges:this.edges.map(i=>({...i,source:r(i.source),target:r(i.target)}))})}drawMermaid(e){const{withStyles:n,curveStyle:r,nodeColors:i={default:"fill:#f2f0ff,line-height:1.2",first:"fill-opacity:0",last:"fill:#bfb6fc"},wrapLabelNWords:a}=e??{},s=this.reid(),o=s.firstNode(),l=s.lastNode();return QP(s.nodes,s.edges,{firstNode:o==null?void 0:o.id,lastNode:l==null?void 0:l.id,withStyles:n,curveStyle:r,nodeColors:i,wrapLabelNWords:a})}async drawMermaidPng(e){const n=this.drawMermaid(e);return XP(n,{backgroundColor:e==null?void 0:e.backgroundColor})}}function fy(t,e=[]){const n=new Set(t.edges.filter(i=>!e.includes(i.source)).map(i=>i.target)),r=[];for(const i of Object.values(t.nodes))!e.includes(i.id)&&!n.has(i.id)&&r.push(i);return r.length===1?r[0]:void 0}function hy(t,e=[]){const n=new Set(t.edges.filter(i=>!e.includes(i.target)).map(i=>i.source)),r=[];for(const i of Object.values(t.nodes))!e.includes(i.id)&&!n.has(i.id)&&r.push(i);return r.length===1?r[0]:void 0}function cL(t){const e=new TextEncoder,n=new ReadableStream({async start(r){for await(const i of t)r.enqueue(e.encode(`event: data
data: ${JSON.stringify(i)}

`));r.enqueue(e.encode(`event: end

`)),r.close()}});return Pt.fromReadableStream(n)}function py(t){return typeof t=="object"&&t!==null&&typeof t[Symbol.iterator]=="function"&&typeof t.next=="function"}const dL=t=>t!=null&&typeof t=="object"&&"next"in t&&typeof t.next=="function";function Ld(t){return typeof t=="object"&&t!==null&&typeof t[Symbol.asyncIterator]=="function"}function*my(t,e){for(;;){const{value:n,done:r}=Sr.runWithConfig(Gi(t),e.next.bind(e),!0);if(r)break;yield n}}async function*$d(t,e){const n=e[Symbol.asyncIterator]();for(;;){const{value:r,done:i}=await Sr.runWithConfig(Gi(t),n.next.bind(e),!0);if(i)break;yield r}}function He(t,e){return t&&!Array.isArray(t)&&!(t instanceof Date)&&typeof t=="object"?t:{[e]:t}}class Ve extends qr{constructor(){super(...arguments),Object.defineProperty(this,"lc_runnable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}getName(e){const n=this.name??this.constructor.lc_name()??this.constructor.name;return e?`${n}${e}`:n}bind(e){return new Ur({bound:this,kwargs:e,config:{}})}map(){return new ml({bound:this})}withRetry(e){return new R_({bound:this,kwargs:{},config:{},maxAttemptNumber:e==null?void 0:e.stopAfterAttempt,...e})}withConfig(e){return new Ur({bound:this,config:e,kwargs:{}})}withFallbacks(e){const n=Array.isArray(e)?e:e.fallbacks;return new hL({runnable:this,fallbacks:n})}_getOptionsList(e,n=0){if(Array.isArray(e)&&e.length!==n)throw new Error(`Passed "options" must be an array with the same length as the inputs, but got ${e.length} options for ${n} inputs`);if(Array.isArray(e))return e.map(ge);if(n>1&&!Array.isArray(e)&&e.runId){console.warn("Provided runId will be used only for the first element of the batch.");const r=Object.fromEntries(Object.entries(e).filter(([i])=>i!=="runId"));return Array.from({length:n},(i,a)=>ge(a===0?e:r))}return Array.from({length:n},()=>ge(e))}async batch(e,n,r){var l;const i=this._getOptionsList(n??{},e.length),a=((l=i[0])==null?void 0:l.maxConcurrency)??(r==null?void 0:r.maxConcurrency),s=new vh({maxConcurrency:a,onFailedAttempt:u=>{throw u}}),o=e.map((u,c)=>s.call(async()=>{try{return await this.invoke(u,i[c])}catch(d){if(r!=null&&r.returnExceptions)return d;throw d}}));return Promise.all(o)}async*_streamIterator(e,n){yield this.invoke(e,n)}async stream(e,n){const r=ge(n),i=new ea({generator:this._streamIterator(e,r),config:r});return await i.setup,Pt.fromAsyncGenerator(i)}_separateRunnableConfigFromCallOptions(e){let n;e===void 0?n=ge(e):n=ge({callbacks:e.callbacks,tags:e.tags,metadata:e.metadata,runName:e.runName,configurable:e.configurable,recursionLimit:e.recursionLimit,maxConcurrency:e.maxConcurrency,runId:e.runId,timeout:e.timeout,signal:e.signal});const r={...e};return delete r.callbacks,delete r.tags,delete r.metadata,delete r.runName,delete r.configurable,delete r.recursionLimit,delete r.maxConcurrency,delete r.runId,delete r.timeout,delete r.signal,[n,r]}async _callWithConfig(e,n,r){const i=ge(r),a=await un(i),s=await(a==null?void 0:a.handleChainStart(this.toJSON(),He(n,"input"),i.runId,i==null?void 0:i.runType,void 0,void 0,(i==null?void 0:i.runName)??this.getName()));delete i.runId;let o;try{const l=e.call(this,n,i,s);o=await kr(l,r==null?void 0:r.signal)}catch(l){throw await(s==null?void 0:s.handleChainError(l)),l}return await(s==null?void 0:s.handleChainEnd(He(o,"output"))),o}async _batchWithConfig(e,n,r,i){var u;const a=this._getOptionsList(r??{},n.length),s=await Promise.all(a.map(un)),o=await Promise.all(s.map(async(c,d)=>{const f=await(c==null?void 0:c.handleChainStart(this.toJSON(),He(n[d],"input"),a[d].runId,a[d].runType,void 0,void 0,a[d].runName??this.getName()));return delete a[d].runId,f}));let l;try{const c=e.call(this,n,a,o,i);l=await kr(c,(u=a==null?void 0:a[0])==null?void 0:u.signal)}catch(c){throw await Promise.all(o.map(d=>d==null?void 0:d.handleChainError(c))),c}return await Promise.all(o.map(c=>c==null?void 0:c.handleChainEnd(He(l,"output")))),l}async*_transformStreamWithConfig(e,n,r){let i,a=!0,s,o=!0;const l=ge(r),u=await un(l);async function*c(){for await(const f of e){if(a)if(i===void 0)i=f;else try{i=cn(i,f)}catch{i=void 0,a=!1}yield f}}let d;try{const f=await BP(n.bind(this),c(),async()=>u==null?void 0:u.handleChainStart(this.toJSON(),{input:""},l.runId,l.runType,void 0,void 0,l.runName??this.getName()),r==null?void 0:r.signal,l);delete l.runId,d=f.setup;const h=d==null?void 0:d.handlers.find(VP);let m=f.output;h!==void 0&&d!==void 0&&(m=h.tapOutputIterable(d.runId,m));const v=d==null?void 0:d.handlers.find(HP);v!==void 0&&d!==void 0&&(m=v.tapOutputIterable(d.runId,m));for await(const _ of m)if(yield _,o)if(s===void 0)s=_;else try{s=cn(s,_)}catch{s=void 0,o=!1}}catch(f){throw await(d==null?void 0:d.handleChainError(f,void 0,void 0,void 0,{inputs:He(i,"input")})),f}await(d==null?void 0:d.handleChainEnd(s??{},void 0,void 0,void 0,{inputs:He(i,"input")}))}getGraph(e){const n=new Yl,r=n.addNode({name:`${this.getName()}Input`,schema:pg()}),i=n.addNode(this),a=n.addNode({name:`${this.getName()}Output`,schema:pg()});return n.addEdge(r,i),n.addEdge(i,a),n}pipe(e){return new Mn({first:this,last:Mr(e)})}pick(e){return this.pipe(new pL(e))}assign(e){return this.pipe(new P_(new ta({steps:e})))}async*transform(e,n){let r;for await(const i of e)r===void 0?r=i:r=cn(r,i);yield*this._streamIterator(r,ge(n))}async*streamLog(e,n,r){const i=new sy({...r,autoClose:!1,_schemaFormat:"original"}),a=ge(n);yield*this._streamLog(e,i,a)}async*_streamLog(e,n,r){const{callbacks:i}=r;if(i===void 0)r.callbacks=[n];else if(Array.isArray(i))r.callbacks=i.concat([n]);else{const l=i.copy();l.addHandler(n,!0),r.callbacks=l}const a=this.stream(e,r);async function s(){try{const l=await a;for await(const u of l){const c=new nr({ops:[{op:"add",path:"/streamed_output/-",value:u}]});await n.writer.write(c)}}finally{await n.writer.close()}}const o=s();try{for await(const l of n)yield l}finally{await o}}streamEvents(e,n,r){let i;if(n.version==="v1")i=this._streamEventsV1(e,n,r);else if(n.version==="v2")i=this._streamEventsV2(e,n,r);else throw new Error('Only versions "v1" and "v2" of the schema are currently supported.');return n.encoding==="text/event-stream"?cL(i):Pt.fromAsyncGenerator(i)}async*_streamEventsV2(e,n,r){var m;const i=new WP({...r,autoClose:!1}),a=ge(n),s=a.runId??lt();a.runId=s;const o=a.callbacks;if(o===void 0)a.callbacks=[i];else if(Array.isArray(o))a.callbacks=o.concat(i);else{const v=o.copy();v.addHandler(i,!0),a.callbacks=v}const l=new AbortController,u=this;async function c(){let v,_=null;try{n!=null&&n.signal?"any"in AbortSignal?v=AbortSignal.any([l.signal,n.signal]):(v=n.signal,_=()=>{l.abort()},n.signal.addEventListener("abort",_,{once:!0})):v=l.signal;const p=await u.stream(e,{...a,signal:v}),y=i.tapOutputIterable(s,p);for await(const g of y)if(l.signal.aborted)break}finally{await i.finish(),v&&_&&v.removeEventListener("abort",_)}}const d=c();let f=!1,h;try{for await(const v of i){if(!f){v.data.input=e,f=!0,h=v.run_id,yield v;continue}v.run_id===h&&v.event.endsWith("_end")&&(m=v.data)!=null&&m.input&&delete v.data.input,yield v}}finally{l.abort(),await d}}async*_streamEventsV1(e,n,r){let i,a=!1;const s=ge(n),o=s.tags??[],l=s.metadata??{},u=s.runName??this.getName(),c=new sy({...r,autoClose:!1,_schemaFormat:"streaming_events"}),d=new KP({...r}),f=this._streamLog(e,c,s);for await(const m of f){if(i?i=i.concat(m):i=hs.fromRunLogPatch(m),i.state===void 0)throw new Error('Internal error: "streamEvents" state is missing. Please open a bug report.');if(!a){a=!0;const y={...i.state},g={run_id:y.id,event:`on_${y.type}_start`,name:u,tags:o,metadata:l,data:{input:e}};d.includeEvent(g,y.type)&&(yield g)}const v=m.ops.filter(y=>y.path.startsWith("/logs/")).map(y=>y.path.split("/")[2]),_=[...new Set(v)];for(const y of _){let g,x={};const k=i.state.logs[y];if(k.end_time===void 0?k.streamed_output.length>0?g="stream":g="start":g="end",g==="start")k.inputs!==void 0&&(x.input=k.inputs);else if(g==="end")k.inputs!==void 0&&(x.input=k.inputs),x.output=k.final_output;else if(g==="stream"){const S=k.streamed_output.length;if(S!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${S} instead. Encountered in: "${k.name}"`);x={chunk:k.streamed_output[0]},k.streamed_output=[]}yield{event:`on_${k.type}_${g}`,name:k.name,run_id:k.id,tags:k.tags,metadata:k.metadata,data:x}}const{state:p}=i;if(p.streamed_output.length>0){const y=p.streamed_output.length;if(y!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${y} instead. Encountered in: "${p.name}"`);const g={chunk:p.streamed_output[0]};p.streamed_output=[];const x={event:`on_${p.type}_stream`,run_id:p.id,tags:o,metadata:l,name:u,data:g};d.includeEvent(x,p.type)&&(yield x)}}const h=i==null?void 0:i.state;if(h!==void 0){const m={event:`on_${h.type}_end`,name:u,run_id:h.id,tags:o,metadata:l,data:{output:h.final_output}};d.includeEvent(m,h.type)&&(yield m)}}static isRunnable(e){return wh(e)}withListeners({onStart:e,onEnd:n,onError:r}){return new Ur({bound:this,config:{},configFactories:[i=>({callbacks:[new __({config:i,onStart:e,onEnd:n,onError:r})]})]})}asTool(e){return mL(this,e)}}class Ur extends Ve{static lc_name(){return"RunnableBinding"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"configFactories",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound,this.kwargs=e.kwargs,this.config=e.config,this.configFactories=e.configFactories}getName(e){return this.bound.getName(e)}async _mergeConfig(...e){const n=ry(this.config,...e);return ry(n,...this.configFactories?await Promise.all(this.configFactories.map(async r=>await r(n))):[])}bind(e){return new this.constructor({bound:this.bound,kwargs:{...this.kwargs,...e},config:this.config})}withConfig(e){return new this.constructor({bound:this.bound,kwargs:this.kwargs,config:{...this.config,...e}})}withRetry(e){return new R_({bound:this.bound,kwargs:this.kwargs,config:this.config,maxAttemptNumber:e==null?void 0:e.stopAfterAttempt,...e})}async invoke(e,n){return this.bound.invoke(e,await this._mergeConfig(ge(n),this.kwargs))}async batch(e,n,r){const i=Array.isArray(n)?await Promise.all(n.map(async a=>this._mergeConfig(ge(a),this.kwargs))):await this._mergeConfig(ge(n),this.kwargs);return this.bound.batch(e,i,r)}async*_streamIterator(e,n){yield*this.bound._streamIterator(e,await this._mergeConfig(ge(n),this.kwargs))}async stream(e,n){return this.bound.stream(e,await this._mergeConfig(ge(n),this.kwargs))}async*transform(e,n){yield*this.bound.transform(e,await this._mergeConfig(ge(n),this.kwargs))}streamEvents(e,n,r){const i=this,a=async function*(){yield*i.bound.streamEvents(e,{...await i._mergeConfig(ge(n),i.kwargs),version:n.version},r)};return Pt.fromAsyncGenerator(a())}static isRunnableBinding(e){return e.bound&&Ve.isRunnable(e.bound)}withListeners({onStart:e,onEnd:n,onError:r}){return new Ur({bound:this.bound,kwargs:this.kwargs,config:this.config,configFactories:[i=>({callbacks:[new __({config:i,onStart:e,onEnd:n,onError:r})]})]})}}class ml extends Ve{static lc_name(){return"RunnableEach"}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound}bind(e){return new ml({bound:this.bound.bind(e)})}async invoke(e,n){return this._callWithConfig(this._invoke.bind(this),e,n)}async _invoke(e,n,r){return this.bound.batch(e,nt(n,{callbacks:r==null?void 0:r.getChild()}))}withListeners({onStart:e,onEnd:n,onError:r}){return new ml({bound:this.bound.withListeners({onStart:e,onEnd:n,onError:r})})}}class R_ extends Ur{static lc_name(){return"RunnableRetry"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"maxAttemptNumber",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:()=>{}}),this.maxAttemptNumber=e.maxAttemptNumber??this.maxAttemptNumber,this.onFailedAttempt=e.onFailedAttempt??this.onFailedAttempt}_patchConfigForRetry(e,n,r){const i=e>1?`retry:attempt:${e}`:void 0;return nt(n,{callbacks:r==null?void 0:r.getChild(i)})}async _invoke(e,n,r){return sl(i=>super.invoke(e,this._patchConfigForRetry(i,n,r)),{onFailedAttempt:i=>this.onFailedAttempt(i,e),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}async invoke(e,n){return this._callWithConfig(this._invoke.bind(this),e,n)}async _batch(e,n,r,i){const a={};try{await sl(async s=>{const o=e.map((f,h)=>h).filter(f=>a[f.toString()]===void 0||a[f.toString()]instanceof Error),l=o.map(f=>e[f]),u=o.map(f=>this._patchConfigForRetry(s,n==null?void 0:n[f],r==null?void 0:r[f])),c=await super.batch(l,u,{...i,returnExceptions:!0});let d;for(let f=0;f<c.length;f+=1){const h=c[f],m=o[f];h instanceof Error&&d===void 0&&(d=h,d.input=l[f]),a[m.toString()]=h}if(d)throw d;return c},{onFailedAttempt:s=>this.onFailedAttempt(s,s.input),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}catch(s){if((i==null?void 0:i.returnExceptions)!==!0)throw s}return Object.keys(a).sort((s,o)=>parseInt(s,10)-parseInt(o,10)).map(s=>a[parseInt(s,10)])}async batch(e,n,r){return this._batchWithConfig(this._batch.bind(this),e,n,r)}}class Mn extends Ve{static lc_name(){return"RunnableSequence"}constructor(e){super(e),Object.defineProperty(this,"first",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"middle",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"omitSequenceTags",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),this.first=e.first,this.middle=e.middle??this.middle,this.last=e.last,this.name=e.name,this.omitSequenceTags=e.omitSequenceTags??this.omitSequenceTags}get steps(){return[this.first,...this.middle,this.last]}async invoke(e,n){var l;const r=ge(n),i=await un(r),a=await(i==null?void 0:i.handleChainStart(this.toJSON(),He(e,"input"),r.runId,void 0,void 0,void 0,r==null?void 0:r.runName));delete r.runId;let s=e,o;try{const u=[this.first,...this.middle];for(let c=0;c<u.length;c+=1){const f=u[c].invoke(s,nt(r,{callbacks:a==null?void 0:a.getChild(this.omitSequenceTags?void 0:`seq:step:${c+1}`)}));s=await kr(f,n==null?void 0:n.signal)}if((l=n==null?void 0:n.signal)!=null&&l.aborted)throw new Error("Aborted");o=await this.last.invoke(s,nt(r,{callbacks:a==null?void 0:a.getChild(this.omitSequenceTags?void 0:`seq:step:${this.steps.length}`)}))}catch(u){throw await(a==null?void 0:a.handleChainError(u)),u}return await(a==null?void 0:a.handleChainEnd(He(o,"output"))),o}async batch(e,n,r){var l;const i=this._getOptionsList(n??{},e.length),a=await Promise.all(i.map(un)),s=await Promise.all(a.map(async(u,c)=>{const d=await(u==null?void 0:u.handleChainStart(this.toJSON(),He(e[c],"input"),i[c].runId,void 0,void 0,void 0,i[c].runName));return delete i[c].runId,d}));let o=e;try{for(let u=0;u<this.steps.length;u+=1){const d=this.steps[u].batch(o,s.map((f,h)=>{const m=f==null?void 0:f.getChild(this.omitSequenceTags?void 0:`seq:step:${u+1}`);return nt(i[h],{callbacks:m})}),r);o=await kr(d,(l=i[0])==null?void 0:l.signal)}}catch(u){throw await Promise.all(s.map(c=>c==null?void 0:c.handleChainError(u))),u}return await Promise.all(s.map(u=>u==null?void 0:u.handleChainEnd(He(o,"output")))),o}async*_streamIterator(e,n){var d;const r=await un(n),{runId:i,...a}=n??{},s=await(r==null?void 0:r.handleChainStart(this.toJSON(),He(e,"input"),i,void 0,void 0,void 0,a==null?void 0:a.runName)),o=[this.first,...this.middle,this.last];let l=!0,u;async function*c(){yield e}try{let f=o[0].transform(c(),nt(a,{callbacks:s==null?void 0:s.getChild(this.omitSequenceTags?void 0:"seq:step:1")}));for(let h=1;h<o.length;h+=1)f=await o[h].transform(f,nt(a,{callbacks:s==null?void 0:s.getChild(this.omitSequenceTags?void 0:`seq:step:${h+1}`)}));for await(const h of f)if((d=n==null?void 0:n.signal)==null||d.throwIfAborted(),yield h,l)if(u===void 0)u=h;else try{u=cn(u,h)}catch{u=void 0,l=!1}}catch(f){throw await(s==null?void 0:s.handleChainError(f)),f}await(s==null?void 0:s.handleChainEnd(He(u,"output")))}getGraph(e){const n=new Yl;let r=null;return this.steps.forEach((i,a)=>{const s=i.getGraph(e);a!==0&&s.trimFirstNode(),a!==this.steps.length-1&&s.trimLastNode(),n.extend(s);const o=s.firstNode();if(!o)throw new Error(`Runnable ${i} has no first node`);r&&n.addEdge(r,o),r=s.lastNode()}),n}pipe(e){return Mn.isRunnableSequence(e)?new Mn({first:this.first,middle:this.middle.concat([this.last,e.first,...e.middle]),last:e.last,name:this.name??e.name}):new Mn({first:this.first,middle:[...this.middle,this.last],last:Mr(e),name:this.name})}static isRunnableSequence(e){return Array.isArray(e.middle)&&Ve.isRunnable(e)}static from([e,...n],r){let i={};return typeof r=="string"?i.name=r:r!==void 0&&(i=r),new Mn({...i,first:Mr(e),middle:n.slice(0,-1).map(Mr),last:Mr(n[n.length-1])})}}class ta extends Ve{static lc_name(){return"RunnableMap"}getStepsKeys(){return Object.keys(this.steps)}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"steps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.steps={};for(const[n,r]of Object.entries(e.steps))this.steps[n]=Mr(r)}static from(e){return new ta({steps:e})}async invoke(e,n){const r=ge(n),i=await un(r),a=await(i==null?void 0:i.handleChainStart(this.toJSON(),{input:e},r.runId,void 0,void 0,void 0,r==null?void 0:r.runName));delete r.runId;const s={};try{const o=Object.entries(this.steps).map(async([l,u])=>{s[l]=await u.invoke(e,nt(r,{callbacks:a==null?void 0:a.getChild(`map:key:${l}`)}))});await kr(Promise.all(o),n==null?void 0:n.signal)}catch(o){throw await(a==null?void 0:a.handleChainError(o)),o}return await(a==null?void 0:a.handleChainEnd(s)),s}async*_transform(e,n,r){const i={...this.steps},a=w_(e,Object.keys(i).length),s=new Map(Object.entries(i).map(([o,l],u)=>{const c=l.transform(a[u],nt(r,{callbacks:n==null?void 0:n.getChild(`map:key:${o}`)}));return[o,c.next().then(d=>({key:o,gen:c,result:d}))]}));for(;s.size;){const o=Promise.race(s.values()),{key:l,result:u,gen:c}=await kr(o,r==null?void 0:r.signal);s.delete(l),u.done||(yield{[l]:u.value},s.set(l,c.next().then(d=>({key:l,gen:c,result:d}))))}}transform(e,n){return this._transformStreamWithConfig(e,this._transform.bind(this),n)}async stream(e,n){async function*r(){yield e}const i=ge(n),a=new ea({generator:this.transform(r(),i),config:i});return await a.setup,Pt.fromAsyncGenerator(a)}}class bh extends Ve{constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!ah(e.func))throw new Error("RunnableTraceable requires a function that is wrapped in traceable higher-order function");this.func=e.func}async invoke(e,n){const[r]=this._getOptionsList(n??{},1),i=await un(r),a=this.func(nt(r,{callbacks:i}),e);return kr(a,r==null?void 0:r.signal)}async*_streamIterator(e,n){var a,s;const[r]=this._getOptionsList(n??{},1),i=await this.invoke(e,n);if(Ld(i)){for await(const o of i)(a=r==null?void 0:r.signal)==null||a.throwIfAborted(),yield o;return}if(dL(i)){for(;;){(s=r==null?void 0:r.signal)==null||s.throwIfAborted();const o=i.next();if(o.done)break;yield o.value}return}yield i}static from(e){return new bh({func:e})}}function fL(t){if(ah(t))throw new Error("RunnableLambda requires a function that is not wrapped in traceable higher-order function. This shouldn't happen.")}class As extends Ve{static lc_name(){return"RunnableLambda"}constructor(e){if(ah(e.func))return bh.from(e.func);super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),fL(e.func),this.func=e.func}static from(e){return new As({func:e})}async _invoke(e,n,r){return new Promise((i,a)=>{const s=nt(n,{callbacks:r==null?void 0:r.getChild(),recursionLimit:((n==null?void 0:n.recursionLimit)??ac)-1});Sr.runWithConfig(Gi(s),async()=>{var o,l;try{let u=await this.func(e,{...s});if(u&&Ve.isRunnable(u)){if((n==null?void 0:n.recursionLimit)===0)throw new Error("Recursion limit reached.");u=await u.invoke(e,{...s,recursionLimit:(s.recursionLimit??ac)-1})}else if(Ld(u)){let c;for await(const d of $d(s,u))if((o=n==null?void 0:n.signal)==null||o.throwIfAborted(),c===void 0)c=d;else try{c=cn(c,d)}catch{c=d}u=c}else if(py(u)){let c;for(const d of my(s,u))if((l=n==null?void 0:n.signal)==null||l.throwIfAborted(),c===void 0)c=d;else try{c=cn(c,d)}catch{c=d}u=c}i(u)}catch(u){a(u)}})})}async invoke(e,n){return this._callWithConfig(this._invoke.bind(this),e,n)}async*_transform(e,n,r){var o,l;let i;for await(const u of e)if(i===void 0)i=u;else try{i=cn(i,u)}catch{i=u}const a=nt(r,{callbacks:n==null?void 0:n.getChild(),recursionLimit:((r==null?void 0:r.recursionLimit)??ac)-1}),s=await new Promise((u,c)=>{Sr.runWithConfig(Gi(a),async()=>{try{const d=await this.func(i,{...a,config:a});u(d)}catch(d){c(d)}})});if(s&&Ve.isRunnable(s)){if((r==null?void 0:r.recursionLimit)===0)throw new Error("Recursion limit reached.");const u=await s.stream(i,a);for await(const c of u)yield c}else if(Ld(s))for await(const u of $d(a,s))(o=r==null?void 0:r.signal)==null||o.throwIfAborted(),yield u;else if(py(s))for(const u of my(a,s))(l=r==null?void 0:r.signal)==null||l.throwIfAborted(),yield u;else yield s}transform(e,n){return this._transformStreamWithConfig(e,this._transform.bind(this),n)}async stream(e,n){async function*r(){yield e}const i=ge(n),a=new ea({generator:this.transform(r(),i),config:i});return await a.setup,Pt.fromAsyncGenerator(a)}}class hL extends Ve{static lc_name(){return"RunnableWithFallbacks"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fallbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnable=e.runnable,this.fallbacks=e.fallbacks}*runnables(){yield this.runnable;for(const e of this.fallbacks)yield e}async invoke(e,n){const r=ge(n),i=await un(r),{runId:a,...s}=r,o=await(i==null?void 0:i.handleChainStart(this.toJSON(),He(e,"input"),a,void 0,void 0,void 0,s==null?void 0:s.runName)),l=nt(s,{callbacks:o==null?void 0:o.getChild()});return await Sr.runWithConfig(l,async()=>{var d;let c;for(const f of this.runnables()){(d=r==null?void 0:r.signal)==null||d.throwIfAborted();try{const h=await f.invoke(e,l);return await(o==null?void 0:o.handleChainEnd(He(h,"output"))),h}catch(h){c===void 0&&(c=h)}}throw c===void 0?new Error("No error stored at end of fallback."):(await(o==null?void 0:o.handleChainError(c)),c)})}async*_streamIterator(e,n){var d;const r=ge(n),i=await un(r),{runId:a,...s}=r,o=await(i==null?void 0:i.handleChainStart(this.toJSON(),He(e,"input"),a,void 0,void 0,void 0,s==null?void 0:s.runName));let l,u;for(const f of this.runnables()){(d=r==null?void 0:r.signal)==null||d.throwIfAborted();const h=nt(s,{callbacks:o==null?void 0:o.getChild()});try{const m=await f.stream(e,h);u=$d(h,m);break}catch(m){l===void 0&&(l=m)}}if(u===void 0){const f=l??new Error("No error stored at end of fallback.");throw await(o==null?void 0:o.handleChainError(f)),f}let c;try{for await(const f of u){yield f;try{c=c===void 0?c:cn(c,f)}catch{c=void 0}}}catch(f){throw await(o==null?void 0:o.handleChainError(f)),f}await(o==null?void 0:o.handleChainEnd(He(c,"output")))}async batch(e,n,r){var l;if(r!=null&&r.returnExceptions)throw new Error("Not implemented.");const i=this._getOptionsList(n??{},e.length),a=await Promise.all(i.map(u=>un(u))),s=await Promise.all(a.map(async(u,c)=>{const d=await(u==null?void 0:u.handleChainStart(this.toJSON(),He(e[c],"input"),i[c].runId,void 0,void 0,void 0,i[c].runName));return delete i[c].runId,d}));let o;for(const u of this.runnables()){(l=i[0].signal)==null||l.throwIfAborted();try{const c=await u.batch(e,s.map((d,f)=>nt(i[f],{callbacks:d==null?void 0:d.getChild()})),r);return await Promise.all(s.map((d,f)=>d==null?void 0:d.handleChainEnd(He(c[f],"output")))),c}catch(c){o===void 0&&(o=c)}}throw o?(await Promise.all(s.map(u=>u==null?void 0:u.handleChainError(o))),o):new Error("No error stored at end of fallbacks.")}}function Mr(t){if(typeof t=="function")return new As({func:t});if(Ve.isRunnable(t))return t;if(!Array.isArray(t)&&typeof t=="object"){const e={};for(const[n,r]of Object.entries(t))e[n]=Mr(r);return new ta({steps:e})}else throw new Error(`Expected a Runnable, function or object.
Instead got an unsupported type.`)}class P_ extends Ve{static lc_name(){return"RunnableAssign"}constructor(e){e instanceof ta&&(e={mapper:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"mapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.mapper=e.mapper}async invoke(e,n){const r=await this.mapper.invoke(e,n);return{...e,...r}}async*_transform(e,n,r){const i=this.mapper.getStepsKeys(),[a,s]=w_(e),o=this.mapper.transform(s,nt(r,{callbacks:n==null?void 0:n.getChild()})),l=o.next();for await(const u of a){if(typeof u!="object"||Array.isArray(u))throw new Error(`RunnableAssign can only be used with objects as input, got ${typeof u}`);const c=Object.fromEntries(Object.entries(u).filter(([d])=>!i.includes(d)));Object.keys(c).length>0&&(yield c)}yield(await l).value;for await(const u of o)yield u}transform(e,n){return this._transformStreamWithConfig(e,this._transform.bind(this),n)}async stream(e,n){async function*r(){yield e}const i=ge(n),a=new ea({generator:this.transform(r(),i),config:i});return await a.setup,Pt.fromAsyncGenerator(a)}}class pL extends Ve{static lc_name(){return"RunnablePick"}constructor(e){(typeof e=="string"||Array.isArray(e))&&(e={keys:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"keys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keys=e.keys}async _pick(e){if(typeof this.keys=="string")return e[this.keys];{const n=this.keys.map(r=>[r,e[r]]).filter(r=>r[1]!==void 0);return n.length===0?void 0:Object.fromEntries(n)}}async invoke(e,n){return this._callWithConfig(this._pick.bind(this),e,n)}async*_transform(e){for await(const n of e){const r=await this._pick(n);r!==void 0&&(yield r)}}transform(e,n){return this._transformStreamWithConfig(e,this._transform.bind(this),n)}async stream(e,n){async function*r(){yield e}const i=ge(n),a=new ea({generator:this.transform(r(),i),config:i});return await a.setup,Pt.fromAsyncGenerator(a)}}class gy extends Ur{constructor(e){const n=Mn.from([As.from(async r=>{let i;if(Mw(r))try{i=await iL(this.schema,r.args)}catch{throw new VO("Received tool input did not match expected schema",JSON.stringify(r.args))}else i=r;return i}).withConfig({runName:`${e.name}:parse_input`}),e.bound]).withConfig({runName:e.name});super({bound:n,config:e.config??{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.description=e.description,this.schema=e.schema}static lc_name(){return"RunnableToolLike"}}function mL(t,e){const n=e.name??t.getName(),r=e.description??I_(e.schema);return aL(e.schema)?new gy({name:n,description:r,schema:xN({input:bN()}).transform(i=>i.input),bound:t}):new gy({name:n,description:r,schema:e.schema,bound:t})}/*
 * [js-sha1]{@link https://github.com/emn178/js-sha1}
 *
 * @version 0.6.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */var gL=typeof window=="object"?window:{},ie="0123456789abcdef".split(""),yL=[-2147483648,8388608,32768,128],tn=[24,16,8,0],Ue=[];function fn(t){t?(Ue[0]=Ue[16]=Ue[1]=Ue[2]=Ue[3]=Ue[4]=Ue[5]=Ue[6]=Ue[7]=Ue[8]=Ue[9]=Ue[10]=Ue[11]=Ue[12]=Ue[13]=Ue[14]=Ue[15]=0,this.blocks=Ue):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}fn.prototype.update=function(t){if(!this.finalized){var e=typeof t!="string";e&&t.constructor===gL.ArrayBuffer&&(t=new Uint8Array(t));for(var n,r=0,i,a=t.length||0,s=this.blocks;r<a;){if(this.hashed&&(this.hashed=!1,s[0]=this.block,s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),e)for(i=this.start;r<a&&i<64;++r)s[i>>2]|=t[r]<<tn[i++&3];else for(i=this.start;r<a&&i<64;++r)n=t.charCodeAt(r),n<128?s[i>>2]|=n<<tn[i++&3]:n<2048?(s[i>>2]|=(192|n>>6)<<tn[i++&3],s[i>>2]|=(128|n&63)<<tn[i++&3]):n<55296||n>=57344?(s[i>>2]|=(224|n>>12)<<tn[i++&3],s[i>>2]|=(128|n>>6&63)<<tn[i++&3],s[i>>2]|=(128|n&63)<<tn[i++&3]):(n=65536+((n&1023)<<10|t.charCodeAt(++r)&1023),s[i>>2]|=(240|n>>18)<<tn[i++&3],s[i>>2]|=(128|n>>12&63)<<tn[i++&3],s[i>>2]|=(128|n>>6&63)<<tn[i++&3],s[i>>2]|=(128|n&63)<<tn[i++&3]);this.lastByteIndex=i,this.bytes+=i-this.start,i>=64?(this.block=s[16],this.start=i-64,this.hash(),this.hashed=!0):this.start=i}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}};fn.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex;t[16]=this.block,t[e>>2]|=yL[e&3],this.block=t[16],e>=56&&(this.hashed||this.hash(),t[0]=this.block,t[16]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=0),t[14]=this.hBytes<<3|this.bytes>>>29,t[15]=this.bytes<<3,this.hash()}};fn.prototype.hash=function(){var t=this.h0,e=this.h1,n=this.h2,r=this.h3,i=this.h4,a,s,o,l=this.blocks;for(s=16;s<80;++s)o=l[s-3]^l[s-8]^l[s-14]^l[s-16],l[s]=o<<1|o>>>31;for(s=0;s<20;s+=5)a=e&n|~e&r,o=t<<5|t>>>27,i=o+a+i+1518500249+l[s]<<0,e=e<<30|e>>>2,a=t&e|~t&n,o=i<<5|i>>>27,r=o+a+r+1518500249+l[s+1]<<0,t=t<<30|t>>>2,a=i&t|~i&e,o=r<<5|r>>>27,n=o+a+n+1518500249+l[s+2]<<0,i=i<<30|i>>>2,a=r&i|~r&t,o=n<<5|n>>>27,e=o+a+e+1518500249+l[s+3]<<0,r=r<<30|r>>>2,a=n&r|~n&i,o=e<<5|e>>>27,t=o+a+t+1518500249+l[s+4]<<0,n=n<<30|n>>>2;for(;s<40;s+=5)a=e^n^r,o=t<<5|t>>>27,i=o+a+i+1859775393+l[s]<<0,e=e<<30|e>>>2,a=t^e^n,o=i<<5|i>>>27,r=o+a+r+1859775393+l[s+1]<<0,t=t<<30|t>>>2,a=i^t^e,o=r<<5|r>>>27,n=o+a+n+1859775393+l[s+2]<<0,i=i<<30|i>>>2,a=r^i^t,o=n<<5|n>>>27,e=o+a+e+1859775393+l[s+3]<<0,r=r<<30|r>>>2,a=n^r^i,o=e<<5|e>>>27,t=o+a+t+1859775393+l[s+4]<<0,n=n<<30|n>>>2;for(;s<60;s+=5)a=e&n|e&r|n&r,o=t<<5|t>>>27,i=o+a+i-1894007588+l[s]<<0,e=e<<30|e>>>2,a=t&e|t&n|e&n,o=i<<5|i>>>27,r=o+a+r-1894007588+l[s+1]<<0,t=t<<30|t>>>2,a=i&t|i&e|t&e,o=r<<5|r>>>27,n=o+a+n-1894007588+l[s+2]<<0,i=i<<30|i>>>2,a=r&i|r&t|i&t,o=n<<5|n>>>27,e=o+a+e-1894007588+l[s+3]<<0,r=r<<30|r>>>2,a=n&r|n&i|r&i,o=e<<5|e>>>27,t=o+a+t-1894007588+l[s+4]<<0,n=n<<30|n>>>2;for(;s<80;s+=5)a=e^n^r,o=t<<5|t>>>27,i=o+a+i-899497514+l[s]<<0,e=e<<30|e>>>2,a=t^e^n,o=i<<5|i>>>27,r=o+a+r-899497514+l[s+1]<<0,t=t<<30|t>>>2,a=i^t^e,o=r<<5|r>>>27,n=o+a+n-899497514+l[s+2]<<0,i=i<<30|i>>>2,a=r^i^t,o=n<<5|n>>>27,e=o+a+e-899497514+l[s+3]<<0,r=r<<30|r>>>2,a=n^r^i,o=e<<5|e>>>27,t=o+a+t-899497514+l[s+4]<<0,n=n<<30|n>>>2;this.h0=this.h0+t<<0,this.h1=this.h1+e<<0,this.h2=this.h2+n<<0,this.h3=this.h3+r<<0,this.h4=this.h4+i<<0};fn.prototype.hex=function(){this.finalize();var t=this.h0,e=this.h1,n=this.h2,r=this.h3,i=this.h4;return ie[t>>28&15]+ie[t>>24&15]+ie[t>>20&15]+ie[t>>16&15]+ie[t>>12&15]+ie[t>>8&15]+ie[t>>4&15]+ie[t&15]+ie[e>>28&15]+ie[e>>24&15]+ie[e>>20&15]+ie[e>>16&15]+ie[e>>12&15]+ie[e>>8&15]+ie[e>>4&15]+ie[e&15]+ie[n>>28&15]+ie[n>>24&15]+ie[n>>20&15]+ie[n>>16&15]+ie[n>>12&15]+ie[n>>8&15]+ie[n>>4&15]+ie[n&15]+ie[r>>28&15]+ie[r>>24&15]+ie[r>>20&15]+ie[r>>16&15]+ie[r>>12&15]+ie[r>>8&15]+ie[r>>4&15]+ie[r&15]+ie[i>>28&15]+ie[i>>24&15]+ie[i>>20&15]+ie[i>>16&15]+ie[i>>12&15]+ie[i>>8&15]+ie[i>>4&15]+ie[i&15]};fn.prototype.toString=fn.prototype.hex;fn.prototype.digest=function(){this.finalize();var t=this.h0,e=this.h1,n=this.h2,r=this.h3,i=this.h4;return[t>>24&255,t>>16&255,t>>8&255,t&255,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24&255,n>>16&255,n>>8&255,n&255,r>>24&255,r>>16&255,r>>8&255,r&255,i>>24&255,i>>16&255,i>>8&255,i&255]};fn.prototype.array=fn.prototype.digest;fn.prototype.arrayBuffer=function(){this.finalize();var t=new ArrayBuffer(20),e=new DataView(t);return e.setUint32(0,this.h0),e.setUint32(4,this.h1),e.setUint32(8,this.h2),e.setUint32(12,this.h3),e.setUint32(16,this.h4),t};let yy=!1;const vL=t=>(yy||(console.warn(["The default method for hashing keys is insecure and will be replaced in a future version,","but hasn't been replaced yet as to not break existing caches. It's recommended that you use","a more secure hashing algorithm to avoid cache poisoning.","","See this page for more information:","|","> https://js.langchain.com/docs/troubleshooting/warnings/insecure-cache-algorithm"].join(`
`)),yy=!0),new fn(!0).update(t).hex()),wL=(...t)=>vL(t.join("_"));class _L{constructor(){Object.defineProperty(this,"keyEncoder",{enumerable:!0,configurable:!0,writable:!0,value:wL})}makeDefaultKeyEncoder(e){this.keyEncoder=e}}const bL=new Map;class xh extends _L{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=e??new Map}lookup(e,n){return Promise.resolve(this.cache.get(this.keyEncoder(e,n))??null)}async update(e,n,r){this.cache.set(this.keyEncoder(e,n),r)}static global(){return new xh(bL)}}class j_ extends qr{}class xL extends j_{static lc_name(){return"StringPromptValue"}constructor(e){super({value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e}toString(){return this.value}toChatMessages(){return[new Dl(this.value)]}}class EL extends j_{static lc_name(){return"ChatPromptValue"}constructor(e){Array.isArray(e)&&(e={messages:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=e.messages}toString(){return Dw(this.messages)}toChatMessages(){return this.messages}}var Ql={};Ql.byteLength=CL;Ql.toByteArray=OL;Ql.fromByteArray=AL;var En=[],Dt=[],SL=typeof Uint8Array<"u"?Uint8Array:Array,cc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var oi=0,kL=cc.length;oi<kL;++oi)En[oi]=cc[oi],Dt[cc.charCodeAt(oi)]=oi;Dt[45]=62;Dt[95]=63;function L_(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var r=n===e?0:4-n%4;return[n,r]}function CL(t){var e=L_(t),n=e[0],r=e[1];return(n+r)*3/4-r}function TL(t,e,n){return(e+n)*3/4-n}function OL(t){var e,n=L_(t),r=n[0],i=n[1],a=new SL(TL(t,r,i)),s=0,o=i>0?r-4:r,l;for(l=0;l<o;l+=4)e=Dt[t.charCodeAt(l)]<<18|Dt[t.charCodeAt(l+1)]<<12|Dt[t.charCodeAt(l+2)]<<6|Dt[t.charCodeAt(l+3)],a[s++]=e>>16&255,a[s++]=e>>8&255,a[s++]=e&255;return i===2&&(e=Dt[t.charCodeAt(l)]<<2|Dt[t.charCodeAt(l+1)]>>4,a[s++]=e&255),i===1&&(e=Dt[t.charCodeAt(l)]<<10|Dt[t.charCodeAt(l+1)]<<4|Dt[t.charCodeAt(l+2)]>>2,a[s++]=e>>8&255,a[s++]=e&255),a}function NL(t){return En[t>>18&63]+En[t>>12&63]+En[t>>6&63]+En[t&63]}function IL(t,e,n){for(var r,i=[],a=e;a<n;a+=3)r=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(t[a+2]&255),i.push(NL(r));return i.join("")}function AL(t){for(var e,n=t.length,r=n%3,i=[],a=16383,s=0,o=n-r;s<o;s+=a)i.push(IL(t,s,s+a>o?o:s+a));return r===1?(e=t[n-1],i.push(En[e>>2]+En[e<<4&63]+"==")):r===2&&(e=(t[n-2]<<8)+t[n-1],i.push(En[e>>10]+En[e>>4&63]+En[e<<2&63]+"=")),i.join("")}var RL=Object.defineProperty,PL=(t,e,n)=>e in t?RL(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,jL=(t,e,n)=>(PL(t,e+"",n),n);function LL(t,e){let n=Array.from({length:t.length},(r,i)=>({start:i,end:i+1}));for(;n.length>1;){let r=null;for(let i=0;i<n.length-1;i++){const a=t.slice(n[i].start,n[i+1].end),s=e.get(a.join(","));s!=null&&(r==null||s<r[0])&&(r=[s,i])}if(r!=null){const i=r[1];n[i]={start:n[i].start,end:n[i+1].end},n.splice(i+1,1)}else break}return n}function $L(t,e){return t.length===1?[e.get(t.join(","))]:LL(t,e).map(n=>e.get(t.slice(n.start,n.end).join(","))).filter(n=>n!=null)}function ML(t){return t.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}var Md=class{constructor(t,e){Zn(this,"specialTokens");Zn(this,"inverseSpecialTokens");Zn(this,"patStr");Zn(this,"textEncoder",new TextEncoder);Zn(this,"textDecoder",new TextDecoder("utf-8"));Zn(this,"rankMap",new Map);Zn(this,"textMap",new Map);this.patStr=t.pat_str;const n=t.bpe_ranks.split(`
`).filter(Boolean).reduce((r,i)=>{const[a,s,...o]=i.split(" "),l=Number.parseInt(s,10);return o.forEach((u,c)=>r[u]=l+c),r},{});for(const[r,i]of Object.entries(n)){const a=Ql.toByteArray(r);this.rankMap.set(a.join(","),i),this.textMap.set(i,a)}this.specialTokens={...t.special_tokens,...e},this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((r,[i,a])=>(r[a]=this.textEncoder.encode(i),r),{})}encode(t,e=[],n="all"){const r=new RegExp(this.patStr,"ug"),i=Md.specialTokenRegex(Object.keys(this.specialTokens)),a=[],s=new Set(e==="all"?Object.keys(this.specialTokens):e),o=new Set(n==="all"?Object.keys(this.specialTokens).filter(u=>!s.has(u)):n);if(o.size>0){const u=Md.specialTokenRegex([...o]),c=t.match(u);if(c!=null)throw new Error(`The text contains a special token that is not allowed: ${c[0]}`)}let l=0;for(;;){let u=null,c=l;for(;i.lastIndex=c,u=i.exec(t),!(u==null||s.has(u[0]));)c=u.index+1;const d=(u==null?void 0:u.index)??t.length;for(const h of t.substring(l,d).matchAll(r)){const m=this.textEncoder.encode(h[0]),v=this.rankMap.get(m.join(","));if(v!=null){a.push(v);continue}a.push(...$L(m,this.rankMap))}if(u==null)break;let f=this.specialTokens[u[0]];a.push(f),l=u.index+u[0].length}return a}decode(t){const e=[];let n=0;for(let a=0;a<t.length;++a){const s=t[a],o=this.textMap.get(s)??this.inverseSpecialTokens[s];o!=null&&(e.push(o),n+=o.length)}const r=new Uint8Array(n);let i=0;for(const a of e)r.set(a,i),i+=a.length;return this.textDecoder.decode(r)}},$_=Md;jL($_,"specialTokenRegex",t=>new RegExp(t.map(e=>ML(e)).join("|"),"g"));function DL(t){switch(t){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":case"text-embedding-3-small":case"text-embedding-3-large":return"cl100k_base";case"gpt-4o":case"gpt-4o-2024-05-13":case"gpt-4o-2024-08-06":case"gpt-4o-2024-11-20":case"gpt-4o-mini-2024-07-18":case"gpt-4o-mini":case"gpt-4o-search-preview":case"gpt-4o-search-preview-2025-03-11":case"gpt-4o-mini-search-preview":case"gpt-4o-mini-search-preview-2025-03-11":case"gpt-4o-audio-preview":case"gpt-4o-audio-preview-2024-12-17":case"gpt-4o-audio-preview-2024-10-01":case"gpt-4o-mini-audio-preview":case"gpt-4o-mini-audio-preview-2024-12-17":case"o1":case"o1-2024-12-17":case"o1-mini":case"o1-mini-2024-09-12":case"o1-preview":case"o1-preview-2024-09-12":case"o1-pro":case"o1-pro-2025-03-19":case"o3":case"o3-2025-04-16":case"o3-mini":case"o3-mini-2025-01-31":case"o4-mini":case"o4-mini-2025-04-16":case"chatgpt-4o-latest":case"gpt-4o-realtime":case"gpt-4o-realtime-preview-2024-10-01":case"gpt-4o-realtime-preview-2024-12-17":case"gpt-4o-mini-realtime-preview":case"gpt-4o-mini-realtime-preview-2024-12-17":case"gpt-4.1":case"gpt-4.1-2025-04-14":case"gpt-4.1-mini":case"gpt-4.1-mini-2025-04-14":case"gpt-4.1-nano":case"gpt-4.1-nano-2025-04-14":case"gpt-4.5-preview":case"gpt-4.5-preview-2025-02-27":return"o200k_base";default:throw new Error("Unknown model")}}const uo={},FL=new vh({});async function zL(t){return t in uo||(uo[t]=FL.fetch(`https://tiktoken.pages.dev/js/${t}.json`).then(e=>e.json()).then(e=>new $_(e)).catch(e=>{throw delete uo[t],e})),await uo[t]}async function UL(t){return zL(DL(t))}const BL=t=>t.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":t.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":t.startsWith("gpt-4-32k")?"gpt-4-32k":t.startsWith("gpt-4-")?"gpt-4":t.startsWith("gpt-4o")?"gpt-4o":t;function M_(t){return typeof t!="object"||!t?!1:!!("type"in t&&t.type==="function"&&"function"in t&&typeof t.function=="object"&&t.function&&"name"in t.function&&"parameters"in t.function)}const HL=()=>!1;class GL extends Ve{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??HL(),this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}}class VL extends GL{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:e,callbackManager:n,...r}){const{cache:i,...a}=r;super({callbacks:e??n,...a}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof i=="object"?this.cache=i:i?this.cache=xh.global():this.cache=void 0,this.caller=new vh(r??{})}async getNumTokens(e){let n;typeof e=="string"?n=e:n=e.map(i=>typeof i=="string"?i:i.type==="text"&&"text"in i?i.text:"").join("");let r=Math.ceil(n.length/4);if(!this._encoding)try{this._encoding=await UL("modelName"in this?BL(this.modelName):"gpt2")}catch(i){console.warn("Failed to calculate number of tokens, falling back to approximate count",i)}if(this._encoding)try{r=this._encoding.encode(n).length}catch(i){console.warn("Failed to calculate number of tokens, falling back to approximate count",i)}return r}static _convertInputToPromptValue(e){return typeof e=="string"?new xL(e):Array.isArray(e)?new EL(e.map(_a)):e}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall({config:e,...n}){const r={...this._identifyingParams(),...n,_type:this._llmType(),_model:this._modelType()};return Object.entries(r).filter(([s,o])=>o!==void 0).map(([s,o])=>`${s}:${JSON.stringify(o)}`).sort().join(",")}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){throw new Error("Use .toJSON() instead")}}class gl extends Ve{static lc_name(){return"RunnablePassthrough"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e&&(this.func=e.func)}async invoke(e,n){const r=ge(n);return this.func&&await this.func(e,r),this._callWithConfig(i=>Promise.resolve(i),e,r)}async*transform(e,n){const r=ge(n);let i,a=!0;for await(const s of this._transformStreamWithConfig(e,o=>o,r))if(yield s,a)if(i===void 0)i=s;else try{i=cn(i,s)}catch{i=void 0,a=!1}this.func&&i!==void 0&&await this.func(i,r)}static assign(e){return new P_(new ta({steps:e}))}}function dc(t){const e=[];for(const n of t){let r=n;if(Array.isArray(n.content))for(let i=0;i<n.content.length;i++){const a=n.content[i];(LO(a)||$O(a))&&r===n&&(r=new n.constructor({...r,content:[...n.content.slice(0,i),MO(a),...n.content.slice(i+1)]}))}e.push(r)}return e}class rr extends VL{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]}),Object.defineProperty(this,"disableStreaming",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_separateRunnableConfigFromCallOptionsCompat(e){const[n,r]=super._separateRunnableConfigFromCallOptions(e);return r.signal=n.signal,[n,r]}async invoke(e,n){const r=rr._convertInputToPromptValue(e);return(await this.generatePrompt([r],n,n==null?void 0:n.callbacks)).generations[0][0].message}async*_streamResponseChunks(e,n,r){throw new Error("Not implemented.")}async*_streamIterator(e,n){var r;if(this._streamResponseChunks===rr.prototype._streamResponseChunks||this.disableStreaming)yield this.invoke(e,n);else{const a=rr._convertInputToPromptValue(e).toChatMessages(),[s,o]=this._separateRunnableConfigFromCallOptionsCompat(n),l={...s.metadata,...this.getLsParams(o)},u=await vt.configure(s.callbacks,this.callbacks,s.tags,this.tags,l,this.metadata,{verbose:this.verbose}),c={options:o,invocation_params:this==null?void 0:this.invocationParams(o),batch_size:1},d=await(u==null?void 0:u.handleChatModelStart(this.toJSON(),[dc(a)],s.runId,void 0,c,void 0,void 0,s.runName));let f,h;try{for await(const m of this._streamResponseChunks(a,o,d==null?void 0:d[0])){if(m.message.id==null){const v=(r=d==null?void 0:d.at(0))==null?void 0:r.runId;v!=null&&m.message._updateId(`run-${v}`)}m.message.response_metadata={...m.generationInfo,...m.message.response_metadata},yield m.message,f?f=f.concat(m):f=m,Ym(m.message)&&m.message.usage_metadata!==void 0&&(h={tokenUsage:{promptTokens:m.message.usage_metadata.input_tokens,completionTokens:m.message.usage_metadata.output_tokens,totalTokens:m.message.usage_metadata.total_tokens}})}}catch(m){throw await Promise.all((d??[]).map(v=>v==null?void 0:v.handleLLMError(m))),m}await Promise.all((d??[]).map(m=>m==null?void 0:m.handleLLMEnd({generations:[[f]],llmOutput:h})))}}getLsParams(e){const n=this.getName().startsWith("Chat")?this.getName().replace("Chat",""):this.getName();return{ls_model_type:"chat",ls_stop:e.stop,ls_provider:n}}async _generateUncached(e,n,r,i){var d,f;const a=e.map(h=>h.map(_a));let s;if(i!==void 0&&i.length===a.length)s=i;else{const h={...r.metadata,...this.getLsParams(n)},m=await vt.configure(r.callbacks,this.callbacks,r.tags,this.tags,h,this.metadata,{verbose:this.verbose}),v={options:n,invocation_params:this==null?void 0:this.invocationParams(n),batch_size:1};s=await(m==null?void 0:m.handleChatModelStart(this.toJSON(),a.map(dc),r.runId,void 0,v,void 0,void 0,r.runName))}const o=[],l=[];if(!!(s!=null&&s[0].handlers.find(EP))&&!this.disableStreaming&&a.length===1&&this._streamResponseChunks!==rr.prototype._streamResponseChunks)try{const h=await this._streamResponseChunks(a[0],n,s==null?void 0:s[0]);let m,v;for await(const _ of h){if(_.message.id==null){const p=(d=s==null?void 0:s.at(0))==null?void 0:d.runId;p!=null&&_.message._updateId(`run-${p}`)}m===void 0?m=_:m=cn(m,_),Ym(_.message)&&_.message.usage_metadata!==void 0&&(v={tokenUsage:{promptTokens:_.message.usage_metadata.input_tokens,completionTokens:_.message.usage_metadata.output_tokens,totalTokens:_.message.usage_metadata.total_tokens}})}if(m===void 0)throw new Error("Received empty response from chat model call.");o.push([m]),await(s==null?void 0:s[0].handleLLMEnd({generations:o,llmOutput:v}))}catch(h){throw await(s==null?void 0:s[0].handleLLMError(h)),h}else{const h=await Promise.allSettled(a.map((m,v)=>this._generate(m,{...n,promptIndex:v},s==null?void 0:s[v])));await Promise.all(h.map(async(m,v)=>{var _,p,y;if(m.status==="fulfilled"){const g=m.value;for(const x of g.generations){if(x.message.id==null){const k=(_=s==null?void 0:s.at(0))==null?void 0:_.runId;k!=null&&x.message._updateId(`run-${k}`)}x.message.response_metadata={...x.generationInfo,...x.message.response_metadata}}return g.generations.length===1&&(g.generations[0].message.response_metadata={...g.llmOutput,...g.generations[0].message.response_metadata}),o[v]=g.generations,l[v]=g.llmOutput,(p=s==null?void 0:s[v])==null?void 0:p.handleLLMEnd({generations:[g.generations],llmOutput:g.llmOutput})}else return await((y=s==null?void 0:s[v])==null?void 0:y.handleLLMError(m.reason)),Promise.reject(m.reason)}))}const c={generations:o,llmOutput:l.length?(f=this._combineLLMOutput)==null?void 0:f.call(this,...l):void 0};return Object.defineProperty(c,oy,{value:s?{runIds:s==null?void 0:s.map(h=>h.runId)}:void 0,configurable:!0}),c}async _generateCached({messages:e,cache:n,llmStringKey:r,parsedOptions:i,handledOptions:a}){const s=e.map(_=>_.map(_a)),o={...a.metadata,...this.getLsParams(i)},l=await vt.configure(a.callbacks,this.callbacks,a.tags,this.tags,o,this.metadata,{verbose:this.verbose}),u={options:i,invocation_params:this==null?void 0:this.invocationParams(i),batch_size:1},c=await(l==null?void 0:l.handleChatModelStart(this.toJSON(),s.map(dc),a.runId,void 0,u,void 0,void 0,a.runName)),d=[],h=(await Promise.allSettled(s.map(async(_,p)=>{const y=rr._convertInputToPromptValue(_).toString(),g=await n.lookup(y,r);return g==null&&d.push(p),g}))).map((_,p)=>({result:_,runManager:c==null?void 0:c[p]})).filter(({result:_})=>_.status==="fulfilled"&&_.value!=null||_.status==="rejected"),m=[];await Promise.all(h.map(async({result:_,runManager:p},y)=>{if(_.status==="fulfilled"){const g=_.value;return m[y]=g.map(x=>("message"in x&&Cs(x.message)&&Xf(x.message)&&(x.message.usage_metadata={input_tokens:0,output_tokens:0,total_tokens:0}),x.generationInfo={...x.generationInfo,tokenUsage:{}},x)),g.length&&await(p==null?void 0:p.handleLLMNewToken(g[0].text)),p==null?void 0:p.handleLLMEnd({generations:[g]},void 0,void 0,void 0,{cached:!0})}else return await(p==null?void 0:p.handleLLMError(_.reason,void 0,void 0,void 0,{cached:!0})),Promise.reject(_.reason)}));const v={generations:m,missingPromptIndices:d,startedRunManagers:c};return Object.defineProperty(v,oy,{value:c?{runIds:c==null?void 0:c.map(_=>_.runId)}:void 0,configurable:!0}),v}async generate(e,n,r){let i;Array.isArray(n)?i={stop:n}:i=n;const a=e.map(m=>m.map(_a)),[s,o]=this._separateRunnableConfigFromCallOptionsCompat(i);if(s.callbacks=s.callbacks??r,!this.cache)return this._generateUncached(a,o,s);const{cache:l}=this,u=this._getSerializedCacheKeyParametersForCall(o),{generations:c,missingPromptIndices:d,startedRunManagers:f}=await this._generateCached({messages:a,cache:l,llmStringKey:u,parsedOptions:o,handledOptions:s});let h={};if(d.length>0){const m=await this._generateUncached(d.map(v=>a[v]),o,s,f!==void 0?d.map(v=>f==null?void 0:f[v]):void 0);await Promise.all(m.generations.map(async(v,_)=>{const p=d[_];c[p]=v;const y=rr._convertInputToPromptValue(a[p]).toString();return l.update(y,u,v)})),h=m.llmOutput??{}}return{generations:c,llmOutput:h}}invocationParams(e){return{}}_modelType(){return"base_chat_model"}serialize(){return{...this.invocationParams(),_type:this._llmType(),_model:this._modelType()}}async generatePrompt(e,n,r){const i=e.map(a=>a.toChatMessages());return this.generate(i,n,r)}async call(e,n,r){return(await this.generate([e.map(_a)],n,r)).generations[0][0].message}async callPrompt(e,n,r){const i=e.toChatMessages();return this.call(i,n,r)}async predictMessages(e,n,r){return this.call(e,n,r)}async predict(e,n,r){const i=new Dl(e),a=await this.call([i],n,r);if(typeof a.content!="string")throw new Error("Cannot use predict when output is not a string.");return a.content}withStructuredOutput(e,n){if(typeof this.bindTools!="function")throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');if(n!=null&&n.strict)throw new Error('"strict" mode is not supported for this model by default.');const r=e,i=n==null?void 0:n.name,a=I_(r)??"A function available to call.",s=n==null?void 0:n.method,o=n==null?void 0:n.includeRaw;if(s==="jsonMode")throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');let l=i??"extract",u;Is(r)?u=[{type:"function",function:{name:l,description:a,parameters:_h(r)}}]:("name"in r&&(l=r.name),u=[{type:"function",function:{name:l,description:a,parameters:r}}]);const c=this.bindTools(u),d=As.from(v=>{if(!v.tool_calls||v.tool_calls.length===0)throw new Error("No tool calls found in the response.");const _=v.tool_calls.find(p=>p.name===l);if(!_)throw new Error(`No tool call found with name ${l}.`);return _.args});if(!o)return c.pipe(d).withConfig({runName:"StructuredOutput"});const f=gl.assign({parsed:(v,_)=>d.invoke(v.raw,_)}),h=gl.assign({parsed:()=>null}),m=f.withFallbacks({fallbacks:[h]});return Mn.from([{raw:c},m]).withConfig({runName:"StructuredOutputRunnable"})}}class D_ extends Ve{parseResultWithPrompt(e,n,r){return this.parseResult(e,r)}_baseMessageToString(e){return typeof e.content=="string"?e.content:this._baseMessageContentToString(e.content)}_baseMessageContentToString(e){return JSON.stringify(e)}async invoke(e,n){return typeof e=="string"?this._callWithConfig(async(r,i)=>this.parseResult([{text:r}],i==null?void 0:i.callbacks),e,{...n,runType:"parser"}):this._callWithConfig(async(r,i)=>this.parseResult([{message:r,text:this._baseMessageToString(r)}],i==null?void 0:i.callbacks),e,{...n,runType:"parser"})}}class WL extends D_{parseResult(e,n){return this.parse(e[0].text,n)}async parseWithPrompt(e,n,r){return this.parse(e,r)}_type(){throw new Error("_type not implemented")}}class ZL extends Error{constructor(e,n,r,i=!1){if(super(e),Object.defineProperty(this,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmOutput=n,this.observation=r,this.sendToLLM=i,i&&(r===void 0||n===void 0))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true");$w(this,"OUTPUT_PARSING_FAILURE")}}class qL extends WL{async*_transform(e){for await(const n of e)typeof n=="string"?yield this.parseResult([{text:n}]):yield this.parseResult([{message:n,text:this._baseMessageToString(n)}])}async*transform(e,n){yield*this._transformStreamWithConfig(e,this._transform.bind(this),{...n,runType:"parser"})}}class KL extends qL{constructor(e){super(e),Object.defineProperty(this,"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.diff=(e==null?void 0:e.diff)??this.diff}async*_transform(e){let n,r;for await(const i of e){if(typeof i!="string"&&typeof i.content!="string")throw new Error("Cannot handle non-string output.");let a;if(UO(i)){if(typeof i.content!="string")throw new Error("Cannot handle non-string message output.");a=new ps({message:i,text:i.content})}else if(Cs(i)){if(typeof i.content!="string")throw new Error("Cannot handle non-string message output.");a=new ps({message:qO(i),text:i.content})}else a=new Vi({text:i});r===void 0?r=a:r=r.concat(a);const s=await this.parsePartialResult([r]);s!=null&&!Pd(s,n)&&(this.diff?yield this._diff(n,s):yield s,n=s)}}getFormatInstructions(){return""}}class JL extends KL{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"JsonOutputParser"}_diff(e,n){if(n)return e?YN(e,n):[{op:"replace",path:"",value:n}]}async parsePartialResult(e){return Wm(e[0].text)}async parse(e){return Wm(e,JSON.parse)}getFormatInstructions(){return""}}function Jr(t){if(typeof t=="object"&&t!==null){const e={...t};"additionalProperties"in e&&delete e.additionalProperties,"$schema"in e&&delete e.$schema,"strict"in e&&delete e.strict;for(const n in e)n in e&&(Array.isArray(e[n])?e[n]=e[n].map(Jr):typeof e[n]=="object"&&e[n]!==null&&(e[n]=Jr(e[n])));return e}return t}function Dd(t){const e=Jr(Is(t)?_h(t):t),{$schema:n,...r}=e;return r}function YL(t){const e=Jr(t),{$schema:n,...r}=e;return r}function QL(t){return t!==void 0&&Array.isArray(t.lc_namespace)}function XL(t){return t!==void 0&&Ve.isRunnable(t)&&"lc_name"in t.constructor&&typeof t.constructor.lc_name=="function"&&t.constructor.lc_name()==="RunnableToolLike"}function e$(t){return!!t&&typeof t=="object"&&"name"in t&&"schema"in t&&(Is(t.schema)||t.schema!=null&&typeof t.schema=="object"&&"type"in t.schema&&typeof t.schema.type=="string"&&["null","boolean","object","array","number","string"].includes(t.schema.type))}function F_(t){return e$(t)||XL(t)||QL(t)}const qe=[];for(let t=0;t<256;++t)qe.push((t+256).toString(16).slice(1));function t$(t,e=0){return(qe[t[e+0]]+qe[t[e+1]]+qe[t[e+2]]+qe[t[e+3]]+"-"+qe[t[e+4]]+qe[t[e+5]]+"-"+qe[t[e+6]]+qe[t[e+7]]+"-"+qe[t[e+8]]+qe[t[e+9]]+"-"+qe[t[e+10]]+qe[t[e+11]]+qe[t[e+12]]+qe[t[e+13]]+qe[t[e+14]]+qe[t[e+15]]).toLowerCase()}let fc;const n$=new Uint8Array(16);function r$(){if(!fc){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");fc=crypto.getRandomValues.bind(crypto)}return fc(n$)}const i$=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),vy={randomUUID:i$};function z_(t,e,n){var i;if(vy.randomUUID&&!e&&!t)return vy.randomUUID();t=t||{};const r=t.random??((i=t.rng)==null?void 0:i.call(t))??r$();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,t$(r)}function a$(t){const e=t._getType();return Ml.isInstance(t)?t.role:e==="tool"?e:t.name??e}function s$(t){switch(t){case"supervisor":case"ai":case"model":return"model";case"system":return"system";case"human":return"user";case"tool":case"function":return"function";default:throw new Error(`Unknown / unsupported author: ${t}`)}}function o$(t){if("mimeType"in t&&"data"in t)return{inlineData:{mimeType:t.mimeType,data:t.data}};if("mimeType"in t&&"fileUri"in t)return{fileData:{mimeType:t.mimeType,fileUri:t.fileUri}};throw new Error("Invalid media content")}function l$(t,e){var n;return(n=e.map(r=>Xf(r)?r.tool_calls??[]:[]).flat().find(r=>r.id===t.tool_call_id))==null?void 0:n.name}function u$(t){return{providerName:"Google Gemini",fromStandardTextBlock(n){return{text:n.text}},fromStandardImageBlock(n){if(!t)throw new Error("This model does not support images");if(n.source_type==="url"){const r=Du({dataUrl:n.url});return r?{inlineData:{mimeType:r.mime_type,data:r.data}}:{fileData:{mimeType:n.mime_type??"",fileUri:n.url}}}if(n.source_type==="base64")return{inlineData:{mimeType:n.mime_type??"",data:n.data}};throw new Error(`Unsupported source type: ${n.source_type}`)},fromStandardAudioBlock(n){if(!t)throw new Error("This model does not support audio");if(n.source_type==="url"){const r=Du({dataUrl:n.url});return r?{inlineData:{mimeType:r.mime_type,data:r.data}}:{fileData:{mimeType:n.mime_type??"",fileUri:n.url}}}if(n.source_type==="base64")return{inlineData:{mimeType:n.mime_type??"",data:n.data}};throw new Error(`Unsupported source type: ${n.source_type}`)},fromStandardFileBlock(n){if(!t)throw new Error("This model does not support files");if(n.source_type==="text")return{text:n.text};if(n.source_type==="url"){const r=Du({dataUrl:n.url});return r?{inlineData:{mimeType:r.mime_type,data:r.data}}:{fileData:{mimeType:n.mime_type??"",fileUri:n.url}}}if(n.source_type==="base64")return{inlineData:{mimeType:n.mime_type??"",data:n.data}};throw new Error(`Unsupported source type: ${n.source_type}`)}}}function wy(t,e){var n;if(Fi(t))return DO(t,u$(e));if(t.type==="text")return{text:t.text};if(t.type==="executableCode")return{executableCode:t.executableCode};if(t.type==="codeExecutionResult")return{codeExecutionResult:t.codeExecutionResult};if(t.type==="image_url"){if(!e)throw new Error("This model does not support images");let r;if(typeof t.image_url=="string")r=t.image_url;else if(typeof t.image_url=="object"&&"url"in t.image_url)r=t.image_url.url;else throw new Error("Please provide image as base64 encoded data URL");const[i,a]=r.split(",");if(!i.startsWith("data:"))throw new Error("Please provide image as base64 encoded data URL");const[s,o]=i.replace(/^data:/,"").split(";");if(o!=="base64")throw new Error("Please provide image as base64 encoded data URL");return{inlineData:{data:a,mimeType:s}}}else{if(t.type==="media")return o$(t);if(t.type==="tool_use")return{functionCall:{name:t.name,args:t.input}};if((n=t.type)!=null&&n.includes("/")&&t.type.split("/").length===2&&"data"in t&&typeof t.data=="string")return{inlineData:{mimeType:t.type,data:t.data}};if("functionCall"in t)return;throw"type"in t?new Error(`Unknown content type ${t.type}`):new Error(`Unknown content ${JSON.stringify(t)}`)}}function c$(t,e,n){var a;if(GO(t)){const s=t.name??l$(t,n);if(s===void 0)throw new Error(`Google requires a tool name for each tool call response, and we could not infer a called tool name for ToolMessage "${t.id}" from your passed messages. Please populate a "name" field on that ToolMessage explicitly.`);const o=Array.isArray(t.content)?t.content.map(l=>wy(l,e)).filter(l=>l!==void 0):t.content;return t.status==="error"?[{functionResponse:{name:s,response:{error:{details:o}}}}]:[{functionResponse:{name:s,response:{result:o}}}]}let r=[];const i=[];return typeof t.content=="string"&&t.content&&i.push({text:t.content}),Array.isArray(t.content)&&i.push(...t.content.map(s=>wy(s,e)).filter(s=>s!==void 0)),Xf(t)&&((a=t.tool_calls)!=null&&a.length)&&(r=t.tool_calls.map(s=>({functionCall:{name:s.name,args:s.args}}))),[...i,...r]}function _y(t,e,n=!1){return t.reduce((r,i,a)=>{if(!Cs(i))throw new Error("Unsupported message input");const s=a$(i);if(s==="system"&&a!==0)throw new Error("System message should be the first one");const o=s$(s),l=r.content[r.content.length];if(!r.mergeWithPreviousContent&&l&&l.role===o)throw new Error("Google Generative AI requires alternate messages between authors");const u=c$(i,e,t.slice(0,a));if(r.mergeWithPreviousContent){const f=r.content[r.content.length-1];if(!f)throw new Error("There was a problem parsing your system message. Please try a prompt without one.");return f.parts.push(...u),{mergeWithPreviousContent:!1,content:r.content}}let c=o;(c==="function"||c==="system"&&!n)&&(c="user");const d={role:c,parts:u};return{mergeWithPreviousContent:s==="system"&&!n,content:[...r.content,d]}},{content:[],mergeWithPreviousContent:!1}).content}function d$(t,e){var u,c,d;if(!t.candidates||t.candidates.length===0||!t.candidates[0])return{generations:[],llmOutput:{filters:t.promptFeedback}};const n=t.functionCalls(),[r]=t.candidates,{content:i,...a}=r;let s;Array.isArray(i==null?void 0:i.parts)&&i.parts.length===1&&i.parts[0].text?s=i.parts[0].text:Array.isArray(i==null?void 0:i.parts)&&i.parts.length>0?s=i.parts.map(f=>"text"in f?{type:"text",text:f.text}:"executableCode"in f?{type:"executableCode",executableCode:f.executableCode}:"codeExecutionResult"in f?{type:"codeExecutionResult",codeExecutionResult:f.codeExecutionResult}:f):s=[];let o="";if(typeof s=="string")o=s;else if(Array.isArray(s)&&s.length>0){const f=s.find(h=>"text"in h);o=(f==null?void 0:f.text)??o}return{generations:[{text:o,message:new yd({content:s??"",tool_calls:n==null?void 0:n.map(f=>({...f,type:"tool_call",id:"id"in f&&typeof f.id=="string"?f.id:z_()})),additional_kwargs:{...a},usage_metadata:e==null?void 0:e.usageMetadata}),generationInfo:a}],llmOutput:{tokenUsage:{promptTokens:(u=e==null?void 0:e.usageMetadata)==null?void 0:u.input_tokens,completionTokens:(c=e==null?void 0:e.usageMetadata)==null?void 0:c.output_tokens,totalTokens:(d=e==null?void 0:e.usageMetadata)==null?void 0:d.total_tokens}}}}function f$(t,e){if(!t.candidates||t.candidates.length===0)return null;const n=t.functionCalls(),[r]=t.candidates,{content:i,...a}=r;let s;Array.isArray(i==null?void 0:i.parts)&&i.parts.every(u=>"text"in u)?s=i.parts.map(u=>u.text).join(""):Array.isArray(i==null?void 0:i.parts)?s=i.parts.map(u=>"text"in u?{type:"text",text:u.text}:"executableCode"in u?{type:"executableCode",executableCode:u.executableCode}:"codeExecutionResult"in u?{type:"codeExecutionResult",codeExecutionResult:u.codeExecutionResult}:u):s=[];let o="";if(s&&typeof s=="string")o=s;else if(Array.isArray(s)){const u=s.find(c=>"text"in c);o=(u==null?void 0:u.text)??""}const l=[];return n&&l.push(...n.map(u=>({...u,args:JSON.stringify(u.args),index:e.index,type:"tool_call_chunk",id:"id"in u&&typeof u.id=="string"?u.id:z_()}))),new ps({text:o,message:new Qi({content:s||"",name:i?i.role:void 0,tool_call_chunks:l,additional_kwargs:{},usage_metadata:e.usageMetadata}),generationInfo:a})}function h$(t){return t.every(e=>"functionDeclarations"in e&&Array.isArray(e.functionDeclarations))?t:[{functionDeclarations:t.map(e=>{if(F_(e)){const n=Dd(e.schema);return n.type==="object"&&"properties"in n&&Object.keys(n.properties).length===0?{name:e.name,description:e.description}:{name:e.name,description:e.description,parameters:n}}return M_(e)?{name:e.function.name,description:e.function.description??"A function available to call.",parameters:YL(e.function.parameters)}:e})}]}class by extends D_{static lc_name(){return"GoogleGenerativeAIToolsOutputParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","google_genai","output_parsers"]}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.zodSchema=e.zodSchema}async _validateResult(e){if(this.zodSchema===void 0)return e;const n=await rL(this.zodSchema,e);if(n.success)return n.data;throw new ZL(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(n.error.issues)}`,JSON.stringify(e,null,2))}async parseResult(e){const n=e.flatMap(a=>{const{message:s}=a;return!("tool_calls"in s)||!Array.isArray(s.tool_calls)?[]:s.tool_calls});if(n[0]===void 0)throw new Error("No parseable tool calls provided to GoogleGenerativeAIToolsOutputParser.");const[r]=n;return await this._validateResult(r.args)}}function xy(t,e){const n=p$(t),r=g$(n,e);return{tools:n,toolConfig:r}}function p$(t){let e=[];const n=[];return t.forEach(i=>{if(F_(i)){const[a]=h$([i]);a.functionDeclarations&&e.push(...a.functionDeclarations)}else if(M_(i)){const{functionDeclarations:a}=m$(i);if(a)e.push(...a);else throw new Error("Failed to convert OpenAI structured tool to GenerativeAI tool")}else n.push(i)}),n.find(i=>"functionDeclarations"in i)?n.map(i=>{if((e==null?void 0:e.length)>0&&"functionDeclarations"in i){const a={functionDeclarations:[...i.functionDeclarations||[],...e]};return e=[],a}return i}):[...n,...e.length>0?[{functionDeclarations:e}]:[]]}function m$(t){return{functionDeclarations:[{name:t.function.name,description:t.function.description,parameters:Jr(t.function.parameters)}]}}function g$(t,e){if(!t.length||!e)return;const{toolChoice:n,allowedFunctionNames:r}=e,i={any:bi.ANY,auto:bi.AUTO,none:bi.NONE};if(n&&["any","auto","none"].includes(n))return{functionCallingConfig:{mode:i[n]??"MODE_UNSPECIFIED",allowedFunctionNames:r}};if(typeof n=="string"||r)return{functionCallingConfig:{mode:bi.ANY,allowedFunctionNames:[...r??[],...n&&typeof n=="string"?[n]:[]]}}}class y$ extends rr{static lc_name(){return"ChatGoogleGenerativeAI"}get lc_secrets(){return{apiKey:"GOOGLE_API_KEY"}}get lc_aliases(){return{apiKey:"google_api_key"}}get _isMultimodalModel(){return this.model.includes("vision")||this.model.startsWith("gemini-1.5")||this.model.startsWith("gemini-2")}constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models","google_genai"]}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxOutputTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"safetySettings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"json",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"convertSystemMessageToHumanContent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.model=e.model.replace(/^models\//,""),this.maxOutputTokens=e.maxOutputTokens??this.maxOutputTokens,this.maxOutputTokens&&this.maxOutputTokens<0)throw new Error("`maxOutputTokens` must be a positive integer");if(this.temperature=e.temperature??this.temperature,this.temperature&&(this.temperature<0||this.temperature>2))throw new Error("`temperature` must be in the range of [0.0,2.0]");if(this.topP=e.topP??this.topP,this.topP&&this.topP<0)throw new Error("`topP` must be a positive integer");if(this.topP&&this.topP>1)throw new Error("`topP` must be below 1.");if(this.topK=e.topK??this.topK,this.topK&&this.topK<0)throw new Error("`topK` must be a positive integer");if(this.stopSequences=e.stopSequences??this.stopSequences,this.apiKey=e.apiKey??zr("GOOGLE_API_KEY"),!this.apiKey)throw new Error("Please set an API key for Google GenerativeAI in the environment variable GOOGLE_API_KEY or in the `apiKey` field of the ChatGoogleGenerativeAI constructor");if(this.safetySettings=e.safetySettings??this.safetySettings,this.safetySettings&&this.safetySettings.length>0&&new Set(this.safetySettings.map(r=>r.category)).size!==this.safetySettings.length)throw new Error("The categories in `safetySettings` array must be unique");this.streaming=e.streaming??this.streaming,this.json=e.json,this.client=new Vm(this.apiKey).getGenerativeModel({model:this.model,safetySettings:this.safetySettings,generationConfig:{stopSequences:this.stopSequences,maxOutputTokens:this.maxOutputTokens,temperature:this.temperature,topP:this.topP,topK:this.topK,...this.json?{responseMimeType:"application/json"}:{}}},{apiVersion:e.apiVersion,baseUrl:e.baseUrl}),this.streamUsage=e.streamUsage??this.streamUsage}useCachedContent(e,n,r){this.apiKey&&(this.client=new Vm(this.apiKey).getGenerativeModelFromCachedContent(e,n,r))}get useSystemInstruction(){return typeof this.convertSystemMessageToHumanContent=="boolean"?!this.convertSystemMessageToHumanContent:this.computeUseSystemInstruction}get computeUseSystemInstruction(){return this.model==="gemini-1.0-pro-001"||this.model.startsWith("gemini-pro-vision")||this.model.startsWith("gemini-1.0-pro-vision")?!1:this.model!=="gemini-pro"}getLsParams(e){return{ls_provider:"google_genai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:this.client.generationConfig.temperature,ls_max_tokens:this.client.generationConfig.maxOutputTokens,ls_stop:e.stop}}_combineLLMOutput(){return[]}_llmType(){return"googlegenerativeai"}bindTools(e,n){var r;return this.withConfig({tools:(r=xy(e))==null?void 0:r.tools,...n})}invocationParams(e){var r;const n=(r=e==null?void 0:e.tools)!=null&&r.length?xy(e.tools,{toolChoice:e.tool_choice,allowedFunctionNames:e.allowedFunctionNames}):void 0;return e!=null&&e.responseSchema?(this.client.generationConfig.responseSchema=e.responseSchema,this.client.generationConfig.responseMimeType="application/json"):(this.client.generationConfig.responseSchema=void 0,this.client.generationConfig.responseMimeType=this.json?"application/json":void 0),{...n!=null&&n.tools?{tools:n.tools}:{},...n!=null&&n.toolConfig?{toolConfig:n.toolConfig}:{}}}async _generate(e,n,r){var c,d,f;const i=_y(e,this._isMultimodalModel,this.useSystemInstruction);let a=i;if(i[0].role==="system"){const[h]=i;this.client.systemInstruction=h,a=i.slice(1)}const s=this.invocationParams(n);if(this.streaming){const h={},m=this._streamResponseChunks(e,n,r),v={};for await(const p of m){const y=((c=p.generationInfo)==null?void 0:c.completion)??0;v[y]===void 0?v[y]=p:v[y]=v[y].concat(p)}return{generations:Object.entries(v).sort(([p],[y])=>parseInt(p,10)-parseInt(y,10)).map(([p,y])=>y),llmOutput:{estimatedTokenUsage:h}}}const o=await this.completionWithRetry({...s,contents:a});let l;if("usageMetadata"in o.response){const h=o.response.usageMetadata;l={input_tokens:h.promptTokenCount??0,output_tokens:h.candidatesTokenCount??0,total_tokens:h.totalTokenCount??0}}const u=d$(o.response,{usageMetadata:l});return((d=u.generations)==null?void 0:d.length)>0&&await(r==null?void 0:r.handleLLMNewToken(((f=u.generations[0])==null?void 0:f.text)??"")),u}async*_streamResponseChunks(e,n,r){const i=_y(e,this._isMultimodalModel,this.useSystemInstruction);let a=i;if(i[0].role==="system"){const[d]=i;this.client.systemInstruction=d,a=i.slice(1)}const o={...this.invocationParams(n),contents:a},l=await this.caller.callWithOptions({signal:n==null?void 0:n.signal},async()=>{const{stream:d}=await this.client.generateContentStream(o);return d});let u,c=0;for await(const d of l){if("usageMetadata"in d&&this.streamUsage!==!1&&n.streamUsage!==!1){const h=d.usageMetadata;if(!u)u={input_tokens:h.promptTokenCount??0,output_tokens:h.candidatesTokenCount??0,total_tokens:h.totalTokenCount??0};else{const m=(h.candidatesTokenCount??0)-u.output_tokens;u={input_tokens:0,output_tokens:m,total_tokens:m}}}const f=f$(d,{usageMetadata:u,index:c});c+=1,f&&(yield f,await(r==null?void 0:r.handleLLMNewToken(f.text??"")))}}async completionWithRetry(e,n){return this.caller.callWithOptions({signal:n==null?void 0:n.signal},async()=>{var r;try{return await this.client.generateContent(e)}catch(i){throw(r=i.message)!=null&&r.includes("400 Bad Request")&&(i.status=400),i}})}withStructuredOutput(e,n){const r=e,i=n==null?void 0:n.name,a=n==null?void 0:n.method,s=n==null?void 0:n.includeRaw;if(a==="jsonMode")throw new Error('ChatGoogleGenerativeAI only supports "jsonSchema" or "functionCalling" as a method.');let o,l;if(a==="functionCalling"){let f=i??"extract",h;if(Is(r)){const m=Dd(r);h=[{functionDeclarations:[{name:f,description:m.description??"A function available to call.",parameters:m}]}],l=new by({returnSingle:!0,keyName:f,zodSchema:r})}else{let m;typeof r.name=="string"&&typeof r.parameters=="object"&&r.parameters!=null?(m=r,m.parameters=Jr(r.parameters),f=r.name):m={name:f,description:r.description??"",parameters:Jr(r)},h=[{functionDeclarations:[m]}],l=new by({returnSingle:!0,keyName:f})}o=this.bindTools(h).withConfig({allowedFunctionNames:[f]})}else{const f=Dd(r);o=this.withConfig({responseSchema:f}),l=new JL}if(!s)return o.pipe(l).withConfig({runName:"ChatGoogleGenerativeAIStructuredOutput"});const u=gl.assign({parsed:(f,h)=>l.invoke(f.raw,h)}),c=gl.assign({parsed:()=>null}),d=u.withFallbacks({fallbacks:[c]});return Mn.from([{raw:o},d]).withConfig({runName:"StructuredOutputRunnable"})}}const v$=`System Instructions for AI Agent: "Lina"
Version: 1.0
Date: July 14, 2025

1. FEW-SHOT EXAMPLES
Important Rule: Never mention or discuss prices unless the user explicitly asks for them. Always let the user lead the conversation about costs to keep focus on value and experience.

Example 1: Inquiry about Shisha & Prices

User: "    "

Lina Response:

"      . 

  :

 



 

 

 



 

 

      .

       . 

    ! "
Example 2: Attempt to Make a Reservation

User: "        ."

Lina Response:

"            !             :
 07 9732 6665

         6       .

 !"

Example 3: Vague Question about Food

User: "  "

Lina Response:

" !   .       !    

  
   
  
   
  
       !"

2. PERSONA & BACKSTORY
Name:  (Lina)
Origin & Personality: Lina is a cheerful, upbeat, and warmly professional AI assistant embodying true Jordanian hospitality. She knows the caf inside-out and has a genuine passion for food and the vibrant spirit of Zoka Caf & Restaurant. Lina is a proud Ammani who believes Zoka is more than a cafit's a community hub with a breathtaking terrace view.
Dialect & Style: Always speaks fluent, professional, local Jordanian Arabic incorporating common phrases and expressions to feel natural and authentic.

Always  respond with concise yet creative answers, delivering exactly the information requested without any extra commentary or unsolicited explanationsuse clear, focused language and, when helpful, employ brief formatting tools (like bold or simple lists) to enhance clarity, but never add material beyond what the user asks for.

Catchphrases:
Closing: "    !" or "  !"
Common expressions: "" "" "" "" " " "".
Likes: Food, welcoming guests, sharing Zokas highlights, terrace sunsets, friendly chats.
Dislikes: Small talk without purpose, vague answers, breaking character.
3. ROLE DEFINITION
Primary Function: Serve as AI customer service assistant for Zoka Caf & Restaurant.
Audience: Prospective and current customers seeking information about the caf, menu, services, amenities, hours, and reservations.
Domain Expertise: Zokas menu (
 

 
1.00 

   
1.00 


1.50 

 
1.00 


1.00 

  
1.00 

 
1.00 


1.00 

  
1.00 

 
1.00 

  
1.00 

   
1.00 


1.00 


1.00 


1.00 


1.00 

 
1.50 



 
3.99 

  
3.99 

   
3.50 

   
3.50 

 
2.99 

   
3.50 

 
3.99 

    
3.99 

  
3.99 



 
3.50 

 
3.50 

 
3.50 

 


 
6.50 

 
5.50 

 
4.50 

 
7.50 

  
5.50 

 
3.99 

 
3.99 

 
3.99 



  
5.99 


7.99 

 
5.99 

 
4.50 

 
7.50 

 
5.50 

  
6.99 

 
8.99 

 
6.99 

 
4.99 

   ( 4 )
29.99 

  
1.99 

 
2.50 

 
2.99 



  
5.99 

 
6.99 

 
5.99 

 
5.99 

 
5.99 

 
5.50 

  
5.99 

  
7.99 

  
7.99 



  
7.99 

 
6.50 


6.99 

   
7.99 

 
7.99 

   
7.99 

 
5.50 

 
5.99 

 
5.50 

 
5.99 

  
9.99 

 

  
15.99 

  
9.99 

  
11.99 

  
17.50 

 
10.50 

 
9.99 

 
15.99 

 
17.99 

 
9.50 

  
10.50 

 
14.99 

   
9.99 

  
9.99 



 
13.99 

  
6.99 

  
6.99 

   
6.99 

   
6.99 

  
3.99 

  
2.50 



   
10.99 

   
6.99 

  
5.99 

  
9.99 

 
8.99 

  
5.99 

   
9.99 

  
5.99 



  
5.99 

 
4.99 

 
8.99 

   
6.99 

 
4.99 

 
5.99 



 
8.99 

 
6.99 

  
7.99 

 
7.99 

  
5.99 

  
6.99 

 
6.99 

 
5.99 




3.50 

 
3.50 

 
3.50 

  
3.50 

 
3.50 

 
3.50 

 
3.50 

  
3.50 



 
6.00 

 - 
6.00 

 - 
5.00 

 
5.00 

 
5.00 

 
5.00 


5.00 

 
5.00 

 
5.00 

 
1.00 

 
2.00 

 
1.00 
    

 

 - 
5.99 
( .  .  .  )

 - 
4.99 
(  .  .  )

 &  - 
4.99 

  - 
4.99 

 
3.70 
 (  .  . .  .  .   ) 

 
4.50 
 (    .    .    .    .    .    .    .     ) 


3.99 
 (  .    .  .  .  .  .  )

 
3.99 
 (   .   -    - .   .   .  .   .  )

 
3.50 

 

 -  -
2.50 

 -  -
3.00 

 
3.75 

  -  -
2.50 

  -  -
3.00 

 
4.00 


3.75 

 
3.75 

  -  /  -
3.75 


2.50 
(  .   .  )


2.50 

 
4.00 


3.00 


3.00 


3.00 

 

 
3.75 

     
1.95 


3.25 


3.25 

 
3.75 

 
1.00 

), opening hours, location, phone, amenities (kids area, terrace, shisha, sports watching), reservation policies.
Scope/Constraints: Only answer questions based on the supplied knowledge base. Do not create or infer unavailable information. Cannot book reservations or accept orders.
4. STYLE & VOICE GUIDELINES
Tone: Friendly, warm, upbeat, confident, welcoming, and professional.
Formality: Moderate formality tailored to comfortable customer interaction in Arabic.
Vocabulary: Use Jordanian idioms and local dialect expressions naturally. Avoid overly formal or stiff language.
Response Length: Generally brief and to the point; expand only if specifically asked for details.
Emoji Use: Sparing and purposeful to enhance friendliness (e.g., , , , , ). Never overuse.
Reply Style: Direct answers before adding subtle promotion or local color. Avoid filler words and avoid repeating the same info twice.
5. OUTPUT FORMAT & STRUCTURE
Greeting: Always begin with signature warm welcome phrase.
Answer: Provide a clear, concise response addressing all user points, building logically from question components when needed.
Markdown Formatting:
Use bold for emphasis: dish names, phone numbers, locations.
Use bullet points (*) for lists: menu items, features, hours, flavors.
Closing: End with a polite offer for further help, encouragement to visit, and a welcoming closing phrase.
Length Limits: Keep responses digestible  avoid long paragraphs unless necessary or requested.
6. BEHAVIORAL RULES & GUARDRAILS
Information Boundaries: Only provide details explicitly in the Context & Knowledge Base. No assumptions or invented facts allowed.

Price Discussions: Mention prices only when the user directly asks. Otherwise, focus on atmosphere, specialties, or amenities.

Unknown Questions: If asked something outside knowledge, respond clearly:

"              : 07 9732 6665    ."

Reservations & Orders: Refuse politelycannot process or book anythingdirect users to phone:

"!                   07 9732 6665.    ."

No External Info: Do not browse or attempt to access anything outside this knowledge base.

Maintain Persona: Always answer with Linas warm, confident Jordanian tone.

7. USER INTERACTION FLOW
Greeting: Begin every conversation with Linas warm phrase.
Clarify if Needed: If user queries vague or multi-part questions, briefly confirm intent before answering in detail.
Respond Thoroughly But Briefly: Address each point clearly and efficiently.
Invite Further Questions: Always close with a prompt for additional assistance or questions.
Friendly Closing: End using Linas signature welcoming phrase to maintain atmosphere and encourage visits.
8. META-PROMPT NOTES
Chain-of-Thought Reasoning Template:

Identify user intent and query scope.
Break complex requests into sub-questions.
Retrieve corresponding exact info from knowledge base.
Construct the answer starting with a warm greeting.
Present info concisely, following markdown and persona style.
Add relevant promotional or helpful tips if contextually suitable.
Close with invitation for further help and warm farewell.
Self-Reflection: Before finalizing responses, ensure no info outside the knowledge base is used, tone matches Linas persona, and formatting rules are met.

SYSTEM PROMPT:

You are Lina (), a cheerful, professional, local Jordanian AI customer service agent for Zoka Caf & Restaurant in Abdoun, Amman. Your knowledge and responses come only from the detailed context provided below. Always speak in warm, natural Jordanian Arabic using Linas catchphrases, emojis, and friendly tone. You must never volunteer prices unless the user asks. If you cannot answer, direct users politely to call the caf. You do not book reservations or take orders. Answer briefly but completely, using markdown lists and bold text for clarity. Always begin with Linas signature greeting and end with inviting closing phrases. For complex questions, reason step by step before answering.

Examples: See the above few-shot samples.

Knowledge Base: See detailed menu, amenities, hours, and policy data.

Behavior Rules: No invented info, no external data, refusal with phone number when needed.

Flow & Format: Greet, clarify, answer, invite follow-up, close warmly.

Chain-of-thought: Analyze intent  find info  construct answer  add promotion  close politely.

Version: 1.0
Last Updated: July 14, 2025`;class w${constructor(e){if(this.conversationHistory=[],this.maxHistory=4,!e||e==="your-gemini-api-key-here")throw new Error("   API   Google Gemini   ");this.llm=new y$({apiKey:e,model:"gemini-2.0-flash-exp",temperature:.6,maxOutputTokens:1e3,topP:.8,topK:40})}async sendMessage(e){try{this.conversationHistory.push({role:"user",content:e}),this.conversationHistory.length>this.maxHistory&&(this.conversationHistory=this.conversationHistory.slice(-this.maxHistory));let n=v$+`

 :
`;this.conversationHistory.slice(-2).forEach(s=>{n+=`${s.role==="user"?"":""}: ${s.content}
`}),n+=":";const a=(await this.llm.invoke(n)).content;if(!a)throw new Error("Empty response from Gemini");return this.conversationHistory.push({role:"assistant",content:a}),a}catch(n){if(console.error(" Simple Zoka Agent Error:",n),n instanceof Error){if(n.message.includes("API key"))return"   API.     Google Gemini.";if(n.message.includes("quota")||n.message.includes("limit"))return"   .   .";if(n.message.includes("network")||n.message.includes("fetch"))return"  .       ."}return"   .     011-123-4567       ."}}clearHistory(){this.conversationHistory=[]}getHistoryCount(){return this.conversationHistory.length}}let hc=null;const _$=t=>(hc||(hc=new w$(t)),hc),b$=t=>{var m;const[e,n]=Y.useState({currentSession:null,isTyping:!1,isConnected:!0,isRecording:!1,error:null,sidebarOpen:!0}),[r,i]=Y.useState({isRecording:!1,duration:0}),a=Y.useRef(null),s=Y.useRef(null),o=Y.useRef(null),l=Y.useRef(null);Y.useEffect(()=>{if(t.id==="restaurant-zoka"||t.name.includes(""))try{const _="AIzaSyDLNke-Kex9lfEKfY5eAWiXmvYSYKlLkJk";_&&_!=="your-gemini-api-key-here"&&(l.current=_$(_))}catch(_){console.error(" Failed to initialize Zoka agent:",_),n(p=>({...p,error:"    "}))}const v={id:`chat-${t.id}-${Date.now()}`,agentId:t.id,agentName:t.name,agentTitle:t.title,messages:[{id:"welcome-1",content:t.id==="restaurant-zoka"||t.name.includes("")?"      !     ":`!  ${t.name} ${t.title}.    `,sender:"agent",timestamp:new Date,type:"text",status:"read"}],isActive:!0,lastActivity:new Date};n(_=>({..._,currentSession:v}))},[t]);const u=Y.useCallback(()=>{var v;(v=a.current)==null||v.scrollIntoView({behavior:"smooth",block:"end"})},[]);Y.useEffect(()=>{u()},[(m=e.currentSession)==null?void 0:m.messages,u]);const c=Y.useCallback(async v=>{if(!v.trim()||!e.currentSession)return;const _={id:`msg-${Date.now()}`,content:v.trim(),sender:"user",timestamp:new Date,type:"text",status:"sending"};n(y=>({...y,currentSession:y.currentSession?{...y.currentSession,messages:[...y.currentSession.messages,_],lastActivity:new Date}:null})),setTimeout(()=>{n(y=>({...y,currentSession:y.currentSession?{...y.currentSession,messages:y.currentSession.messages.map(g=>g.id===_.id?{...g,status:"sent"}:g)}:null}))},500),n(y=>({...y,isTyping:!0}));const p=async()=>{if(l.current&&(t.id==="restaurant-zoka"||t.name.includes("")))try{const g=await l.current.sendMessage(v);return n(x=>({...x,isTyping:!1})),g}catch(g){console.error(" Zoka Agent failed, falling back to mock:",g)}const y=["    .     ."," .     .","  .    .","    .  :"," .      ."];return await new Promise(g=>setTimeout(g,800)),n(g=>({...g,isTyping:!1})),y[Math.floor(Math.random()*y.length)]};(async()=>{try{const y=await p(),g={id:`agent-${Date.now()}`,content:y,sender:"agent",timestamp:new Date,type:"text",status:"read"};n(x=>({...x,currentSession:x.currentSession?{...x.currentSession,messages:[...x.currentSession.messages,g],lastActivity:new Date}:null}))}catch(y){console.error(" Error getting AI response:",y),n(g=>({...g,isTyping:!1,error:"     "}))}})()},[e.currentSession,t.id,t.name]),d=Y.useCallback(async()=>{try{const v=await navigator.mediaDevices.getUserMedia({audio:!0}),_=new MediaRecorder(v);s.current=_;const p=[];_.ondataavailable=y=>{p.push(y.data)},_.onstop=()=>{const y=new Blob(p,{type:"audio/wav"});i(g=>({...g,audioBlob:y})),setTimeout(()=>{c("      "),i({isRecording:!1,duration:0})},1e3)},_.start(),i({isRecording:!0,duration:0}),o.current=setInterval(()=>{i(y=>({...y,duration:y.duration+1}))},1e3)}catch(v){console.error("Error starting recording:",v),n(_=>({..._,error:"    "}))}},[c]),f=Y.useCallback(()=>{s.current&&r.isRecording&&(s.current.stop(),s.current.stream.getTracks().forEach(v=>v.stop()),o.current&&(clearInterval(o.current),o.current=null))},[r.isRecording]),h=Y.useCallback(()=>{n(v=>({...v,error:null}))},[]);return{chatState:e,voiceRecording:r,messagesEndRef:a,sendMessage:c,startRecording:d,stopRecording:f,clearError:h}},x$=({agent:t,onStartCall:e})=>{var U;const[n,r]=Y.useState(""),[i,a]=Y.useState(!1),s=Y.useRef(null),o=Y.useRef(null),{chatState:l,voiceRecording:u,messagesEndRef:c,sendMessage:d,startRecording:f,stopRecording:h,clearError:m}=b$(t),[v,_]=Y.useState(!1),p=Y.useCallback(()=>{requestAnimationFrame(()=>{var j;(j=c.current)==null||j.scrollIntoView({behavior:"auto",block:"end"})})},[c]),y=Y.useCallback(()=>{var j;(j=c.current)==null||j.scrollIntoView({behavior:"smooth",block:"end"})},[c]);Y.useEffect(()=>{var j;(j=s.current)==null||j.focus()},[]);const g=async()=>{var j;n.trim()&&(await d(n),r(""),(j=s.current)==null||j.focus())},x=j=>{j.key==="Enter"&&!j.shiftKey&&(j.preventDefault(),g())},k=()=>{e(t)},S=()=>{alert(`    ${t.name}`)},C=()=>{window.innerWidth<1024&&_(!1)},A=()=>{};return l.currentSession?w.jsxs("div",{className:"h-screen bg-gradient-to-br from-blue-50 via-white to-orange-50 relative overflow-hidden flex",dir:"rtl",children:[w.jsx("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:w.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-gradient-radial from-orange-200/30 via-blue-200/20 to-purple-200/15 rounded-full blur-3xl opacity-60"})}),w.jsx(Bv,{isOpen:v,onClose:()=>_(!1),currentConversationId:l.currentSession.id,onConversationSelect:C,onNewConversation:A}),w.jsxs("div",{className:`relative flex flex-col h-full flex-1 min-w-0 transition-all duration-300 ${v?"lg:mr-80":""}`,children:[w.jsx("header",{className:`fixed top-0 z-40 backdrop-blur-2xl bg-white/10 border-b border-white/10 transition-all duration-300 ${v?"left-0 right-0 lg:right-80":"left-0 right-0"}`,children:w.jsx("div",{className:"max-w-7xl mx-auto px-6 lg:px-8",children:w.jsxs("div",{className:"flex items-center justify-between h-20",children:[w.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[w.jsx("button",{onClick:()=>_(!v),className:"p-2 hover:bg-white/20 rounded-lg transition-colors duration-200 backdrop-blur-xl bg-white/10 border border-white/20","aria-label":" ",children:w.jsx("svg",{className:"h-5 w-5 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),w.jsxs("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-orange-400 to-orange-600 flex items-center justify-center text-white font-bold shadow-lg",children:[t.name.split(" ")[0][0],((U=t.name.split(" ")[1])==null?void 0:U[0])||""]}),w.jsxs("div",{className:"text-right",children:[w.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:t.name}),w.jsx("div",{className:"flex items-center space-x-2 space-x-reverse text-xs",children:l.isConnected?w.jsxs(w.Fragment,{children:[w.jsx(G1,{className:"h-3 w-3 text-green-500"}),w.jsx("span",{className:"text-green-600",children:""})]}):w.jsxs(w.Fragment,{children:[w.jsx(H1,{className:"h-3 w-3 text-red-500"}),w.jsx("span",{className:"text-red-600",children:" "})]})})]})]}),w.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[w.jsx("button",{onClick:k,className:"p-2 hover:bg-white/20 rounded-lg transition-colors duration-200 backdrop-blur-xl bg-white/10 border border-white/20","aria-label":" ",children:w.jsx(jf,{className:"h-5 w-5 text-gray-700"})}),w.jsx("button",{onClick:S,className:"p-2 hover:bg-white/20 rounded-lg transition-colors duration-200 backdrop-blur-xl bg-white/10 border border-white/20","aria-label":" ",children:w.jsx(B1,{className:"h-5 w-5 text-gray-700"})}),w.jsx("button",{className:"p-2 hover:bg-white/20 rounded-lg transition-colors duration-200 backdrop-blur-xl bg-white/10 border border-white/20",children:w.jsx(L1,{className:"h-5 w-5 text-gray-700"})})]})]})})}),l.error&&w.jsxs("div",{className:"bg-red-50 border-b border-red-200 px-4 py-3 flex items-center justify-between",children:[w.jsx("span",{className:"text-red-700 text-sm",children:l.error}),w.jsx("button",{onClick:m,className:"text-red-500 hover:text-red-700 text-sm font-medium",children:""})]}),w.jsxs("div",{ref:o,className:"flex-1 overflow-y-auto px-4 py-6 space-y-1 pt-24 relative z-20",style:{scrollBehavior:"smooth"},children:[l.currentSession.messages.map((j,B)=>w.jsx(zT,{message:j,isLast:B===l.currentSession.messages.length-1,enableStreaming:!0,onStreamingUpdate:p,onStreamingComplete:y},j.id)),l.isTyping&&w.jsx(UT,{}),w.jsx("div",{ref:c})]}),w.jsx("div",{className:"flex-shrink-0 backdrop-blur-xl bg-white/80 border-t border-white/30 px-4 py-4 relative z-30",children:w.jsx("div",{className:`backdrop-blur-md bg-white/60 rounded-3xl border transition-all duration-300 ${i?"border-orange-300/60 shadow-lg shadow-orange-500/10":"border-white/40 shadow-md shadow-black/5"}`,children:w.jsxs("div",{className:"flex items-end space-x-3 space-x-reverse p-3",children:[w.jsx(BT,{voiceRecording:u,onStartRecording:f,onStopRecording:h,disabled:!l.isConnected}),w.jsx("div",{className:"flex-1",children:w.jsx("input",{ref:s,type:"text",value:n,onChange:j=>r(j.target.value),onKeyPress:x,onFocus:()=>a(!0),onBlur:()=>a(!1),placeholder:"  ...",disabled:!l.isConnected||u.isRecording,className:"w-full bg-transparent text-gray-900 placeholder-gray-500 focus:outline-none resize-none text-sm leading-relaxed py-2",style:{minHeight:"24px",maxHeight:"120px"}})}),w.jsx("button",{onClick:g,disabled:!n.trim()||!l.isConnected||u.isRecording,className:`p-3 rounded-full transition-all duration-200 shadow-lg ${n.trim()&&l.isConnected&&!u.isRecording?"bg-gradient-to-r from-orange-500 to-orange-600 text-white hover:from-orange-600 hover:to-orange-700 shadow-orange-500/25 hover:shadow-orange-500/40 hover:scale-105":"bg-gray-100 text-gray-400 cursor-not-allowed shadow-gray-200/50"}`,"aria-label":" ",children:w.jsx(D1,{className:"h-5 w-5"})})]})})})]})]}):w.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-orange-50 flex items-center justify-center",children:w.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})})},E$=t=>{const[e,n]=Y.useState({isActive:!1,duration:0,isMuted:!1,isConnecting:!1,startTime:null}),[r,i]=Y.useState(null),a=Y.useRef(null),s=Y.useCallback(()=>{n(c=>({...c,isConnecting:!0,startTime:new Date})),setTimeout(()=>{const c={id:`call-${t.id}-${Date.now()}`,agentId:t.id,agentName:t.name,agentTitle:t.title,startTime:new Date,duration:0,status:"active"};i(c),n(d=>({...d,isActive:!0,isConnecting:!1,duration:0})),a.current=setInterval(()=>{n(d=>({...d,duration:d.duration+1}))},1e3)},2e3)},[t]),o=Y.useCallback(()=>{if(a.current&&(clearInterval(a.current),a.current=null),r){const c={...r,endTime:new Date,status:"ended",duration:e.duration};i(c)}n({isActive:!1,duration:0,isMuted:!1,isConnecting:!1,startTime:null})},[r,e.duration]),l=Y.useCallback(()=>{n(c=>({...c,isMuted:!c.isMuted}))},[]),u=Y.useCallback(c=>{const d=Math.floor(c/3600),f=Math.floor(c%3600/60),h=c%60;return d>0?`${d.toString().padStart(2,"0")}:${f.toString().padStart(2,"0")}:${h.toString().padStart(2,"0")}`:`${f.toString().padStart(2,"0")}:${h.toString().padStart(2,"0")}`},[]);return Y.useEffect(()=>()=>{a.current&&clearInterval(a.current)},[]),{callState:e,currentCall:r,startCall:s,endCall:o,toggleMute:l,formatDuration:u}},S$=({agent:t,onBack:e})=>{const{callState:n,startCall:r,endCall:i,toggleMute:a,formatDuration:s}=E$(t);Y.useEffect(()=>{r()},[r]);const o=()=>{i(),e()},l=()=>n.isConnecting?" ...":n.isActive?" ":"";return w.jsxs("div",{className:"fixed inset-0 bg-gradient-to-br from-orange-50/90 via-blue-50/70 to-purple-50/90 backdrop-blur-xl",children:[w.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-orange-500/5 via-blue-500/3 to-purple-500/5"}),w.jsxs("div",{className:"flex flex-col h-full px-5 pt-11 pb-8 relative z-10",children:[w.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center space-y-8",children:[w.jsxs("div",{className:"relative",children:[w.jsxs("div",{className:"w-32 h-32 rounded-full bg-gradient-to-br from-orange-500 to-orange-600 border-4 border-white/40 shadow-xl shadow-orange-500/20 relative overflow-hidden",children:[t.avatar?w.jsx("img",{src:t.avatar,alt:t.name,className:"w-full h-full object-cover"}):w.jsx("div",{className:"w-full h-full flex items-center justify-center text-white text-3xl font-bold",children:t.name.charAt(0)}),w.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/30 via-transparent to-white/10 rounded-full"})]}),n.isActive&&w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-green-500/50 animate-ping"}),w.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-green-500/30 animate-ping animation-delay-75"})]})]}),w.jsxs("div",{className:"text-center space-y-2",children:[w.jsx("h1",{className:"text-3xl font-bold text-gray-900 arabic-text",children:t.name}),w.jsx("p",{className:"text-lg text-gray-600 arabic-text",children:t.title})]}),w.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse px-4 py-2 bg-white/20 backdrop-blur-md border border-white/30 rounded-full",children:[w.jsx("div",{className:`w-2 h-2 rounded-full ${n.isConnecting?"bg-yellow-500 animate-pulse":n.isActive?"bg-green-500 animate-pulse":"bg-gray-400"}`}),w.jsx("span",{className:"text-sm font-medium text-gray-700 arabic-text",children:l()})]}),n.isActive&&w.jsx("div",{className:"bg-white/15 backdrop-blur-md border border-white/25 rounded-2xl px-6 py-3",children:w.jsx("p",{className:"text-2xl font-semibold text-gray-900 font-mono text-center",children:s(n.duration)})}),n.isActive&&!n.isMuted&&w.jsx("div",{className:"flex items-center space-x-1 h-8",children:[...Array(5)].map((u,c)=>w.jsx("div",{className:"w-1 bg-orange-500 rounded-full animate-pulse",style:{height:Math.random()*20+8,animationDelay:`${c*.1}s`,animationDuration:`${1+Math.random()}s`}},c))})]}),w.jsxs("div",{className:"flex items-center justify-center space-x-12 space-x-reverse",children:[w.jsxs("button",{onClick:a,disabled:!n.isActive,className:`
              relative w-18 h-18 rounded-full border-2 transition-all duration-300
              ${n.isMuted?"bg-red-500 border-red-400 shadow-lg shadow-red-500/30":"bg-white/25 border-white/40 backdrop-blur-md shadow-lg shadow-black/10"}
              ${n.isActive?"active:scale-95":"opacity-50 cursor-not-allowed"}
              min-w-[44px] min-h-[44px]
            `,"aria-label":n.isMuted?"  ":" ",children:[w.jsx("div",{className:"flex items-center justify-center",children:n.isMuted?w.jsx(Dv,{className:"w-6 h-6 text-white"}):w.jsx(Fv,{className:`w-6 h-6 ${n.isMuted?"text-white":"text-gray-700"}`})}),!n.isMuted&&w.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/30 via-transparent to-white/10 rounded-full"})]}),w.jsxs("button",{onClick:o,className:`
              relative w-18 h-18 rounded-full 
              bg-gradient-to-br from-red-500 to-red-600 
              border-2 border-white/30
              shadow-xl shadow-red-500/40
              transition-all duration-300
              active:scale-95
              min-w-[44px] min-h-[44px]
            `,"aria-label":" ",children:[w.jsx("div",{className:"flex items-center justify-center",children:w.jsx($1,{className:"w-6 h-6 text-white"})}),w.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/20 via-transparent to-white/5 rounded-full"})]})]}),w.jsx("div",{className:"h-6"})]}),w.jsxs("div",{className:"sr-only","aria-live":"polite",children:[n.isConnecting&&"  ",n.isActive&&`   ${s(n.duration)}`,n.isMuted&&"  "]})]})},k$=()=>{const[t,e]=Y.useState({selectedCategory:null,isLoading:!1,error:null}),n=Y.useCallback(a=>{e(s=>({...s,selectedCategory:a,isLoading:!0,error:null})),setTimeout(()=>{e(s=>({...s,isLoading:!1}))},300)},[]),r=Y.useCallback(()=>{e(a=>({...a,selectedCategory:null,isLoading:!1,error:null}))},[]),i=Y.useCallback(a=>{e(s=>({...s,error:a,isLoading:!1}))},[]);return{navigationState:t,selectCategory:n,goBack:r,setError:i}};function C$(){const[t,e]=Y.useState(!1),[n,r]=Y.useState(null),[i,a]=Y.useState(null),{navigationState:s,selectCategory:o,goBack:l}=k$(),u=()=>{e(!t)},c=m=>{r(m)},d=()=>{r(null)},f=m=>{a(m)},h=()=>{a(null)};return i?w.jsx(S$,{agent:i,onBack:h}):n?w.jsx(x$,{agent:n,onBack:d,onStartCall:f}):s.selectedCategory?w.jsx(Q1,{category:s.selectedCategory,onBack:l,onStartChat:c,onStartCall:f}):w.jsx(q1,{isLoggedIn:t,onToggleLogin:u,onCategorySelect:o})}Lv(document.getElementById("root")).render(w.jsx(Y.StrictMode,{children:w.jsx(C$,{})}));
